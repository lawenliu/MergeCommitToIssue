time:
2014-08-19T15:04:13Z
class:
src/main/java/org/elasticsearch/action/admin/indices/create/CreateIndexRequest.java
src/main/java/org/elasticsearch/action/bulk/TransportBulkAction.java
src/main/java/org/elasticsearch/action/delete/TransportDeleteAction.java
src/main/java/org/elasticsearch/action/index/TransportIndexAction.java
src/main/java/org/elasticsearch/action/support/master/AcknowledgedRequest.java
src/main/java/org/elasticsearch/action/support/master/MasterNodeOperationRequest.java
src/main/java/org/elasticsearch/action/update/TransportUpdateAction.java
comments:
Internal: auto create index to keep around headers and context of the request that caused it

Closes #7331

time:
2014-08-19T15:04:13Z
class:
src/main/java/org/elasticsearch/action/get/TransportShardMultiGetAction.java
src/main/java/org/elasticsearch/action/percolate/TransportShardMultiPercolateAction.java
src/main/java/org/elasticsearch/action/support/single/shard/TransportShardSingleOperationAction.java
src/main/java/org/elasticsearch/action/termvector/TransportSingleShardMultiTermsVectorAction.java
src/main/java/org/elasticsearch/transport/ActionNames.java
comments:
Internal: made it possible to disable the main transport handler in TransportShardSingleOperationAction

TransportShardSingleOperationAction is currently subclassed by different transport actions. Some of them are internal only, meaning that their execution will take place only in the same node where their parent execution took place. That means that their main transport handler doesn't need to be registered, the only transport handler that's needed is the shard level one.

Added `isSubAction` method (defaults to false) to the parent class that tells whether the action is a main one or a subaction, used to decide whether we need to register the main transport handler.

Closes #7285

time:
2014-08-19T14:34:54Z
class:
src/test/java/org/elasticsearch/search/aggregations/bucket/ChildrenTests.java
comments:
[TEST] Added more assertions

time:
2014-08-19T13:33:05Z
class:
src/main/java/org/elasticsearch/index/fielddata/FieldData.java
src/main/java/org/elasticsearch/index/fielddata/SortableLongBitsNumericDocValues.java
src/main/java/org/elasticsearch/index/fielddata/SortableLongBitsSortedNumericDocValues.java
src/main/java/org/elasticsearch/index/fielddata/SortableLongBitsToNumericDoubleValues.java
src/main/java/org/elasticsearch/index/fielddata/SortableLongBitsToSortedNumericDoubleValues.java
src/main/java/org/elasticsearch/index/fielddata/plain/SortedNumericDVIndexFieldData.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/DoubleTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/LongTerms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/LongTermsAggregator.java
src/test/java/org/elasticsearch/index/fielddata/FieldDataTests.java
comments:
Aggregations: Merge LongTermsAggregator and DoubleTermsAggregator.

These two aggregators basically do exactly the same thing, they just interpret
bytes differently. This refactoring found an (unreleased) bug in the long terms
aggregator which didn't work correctly with duplicate values.

Close #7279

time:
2014-08-19T12:56:06Z
class:
src/main/java/org/elasticsearch/index/store/DistributorDirectory.java
src/test/java/org/elasticsearch/index/store/DistributorDirectoryTest.java
comments:
Core: DistributorDirectory shouldn't search for directory when reading existing file

This was causing too much work e.g. when pulling node stats or when
opening a new reader, because the least_used distributor would
unnecessarily check free disk space on all path.data entires every
time we try to open a file for reading or check its length.

Closes #7306

Closes #7323

time:
2014-08-19T12:32:42Z
class:
src/main/java/org/elasticsearch/action/get/GetRequest.java
src/main/java/org/elasticsearch/action/get/MultiGetRequest.java
src/main/java/org/elasticsearch/action/percolate/TransportMultiPercolateAction.java
src/main/java/org/elasticsearch/action/percolate/TransportPercolateAction.java
src/main/java/org/elasticsearch/action/support/single/shard/SingleShardOperationRequest.java
comments:
Internal: get request while percolating existing documents to keep around headers and context of the original percolate request

Closes #7333

time:
2014-08-19T11:43:36Z
class:
src/main/java/org/elasticsearch/action/admin/indices/template/delete/DeleteIndexTemplateAction.java
src/main/java/org/elasticsearch/action/admin/indices/template/get/GetIndexTemplatesAction.java
src/main/java/org/elasticsearch/action/admin/indices/template/put/PutIndexTemplateAction.java
comments:
Internal: changed index templates api category from indices to cluster

time:
2014-08-19T10:40:51Z
class:
src/main/java/org/elasticsearch/index/search/child/ConstantScorer.java
src/main/java/org/elasticsearch/search/aggregations/AggregationBuilders.java
src/main/java/org/elasticsearch/search/aggregations/AggregationModule.java
src/main/java/org/elasticsearch/search/aggregations/TransportAggregationModule.java
src/main/java/org/elasticsearch/search/aggregations/bucket/children/Children.java
src/main/java/org/elasticsearch/search/aggregations/bucket/children/ChildrenBuilder.java
src/main/java/org/elasticsearch/search/aggregations/bucket/children/ChildrenParser.java
src/main/java/org/elasticsearch/search/aggregations/bucket/children/InternalChildren.java
src/main/java/org/elasticsearch/search/aggregations/bucket/children/ParentToChildrenAggregator.java
src/main/java/org/elasticsearch/search/aggregations/support/AggregationContext.java
src/main/java/org/elasticsearch/search/aggregations/support/ValuesSource.java
src/test/java/org/elasticsearch/benchmark/search/child/ChildSearchBenchmark.java
src/test/java/org/elasticsearch/search/aggregations/bucket/ChildrenTests.java
comments:
Aggregations: Add `children` bucket aggregator that is able to map buckets between parent types and child types using the already builtin parent/child support.

Closes #6936

time:
2014-08-19T08:55:41Z
class:
src/main/java/org/elasticsearch/common/cli/CliToolConfig.java
src/test/java/org/elasticsearch/common/cli/CliToolTests.java
comments:
Cli: parsing multiple times throws `AlreadySelectedException`

This issue has been fixed in commons-cli:1.3 project which sadly has not been released yet.
See https://issues.apache.org/jira/browse/CLI-183

This patch builds another list of options with no selected groups by default.

When commons-cli:1.3 will be released, we need to remove this patch.

Closes #7282.

time:
2014-08-18T19:52:53Z
class:
comments:
update documentation with release 2.3.1

time:
2014-08-18T19:46:29Z
class:
src/main/java/org/elasticsearch/threadpool/ThreadPool.java
comments:
Core: switch to fixed thread pool by default for management threads

Switch management threads to a fixed thread pool with up to 5 threads, and queue size of 100 by default, after which excess incoming requests are rejected.

Closes #7318

Closes #7320

time:
2014-08-18T19:39:31Z
class:
comments:
update documentation with release 2.2.1

time:
2014-08-18T17:56:04Z
class:
src/main/java/org/elasticsearch/cluster/routing/RoutingNodes.java
src/main/java/org/elasticsearch/cluster/routing/allocation/AllocationService.java
comments:
[TEST] Don't invoke RoutingNodes.assertShardStats() via asserts many times in tests, just once on each reroute call.

time:
2014-08-18T15:49:36Z
class:
comments:
Update a few dependencies

Related to #80.

time:
2014-08-18T14:37:45Z
class:
src/test/java/org/elasticsearch/common/compress/CompressedStreamTests.java
src/test/java/org/elasticsearch/common/compress/CompressedStringTests.java
comments:
Tests: tone down random compression tests

Closes #7314

time:
2014-08-18T14:15:55Z
class:
comments:
Docs: Document distance type and sort mode for many to many geo_points

closes #7280

time:
2014-08-18T14:07:00Z
class:
src/main/java/org/elasticsearch/common/lucene/search/function/BoostScoreFunction.java
src/main/java/org/elasticsearch/common/lucene/search/function/FieldValueFactorFunction.java
src/main/java/org/elasticsearch/common/lucene/search/function/FiltersFunctionScoreQuery.java
src/main/java/org/elasticsearch/common/lucene/search/function/FunctionScoreQuery.java
src/main/java/org/elasticsearch/common/lucene/search/function/RandomScoreFunction.java
src/main/java/org/elasticsearch/common/lucene/search/function/ScoreFunction.java
src/main/java/org/elasticsearch/common/lucene/search/function/ScriptScoreFunction.java
src/main/java/org/elasticsearch/index/query/functionscore/DecayFunctionParser.java
src/main/java/org/elasticsearch/script/ExplainableSearchScript.java
src/main/java/org/elasticsearch/script/SearchScript.java
src/test/java/org/elasticsearch/common/lucene/search/function/RandomScoreFunctionTests.java
src/test/java/org/elasticsearch/search/functionscore/FunctionScoreTests.java
comments:
function_score: remove explanation of query score from functions

The score is explained already, it should not be again explained per function.

Also, remove explanation from parameter list of ScoreFunction#explainScore()
and leave only the score.

This also removes ExplainableSearchScript which is not used anywhere and
was the only reason to have the Explanation in the parameter anyway.

closes #7245

time:
2014-08-18T13:56:06Z
class:
comments:
[DOCS] document simple_query_string's `lenient` option

time:
2014-08-18T13:39:19Z
class:
src/test/java/org/elasticsearch/index/mapper/xcontent/MapperTestUtils.java
comments:
Update to elasticsearch 1.4.0

Related to #77.

(cherry picked from commit 7e65cfb)

time:
2014-08-18T13:37:03Z
class:
comments:
Update a few dependencies

Related to #80.

(cherry picked from commit 89d5460)

time:
2014-08-18T13:36:43Z
class:
comments:
[TEST] fix for wildcard_expansion REST tests

removed timeout from wait_for_green and set number of replicas to 0 so client tests can pass on single node.

time:
2014-08-18T12:55:39Z
class:
src/main/java/org/elasticsearch/common/geo/builders/GeometryCollectionBuilder.java
src/main/java/org/elasticsearch/common/geo/builders/ShapeBuilder.java
src/test/java/org/elasticsearch/common/geo/GeoJSONShapeParserTests.java
src/test/java/org/elasticsearch/search/geo/GeoShapeIntegrationTests.java
src/test/java/org/elasticsearch/test/hamcrest/ElasticsearchGeoAssertions.java
comments:
Geo: Adds support for GeoJSON GeometryCollection

Closes #2796

time:
2014-08-18T11:38:28Z
class:
comments:
Docs: Fixed header levels in setup/dir-layout.asciidoc

time:
2014-08-18T11:19:36Z
class:
comments:
Docs: Fixed bad ID

time:
2014-08-18T11:09:00Z
class:
comments:
Docs: Update nested-filter.asciidoc

Fix whitespace to standardize on spaces for indents on both code examples for readability.

Closes #6568

time:
2014-08-18T11:06:48Z
class:
comments:
Docs: Fix ambigous explanation of the "fields" parameter in `query_string` query

Closes #7292

time:
2014-08-18T11:04:25Z
class:
comments:
Docs: Update snapshots.asciidoc

Added a link so you directly get to the page that tells how to open/close an index.

Closes #7286

time:
2014-08-18T11:02:15Z
class:
comments:
Docs: Remove the 'Factor' paragraph to reflect #6490

The current implementation of 'date_histogram' does not understand
the `factor` parameter. Since the docs shouldn't raise false hopes,
I removed the section.

Closes #7277

time:
2014-08-18T11:01:12Z
class:
comments:
Docs: Remove phrase duplication in api-conventions.asciidoc

Closes #7263

time:
2014-08-18T11:00:30Z
class:
comments:
Docs: Fix typo in phrase-suggest.asciidoc

Closes #7262

time:
2014-08-18T10:59:31Z
class:
comments:
Docs: Update frontends.asciidoc

Closes #7224

time:
2014-08-18T10:58:49Z
class:
comments:
Docs: Fix minor typo in readme

Closes #7195

time:
2014-08-18T10:57:45Z
class:
comments:
Docs: Update integrations.asciidoc

Closes #7193

time:
2014-08-18T10:57:08Z
class:
comments:
Update repositories.asciidoc

Added apt-get update to the commands for clarity.

Closes #7192

time:
2014-08-18T10:42:23Z
class:
comments:
Docs: Updated typo in getting-started.asciidoc

A very small typo in the description.

Closes #7134

time:
2014-08-18T10:38:03Z
class:
comments:
Docs: make the welcome page more obvious

Closes #79.

time:
2014-08-18T10:35:18Z
class:
comments:
Update search-template.asciidoc

Remove extra commas in template query ;-)

Closes #7033

time:
2014-08-18T10:30:49Z
class:
comments:
Typo

time:
2014-08-18T10:28:53Z
class:
comments:
error in code

The top-tags and terms were reversed.

time:
2014-08-18T10:27:23Z
class:
comments:
Update a few dependencies

Closes #80.

(cherry picked from commit 930c8be)

time:
2014-08-18T10:21:25Z
class:
comments:
Docs: Added tables for directory locations for deb+rpm and zip+tar.gz installs

Closes #6508

time:
2014-08-18T10:10:45Z
class:
comments:
Docs: Added Bloodhound Haskell client/DSL to docs

Closes #6031

time:
2014-08-18T09:19:29Z
class:
src/main/java/org/elasticsearch/index/mapper/object/ObjectMapper.java
src/test/java/org/elasticsearch/index/mapper/nested/NestedMappingTests.java
comments:
Mapping: Fixes using nested doc array with strict mapping

Closes #7304

time:
2014-08-18T09:18:12Z
class:
comments:
[TEST] fix to wildcard_expansion tests to wait for green status

time:
2014-08-18T08:55:32Z
class:
comments:
Build: Changed license header definition file xml encoding to UTF-8

time:
2014-08-18T07:25:32Z
class:
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/DateHistogram.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/Histogram.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/InternalHistogram.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/InternalTerms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/Terms.java
comments:
Aggregations: Make the list of buckets for terms and histogram returned as a java.util.List.

The terms and histogram aggregations always have an order. So it would make the
response easier to consume to return the buckets as a list instead of a
collection in order to make it easier to do things like getting the first/last
buckets.

Close #7275

time:
2014-08-17T02:09:13Z
class:
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
comments:
Fix failed engine exception logging

time:
2014-08-16T01:01:14Z
class:
src/main/java/org/elasticsearch/action/admin/cluster/state/ClusterStateResponse.java
src/main/java/org/elasticsearch/client/support/Headers.java
src/main/java/org/elasticsearch/client/transport/TransportClient.java
src/main/java/org/elasticsearch/client/transport/TransportClientNodesService.java
src/test/java/org/elasticsearch/client/AbstractClientHeadersTests.java
src/test/java/org/elasticsearch/client/transport/InternalTransportClientTests.java
src/test/java/org/elasticsearch/client/transport/TransportClientHeadersTests.java
src/test/java/org/elasticsearch/client/transport/TransportClientNodesServiceTests.java
comments:
Fixed a request headers bug in transport client

Where the configured request headers were not sent with sniffing requests (both node/info & cluster state sniffing)

time:
2014-08-15T23:23:19Z
class:
src/main/java/org/elasticsearch/index/snapshots/blobstore/BlobStoreIndexShardRepository.java
src/test/java/org/elasticsearch/bwcompat/BasicBackwardsCompatibilityTest.java
comments:
Add more logging for testSnapshotAndRestore backward compatibility test

time:
2014-08-15T14:28:27Z
class:
comments:
Merge pull request #7158 from uschindler/forbiddenapis-1.6-update

Update forbidden-apis to 1.6Closes #7158

time:
2014-08-15T13:57:14Z
class:
src/main/java/org/elasticsearch/action/percolate/PercolateRequest.java
comments:
Java api: fixed inconsistencies in PercolateRequest, added return type for method chaining where missing

Closes #7294

time:
2014-08-15T13:28:12Z
class:
src/main/java/org/elasticsearch/index/analysis/AnalysisModule.java
src/main/java/org/elasticsearch/index/analysis/KeepTypesFilterFactory.java
src/test/java/org/elasticsearch/index/analysis/AnalysisFactoryTests.java
src/test/java/org/elasticsearch/index/analysis/KeepTypesFilterFactoryTests.java
comments:
Analysis: Add keep_types for filtering by token type

time:
2014-08-15T11:50:11Z
class:
src/main/java/org/elasticsearch/action/support/IndicesOptions.java
src/test/java/org/elasticsearch/cluster/metadata/MetaDataTests.java
comments:
REST API: Allows all options for expand_wildcards parameter

This change means that the default settings for expand_wildcards are only applied if the expand_wildcards parameter is not specified rather than being set upfront. It also adds the none and all options to the parameter to allow the user to specify no expansion and expansion to all indexes (equivalent to 'open,closed')

Closes #7258

time:
2014-08-14T14:27:30Z
class:
comments:
Fixed a typo

time:
2014-08-14T13:59:21Z
class:
src/test/java/org/elasticsearch/search/functionscore/DecayFunctionScoreTests.java
comments:
[TEST] remove unneeded explain(true)

closes #7248

time:
2014-08-14T13:59:19Z
class:
src/main/java/org/elasticsearch/index/query/functionscore/DecayFunctionParser.java
src/test/java/org/elasticsearch/search/functionscore/DecayFunctionScoreTests.java
comments:
function_score: fix explanation, [ was missing

time:
2014-08-14T13:26:15Z
class:
src/test/java/org/elasticsearch/index/fielddata/DisabledFieldDataFormatTests.java
src/test/java/org/elasticsearch/test/ElasticsearchSingleNodeTest.java
comments:
[TESTS] Make DisabledFieldDataFormatTests less evil.

time:
2014-08-14T12:55:52Z
class:
src/main/java/org/elasticsearch/action/explain/TransportExplainAction.java
src/main/java/org/elasticsearch/action/update/TransportUpdateAction.java
src/main/java/org/elasticsearch/cluster/metadata/MetaDataMappingService.java
src/main/java/org/elasticsearch/index/service/IndexService.java
src/main/java/org/elasticsearch/indices/IndicesService.java
src/main/java/org/elasticsearch/indices/cluster/IndicesClusterStateService.java
src/main/java/org/elasticsearch/indices/store/TransportNodesListShardStoreMetaData.java
src/test/java/org/elasticsearch/indices/store/SimpleDistributorTests.java
comments:
Internal: Add some @Nullable annotations and fix related compilation warnings.

Added @Nullable to:
 - IndicesService.indexService
 - IndexService.shard
 - IndexService.shardInjector

This change doesn't try to do anything smart but just makes sure that a
*MissingException is thrown instead of a NullPointerException when the requested
object doesn't exist.

Close #7251

time:
2014-08-14T12:19:37Z
class:
src/main/java/org/elasticsearch/action/support/single/shard/TransportShardSingleOperationAction.java
comments:
Internal: fixed wrong version check s/onOrBefore/before in TransportShardSingleOperationAction

relates to #7223

time:
2014-08-14T10:34:38Z
class:
src/main/java/org/elasticsearch/ElasticsearchException.java
src/main/java/org/elasticsearch/rest/BytesRestResponse.java
src/main/java/org/elasticsearch/rest/HasRestHeaders.java
src/main/java/org/elasticsearch/rest/RestResponse.java
src/test/java/org/elasticsearch/rest/BytesRestResponseTests.java
comments:
Introduced a new elasticsearch exception family that can hold headers

 - These heades will be copied as response header on the rest response

time:
2014-08-14T09:25:01Z
class:
src/main/java/org/elasticsearch/index/query/GeoDistanceFilterParser.java
comments:
Geo: Improved error handling in geo_distance

geo_distance filter now throws a parse exception if no distance parameter is supplied

Close #7260

time:
2014-08-14T08:53:08Z
class:
src/main/java/org/elasticsearch/plugins/PluginManager.java
src/test/java/org/elasticsearch/plugins/PluginManagerTests.java
comments:
Plugins: Add executable flag to every file in bin/ after install

The PluginManager does not preserve permissions on install. This patch
sets the executable flag on every file in bin/ on plugin install.

Closes #7177

time:
2014-08-13T15:38:18Z
class:
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/status/SnapshotIndexShardStatus.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/status/TransportSnapshotsStatusAction.java
src/main/java/org/elasticsearch/action/admin/indices/cache/clear/ShardClearIndicesCacheResponse.java
src/main/java/org/elasticsearch/action/admin/indices/cache/clear/TransportClearIndicesCacheAction.java
src/main/java/org/elasticsearch/action/admin/indices/flush/ShardFlushResponse.java
src/main/java/org/elasticsearch/action/admin/indices/flush/TransportFlushAction.java
src/main/java/org/elasticsearch/action/admin/indices/optimize/ShardOptimizeResponse.java
src/main/java/org/elasticsearch/action/admin/indices/optimize/TransportOptimizeAction.java
src/main/java/org/elasticsearch/action/admin/indices/recovery/ShardRecoveryResponse.java
src/main/java/org/elasticsearch/action/admin/indices/recovery/TransportRecoveryAction.java
src/main/java/org/elasticsearch/action/admin/indices/refresh/ShardRefreshResponse.java
src/main/java/org/elasticsearch/action/admin/indices/refresh/TransportRefreshAction.java
src/main/java/org/elasticsearch/action/admin/indices/segments/ShardSegments.java
src/main/java/org/elasticsearch/action/admin/indices/segments/TransportIndicesSegmentsAction.java
src/main/java/org/elasticsearch/action/admin/indices/stats/ShardStats.java
src/main/java/org/elasticsearch/action/admin/indices/stats/TransportIndicesStatsAction.java
src/main/java/org/elasticsearch/action/admin/indices/validate/query/ShardValidateQueryResponse.java
src/main/java/org/elasticsearch/action/admin/indices/validate/query/TransportValidateQueryAction.java
src/main/java/org/elasticsearch/action/count/ShardCountResponse.java
src/main/java/org/elasticsearch/action/count/TransportCountAction.java
src/main/java/org/elasticsearch/action/exists/ShardExistsResponse.java
src/main/java/org/elasticsearch/action/exists/TransportExistsAction.java
src/main/java/org/elasticsearch/action/percolate/PercolateShardResponse.java
src/main/java/org/elasticsearch/action/percolate/TransportPercolateAction.java
src/main/java/org/elasticsearch/action/suggest/ShardSuggestResponse.java
src/main/java/org/elasticsearch/action/suggest/TransportSuggestAction.java
src/main/java/org/elasticsearch/action/support/broadcast/BroadcastShardOperationRequest.java
src/main/java/org/elasticsearch/action/support/broadcast/BroadcastShardOperationResponse.java
src/main/java/org/elasticsearch/percolator/PercolatorService.java
comments:
Internal: adjusted BroadcastShardOperationResponse subclasses visibility

Also replaced int,String pair with ShardId that holds the same info and serializes it the same way.
Replaced shardId and index getters in BroadcastOperationRequest with a single ShardId getter.

Closes #7255

time:
2014-08-13T15:09:18Z
class:
comments:
[DOCS] Clarify Completion Suggester output deduplication

time:
2014-08-13T15:03:52Z
class:
src/main/java/org/elasticsearch/Version.java
comments:
Add [1.3.3] and [1.2.5] version constants.

time:
2014-08-13T12:51:21Z
class:
src/main/java/org/elasticsearch/cluster/metadata/MetaDataCreateIndexService.java
src/test/java/org/elasticsearch/indexing/IndexActionTests.java
comments:
Forbid index names over 100 characters in length

Fixes #4417

time:
2014-08-13T12:47:49Z
class:
src/main/java/org/elasticsearch/script/groovy/GroovySandboxExpressionChecker.java
src/test/java/org/elasticsearch/script/GroovySandboxScriptTests.java
comments:
Add GroovyCollections to the sandbox whitelist

Also clarify in the docs that changing the whitelist/blacklist settings
replace the list, they don't add to it.

Fixes #7089
Fixes #7088

time:
2014-08-13T10:25:11Z
class:
src/main/java/org/elasticsearch/http/netty/ESHttpContentDecompressor.java
src/main/java/org/elasticsearch/http/netty/NettyHttpServerTransport.java
comments:
A content decompressor that throws a human readable message when
compression is disabled and the user sends compressed content.

time:
2014-08-13T09:45:09Z
class:
src/main/java/org/elasticsearch/action/update/UpdateRequest.java
src/main/java/org/elasticsearch/index/indexing/IndexingStats.java
src/test/java/org/elasticsearch/bwcompat/BasicBackwardsCompatibilityTest.java
comments:
Update api & Indices stats: fixed version checks for no-op updates which got in after 1.3 was released

Also added basic bw comp test for indices stats api.

Relates to #6822

time:
2014-08-13T09:42:05Z
class:
src/test/java/org/elasticsearch/plugins/PluginLuceneCheckerTests.java
src/test/java/org/elasticsearch/plugins/PluginManagerTests.java
src/test/java/org/elasticsearch/plugins/ResponseHeaderPluginTests.java
src/test/java/org/elasticsearch/plugins/SitePluginTests.java
src/test/java/org/elasticsearch/plugins/lucene/current/CurrentLucenePlugin.java
src/test/java/org/elasticsearch/plugins/lucene/newer/NewerLucenePlugin.java
src/test/java/org/elasticsearch/plugins/lucene/old/OldLucenePlugin.java
src/test/java/org/elasticsearch/plugins/responseheader/TestResponseHeaderPlugin.java
src/test/java/org/elasticsearch/plugins/responseheader/TestResponseHeaderRestAction.java
comments:
Tests: move plugin dir to plugins dir

We should be consistent in our naming for classes and resources.

time:
2014-08-13T09:37:05Z
class:
src/main/java/org/elasticsearch/common/http/client/HttpDownloadHelper.java
comments:
Fix: VerboseProgress(PrintWriter) does not set the writer

time:
2014-08-13T09:23:51Z
class:
comments:
[DOCS] mention the type of caches that warmers load

time:
2014-08-13T08:19:45Z
class:
src/main/java/org/elasticsearch/index/query/FilterBuilders.java
src/main/java/org/elasticsearch/index/query/NumericRangeFilterBuilder.java
src/main/java/org/elasticsearch/index/query/NumericRangeFilterParser.java
src/main/java/org/elasticsearch/indices/query/IndicesQueriesModule.java
src/test/java/org/elasticsearch/index/query/SimpleIndexQueryParserTests.java
src/test/java/org/elasticsearch/search/query/SimpleQueryTests.java
comments:
Remove `numeric_range` filter

As done with #4034, `numeric_range` filter has been deprecated since 1.0.0.

Closes #7108.

time:
2014-08-13T07:51:51Z
class:
src/main/java/org/elasticsearch/action/admin/indices/cache/clear/ShardClearIndicesCacheRequest.java
src/main/java/org/elasticsearch/action/admin/indices/cache/clear/TransportClearIndicesCacheAction.java
src/main/java/org/elasticsearch/action/admin/indices/flush/ShardFlushRequest.java
src/main/java/org/elasticsearch/action/admin/indices/flush/TransportFlushAction.java
src/main/java/org/elasticsearch/action/admin/indices/optimize/ShardOptimizeRequest.java
src/main/java/org/elasticsearch/action/admin/indices/optimize/TransportOptimizeAction.java
src/main/java/org/elasticsearch/action/admin/indices/recovery/TransportRecoveryAction.java
src/main/java/org/elasticsearch/action/admin/indices/refresh/ShardRefreshRequest.java
src/main/java/org/elasticsearch/action/admin/indices/refresh/TransportRefreshAction.java
src/main/java/org/elasticsearch/action/admin/indices/segments/TransportIndicesSegmentsAction.java
src/main/java/org/elasticsearch/action/admin/indices/stats/TransportIndicesStatsAction.java
src/main/java/org/elasticsearch/action/admin/indices/validate/query/ShardValidateQueryRequest.java
src/main/java/org/elasticsearch/action/admin/indices/validate/query/TransportValidateQueryAction.java
src/main/java/org/elasticsearch/action/count/ShardCountRequest.java
src/main/java/org/elasticsearch/action/count/TransportCountAction.java
src/main/java/org/elasticsearch/action/exists/ShardExistsRequest.java
src/main/java/org/elasticsearch/action/exists/TransportExistsAction.java
src/main/java/org/elasticsearch/action/percolate/PercolateShardRequest.java
src/main/java/org/elasticsearch/action/percolate/TransportPercolateAction.java
src/main/java/org/elasticsearch/action/percolate/TransportShardMultiPercolateAction.java
src/main/java/org/elasticsearch/action/suggest/ShardSuggestRequest.java
src/main/java/org/elasticsearch/action/suggest/TransportSuggestAction.java
src/main/java/org/elasticsearch/action/support/broadcast/BroadcastShardOperationRequest.java
comments:
Internal:  adjusted visibility to package private for BroadcastShardOperationRequest subclasses and their constructors

Also replaced the String,int pair for index and shard_id with ShardId object that holds the same info and serialized it the same way too.

Closes #7235

time:
2014-08-13T07:38:44Z
class:
src/main/java/org/elasticsearch/common/geo/GeoHashUtils.java
src/test/java/org/elasticsearch/index/search/geo/GeoHashUtilsTests.java
comments:
Geo: fixes computation of geohash neighbours

The geohash grid it 8 cells wide and 4 cells tall. GeoHashUtils.neighbor(String,int,int.int) set the limit of the number of cells in y to < 3 rather than <= 3 resulting in it either not finding all neighbours or incorrectly searching for a neighbour in a different parent cell.

Closes #7226

time:
2014-08-12T20:34:50Z
class:
src/main/java/org/elasticsearch/action/admin/indices/create/CreateIndexRequest.java
src/main/java/org/elasticsearch/cluster/metadata/IndexMetaData.java
src/main/java/org/elasticsearch/cluster/metadata/MetaDataCreateIndexService.java
src/test/java/org/elasticsearch/action/admin/indices/create/CreateIndexTests.java
src/test/java/org/elasticsearch/cluster/metadata/ToAndFromJsonMetaDataTests.java
comments:
Core: Store index creation time in index metadata

This change stores the index creation time in the index metadata when an index is created.  The creation time cannot be changed but can be set as part of the create index request to allow for correct creation times for historical data.

Closes #7119

time:
2014-08-12T18:32:38Z
class:
src/main/java/org/elasticsearch/action/admin/indices/create/CreateIndexRequest.java
src/test/java/org/elasticsearch/action/admin/indices/CreateIndexTests.java
comments:
Java client API: CreateIndexRequestBuilder.addMapping throws IllegalStateException if you add same type more than once

Previously, it would silently overwrite the previous mapping, which was trappy.

Closes #7231

Closes #7243

time:
2014-08-12T15:43:36Z
class:
src/main/java/org/elasticsearch/common/cli/CliTool.java
src/main/java/org/elasticsearch/common/cli/Terminal.java
src/test/java/org/elasticsearch/common/cli/CliToolTestCase.java
src/test/java/org/elasticsearch/common/cli/CliToolTests.java
comments:
Test: Allow CliTool to write out stacktraces

In order to have the possibility of debugging on the command line, the user
now can either set the es.cli.debug system property
which results in stack traces being written to to the terminal.

Closes #7222

time:
2014-08-12T13:27:02Z
class:
src/main/java/org/elasticsearch/index/mapper/core/DateFieldMapper.java
src/main/java/org/elasticsearch/index/query/RangeFilterParser.java
src/test/java/org/elasticsearch/index/query/IndexQueryParserFilterCachingTests.java
src/test/java/org/elasticsearch/search/query/SimpleQueryTests.java
comments:
Query DSL: Cache range filter on date field by default

A range filter on a date field with a numeric `from`/`to` value is **not** cached by default:

    DELETE /test

    PUT /test/t/1
    {
      "date": "2014-01-01"
    }

    GET /_validate/query?explain
    {
      "query": {
        "filtered": {
          "filter": {
            "range": {
              "date": {
                "from": 0
              }
            }
          }
        }
      }
    }

Returns:

    "explanation": "ConstantScore(no_cache(date:[0 TO *]))"

This patch fixes as well not caching `from`/`to` when using `now` value not rounded.
Previously, a query like:

    GET /_validate/query?explain
    {
      "query": {
        "filtered": {
          "filter": {
            "range": {
              "date": {
                "from": "now"
                "to": "now/d+1"
              }
            }
          }
        }
      }
    }

was cached.

Also, this patch does not cache anymore `now` even if the user asked for caching it.
As it won't be cached at all by definition.

Added as well tests for all possible combinations.

Closes #7114.

time:
2014-08-12T12:59:22Z
class:
comments:
[Test] fix plugins: `bin` and `config` only plugins do not install correctly

Related to #7152.

time:
2014-08-12T12:40:51Z
class:
src/main/java/org/elasticsearch/plugins/PluginManager.java
src/test/java/org/elasticsearch/plugin/PluginManagerTests.java
comments:
plugins: `bin` and `config` only plugins do not install correctly

When installing a bin only plugin, it is identified as a site plugin.

A current workaround would be to create in the zip file another empty dir. So if you have:

* `bin/myfile.sh`
* `empty/empty.txt`

the `bin` content will be extracted as expected.

Closes #7152.

time:
2014-08-12T12:34:11Z
class:
src/test/java/org/elasticsearch/bwcompat/BasicBackwardsCompatibilityTest.java
comments:
[TEST] don't use multiple names (e.g. aliases) pointing to the same concrete index when using indexRandom

indexRandom will try to delete bogus documents multiple times since they get tracked by indexOrAlias/id, and after the actual deletion any other attempt throws error and fails the test

time:
2014-08-12T11:25:23Z
class:
src/main/java/org/elasticsearch/action/admin/indices/analyze/TransportAnalyzeAction.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/get/TransportGetFieldMappingsIndexAction.java
src/main/java/org/elasticsearch/action/bulk/TransportBulkAction.java
src/main/java/org/elasticsearch/action/bulk/TransportShardBulkAction.java
src/main/java/org/elasticsearch/action/delete/IndexDeleteRequest.java
src/main/java/org/elasticsearch/action/delete/TransportDeleteAction.java
src/main/java/org/elasticsearch/action/delete/TransportShardDeleteAction.java
src/main/java/org/elasticsearch/action/deletebyquery/TransportShardDeleteByQueryAction.java
src/main/java/org/elasticsearch/action/explain/TransportExplainAction.java
src/main/java/org/elasticsearch/action/get/TransportGetAction.java
src/main/java/org/elasticsearch/action/get/TransportMultiGetAction.java
src/main/java/org/elasticsearch/action/get/TransportShardMultiGetAction.java
src/main/java/org/elasticsearch/action/index/IndexRequest.java
src/main/java/org/elasticsearch/action/index/TransportIndexAction.java
src/main/java/org/elasticsearch/action/percolate/TransportMultiPercolateAction.java
src/main/java/org/elasticsearch/action/percolate/TransportShardMultiPercolateAction.java
src/main/java/org/elasticsearch/action/support/replication/TransportShardReplicationOperationAction.java
src/main/java/org/elasticsearch/action/support/single/custom/TransportSingleCustomOperationAction.java
src/main/java/org/elasticsearch/action/support/single/instance/TransportInstanceSingleOperationAction.java
src/main/java/org/elasticsearch/action/support/single/shard/TransportShardSingleOperationAction.java
src/main/java/org/elasticsearch/action/termvector/TransportMultiTermVectorsAction.java
src/main/java/org/elasticsearch/action/termvector/TransportSingleShardMultiTermsVectorAction.java
src/main/java/org/elasticsearch/action/termvector/TransportSingleShardTermVectorAction.java
src/main/java/org/elasticsearch/action/update/TransportUpdateAction.java
src/main/java/org/elasticsearch/action/update/UpdateHelper.java
src/main/java/org/elasticsearch/index/termvectors/ShardTermVectorService.java
src/test/java/org/elasticsearch/action/termvector/AbstractTermVectorTests.java
src/test/java/org/elasticsearch/action/termvector/GetTermVectorTests.java
src/test/java/org/elasticsearch/action/termvector/MultiTermVectorsTests.java
src/test/java/org/elasticsearch/bwcompat/BasicBackwardsCompatibilityTest.java
src/test/java/org/elasticsearch/deleteByQuery/DeleteByQueryTests.java
src/test/java/org/elasticsearch/document/BulkTests.java
src/test/java/org/elasticsearch/explain/ExplainActionTests.java
src/test/java/org/elasticsearch/get/GetActionTests.java
src/test/java/org/elasticsearch/index/mapper/timestamp/TimestampMappingTests.java
src/test/java/org/elasticsearch/indices/analyze/AnalyzeActionTests.java
src/test/java/org/elasticsearch/mget/SimpleMgetTests.java
src/test/java/org/elasticsearch/update/UpdateTests.java
comments:
Internal: changed every single index operation to not replace the index within the original request

An anti-pattern that we have in our code, noticeable for java API users, is that we modify incoming requests by replacing the index or alias with the concrete index. This way not only the request has changed, but all following communications that use that request will lose the information on whether the original request was performed against an alias or an index.

Refactored the following base classes: `TransportShardReplicationOperationAction`, `TransportShardSingleOperationAction`, `TransportSingleCustomOperationAction`, `TransportInstanceSingleOperationAction` and all subclasses by introduced an InternalRequest object that contains the original request plus additional info (e.g. the concrete index). This internal request doesn't get sent over the transport but rebuilt on each node on demand (not different to what currently happens anyway, as concrete index gets set on each node). When the request becomes a shard level request, instead of using the only int shardId we serialize the ShardId that contains both concrete index name (which might then differ ffrom the original one within the request) and shard id.

Using this pattern we can move get, multi_get, explain, analyze, term_vector, multi_term_vector, index, delete, update, bulk to not replace the index name with the concrete one within the request. The index name within the original request will stay the same.

Made it also clearer within the different transport actions when the index needs to be resolved and when that's not needed (e.g. shard level request), by exposing `resolveIndex` method. Moved check block methods to parent classes as their content was always the same on every subclass.

Improved existing tests by randomly introducing the use of an alias, and verifying that the responses always contain the concrete index name and not the original one, as that's the expected behaviour.

Added backwards compatibility tests to make sure that the change is applied in a backwards compatible manner.

Closes #7223

time:
2014-08-12T10:04:07Z
class:
src/main/java/org/elasticsearch/common/geo/builders/BasePolygonBuilder.java
comments:
Fix for failing BasePolygonBuilder

time:
2014-08-12T09:30:26Z
class:
src/main/java/org/elasticsearch/common/geo/builders/BasePolygonBuilder.java
comments:
Geo: Better error for invalid multipolygon

Closes #7126

time:
2014-08-12T08:54:16Z
class:
src/main/java/org/elasticsearch/common/geo/builders/BasePolygonBuilder.java
src/main/java/org/elasticsearch/common/geo/builders/ShapeBuilder.java
src/test/java/org/elasticsearch/common/geo/ShapeBuilderTests.java
comments:
Geo: fixes geo_shapes which intersect dateline

If a geo_shape had edges which either ran vertically along the dateline or touched the date line but did not cross it they would fail to parse.  This is because the code which splits a polygon along the dateline did not take into account the case where the polygon touched but did not cross the dateline.  This PR fixes those issues and provides tests for them.

Close #7016

time:
2014-08-12T08:33:09Z
class:
src/main/java/org/elasticsearch/action/termvector/TermVectorRequest.java
comments:
Internal: adjusted TermVectorRequest serialization to not serialize and de-serialize the index twice

Closes #7221

time:
2014-08-12T08:24:10Z
class:
src/test/java/org/elasticsearch/search/query/SimpleQueryTests.java
comments:
Test: don't need to wait for concrete mappings since we map both fields when we create the index

time:
2014-08-11T16:45:02Z
class:
src/main/java/org/elasticsearch/index/mapper/core/AbstractFieldMapper.java
src/test/java/org/elasticsearch/index/mapper/multifield/MultiFieldTests.java
comments:
Mappings: Make sure that multi fields are serialized in alphabetic order to ensure that the source is always the same.

Closes #7215

time:
2014-08-11T16:32:26Z
class:
src/main/java/org/elasticsearch/action/admin/cluster/stats/TransportClusterStatsAction.java
src/main/java/org/elasticsearch/action/explain/TransportExplainAction.java
src/main/java/org/elasticsearch/action/update/TransportUpdateAction.java
src/main/java/org/elasticsearch/cluster/metadata/MetaDataMappingService.java
src/main/java/org/elasticsearch/cluster/routing/RoutingService.java
src/main/java/org/elasticsearch/gateway/local/LocalGatewayAllocator.java
src/main/java/org/elasticsearch/indices/IndicesService.java
src/main/java/org/elasticsearch/indices/InternalIndicesService.java
src/main/java/org/elasticsearch/indices/cluster/IndicesClusterStateService.java
src/test/java/org/elasticsearch/indices/state/RareClusterStateTests.java
comments:
Core: Avoid null references that may be returned due to concurrent changes or inconsistent cluster state

Closes #7181

time:
2014-08-11T15:55:31Z
class:
src/main/java/org/elasticsearch/action/indexedscripts/delete/DeleteIndexedScriptResponse.java
comments:
[DOCS] fixed DeleteIndexedScriptResponse javadocs

time:
2014-08-11T15:55:30Z
class:
src/main/java/org/elasticsearch/action/get/GetRequest.java
comments:
Internal: adjusted visibility of GetRequest members (from protected to private) and resolved warning

time:
2014-08-11T15:19:03Z
class:
src/main/java/org/elasticsearch/action/admin/indices/mapping/delete/TransportDeleteMappingAction.java
src/test/java/org/elasticsearch/percolator/PercolatorTests.java
comments:
Core: Pass down the types from the delete mapping request to the delete by query request.

The `.percolator` type is a hidden type and therefor the types from the delete mapping request should passed down to the delete by query request, otherwise the percolator type gets ignored and the percolator queries don't get deleted from disk (only unregistered).

Closes #7087

time:
2014-08-11T14:26:09Z
class:
src/main/java/org/elasticsearch/common/compress/lzf/LZFCompressedStreamOutput.java
src/main/java/org/elasticsearch/common/compress/lzf/LZFCompressor.java
src/test/java/org/elasticsearch/common/compress/lzf/CorruptedCompressorTests.java
comments:
Internal: Fix a very rare case of corruption in compression used for
internal cluster communication.

See CorruptedCompressorTests for details on how this bug can be hit.
This change also removes the ability to use the unsafe variant of
ChunkedEncoder, removing support for the compress.lzf.decoder setting.

time:
2014-08-11T13:28:41Z
class:
comments:
[Build] Make Eclipse aware of Elasticsearch's Nullable annotation for null pointer dereference analysis.

time:
2014-08-11T13:28:41Z
class:
src/main/java/org/elasticsearch/action/indexedscripts/delete/DeleteIndexedScriptRequest.java
comments:
[Build] @Nullable annotation is not applied to primitive types.

time:
2014-08-11T12:08:32Z
class:
src/main/java/org/elasticsearch/index/mapper/object/ObjectMapper.java
src/test/java/org/elasticsearch/index/mapper/geo/LatLonMappingGeoPointTests.java
comments:
Mapping: fixes dynamic mapping of geo_point fields

If a dynamic mapping for a geo_point field is defined and the first document specifies the value of the field as a geo_point array, the dynamic mapping throws an error as the array is broken into individual number before consulting the dynamic mapping configuration.  This change adds a check of the dynamic mapping before the array is split into individual numbers.

Closes #6939

time:
2014-08-11T12:00:49Z
class:
src/test/java/org/elasticsearch/search/query/SimpleQueryTests.java
comments:
[TEST] Fix SimpleQueryTests.testRangeQuery assumptions.

This test assumed that the `num` field was mapped as an integer on all shards
and thus that all of them should fail when providing a timezone. However, since
it used dynamic mappings, some shards might have this field not mapped, as a
consequence they didn't fail.

time:
2014-08-11T10:31:01Z
class:
comments:
[DOCS] Added section describing how to return only agg results

Closes #5875

time:
2014-08-11T09:08:38Z
class:
src/main/java/org/elasticsearch/action/admin/indices/analyze/AnalyzeRequest.java
src/main/java/org/elasticsearch/action/admin/indices/analyze/TransportAnalyzeAction.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/get/GetFieldMappingsIndexRequest.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/get/TransportGetFieldMappingsIndexAction.java
src/main/java/org/elasticsearch/action/support/single/custom/SingleCustomOperationRequest.java
src/main/java/org/elasticsearch/action/support/single/custom/TransportSingleCustomOperationAction.java
src/main/java/org/elasticsearch/transport/ActionNames.java
comments:
Internal: refactored TransportSingleCustomOperationAction, subclasses and requests

TransportSingleCustomOperationAction is subclassed by two similar, yet different transport action: TransportAnalyzeAction and TransportGetFieldMappingsAction. Made their difference and similarities more explicit by sharing common code and moving specific code to subclasses:
- moved index field to the parent SingleCustomOperationAction class
- moved the common check blocks code to the parent transport action class
- moved the main transport handler to the TransportAnalyzeAction subclass as it is only used to receive external requests through clients. In the case of the TransportGetFieldMappingsIndexAction instead, the action is internal and executed only locally as part of the user facing TransportGetFieldMappingsAction. The corresponding request gets sent over the transport though as part of the related shard request
- removed the get field mappings index action from the action names mapping as it is not a transport handler anymore. It was before although never used.

Closes #7214

time:
2014-08-11T08:40:10Z
class:
src/main/java/org/elasticsearch/common/xcontent/XContentBuilder.java
comments:
Core: Improve XContentBuilder API.

time:
2014-08-11T08:02:04Z
class:
src/main/java/org/elasticsearch/action/ActionModule.java
src/main/java/org/elasticsearch/action/delete/IndexDeleteRequest.java
src/main/java/org/elasticsearch/action/delete/IndexDeleteResponse.java
src/main/java/org/elasticsearch/action/delete/ShardDeleteRequest.java
src/main/java/org/elasticsearch/action/delete/ShardDeleteResponse.java
src/main/java/org/elasticsearch/action/delete/TransportDeleteAction.java
src/main/java/org/elasticsearch/action/delete/TransportIndexDeleteAction.java
src/main/java/org/elasticsearch/action/delete/TransportShardDeleteAction.java
src/main/java/org/elasticsearch/action/delete/index/IndexDeleteRequest.java
src/main/java/org/elasticsearch/action/deletebyquery/IndexDeleteByQueryRequest.java
src/main/java/org/elasticsearch/action/deletebyquery/TransportIndexDeleteByQueryAction.java
src/main/java/org/elasticsearch/action/support/replication/IndexReplicationOperationRequest.java
src/main/java/org/elasticsearch/action/support/replication/TransportIndexReplicationOperationAction.java
src/main/java/org/elasticsearch/transport/ActionNames.java
src/test/java/org/elasticsearch/bwcompat/BasicBackwardsCompatibilityTest.java
comments:
Internal: removed needless serialization code from TransportIndexReplicationAction and corresponding request object

TransportIndexReplicationAction is always executed locally, as an internal action that is part of either delete by query or delete (when routing is required but not specified). Only the corresponding shard level requests get sent over the transport, hence no transport endpoint is needed for the index version, nor the index request itself is supposed to be sent over the transport.

Moved classes from org.elasticsearch.action.delete.index to org.elasticsearch.action.delete and adjusted visibility so that internal requests are not public anymore.

Also removed serialization code from IndexDeleteResponse as it never gets sent over transport either.

Closes #7211

time:
2014-08-11T07:52:55Z
class:
src/test/java/org/elasticsearch/common/cli/CliToolTestCase.java
src/test/java/org/elasticsearch/common/cli/CliToolTests.java
src/test/java/org/elasticsearch/common/cli/TerminalTests.java
comments:
Test: Improved CLI testing infrastructure

Added a CaptureOutputTerminal class to the infrastructure, which can be used
in tests, to make sure that CLI commands write out the right data

time:
2014-08-08T21:26:06Z
class:
src/test/java/org/elasticsearch/action/update/UpdateRequestTests.java
src/test/java/org/elasticsearch/update/UpdateTests.java
comments:
[TEST] moved testUpdateRequest unit test method to a proper unit test class

time:
2014-08-08T16:09:28Z
class:
src/main/java/org/elasticsearch/action/suggest/SuggestRequest.java
src/main/java/org/elasticsearch/client/Requests.java
comments:
Suggester: add suggestRequest to Requests and fix broken javadocs in client

closes #7206

time:
2014-08-08T14:51:23Z
class:
src/test/java/org/elasticsearch/search/query/SimpleQueryTests.java
comments:
Test: make sure mappings are on all shards to prevent false test failures

time:
2014-08-08T13:54:46Z
class:
src/test/java/org/elasticsearch/common/compress/CompressedStreamTests.java
comments:
vary offset/length (i hope) in compressed stream test

time:
2014-08-08T11:03:59Z
class:
comments:
Update clearcache.asciidoc

Changed `field_data` to `fielddata` to be consistent with the indices stats output

Closes #2888

time:
2014-08-08T10:52:03Z
class:
src/main/java/org/elasticsearch/action/explain/ExplainResponse.java
src/main/java/org/elasticsearch/action/explain/TransportExplainAction.java
src/main/java/org/elasticsearch/rest/action/explain/RestExplainAction.java
src/test/java/org/elasticsearch/explain/ExplainActionTests.java
comments:
Java API: add index, type and id to ExplainResponse

Index, type and id were returned as part of the REST explain api response, but not through java api. That info was read out of the request, relying on the fact that the index would get overridden with the concrete one within that same request.

Closes #7201

time:
2014-08-08T10:44:01Z
class:
comments:
Docs: Made config comment about min_master_nodes more explicit

Closes #2818

time:
2014-08-08T10:05:29Z
class:
src/main/java/org/elasticsearch/action/termvector/TermVectorRequest.java
comments:
Java API: fixed warnings in TermVectorRequest, also called super.validate for index not null check

time:
2014-08-08T09:25:14Z
class:
comments:
Docs: md -> asciidoc

time:
2014-08-08T07:22:34Z
class:
src/main/java/org/elasticsearch/common/io/stream/BytesStreamInput.java
src/test/java/org/elasticsearch/common/io/StreamsTests.java
comments:
Fix BytesStreamInput(BytesReference) ctor with nonzero offset

time:
2014-08-08T07:21:41Z
class:
src/test/java/org/elasticsearch/common/compress/CompressedStreamTests.java
comments:
Test: Add test with mix of ints/longs/strings/bytes to compress.

time:
2014-08-08T06:48:38Z
class:
src/main/java/org/elasticsearch/index/mapper/ip/IpFieldMapper.java
src/test/java/org/elasticsearch/index/mapper/ip/SimpleIpMappingTests.java
comments:
Mapping API: Improve IP address validation

Until now, IP addresses were only checked for four dots, which
allowed invalid values like 127.0.0.111111

This adds an additional check for validation.

Closes #7131

time:
2014-08-08T06:20:07Z
class:
comments:
Dependencies: Version bump HPPC to 0.6.0

time:
2014-08-08T05:49:00Z
class:
src/test/java/org/elasticsearch/common/compress/CompressedStreamTests.java
comments:
add multithreaded compressed streams tests

time:
2014-08-08T03:03:18Z
class:
comments:
change version number for 2.3.0 release

time:
2014-08-08T00:13:10Z
class:
src/main/java/org/elasticsearch/common/io/BooleanStreamable.java
comments:
remove dead unused code

time:
2014-08-07T23:36:58Z
class:
src/test/java/org/elasticsearch/common/bytes/ByteBufferBytesReference.java
comments:
move unused code to src/test

time:
2014-08-07T22:40:47Z
class:
src/test/java/org/elasticsearch/common/compress/CompressedStreamTests.java
comments:
ensure we exceed 65k in size sometimes in test

time:
2014-08-07T22:30:27Z
class:
src/test/java/org/elasticsearch/common/compress/CompressedStreamTests.java
comments:
add more evilness to compressed streams test

time:
2014-08-07T21:51:18Z
class:
src/test/java/org/elasticsearch/percolator/PercolatorTests.java
comments:
[TEST] Associate type with percolate query

time:
2014-08-07T21:20:41Z
class:
src/test/java/org/elasticsearch/common/compress/CompressedStreamTests.java
comments:
test some linedocs data with compressed streams

time:
2014-08-07T20:47:36Z
class:
src/test/java/org/elasticsearch/common/compress/CompressedStreamTests.java
comments:
test some random bytes with compressed streams

time:
2014-08-07T20:12:54Z
class:
src/main/java/org/elasticsearch/action/search/ShardSearchFailure.java
src/test/java/org/elasticsearch/search/aggregations/metrics/ExtendedStatsTests.java
src/test/java/org/elasticsearch/search/aggregations/metrics/StatsTests.java
comments:
Internal: Remove (mostly) unused 'failure' member from ShardSearchFailure.

closes #6837
closes #6861

time:
2014-08-07T19:45:41Z
class:
src/test/java/org/elasticsearch/common/compress/CompressedStringTests.java
comments:
test random strings in CompressedStringTests

time:
2014-08-07T19:07:04Z
class:
comments:
Update update.asciidoc

Closes #6577

time:
2014-08-07T15:00:53Z
class:
src/main/java/org/elasticsearch/transport/TransportMessage.java
src/test/java/org/elasticsearch/client/AbstractClientHeadersTests.java
src/test/java/org/elasticsearch/client/node/NodeClientHeadersTests.java
src/test/java/org/elasticsearch/client/transport/TransportClientHeadersTests.java
src/test/java/org/elasticsearch/rest/HeadersCopyClientTests.java
src/test/java/org/elasticsearch/test/ElasticsearchTestCase.java
src/test/java/org/elasticsearch/test/transport/ConfigurableErrorNettyTransportModule.java
src/test/java/org/elasticsearch/transport/TransportMessageTests.java
comments:
Cleaned up TransportMessage and added transient context to it

 - The context enables setting arbitrary transient data on the message (this data is not serialized with the request)
 - Changed header accessors/mutators so header manipulation will be done directly on the request (to void NPE with transport message headers when dealing with maps that can potentially be null)

time:
2014-08-07T12:06:09Z
class:
comments:
Fixing typo in the first JSON example

Closes #7172

time:
2014-08-07T11:41:57Z
class:
src/main/java/org/elasticsearch/action/explain/ExplainRequestBuilder.java
comments:
Java api: remove operationThreaded setter from ExplainRequestBuilder, already available in base class SingleShardOperationRequestBuilder

It also didn't follow the setter convention that we adopted for request builders.
Fixed also javadocs warning caused byt missing descriptions for tag.

Closes #7186

time:
2014-08-07T09:24:44Z
class:
comments:
[DOCS] Remove the section about codecs.

This documentation was dangerous because it felt like it was possible to gain
substantial performance by just switching the codec of the index.

However, non-default codecs are dangerous to use since they are not supported
in terms of backward compatibility, and most improvements that they bring have
been folded into the default codec anyway (for example, the default codec
"pulses" postings lists that contain a single document).

time:
2014-08-07T07:37:43Z
class:
comments:
[DOCS] fixed title for filters aggregation documentation

time:
2014-08-07T07:03:23Z
class:
comments:
Tidied up the filters agg docs and added a coming[] tag

time:
2014-08-06T21:14:47Z
class:
comments:
update documentation with release 2.3.0

time:
2014-08-06T21:08:58Z
class:
comments:
Update to elasticsearch 1.4.0

Closes #34.

(cherry picked from commit e149f70)

time:
2014-08-06T21:02:25Z
class:
src/main/java/org/elasticsearch/cloud/gce/GceComputeServiceImpl.java
src/test/java/org/elasticsearch/discovery/gce/GceComputeEngineTest.java
src/test/java/org/elasticsearch/discovery/gce/mock/GceComputeServiceAbstractMock.java
src/test/java/org/elasticsearch/discovery/gce/mock/GceComputeServiceTwoNodesDifferentTagsMock.java
src/test/java/org/elasticsearch/discovery/gce/mock/GceComputeServiceTwoNodesOneZoneMock.java
src/test/java/org/elasticsearch/discovery/gce/mock/GceComputeServiceTwoNodesSameTagsMock.java
src/test/java/org/elasticsearch/discovery/gce/mock/GceComputeServiceTwoNodesTwoZonesMock.java
comments:
Add multiple zones support

Closes #27.

time:
2014-08-06T20:51:21Z
class:
src/test/java/org/elasticsearch/cloud/gce/AbstractGceTest.java
src/test/java/org/elasticsearch/discovery/gce/AbstractGceComputeServiceTest.java
src/test/java/org/elasticsearch/discovery/gce/GceComputeEngineTest.java
src/test/java/org/elasticsearch/discovery/gce/GceDifferentTagsNoTagTest.java
src/test/java/org/elasticsearch/discovery/gce/GceDifferentTagsOneTagTest.java
src/test/java/org/elasticsearch/discovery/gce/GceDifferentTagsTwoTagsTest.java
src/test/java/org/elasticsearch/discovery/gce/GceSameTagsNoTagTest.java
src/test/java/org/elasticsearch/discovery/gce/GceSameTagsOneTagTest.java
src/test/java/org/elasticsearch/discovery/gce/GceSameTagsTwoTagsTest.java
src/test/java/org/elasticsearch/discovery/gce/mock/GceComputeServiceAbstractMock.java
src/test/java/org/elasticsearch/discovery/gce/mock/GceComputeServiceTwoNodesDifferentTagsMock.java
src/test/java/org/elasticsearch/discovery/gce/mock/GceComputeServiceTwoNodesSameTagsMock.java
src/test/java/org/elasticsearch/gce/itest/GceSimpleITest.java
comments:
Tests: refactor tests

We need to simplify a bit our tests.
Also, we need to mark as `@Ignore` tests as they break now due to some cluster controls after each test in elasticsearch test infra.

See [org.elasticsearch.test.ElasticsearchIntegrationTest#ensureClusterSizeConsistency()](https://github.com/elasticsearch/elasticsearch/blob/v1.3.1/src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java#L974-L979)

Closes #33.

time:
2014-08-06T13:05:46Z
class:
comments:
Test: Trimmed trailing whitespace to make valid YAML

time:
2014-08-06T11:32:33Z
class:
comments:
REST spec: Added missing query_cache param to clear_cache, nodes.stats and indices.stats

Relates to #7167 and #7161

time:
2014-08-06T11:31:11Z
class:
src/main/java/org/elasticsearch/node/service/NodeService.java
comments:
Internal: fixed typo in NodeService s/disovery/discovery

time:
2014-08-06T11:31:11Z
class:
src/test/java/org/elasticsearch/bwcompat/UnicastBackwardsCompatibilityTest.java
comments:
[TEST] fixed unicast bw comp test configuration

The second internal node, when present, wasn't able to join the existing cluster due ti misconfigured unicast hosts, thus it would form its own cluster.

time:
2014-08-06T09:56:20Z
class:
src/test/java/org/elasticsearch/index/mapper/geo/GeoMappingTests.java
comments:
[TEST] Assert that put mappings requests are acked in GeoMappingTests.

time:
2014-08-06T09:55:11Z
class:
comments:
Documented the query cache module

Related to #7161 and #7167

time:
2014-08-06T08:02:18Z
class:
comments:
Update to Lucene 4.9.0

Closes #32.

time:
2014-08-06T07:54:53Z
class:
src/test/java/org/elasticsearch/bwcompat/UnicastBackwardsCompatibilityTest.java
src/test/java/org/elasticsearch/test/CompositeTestCluster.java
comments:
[TEST] simplified unicast bw comp test

also fixed unchecked warning in CompositeTestCluster

time:
2014-08-06T01:33:08Z
class:
src/main/java/org/elasticsearch/client/node/NodeClient.java
src/main/java/org/elasticsearch/client/node/NodeClientModule.java
src/main/java/org/elasticsearch/client/node/NodeClusterAdminClient.java
src/main/java/org/elasticsearch/client/node/NodeIndicesAdminClient.java
src/main/java/org/elasticsearch/client/support/Headers.java
src/main/java/org/elasticsearch/client/transport/ClientTransportModule.java
src/main/java/org/elasticsearch/client/transport/support/InternalTransportClient.java
src/main/java/org/elasticsearch/client/transport/support/InternalTransportClusterAdminClient.java
src/main/java/org/elasticsearch/client/transport/support/InternalTransportIndicesAdminClient.java
src/test/java/org/elasticsearch/client/AbstractClientHeadersTests.java
src/test/java/org/elasticsearch/client/node/NodeClientHeadersTests.java
src/test/java/org/elasticsearch/client/transport/InternalTransportClientTests.java
src/test/java/org/elasticsearch/client/transport/TransportClientHeadersTests.java
comments:
Added an option to add arbitrary headers to the client requests

The headers are key/value pairs defined in the settings under the `request.headers` namespace.

time:
2014-08-05T19:47:21Z
class:
src/main/java/org/elasticsearch/index/engine/internal/LiveVersionMap.java
comments:
Fix false assert trip

time:
2014-08-05T18:28:47Z
class:
src/test/java/org/elasticsearch/indices/stats/IndexStatsTests.java
comments:
[TEST] make sure all shards have docs
we need that in order for refresh to be effective and actually refresh in the second round of indexing, otherwise, it caches a 0 docs shard and a refresh won't expire anything there

time:
2014-08-05T16:28:49Z
class:
src/main/java/org/elasticsearch/action/search/MultiSearchRequest.java
src/main/java/org/elasticsearch/action/search/SearchRequest.java
src/main/java/org/elasticsearch/action/search/SearchRequestBuilder.java
src/main/java/org/elasticsearch/indices/cache/query/IndicesQueryCache.java
src/main/java/org/elasticsearch/rest/action/search/RestSearchAction.java
src/main/java/org/elasticsearch/search/internal/ShardSearchRequest.java
src/test/java/org/elasticsearch/indices/stats/IndexStatsTests.java
comments:
[Query Cache] Add a request level flag to control query cache
A request level flag, defaults to be unset, to control the query cache. When not set, it defaults to the index level settings, when explicitly set, will override the index level setting
closes #7167

time:
2014-08-05T15:52:44Z
class:
src/main/java/org/elasticsearch/action/update/UpdateHelper.java
src/main/java/org/elasticsearch/action/update/UpdateRequest.java
src/main/java/org/elasticsearch/action/update/UpdateRequestBuilder.java
src/test/java/org/elasticsearch/update/UpdateTests.java
comments:
Update API enhancement - add support for scripted upserts.
In the case of inserts the UpdateHelper class will now allow the script used to apply updates to run on the upsert doc provided by clients. This allows the logic for managing the internal state of the data item to be managed by the script and is not reliant on clients performing the initialisation of data structures managed by the script.

Closes #7143

time:
2014-08-05T15:45:42Z
class:
src/main/java/org/elasticsearch/action/admin/indices/cache/clear/ClearIndicesCacheRequest.java
src/main/java/org/elasticsearch/action/admin/indices/cache/clear/ClearIndicesCacheRequestBuilder.java
src/main/java/org/elasticsearch/action/admin/indices/cache/clear/ShardClearIndicesCacheRequest.java
src/main/java/org/elasticsearch/action/admin/indices/cache/clear/TransportClearIndicesCacheAction.java
src/main/java/org/elasticsearch/action/admin/indices/stats/CommonStats.java
src/main/java/org/elasticsearch/action/admin/indices/stats/CommonStatsFlags.java
src/main/java/org/elasticsearch/action/admin/indices/stats/IndicesStatsRequest.java
src/main/java/org/elasticsearch/action/admin/indices/stats/IndicesStatsRequestBuilder.java
src/main/java/org/elasticsearch/action/admin/indices/stats/TransportIndicesStatsAction.java
src/main/java/org/elasticsearch/action/search/type/TransportSearchCountAction.java
src/main/java/org/elasticsearch/action/search/type/TransportSearchQueryThenFetchAction.java
src/main/java/org/elasticsearch/index/cache/query/QueryCacheStats.java
src/main/java/org/elasticsearch/index/cache/query/ShardQueryCache.java
src/main/java/org/elasticsearch/index/cache/query/ShardQueryCacheModule.java
src/main/java/org/elasticsearch/index/service/InternalIndexService.java
src/main/java/org/elasticsearch/index/settings/IndexDynamicSettingsModule.java
src/main/java/org/elasticsearch/index/shard/service/IndexShard.java
src/main/java/org/elasticsearch/index/shard/service/InternalIndexShard.java
src/main/java/org/elasticsearch/indices/IndicesModule.java
src/main/java/org/elasticsearch/indices/NodeIndicesStats.java
src/main/java/org/elasticsearch/indices/cache/filter/IndicesFilterCache.java
src/main/java/org/elasticsearch/indices/cache/query/IndicesQueryCache.java
src/main/java/org/elasticsearch/percolator/PercolateContext.java
src/main/java/org/elasticsearch/rest/action/admin/indices/stats/RestIndicesStatsAction.java
src/main/java/org/elasticsearch/rest/action/cat/RestIndicesAction.java
src/main/java/org/elasticsearch/rest/action/cat/RestNodesAction.java
src/main/java/org/elasticsearch/search/SearchService.java
src/main/java/org/elasticsearch/search/action/SearchServiceTransportAction.java
src/main/java/org/elasticsearch/search/aggregations/metrics/tophits/TopHitsContext.java
src/main/java/org/elasticsearch/search/fetch/QueryFetchSearchResult.java
src/main/java/org/elasticsearch/search/internal/DefaultSearchContext.java
src/main/java/org/elasticsearch/search/internal/SearchContext.java
src/main/java/org/elasticsearch/search/internal/ShardSearchRequest.java
src/main/java/org/elasticsearch/search/query/QuerySearchResult.java
src/main/java/org/elasticsearch/search/query/QuerySearchResultProvider.java
src/test/java/org/elasticsearch/indices/cache/CacheTests.java
src/test/java/org/elasticsearch/indices/stats/IndexStatsTests.java
src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java
src/test/java/org/elasticsearch/test/TestSearchContext.java
comments:
Query Cache: Support shard level query response caching

The query cache allow to cache the (binary serialized) response of the shard level query phase execution based on the actual request as the key. The cache is fully coherent with the semantics of NRT, with a refresh (that actually ended up refreshing) causing previous cached entries on the relevant shard to be invalidated and eventually evicted.

This change enables query caching as an opt in index level setting, called `index.cache.query.enable` and defaults to `false`. The setting can be changed dynamically on an index. The cache is only enabled for search requests with search_type count.

The indices query cache is a node level query cache. The `indices.cache.query.size` controls what is the size (bytes wise) the cache will take, and defaults to `1%` of the heap. Note, this cache is very effective with small values in it already. There is also the advanced option to set `indices.cache.query.expire` that allow to control after a certain time of inaccessibility the cache will be evicted.

Note, the request takes the search "body" as is (bytes), and uses it as the key. This means same JSON but with different key order will constitute different cache entries.

This change includes basic stats (shard level, index/indices level, and node level) for the query cache, showing how much is used and eviction rates.

While this is a good first step, and the goal is to get it in, there are a few things that would be great additions to this work, but they can be done as additional pull requests:

- More stats, specifically cache hit and cache miss, per shard.
- Request level flag, defaults to "not set" (inheriting what the setting is).
- Allowing to change the cache size using the cluster update settings API
- Consider enabling the cache to query phase also when asking hits are involved, note, this will only include the "top docs", not the actual hits.
- See if there is a performant manner to solve the "out of order" of keys in the JSON case.
- Maybe introduce a filter element, that is outside of the request, that is checked, and if it matches all docs in a shard, will not be used as part of the key. This will help with time based indices and moving windows for shards that fall "inside" the window to be more effective caching wise.
- Add a more infra level support in search context that allows for any element to mark the search as non deterministic (on top of the support for "now"), and use it to not cache search responses.

closes #7161

time:
2014-08-05T15:33:06Z
class:
src/main/java/org/elasticsearch/http/netty/NettyHttpChannel.java
src/main/java/org/elasticsearch/http/netty/NettyHttpServerTransport.java
src/test/java/org/elasticsearch/rest/CorsRegexDefaultTests.java
src/test/java/org/elasticsearch/rest/CorsRegexTests.java
comments:
CORS: Allowed to configure allow-credentials header to work via SSL

This adds support to return the "Access-Control-Allow-Credentials" header
if needed, so CORS will work flawlessly with authenticated applications.

Closes #6380

time:
2014-08-05T15:16:53Z
class:
comments:
Resolve wording inconsistency

AND and OR filter docs talk about different targets for the operators. I
believe that both should be described in terms of modifying other 'filters'.
I also added articles for easier (human) parsing. This fixes #4762

Closes #7165

time:
2014-08-05T14:52:46Z
class:
src/test/java/org/elasticsearch/cluster/SimpleClusterStateTests.java
comments:
[TEST] increase ack timeout on large cluster
when we have a small machine running it with randmoized larger number of nodes (5), we need more time to process it

time:
2014-08-05T14:26:09Z
class:
src/main/java/org/elasticsearch/cluster/routing/allocation/decider/ClusterRebalanceAllocationDecider.java
src/main/java/org/elasticsearch/cluster/settings/ClusterDynamicSettingsModule.java
src/test/java/org/elasticsearch/cluster/routing/allocation/AddIncrementallyTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/AwarenessAllocationTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/BalanceConfigurationTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/ClusterRebalanceRoutingTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/DeadNodesAllocationTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/FailedNodeRoutingTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/FailedShardsRoutingTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/IndexBalanceTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/NodeVersionAllocationDeciderTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/RebalanceAfterActiveTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/RoutingNodesIntegrityTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/ShardVersioningTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/SingleShardNoReplicasRoutingTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/TenShardsOneReplicaRoutingTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/decider/DiskThresholdDeciderTests.java
src/test/java/org/elasticsearch/cluster/structure/RoutingIteratorTests.java
comments:
Make "cluster.routing.allocation.allow_rebalance" a dynamic setting

Also makes it a static constant and changes all tests to use it instead
of a string.

Fixes #7092

time:
2014-08-05T14:23:00Z
class:
src/main/java/org/elasticsearch/cloud/gce/GceComputeServiceImpl.java
comments:
Force Token URL to `http://metadata.google.internal/...`

In certain environments (such as inside a docker container) 'metadata' does not resolve.
Forcing URL to `http://metadata.google.internal/computeMetadata/v1/instance/service-accounts/default/token` fix this.

See https://developers.google.com/compute/docs/metadata#metadataserver

Closes #28.
Closes #30.

time:
2014-08-05T14:09:27Z
class:
comments:
Included notes about compute engine permissions

Closes #25.
Closes #26.

time:
2014-08-05T12:25:07Z
class:
comments:
fix typo

time:
2014-08-05T12:23:41Z
class:
comments:
Docs: make the welcome page more obvious

Closes #31.

(cherry picked from commit ab3cde3)

time:
2014-08-05T11:56:02Z
class:
comments:
update documentation with release 2.3.0

time:
2014-08-05T11:53:17Z
class:
comments:
Use new release tool for elasticsearch plugins

See https://github.com/elasticsearch/elasticsearch-plugins-script

time:
2014-08-05T11:40:22Z
class:
comments:
Use new release tool for elasticsearch

time:
2014-08-05T11:40:22Z
class:
src/test/java/org/elasticsearch/repositories/s3/AbstractS3SnapshotRestoreTest.java
src/test/java/org/elasticsearch/repositories/s3/S3SnapshotRestoreOverHttpTest.java
src/test/java/org/elasticsearch/repositories/s3/S3SnapshotRestoreOverHttpsTest.java
comments:
Fix tests

(cherry picked from commit 521d946)

time:
2014-08-05T11:27:19Z
class:
src/test/java/org/elasticsearch/cluster/NoMasterNodeTests.java
comments:
[TEST] add explicit options to no master tests

time:
2014-08-05T11:01:43Z
class:
comments:
Move log4j properties to xml and remove unused elasticsearch.yml file

(cherry picked from commit b07fc7c)

time:
2014-08-05T10:44:02Z
class:
comments:
add Proxy setting for using plugin command

Closes #7150

time:
2014-08-05T10:28:46Z
class:
src/main/java/org/elasticsearch/cloud/aws/AwsEc2Service.java
src/main/java/org/elasticsearch/cloud/aws/InternalAwsS3Service.java
comments:
Switch to https communication for Amazon APIs by default

We should use `https` by default instead of `http` for communication between elasticsearch and AWS API.

Note that it can be modified in case of trouble and fallback to the older setting using `cloud.aws.protocol: http`

Closes #109.

time:
2014-08-05T10:21:39Z
class:
src/main/java/org/elasticsearch/cloud/aws/AwsEc2Service.java
src/main/java/org/elasticsearch/cloud/aws/InternalAwsS3Service.java
src/test/java/org/elasticsearch/repositories/s3/S3SnapshotRestoreAbstractTest.java
src/test/java/org/elasticsearch/repositories/s3/S3SnapshotRestoreOverHttpTest.java
src/test/java/org/elasticsearch/repositories/s3/S3SnapshotRestoreOverHttpsTest.java
comments:
Allow https communication per ec2 or s3 service

By default all communication w/ AWS services done by this plugin is sent the clear over `http`, overriding amazons own default of https: http://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/ClientConfiguration.html#getProtocol()

One has to set `cloud.aws.protocol` in `elasticsearch.yml` to force SSL.

    cloud.aws.protocol: https

This is not entirely clear to the average user, and should be added to the documentation on both this project's README.

Closes #101.

time:
2014-08-05T09:47:10Z
class:
src/test/java/org/elasticsearch/bwcompat/UnicastBackwardsCompatibilityTest.java
comments:
[TEST} make sure unicast bw comp test uses specifically set transport port and properly configure unicast hosts

Added also assertBusy block needed since we test the local cluster state on each node, not only on the master node.

time:
2014-08-05T09:44:53Z
class:
src/main/java/org/elasticsearch/cloud/aws/blobstore/AbstractS3BlobContainer.java
src/test/java/org/elasticsearch/repositories/s3/S3SnapshotRestoreTest.java
comments:
Wrong exception thrown when snapshot doesn't exist

When a Snapshot does not exist, we should raise a `SnapshotMissingException`.
Add also tests for GET/DELETE on non existing repo

Closes #86.

(cherry picked from commit 77ab672)

time:
2014-08-05T09:38:59Z
class:
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/DoubleTerms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/LongTerms.java
comments:
Aggregations: key_as_string only shown when format specified in terms agg

The key_as_string field is now not shown in the terms aggregation for long and double fields unless the format parameter is specified

Closes #7125

time:
2014-08-05T09:35:24Z
class:
comments:
Simplify documentation

Closes #106

time:
2014-08-05T09:27:41Z
class:
comments:
Update maven plugins versions and change compile to 1.7

(cherry picked from commit 4a3929e)

time:
2014-08-05T09:08:26Z
class:
comments:
Remove unused property

time:
2014-08-04T22:59:48Z
class:
comments:
Merge branch 'master' of https://github.com/uschindler/elasticsearch into forbiddenapis-1.6-update

time:
2014-08-04T22:57:18Z
class:
comments:
Update forbidden-apis to 1.6

time:
2014-08-04T22:48:00Z
class:
comments:
Update forbidden-apis to 1.6

time:
2014-08-04T22:25:26Z
class:
comments:
Update forbidden-apis to 1.6

time:
2014-08-04T21:58:30Z
class:
src/test/java/org/elasticsearch/test/ElasticsearchBackwardsCompatIntegrationTest.java
src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java
src/test/java/org/elasticsearch/test/ExternalNode.java
src/test/java/org/elasticsearch/test/InternalTestCluster.java
src/test/java/org/elasticsearch/test/SettingsSource.java
comments:
Added custom transport client settings to test infra

It's now possible to define the additional customesettings for transport clients by extending `transportClientSettings` callback method on `ElasticsearchIntegrationTest`.

time:
2014-08-04T21:55:36Z
class:
src/main/java/org/elasticsearch/action/ActionModule.java
src/main/java/org/elasticsearch/action/admin/cluster/health/ClusterHealthAction.java
src/main/java/org/elasticsearch/action/admin/cluster/node/hotthreads/NodesHotThreadsAction.java
src/main/java/org/elasticsearch/action/admin/cluster/node/info/NodesInfoAction.java
src/main/java/org/elasticsearch/action/admin/cluster/node/restart/NodesRestartAction.java
src/main/java/org/elasticsearch/action/admin/cluster/node/shutdown/NodesShutdownAction.java
src/main/java/org/elasticsearch/action/admin/cluster/node/shutdown/TransportNodesShutdownAction.java
src/main/java/org/elasticsearch/action/admin/cluster/node/stats/NodesStatsAction.java
src/main/java/org/elasticsearch/action/admin/cluster/repositories/delete/DeleteRepositoryAction.java
src/main/java/org/elasticsearch/action/admin/cluster/repositories/get/GetRepositoriesAction.java
src/main/java/org/elasticsearch/action/admin/cluster/repositories/put/PutRepositoryAction.java
src/main/java/org/elasticsearch/action/admin/cluster/reroute/ClusterRerouteAction.java
src/main/java/org/elasticsearch/action/admin/cluster/settings/ClusterUpdateSettingsAction.java
src/main/java/org/elasticsearch/action/admin/cluster/shards/ClusterSearchShardsAction.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/create/CreateSnapshotAction.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/delete/DeleteSnapshotAction.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/get/GetSnapshotsAction.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/restore/RestoreSnapshotAction.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/status/SnapshotsStatusAction.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/status/TransportNodesSnapshotsStatus.java
src/main/java/org/elasticsearch/action/admin/cluster/state/ClusterStateAction.java
src/main/java/org/elasticsearch/action/admin/cluster/stats/ClusterStatsAction.java
src/main/java/org/elasticsearch/action/admin/cluster/tasks/PendingClusterTasksAction.java
src/main/java/org/elasticsearch/action/admin/indices/alias/IndicesAliasesAction.java
src/main/java/org/elasticsearch/action/admin/indices/alias/exists/AliasesExistAction.java
src/main/java/org/elasticsearch/action/admin/indices/alias/get/GetAliasesAction.java
src/main/java/org/elasticsearch/action/admin/indices/analyze/AnalyzeAction.java
src/main/java/org/elasticsearch/action/admin/indices/cache/clear/ClearIndicesCacheAction.java
src/main/java/org/elasticsearch/action/admin/indices/close/CloseIndexAction.java
src/main/java/org/elasticsearch/action/admin/indices/create/CreateIndexAction.java
src/main/java/org/elasticsearch/action/admin/indices/delete/DeleteIndexAction.java
src/main/java/org/elasticsearch/action/admin/indices/exists/indices/IndicesExistsAction.java
src/main/java/org/elasticsearch/action/admin/indices/exists/types/TypesExistsAction.java
src/main/java/org/elasticsearch/action/admin/indices/flush/FlushAction.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/delete/DeleteMappingAction.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/get/GetFieldMappingsAction.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/get/GetMappingsAction.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/get/TransportGetFieldMappingsIndexAction.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/put/PutMappingAction.java
src/main/java/org/elasticsearch/action/admin/indices/open/OpenIndexAction.java
src/main/java/org/elasticsearch/action/admin/indices/optimize/OptimizeAction.java
src/main/java/org/elasticsearch/action/admin/indices/recovery/RecoveryAction.java
src/main/java/org/elasticsearch/action/admin/indices/refresh/RefreshAction.java
src/main/java/org/elasticsearch/action/admin/indices/segments/IndicesSegmentsAction.java
src/main/java/org/elasticsearch/action/admin/indices/settings/get/GetSettingsAction.java
src/main/java/org/elasticsearch/action/admin/indices/settings/put/UpdateSettingsAction.java
src/main/java/org/elasticsearch/action/admin/indices/stats/IndicesStatsAction.java
src/main/java/org/elasticsearch/action/admin/indices/template/delete/DeleteIndexTemplateAction.java
src/main/java/org/elasticsearch/action/admin/indices/template/get/GetIndexTemplatesAction.java
src/main/java/org/elasticsearch/action/admin/indices/template/put/PutIndexTemplateAction.java
src/main/java/org/elasticsearch/action/admin/indices/validate/query/ValidateQueryAction.java
src/main/java/org/elasticsearch/action/admin/indices/warmer/delete/DeleteWarmerAction.java
src/main/java/org/elasticsearch/action/admin/indices/warmer/get/GetWarmersAction.java
src/main/java/org/elasticsearch/action/admin/indices/warmer/put/PutWarmerAction.java
src/main/java/org/elasticsearch/action/bench/AbortBenchmarkAction.java
src/main/java/org/elasticsearch/action/bench/BenchmarkAction.java
src/main/java/org/elasticsearch/action/bench/BenchmarkService.java
src/main/java/org/elasticsearch/action/bench/BenchmarkStatusAction.java
src/main/java/org/elasticsearch/action/bulk/BulkAction.java
src/main/java/org/elasticsearch/action/bulk/TransportBulkAction.java
src/main/java/org/elasticsearch/action/bulk/TransportShardBulkAction.java
src/main/java/org/elasticsearch/action/count/CountAction.java
src/main/java/org/elasticsearch/action/delete/DeleteAction.java
src/main/java/org/elasticsearch/action/delete/index/TransportIndexDeleteAction.java
src/main/java/org/elasticsearch/action/delete/index/TransportShardDeleteAction.java
src/main/java/org/elasticsearch/action/deletebyquery/DeleteByQueryAction.java
src/main/java/org/elasticsearch/action/deletebyquery/TransportIndexDeleteByQueryAction.java
src/main/java/org/elasticsearch/action/deletebyquery/TransportShardDeleteByQueryAction.java
src/main/java/org/elasticsearch/action/exists/ExistsAction.java
src/main/java/org/elasticsearch/action/exists/ExistsRequest.java
src/main/java/org/elasticsearch/action/exists/ExistsRequestBuilder.java
src/main/java/org/elasticsearch/action/exists/ExistsResponse.java
src/main/java/org/elasticsearch/action/exists/ShardExistsRequest.java
src/main/java/org/elasticsearch/action/exists/ShardExistsResponse.java
src/main/java/org/elasticsearch/action/exists/TransportExistsAction.java
src/main/java/org/elasticsearch/action/exists/package-info.java
src/main/java/org/elasticsearch/action/explain/ExplainAction.java
src/main/java/org/elasticsearch/action/explain/TransportExplainAction.java
src/main/java/org/elasticsearch/action/get/GetAction.java
src/main/java/org/elasticsearch/action/get/GetRequest.java
src/main/java/org/elasticsearch/action/get/GetRequestBuilder.java
src/main/java/org/elasticsearch/action/get/MultiGetAction.java
src/main/java/org/elasticsearch/action/get/MultiGetRequest.java
src/main/java/org/elasticsearch/action/get/MultiGetRequestBuilder.java
src/main/java/org/elasticsearch/action/get/MultiGetShardRequest.java
src/main/java/org/elasticsearch/action/get/TransportGetAction.java
src/main/java/org/elasticsearch/action/get/TransportMultiGetAction.java
src/main/java/org/elasticsearch/action/get/TransportShardMultiGetAction.java
src/main/java/org/elasticsearch/action/index/IndexAction.java
src/main/java/org/elasticsearch/action/index/IndexRequest.java
src/main/java/org/elasticsearch/action/indexedscripts/delete/DeleteIndexedScriptAction.java
src/main/java/org/elasticsearch/action/indexedscripts/get/GetIndexedScriptAction.java
src/main/java/org/elasticsearch/action/indexedscripts/put/PutIndexedScriptAction.java
src/main/java/org/elasticsearch/action/mlt/MoreLikeThisAction.java
src/main/java/org/elasticsearch/action/percolate/MultiPercolateAction.java
src/main/java/org/elasticsearch/action/percolate/PercolateAction.java
src/main/java/org/elasticsearch/action/percolate/TransportShardMultiPercolateAction.java
src/main/java/org/elasticsearch/action/search/ClearScrollAction.java
src/main/java/org/elasticsearch/action/search/MultiSearchAction.java
src/main/java/org/elasticsearch/action/search/SearchAction.java
src/main/java/org/elasticsearch/action/search/SearchScrollAction.java
src/main/java/org/elasticsearch/action/suggest/SuggestAction.java
src/main/java/org/elasticsearch/action/support/broadcast/TransportBroadcastOperationAction.java
src/main/java/org/elasticsearch/action/support/nodes/TransportNodesOperationAction.java
src/main/java/org/elasticsearch/action/support/replication/TransportShardReplicationOperationAction.java
src/main/java/org/elasticsearch/action/support/single/custom/TransportSingleCustomOperationAction.java
src/main/java/org/elasticsearch/action/support/single/shard/TransportShardSingleOperationAction.java
src/main/java/org/elasticsearch/action/termvector/MultiTermVectorsAction.java
src/main/java/org/elasticsearch/action/termvector/TermVectorAction.java
src/main/java/org/elasticsearch/action/termvector/TransportMultiTermVectorsAction.java
src/main/java/org/elasticsearch/action/termvector/TransportSingleShardMultiTermsVectorAction.java
src/main/java/org/elasticsearch/action/update/UpdateAction.java
src/main/java/org/elasticsearch/action/update/UpdateHelper.java
src/main/java/org/elasticsearch/client/Client.java
src/main/java/org/elasticsearch/client/Requests.java
src/main/java/org/elasticsearch/client/support/AbstractClient.java
src/main/java/org/elasticsearch/client/transport/TransportClientNodesService.java
src/main/java/org/elasticsearch/cluster/action/index/MappingUpdatedAction.java
src/main/java/org/elasticsearch/cluster/action/index/NodeIndexDeletedAction.java
src/main/java/org/elasticsearch/cluster/action/index/NodeMappingRefreshAction.java
src/main/java/org/elasticsearch/cluster/action/shard/ShardStateAction.java
src/main/java/org/elasticsearch/cluster/metadata/IndexMetaData.java
src/main/java/org/elasticsearch/cluster/metadata/MappingMetaData.java
src/main/java/org/elasticsearch/cluster/routing/allocation/decider/Decision.java
src/main/java/org/elasticsearch/common/breaker/ChildMemoryCircuitBreaker.java
src/main/java/org/elasticsearch/common/cli/CliTool.java
src/main/java/org/elasticsearch/common/cli/CliToolConfig.java
src/main/java/org/elasticsearch/common/cli/HelpPrinter.java
src/main/java/org/elasticsearch/common/cli/Terminal.java
src/main/java/org/elasticsearch/common/geo/GeoDistance.java
src/main/java/org/elasticsearch/common/http/client/HttpDownloadHelper.java
src/main/java/org/elasticsearch/common/io/Streams.java
src/main/java/org/elasticsearch/common/joda/DateMathParser.java
src/main/java/org/elasticsearch/common/rounding/TimeZoneRounding.java
src/main/java/org/elasticsearch/common/text/StringAndBytesText.java
src/main/java/org/elasticsearch/common/util/Callback.java
src/main/java/org/elasticsearch/discovery/zen/ZenDiscovery.java
src/main/java/org/elasticsearch/discovery/zen/fd/MasterFaultDetection.java
src/main/java/org/elasticsearch/discovery/zen/fd/NodesFaultDetection.java
src/main/java/org/elasticsearch/discovery/zen/membership/MembershipAction.java
src/main/java/org/elasticsearch/discovery/zen/ping/multicast/MulticastZenPing.java
src/main/java/org/elasticsearch/discovery/zen/ping/unicast/UnicastZenPing.java
src/main/java/org/elasticsearch/discovery/zen/publish/PublishClusterStateAction.java
src/main/java/org/elasticsearch/gateway/local/state/meta/LocalAllocateDangledIndices.java
src/main/java/org/elasticsearch/gateway/local/state/meta/TransportNodesListGatewayMetaState.java
src/main/java/org/elasticsearch/gateway/local/state/shards/TransportNodesListGatewayStartedShards.java
src/main/java/org/elasticsearch/http/netty/NettyHttpServerTransport.java
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
src/main/java/org/elasticsearch/index/fielddata/IndexFieldDataService.java
src/main/java/org/elasticsearch/index/get/ShardGetService.java
src/main/java/org/elasticsearch/index/mapper/FieldMapper.java
src/main/java/org/elasticsearch/index/mapper/MapperService.java
src/main/java/org/elasticsearch/index/mapper/ParseContext.java
src/main/java/org/elasticsearch/index/mapper/core/AbstractFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/core/CompletionFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/core/DateFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/core/Murmur3FieldMapper.java
src/main/java/org/elasticsearch/index/mapper/core/TokenCountFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/internal/AllFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/internal/FieldNamesFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/internal/TimestampFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/object/ObjectMapper.java
src/main/java/org/elasticsearch/index/query/QueryParseContext.java
src/main/java/org/elasticsearch/index/query/RangeFilterBuilder.java
src/main/java/org/elasticsearch/index/query/RangeFilterParser.java
src/main/java/org/elasticsearch/index/query/RangeQueryBuilder.java
src/main/java/org/elasticsearch/index/query/RangeQueryParser.java
src/main/java/org/elasticsearch/index/query/functionscore/DecayFunctionParser.java
src/main/java/org/elasticsearch/index/termvectors/ShardTermVectorService.java
src/main/java/org/elasticsearch/indices/recovery/RecoverySource.java
src/main/java/org/elasticsearch/indices/recovery/RecoveryTarget.java
src/main/java/org/elasticsearch/indices/store/IndicesStore.java
src/main/java/org/elasticsearch/indices/store/TransportNodesListShardStoreMetaData.java
src/main/java/org/elasticsearch/rest/action/RestActionModule.java
src/main/java/org/elasticsearch/rest/action/exists/RestExistsAction.java
src/main/java/org/elasticsearch/rest/action/get/RestGetAction.java
src/main/java/org/elasticsearch/rest/action/get/RestMultiGetAction.java
src/main/java/org/elasticsearch/rest/action/search/RestSearchAction.java
src/main/java/org/elasticsearch/river/cluster/PublishRiverClusterStateAction.java
src/main/java/org/elasticsearch/search/action/SearchServiceTransportAction.java
src/main/java/org/elasticsearch/search/aggregations/AggregationBuilders.java
src/main/java/org/elasticsearch/search/aggregations/AggregationModule.java
src/main/java/org/elasticsearch/search/aggregations/TransportAggregationModule.java
src/main/java/org/elasticsearch/search/aggregations/bucket/filters/Filters.java
src/main/java/org/elasticsearch/search/aggregations/bucket/filters/FiltersAggregationBuilder.java
src/main/java/org/elasticsearch/search/aggregations/bucket/filters/FiltersAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/filters/FiltersParser.java
src/main/java/org/elasticsearch/search/aggregations/bucket/filters/InternalFilters.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/DateHistogramParser.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/InternalHistogram.java
src/main/java/org/elasticsearch/search/aggregations/bucket/range/geodistance/GeoDistanceParser.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/heuristics/ChiSquare.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/heuristics/GND.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/heuristics/JLHScore.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/heuristics/MutualInformation.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/heuristics/NXYSignificanceHeuristic.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/heuristics/SignificanceHeuristic.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/heuristics/SignificantTermsHeuristicModule.java
src/main/java/org/elasticsearch/search/facet/datehistogram/DateHistogramFacetParser.java
src/main/java/org/elasticsearch/search/sort/FieldSortBuilder.java
src/main/java/org/elasticsearch/search/sort/GeoDistanceSortBuilder.java
src/main/java/org/elasticsearch/search/sort/GeoDistanceSortParser.java
src/main/java/org/elasticsearch/search/sort/SortParseElement.java
src/main/java/org/elasticsearch/snapshots/RestoreService.java
src/main/java/org/elasticsearch/snapshots/SnapshotsService.java
src/main/java/org/elasticsearch/transport/ActionNames.java
src/main/java/org/elasticsearch/transport/TransportService.java
src/main/java/org/elasticsearch/transport/TransportServiceAdapter.java
src/main/java/org/elasticsearch/transport/local/LocalTransport.java
src/main/java/org/elasticsearch/transport/netty/MessageChannelHandler.java
src/main/java/org/elasticsearch/transport/netty/NettyTransport.java
src/test/java/org/elasticsearch/action/termvector/GetTermVectorTests.java
src/test/java/org/elasticsearch/bwcompat/TransportClientBackwardsCompatibilityTest.java
src/test/java/org/elasticsearch/bwcompat/UnicastBackwardsCompatibilityTest.java
src/test/java/org/elasticsearch/cluster/NoMasterNodeTests.java
src/test/java/org/elasticsearch/cluster/metadata/MappingMetaDataParserTests.java
src/test/java/org/elasticsearch/cluster/metadata/ToAndFromJsonMetaDataTests.java
src/test/java/org/elasticsearch/common/breaker/MemoryCircuitBreakerTests.java
src/test/java/org/elasticsearch/common/cli/CliToolTestCase.java
src/test/java/org/elasticsearch/common/cli/CliToolTests.java
src/test/java/org/elasticsearch/common/cli/TerminalTests.java
src/test/java/org/elasticsearch/document/AliasedIndexDocumentActionsTests.java
src/test/java/org/elasticsearch/exists/SimpleExistsTests.java
src/test/java/org/elasticsearch/get/GetActionTests.java
src/test/java/org/elasticsearch/index/TransportIndexFailuresTest.java
src/test/java/org/elasticsearch/index/mapper/copyto/CopyToMapperTests.java
src/test/java/org/elasticsearch/index/mapper/timestamp/TimestampMappingTests.java
src/test/java/org/elasticsearch/index/query/IndexQueryParserFilterDateRangeTimezoneTests.java
src/test/java/org/elasticsearch/indices/IndicesOptionsIntegrationTests.java
src/test/java/org/elasticsearch/indices/store/IndicesStoreIntegrationTests.java
src/test/java/org/elasticsearch/mget/SimpleMgetTests.java
src/test/java/org/elasticsearch/percolator/ConcurrentPercolatorTests.java
src/test/java/org/elasticsearch/routing/SimpleRoutingTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/DateHistogramTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/FiltersTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/SignificantTermsSignificanceScoreTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/SignificantTermsTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/significant/SignificanceHeuristicTests.java
src/test/java/org/elasticsearch/search/query/SimpleQueryTests.java
src/test/java/org/elasticsearch/search/sort/SimpleSortTests.java
src/test/java/org/elasticsearch/search/sort/SortParserTests.java
src/test/java/org/elasticsearch/search/suggest/CompletionSuggestSearchTests.java
src/test/java/org/elasticsearch/test/CompositeTestCluster.java
src/test/java/org/elasticsearch/test/ElasticsearchBackwardsCompatIntegrationTest.java
src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java
src/test/java/org/elasticsearch/test/ElasticsearchSingleNodeTest.java
src/test/java/org/elasticsearch/test/ExternalNode.java
src/test/java/org/elasticsearch/test/ExternalTestCluster.java
src/test/java/org/elasticsearch/test/InternalTestCluster.java
src/test/java/org/elasticsearch/test/TestCluster.java
src/test/java/org/elasticsearch/test/TestSearchContext.java
src/test/java/org/elasticsearch/test/hamcrest/ElasticsearchAssertions.java
src/test/java/org/elasticsearch/test/transport/ConfigurableErrorNettyTransportModule.java
src/test/java/org/elasticsearch/transport/ActionNamesBackwardsCompatibilityTest.java
src/test/java/org/elasticsearch/transport/ActionNamesTests.java
src/test/java/org/elasticsearch/update/UpdateTests.java
comments:
Merge branch 'master' of https://github.com/elasticsearch/elasticsearch

time:
2014-08-04T20:56:22Z
class:
comments:
Update release script

We need also to update README in current release branch.

(cherry picked from commit 42db2fa)
(cherry picked from commit 91d7989)

time:
2014-08-04T15:16:10Z
class:
src/test/java/org/elasticsearch/action/termvector/GetTermVectorTests.java
comments:
[TEST] Fixed GetTermVectorTests, added missing break statements in randomization switch

time:
2014-08-04T15:00:40Z
class:
src/test/java/org/elasticsearch/transport/ActionNamesBackwardsCompatibilityTest.java
comments:
[TEST] Fixed action names bw comp tests, action not found is expected for newly added exists actions

time:
2014-08-04T14:30:31Z
class:
comments:
Fix installation instructions update

time:
2014-08-04T14:29:25Z
class:
comments:
fix install instruction with version 2.4.0

time:
2014-08-04T14:24:26Z
class:
comments:
update documentation with release 2.4.0

time:
2014-08-04T14:22:22Z
class:
comments:
Update release tool

(cherry picked from commit d56d5fb)

time:
2014-08-04T14:12:13Z
class:
comments:
Update release tool

(cherry picked from commit b3dd4a7)

time:
2014-08-04T13:42:03Z
class:
src/main/java/org/elasticsearch/common/joda/DateMathParser.java
src/main/java/org/elasticsearch/index/mapper/core/DateFieldMapper.java
src/main/java/org/elasticsearch/index/query/RangeFilterBuilder.java
src/main/java/org/elasticsearch/index/query/RangeFilterParser.java
src/main/java/org/elasticsearch/index/query/RangeQueryBuilder.java
src/main/java/org/elasticsearch/index/query/RangeQueryParser.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/DateHistogramParser.java
src/main/java/org/elasticsearch/search/facet/datehistogram/DateHistogramFacetParser.java
src/test/java/org/elasticsearch/index/query/IndexQueryParserFilterDateRangeTimezoneTests.java
src/test/java/org/elasticsearch/search/query/SimpleQueryTests.java
comments:
Search: add time zone setting for relative date math in range filter/query

Filters and Queries now supports `time_zone` parameter which defines which time zone should be applied to the query or filter to convert it to UTC time based value.

When applied on `date` fields the `range` filter and queries accept also a `time_zone` parameter.

The `time_zone` parameter will be applied to your input lower and upper bounds and will move them to UTC time based date:

[source,js]
--------------------------------------------------
{
    "constant_score": {
        "filter": {
            "range" : {
                "born" : {
                    "gte": "2012-01-01",
                    "lte": "now",
                    "time_zone": "+1:00"
                }
            }
        }
    }
}

{
    "range" : {
        "born" : {
            "gte": "2012-01-01",
            "lte": "now",
            "time_zone": "+1:00"
        }
    }
}
--------------------------------------------------

In the above examples, `gte` will be actually moved to `2011-12-31T23:00:00` UTC date.

NOTE: if you give a date with a timezone explicitly defined and use the `time_zone` parameter, `time_zone` will be
ignored. For example, setting `from` to `2012-01-01T00:00:00+01:00` with `"time_zone":"+10:00"` will still use `+01:00` time zone.

Closes #3729.

time:
2014-08-04T13:24:16Z
class:
src/main/java/org/elasticsearch/action/admin/cluster/health/ClusterHealthAction.java
src/main/java/org/elasticsearch/action/admin/cluster/node/hotthreads/NodesHotThreadsAction.java
src/main/java/org/elasticsearch/action/admin/cluster/node/info/NodesInfoAction.java
src/main/java/org/elasticsearch/action/admin/cluster/node/restart/NodesRestartAction.java
src/main/java/org/elasticsearch/action/admin/cluster/node/shutdown/NodesShutdownAction.java
src/main/java/org/elasticsearch/action/admin/cluster/node/shutdown/TransportNodesShutdownAction.java
src/main/java/org/elasticsearch/action/admin/cluster/node/stats/NodesStatsAction.java
src/main/java/org/elasticsearch/action/admin/cluster/repositories/delete/DeleteRepositoryAction.java
src/main/java/org/elasticsearch/action/admin/cluster/repositories/get/GetRepositoriesAction.java
src/main/java/org/elasticsearch/action/admin/cluster/repositories/put/PutRepositoryAction.java
src/main/java/org/elasticsearch/action/admin/cluster/reroute/ClusterRerouteAction.java
src/main/java/org/elasticsearch/action/admin/cluster/settings/ClusterUpdateSettingsAction.java
src/main/java/org/elasticsearch/action/admin/cluster/shards/ClusterSearchShardsAction.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/create/CreateSnapshotAction.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/delete/DeleteSnapshotAction.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/get/GetSnapshotsAction.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/restore/RestoreSnapshotAction.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/status/SnapshotsStatusAction.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/status/TransportNodesSnapshotsStatus.java
src/main/java/org/elasticsearch/action/admin/cluster/state/ClusterStateAction.java
src/main/java/org/elasticsearch/action/admin/cluster/stats/ClusterStatsAction.java
src/main/java/org/elasticsearch/action/admin/cluster/tasks/PendingClusterTasksAction.java
src/main/java/org/elasticsearch/action/admin/indices/alias/IndicesAliasesAction.java
src/main/java/org/elasticsearch/action/admin/indices/alias/exists/AliasesExistAction.java
src/main/java/org/elasticsearch/action/admin/indices/alias/get/GetAliasesAction.java
src/main/java/org/elasticsearch/action/admin/indices/analyze/AnalyzeAction.java
src/main/java/org/elasticsearch/action/admin/indices/cache/clear/ClearIndicesCacheAction.java
src/main/java/org/elasticsearch/action/admin/indices/close/CloseIndexAction.java
src/main/java/org/elasticsearch/action/admin/indices/create/CreateIndexAction.java
src/main/java/org/elasticsearch/action/admin/indices/delete/DeleteIndexAction.java
src/main/java/org/elasticsearch/action/admin/indices/exists/indices/IndicesExistsAction.java
src/main/java/org/elasticsearch/action/admin/indices/exists/types/TypesExistsAction.java
src/main/java/org/elasticsearch/action/admin/indices/flush/FlushAction.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/delete/DeleteMappingAction.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/get/GetFieldMappingsAction.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/get/GetMappingsAction.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/get/TransportGetFieldMappingsIndexAction.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/put/PutMappingAction.java
src/main/java/org/elasticsearch/action/admin/indices/open/OpenIndexAction.java
src/main/java/org/elasticsearch/action/admin/indices/optimize/OptimizeAction.java
src/main/java/org/elasticsearch/action/admin/indices/recovery/RecoveryAction.java
src/main/java/org/elasticsearch/action/admin/indices/refresh/RefreshAction.java
src/main/java/org/elasticsearch/action/admin/indices/segments/IndicesSegmentsAction.java
src/main/java/org/elasticsearch/action/admin/indices/settings/get/GetSettingsAction.java
src/main/java/org/elasticsearch/action/admin/indices/settings/put/UpdateSettingsAction.java
src/main/java/org/elasticsearch/action/admin/indices/stats/IndicesStatsAction.java
src/main/java/org/elasticsearch/action/admin/indices/template/delete/DeleteIndexTemplateAction.java
src/main/java/org/elasticsearch/action/admin/indices/template/get/GetIndexTemplatesAction.java
src/main/java/org/elasticsearch/action/admin/indices/template/put/PutIndexTemplateAction.java
src/main/java/org/elasticsearch/action/admin/indices/validate/query/ValidateQueryAction.java
src/main/java/org/elasticsearch/action/admin/indices/warmer/delete/DeleteWarmerAction.java
src/main/java/org/elasticsearch/action/admin/indices/warmer/get/GetWarmersAction.java
src/main/java/org/elasticsearch/action/admin/indices/warmer/put/PutWarmerAction.java
src/main/java/org/elasticsearch/action/bench/AbortBenchmarkAction.java
src/main/java/org/elasticsearch/action/bench/BenchmarkAction.java
src/main/java/org/elasticsearch/action/bench/BenchmarkService.java
src/main/java/org/elasticsearch/action/bench/BenchmarkStatusAction.java
src/main/java/org/elasticsearch/action/bulk/BulkAction.java
src/main/java/org/elasticsearch/action/bulk/TransportShardBulkAction.java
src/main/java/org/elasticsearch/action/count/CountAction.java
src/main/java/org/elasticsearch/action/delete/DeleteAction.java
src/main/java/org/elasticsearch/action/delete/index/TransportIndexDeleteAction.java
src/main/java/org/elasticsearch/action/delete/index/TransportShardDeleteAction.java
src/main/java/org/elasticsearch/action/deletebyquery/DeleteByQueryAction.java
src/main/java/org/elasticsearch/action/deletebyquery/TransportIndexDeleteByQueryAction.java
src/main/java/org/elasticsearch/action/deletebyquery/TransportShardDeleteByQueryAction.java
src/main/java/org/elasticsearch/action/exists/ExistsAction.java
src/main/java/org/elasticsearch/action/explain/ExplainAction.java
src/main/java/org/elasticsearch/action/get/GetAction.java
src/main/java/org/elasticsearch/action/get/MultiGetAction.java
src/main/java/org/elasticsearch/action/get/TransportShardMultiGetAction.java
src/main/java/org/elasticsearch/action/index/IndexAction.java
src/main/java/org/elasticsearch/action/indexedscripts/delete/DeleteIndexedScriptAction.java
src/main/java/org/elasticsearch/action/indexedscripts/get/GetIndexedScriptAction.java
src/main/java/org/elasticsearch/action/indexedscripts/put/PutIndexedScriptAction.java
src/main/java/org/elasticsearch/action/mlt/MoreLikeThisAction.java
src/main/java/org/elasticsearch/action/percolate/MultiPercolateAction.java
src/main/java/org/elasticsearch/action/percolate/PercolateAction.java
src/main/java/org/elasticsearch/action/percolate/TransportShardMultiPercolateAction.java
src/main/java/org/elasticsearch/action/search/ClearScrollAction.java
src/main/java/org/elasticsearch/action/search/MultiSearchAction.java
src/main/java/org/elasticsearch/action/search/SearchAction.java
src/main/java/org/elasticsearch/action/search/SearchScrollAction.java
src/main/java/org/elasticsearch/action/suggest/SuggestAction.java
src/main/java/org/elasticsearch/action/support/broadcast/TransportBroadcastOperationAction.java
src/main/java/org/elasticsearch/action/support/nodes/TransportNodesOperationAction.java
src/main/java/org/elasticsearch/action/support/replication/TransportShardReplicationOperationAction.java
src/main/java/org/elasticsearch/action/support/single/custom/TransportSingleCustomOperationAction.java
src/main/java/org/elasticsearch/action/support/single/shard/TransportShardSingleOperationAction.java
src/main/java/org/elasticsearch/action/termvector/MultiTermVectorsAction.java
src/main/java/org/elasticsearch/action/termvector/TermVectorAction.java
src/main/java/org/elasticsearch/action/termvector/TransportSingleShardMultiTermsVectorAction.java
src/main/java/org/elasticsearch/action/update/UpdateAction.java
src/main/java/org/elasticsearch/client/transport/TransportClientNodesService.java
src/main/java/org/elasticsearch/cluster/action/index/MappingUpdatedAction.java
src/main/java/org/elasticsearch/cluster/action/index/NodeIndexDeletedAction.java
src/main/java/org/elasticsearch/cluster/action/index/NodeMappingRefreshAction.java
src/main/java/org/elasticsearch/cluster/action/shard/ShardStateAction.java
src/main/java/org/elasticsearch/discovery/zen/ZenDiscovery.java
src/main/java/org/elasticsearch/discovery/zen/fd/MasterFaultDetection.java
src/main/java/org/elasticsearch/discovery/zen/fd/NodesFaultDetection.java
src/main/java/org/elasticsearch/discovery/zen/membership/MembershipAction.java
src/main/java/org/elasticsearch/discovery/zen/ping/multicast/MulticastZenPing.java
src/main/java/org/elasticsearch/discovery/zen/ping/unicast/UnicastZenPing.java
src/main/java/org/elasticsearch/discovery/zen/publish/PublishClusterStateAction.java
src/main/java/org/elasticsearch/gateway/local/state/meta/LocalAllocateDangledIndices.java
src/main/java/org/elasticsearch/gateway/local/state/meta/TransportNodesListGatewayMetaState.java
src/main/java/org/elasticsearch/gateway/local/state/shards/TransportNodesListGatewayStartedShards.java
src/main/java/org/elasticsearch/indices/recovery/RecoverySource.java
src/main/java/org/elasticsearch/indices/recovery/RecoveryTarget.java
src/main/java/org/elasticsearch/indices/store/IndicesStore.java
src/main/java/org/elasticsearch/indices/store/TransportNodesListShardStoreMetaData.java
src/main/java/org/elasticsearch/river/cluster/PublishRiverClusterStateAction.java
src/main/java/org/elasticsearch/search/action/SearchServiceTransportAction.java
src/main/java/org/elasticsearch/snapshots/RestoreService.java
src/main/java/org/elasticsearch/snapshots/SnapshotsService.java
src/main/java/org/elasticsearch/transport/ActionNames.java
src/main/java/org/elasticsearch/transport/TransportService.java
src/main/java/org/elasticsearch/transport/TransportServiceAdapter.java
src/main/java/org/elasticsearch/transport/local/LocalTransport.java
src/main/java/org/elasticsearch/transport/netty/MessageChannelHandler.java
src/main/java/org/elasticsearch/transport/netty/NettyTransport.java
src/test/java/org/elasticsearch/bwcompat/TransportClientBackwardsCompatibilityTest.java
src/test/java/org/elasticsearch/bwcompat/UnicastBackwardsCompatibilityTest.java
src/test/java/org/elasticsearch/index/TransportIndexFailuresTest.java
src/test/java/org/elasticsearch/test/CompositeTestCluster.java
src/test/java/org/elasticsearch/test/ExternalNode.java
src/test/java/org/elasticsearch/test/ExternalTestCluster.java
src/test/java/org/elasticsearch/test/InternalTestCluster.java
src/test/java/org/elasticsearch/test/TestCluster.java
src/test/java/org/elasticsearch/test/transport/ConfigurableErrorNettyTransportModule.java
src/test/java/org/elasticsearch/transport/ActionNamesBackwardsCompatibilityTest.java
src/test/java/org/elasticsearch/transport/ActionNamesTests.java
comments:
Transport: better categorization for transport actions

Our transport relies on action names that tell what we need to do with each message received and sent on any node, together with the content of the request itself.
The action names could use a better categorization and more consistent naming though, the following are the categories introduced with this commit:

- indices: for all the apis that execute against indices
  - admin: for the apis that allow to perform administration tasks against indices
  - data: for the apis that are about data
    - read: apis that read data
    - write: apis that write data
    - benchmark: apis that run benchmarks

- cluster: for all the cluster apis
  - admin: for the cluster apis that allow to perform administration tasks
  - monitor: for the cluster apis that allow to monitor the system

- internal: for all the internal actions that are used from node to node but not directly exposed to users

The change is applied in a backwards compatible manner: we keep the mapping old-to-new action name around, and when receiving a message, depending on the version of the node we receive it from, we use the received action name or we convert it to the previous version (old to new if version < 1.4). When sending a message, depending on the version of the node we talk to, we use the updated action or we convert it to the previous version (new to old if version < 1.4).
For the cases where we don't know the version of the node we talk to, namely unicast ping, transport client nodes info and transport client sniff mode (which calls cluster state), we just use a lower bound for the version, thus we will always use the old action name, which can be understood by both old nodes and new nodes.

Added test that enforces known updated categories for transport action names and test that verifies all action names have a pre 1.4 version for bw compatibility

Added backwards compatibility tests for unicast and transport client in sniff mode, the one for the ordinary transport client (which calls nodes info) is implicit as it's used all the time in our bw comp tests.
Added also backwards comp test that sends an empty message to any of the registered transport handler exposed by older nodes and verifies that what gets back is not ActionNotFoundTransportException, which would mean that there is a problem in the actions mappings.

Added TestCluster#getClusterName abstract method and allow to retrieve externalTransportAddress and internalCluster from CompositeTestCluster.

Closes #7105

time:
2014-08-04T13:14:09Z
class:
src/main/java/org/elasticsearch/action/support/replication/TransportShardReplicationOperationAction.java
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
comments:
Core: simultaneous create/delete against same id can cause silently inconsistent replica

If simultaneous create & delete operations arrive against the same id,
it's possible that primary and replica see those operations in
different orders, which may result in replica throwing
DocumentAlreadyExistsException when the primary didn't which would
lead to replica being inconsistent (missing a document that primary
had indexed).

This push fixes the issue, by never throwing DAEE from the replica on
create.

Closes #7146 #7142

time:
2014-08-04T12:19:19Z
class:
src/main/java/org/elasticsearch/action/get/TransportMultiGetAction.java
src/main/java/org/elasticsearch/action/termvector/TransportMultiTermVectorsAction.java
src/test/java/org/elasticsearch/mget/SimpleMgetTests.java
src/test/java/org/elasticsearch/routing/SimpleRoutingTests.java
comments:
MultiGet & MultiTermVector api: fail when using no routing and an alias to an index that has routing required (for that doc type)

Made sure that the routing required check is performed against the concrete index, added use of aliases to existing routing tests.

Taken the change to unify the failure message as well to this form: routing is required for [" + index + "]/[" + type + "]/[" + id + "]

Closes #7145

time:
2014-08-04T10:50:37Z
class:
src/test/java/org/elasticsearch/test/ElasticsearchBackwardsCompatIntegrationTest.java
comments:
[TEST] better failure message when back location is missing

time:
2014-08-04T08:23:34Z
class:
src/main/java/org/elasticsearch/index/fielddata/IndexFieldDataService.java
src/main/java/org/elasticsearch/index/query/QueryParseContext.java
src/test/java/org/elasticsearch/test/ExternalTestCluster.java
src/test/java/org/elasticsearch/test/InternalTestCluster.java
comments:
Percolator should cache index field data instances.

Before the index reader used by the percolator didn't allow to register a CoreCloseListener, but now it does, making it safe to cache index field data cache entries.
Creating field data structures is relatively expensive and caching them can save a lot of noise if many queries are evaluated in a percolator call.

Closes #6806
Closes #7081

time:
2014-08-04T07:29:16Z
class:
comments:
Dependencies: Randomized testing version bump

time:
2014-08-04T06:43:44Z
class:
comments:
Docs: remove duplicate label

time:
2014-08-04T06:15:34Z
class:
src/main/java/org/elasticsearch/action/explain/TransportExplainAction.java
src/main/java/org/elasticsearch/action/get/GetRequest.java
src/main/java/org/elasticsearch/action/get/GetRequestBuilder.java
src/main/java/org/elasticsearch/action/get/MultiGetRequest.java
src/main/java/org/elasticsearch/action/get/MultiGetRequestBuilder.java
src/main/java/org/elasticsearch/action/get/MultiGetShardRequest.java
src/main/java/org/elasticsearch/action/get/TransportGetAction.java
src/main/java/org/elasticsearch/action/get/TransportMultiGetAction.java
src/main/java/org/elasticsearch/action/get/TransportShardMultiGetAction.java
src/main/java/org/elasticsearch/action/update/UpdateHelper.java
src/main/java/org/elasticsearch/index/get/ShardGetService.java
src/main/java/org/elasticsearch/index/mapper/FieldMapper.java
src/main/java/org/elasticsearch/index/mapper/core/AbstractFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/core/Murmur3FieldMapper.java
src/main/java/org/elasticsearch/index/mapper/core/TokenCountFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/internal/AllFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/internal/FieldNamesFieldMapper.java
src/main/java/org/elasticsearch/index/termvectors/ShardTermVectorService.java
src/main/java/org/elasticsearch/rest/action/get/RestGetAction.java
src/main/java/org/elasticsearch/rest/action/get/RestMultiGetAction.java
src/test/java/org/elasticsearch/get/GetActionTests.java
src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java
comments:
Add parameter to GET for checking if generated fields can be retrieved

Fields of type `token_count`, `murmur3`, `_all` and `_field_names` are generated only when indexing.
If a GET requests accesses the transaction log (because no refresh
between indexing and GET request) then these fields cannot be retrieved at all.
Before the behavior was so:

`_all, _field_names`: The field was siletly ignored
`murmur3, token_count`: `NumberFormatException` because GET tried to parse the values from the source.

In addition, if these fields were not stored, the same behavior occured if the fields were
retrieved with GET after a `refresh()` because here also the source was used to get the fields.

Now, GET accepts a parameter `ignore_errors_on_generated_fields` which has
the following effect:
- Throw exception with meaningful error message explaining the problem if set to false (default)
- Ignore the field if set to true
- Always ignore the field if it was not set to stored

This changes the behavior for `_all` and `_field_names` as now an Exception is thrown if a user
tries to GET them before a `refresh()`.

closes #6676
closes #6973

time:
2014-08-04T06:15:26Z
class:
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/heuristics/ChiSquare.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/heuristics/GND.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/heuristics/JLHScore.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/heuristics/MutualInformation.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/heuristics/NXYSignificanceHeuristic.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/heuristics/SignificanceHeuristic.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/heuristics/SignificantTermsHeuristicModule.java
src/test/java/org/elasticsearch/search/aggregations/bucket/SignificantTermsSignificanceScoreTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/SignificantTermsTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/significant/SignificanceHeuristicTests.java
comments:
significant terms: add google normalized distance, add chi square

closes #6858

time:
2014-08-03T20:18:33Z
class:
comments:
Added CliToolTestCase's sub classes to the test jar

time:
2014-08-03T19:10:25Z
class:
comments:
Added CliToolTestCase to the test jar

time:
2014-08-03T11:59:20Z
class:
comments:
Update release tool

(cherry picked from commit 288755a)

time:
2014-08-03T11:58:59Z
class:
src/test/java/org/elasticsearch/discovery/azure/AbstractAzureComputeServiceTest.java
comments:
Fix non integration tests

With change #24, non integration can not run anymore.

(cherry picked from commit 76eecc8)

time:
2014-08-02T19:02:22Z
class:
src/test/java/org/elasticsearch/common/cli/CliToolTests.java
comments:
fixed platform independent line separator in CliToolTests

time:
2014-08-02T15:32:41Z
class:
src/main/java/org/elasticsearch/http/netty/NettyHttpServerTransport.java
src/main/java/org/elasticsearch/transport/netty/NettyTransport.java
comments:
Support "default" for tcpNoDelay and tcpKeepAlive
Allow to set the value default to network.tcp.no_delay and network.tcp.keep_alive so they won't be set at all, since on solaris, setting tcpNoDelay can actually cause failure
relates to #7115

time:
2014-08-02T15:16:27Z
class:
src/main/java/org/elasticsearch/common/cli/CliTool.java
src/main/java/org/elasticsearch/common/cli/CliToolConfig.java
src/main/java/org/elasticsearch/common/cli/HelpPrinter.java
src/main/java/org/elasticsearch/common/cli/Terminal.java
src/main/java/org/elasticsearch/common/http/client/HttpDownloadHelper.java
src/main/java/org/elasticsearch/common/io/Streams.java
src/main/java/org/elasticsearch/common/util/Callback.java
src/test/java/org/elasticsearch/common/cli/CliToolTestCase.java
src/test/java/org/elasticsearch/common/cli/CliToolTests.java
src/test/java/org/elasticsearch/common/cli/TerminalTests.java
comments:
Added a cli infrastructure

CliTool is a base class for command-line interface tools (such as the plugin manager and potentially others). It supports the following:
  - single or multi command tool
  - help printing infrastructure (based on help files)
  - consistent mechanism of parsing arguments (based on commons-cli lib)
  - separation of argument parsing and command execution (for easier unit testing)
  - terminal abstraction (will use System.console() when available)

time:
2014-08-02T14:52:52Z
class:
src/main/java/org/elasticsearch/cluster/routing/allocation/decider/Decision.java
comments:
Fix missing break statement causing reroute serialization failure
closes #7135

time:
2014-08-01T19:25:05Z
class:
src/main/java/org/elasticsearch/index/mapper/FieldMapper.java
src/main/java/org/elasticsearch/index/mapper/core/AbstractFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/core/CompletionFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/object/ObjectMapper.java
src/test/java/org/elasticsearch/search/suggest/CompletionSuggestSearchTests.java
comments:
[Fix] CompletionMapper throws misleading error on null value

closes #6399

time:
2014-08-01T17:21:44Z
class:
comments:
Docs: make the welcome page more obvious

One of the concern we have with our documentation is that it's hard for users to understand which plugin version they should use with a given elasticsearch version.

The change will consist of:

* have a clean and simple compatibility matrix on master branch
* remove list of versions in other branches

Closes #29.

time:
2014-08-01T16:30:08Z
class:
comments:
Docs: make the welcome page more obvious

One of the concern we have with our documentation is that it's hard for users to understand which plugin version they should use with a given elasticsearch version.

The change will consist of:

* have a clean and simple compatibility matrix on master branch
* remove list of versions in other branches

Closes #29.

time:
2014-08-01T16:19:55Z
class:
comments:
Docs: make the welcome page more obvious

One of the concern we have with our documentation is that it's hard for users to understand which plugin version they should use with a given elasticsearch version.

The change will consist of:

* have a clean and simple compatibility matrix on master branch
* remove list of versions in other branches

Closes #29.

time:
2014-08-01T15:23:21Z
class:
src/main/java/org/elasticsearch/cloud/azure/AzureStorageServiceImpl.java
comments:
Add a missing trace to `removeContainer`

time:
2014-08-01T15:22:59Z
class:
src/test/java/org/elasticsearch/repositories/azure/AzureSnapshotRestoreITest.java
comments:
Tests: test GET/DELETE on non existing repo

`GET` and `DELETE` should return `404` error.

Closes #28.

time:
2014-08-01T15:06:29Z
class:
src/main/java/org/elasticsearch/cloud/azure/blobstore/AbstractAzureBlobContainer.java
comments:
Replace 404 with HttpURLConnection.HTTP_NOT_FOUND

time:
2014-08-01T15:01:08Z
class:
src/main/java/org/elasticsearch/search/aggregations/AggregationBuilders.java
src/main/java/org/elasticsearch/search/aggregations/AggregationModule.java
src/main/java/org/elasticsearch/search/aggregations/TransportAggregationModule.java
src/main/java/org/elasticsearch/search/aggregations/bucket/filters/Filters.java
src/main/java/org/elasticsearch/search/aggregations/bucket/filters/FiltersAggregationBuilder.java
src/main/java/org/elasticsearch/search/aggregations/bucket/filters/FiltersAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/filters/FiltersParser.java
src/main/java/org/elasticsearch/search/aggregations/bucket/filters/InternalFilters.java
src/test/java/org/elasticsearch/search/aggregations/bucket/FiltersTests.java
comments:
Aggregations Added Filters aggregation

A multi-bucket aggregation where multiple filters can be defined (each filter defines a bucket). The buckets will collect all the documents that match their associated filter.

This aggregation can be very useful when one wants to compare analytics between different criterias. It can also be accomplished using multiple definitions of the single filter aggregation, but here, the user will only need to define the sub-aggregations only once.

Closes #6118

time:
2014-08-01T13:30:17Z
class:
src/main/java/org/elasticsearch/common/text/StringAndBytesText.java
src/main/java/org/elasticsearch/index/mapper/MapperService.java
src/main/java/org/elasticsearch/search/sort/FieldSortBuilder.java
src/main/java/org/elasticsearch/search/sort/SortParseElement.java
src/test/java/org/elasticsearch/search/sort/SimpleSortTests.java
src/test/java/org/elasticsearch/test/hamcrest/ElasticsearchAssertions.java
comments:
Sort: Make `ignore_unmapped` work for cross-index queries.

Close #2255

time:
2014-08-01T13:18:38Z
class:
src/main/java/org/elasticsearch/common/breaker/ChildMemoryCircuitBreaker.java
src/test/java/org/elasticsearch/common/breaker/MemoryCircuitBreakerTests.java
comments:
[TEST] check breaker reset after parent trip instead of trip count

time:
2014-08-01T11:49:43Z
class:
src/main/java/org/elasticsearch/cluster/metadata/IndexMetaData.java
src/test/java/org/elasticsearch/cluster/metadata/ToAndFromJsonMetaDataTests.java
src/test/java/org/elasticsearch/document/AliasedIndexDocumentActionsTests.java
comments:
Removed support for aliases as part of index settings

Now that we have explicit support for aliases when creating indices and as part of index templates, we may remove support for aliases (only names) as part of index settings. This is partially breaking as the following calls:

curl -XPUT localhost:9200/index -d '{
  "settings" : {
    "aliases" : [ "alias1"]
  }
}

and

curl -XPUT localhost:9200/index -d '{
  "settings" : {
    "index.aliases" : [ "alias1"]
  }
}

were previously supported and will need to be replaced with

curl -XPUT localhost:9200/index -d '{
  "aliases" : {
    "alias1": {}
  }
}

Closes #5545

time:
2014-08-01T10:43:26Z
class:
src/main/java/org/elasticsearch/index/query/functionscore/DecayFunctionParser.java
comments:
Function score query: Add missing whitespace when throwing exception

DecayFunctionParser throws a parse exception with a string containing "scaleand origin", this fixes the spacing issue.

time:
2014-08-01T10:38:35Z
class:
comments:
[DOCS] fixed small typo in percolate.asciidoc

time:
2014-08-01T10:30:08Z
class:
comments:
Docs: add 1.4.0 label to many to many geo distance sort

time:
2014-08-01T07:20:19Z
class:
comments:
Update fielddata-fields.asciidoc

time:
2014-08-01T06:58:10Z
class:
src/main/java/org/elasticsearch/common/rounding/TimeZoneRounding.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/InternalHistogram.java
src/test/java/org/elasticsearch/search/aggregations/bucket/DateHistogramTests.java
comments:
Aggregations: Fix infinite loop in the histogram reduce logic.

The histogram reduce method can run into an infinite loop if the
Rounding.nextRoundingValue value is buggy, which happened to be the case for
DayTimeZoneRoundingFloor.

DayTimeZoneRoundingFloor is fixed, and the histogram reduce method has been
changed to fail instead of running into an infinite loop in case of a buffy
nextRoundingValue impl.

Close #6965

time:
2014-08-01T06:57:33Z
class:
src/main/java/org/elasticsearch/index/mapper/ParseContext.java
src/main/java/org/elasticsearch/index/mapper/core/AbstractFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/object/ObjectMapper.java
src/test/java/org/elasticsearch/index/mapper/copyto/CopyToMapperTests.java
comments:
Mappings: Fix `copy_to` behavior on nested documents.

Today, `copy_to` always copies a field to the current document, which is often
wrong in the case of nested documents. For example, if you have a nested field
called `n` which has a sub-field `n.source` whose content should be copied to
`target`, then the latter field should be created in the root document instead
of the nested one, since it doesn't have `n.` as a prefix. On the contrary, if
you configure the destination field to be `n.target`, then it should go to the
nested document.

Close #6701

time:
2014-07-31T19:42:30Z
class:
src/main/java/org/elasticsearch/action/ActionModule.java
src/main/java/org/elasticsearch/action/exists/ExistsAction.java
src/main/java/org/elasticsearch/action/exists/ExistsRequest.java
src/main/java/org/elasticsearch/action/exists/ExistsRequestBuilder.java
src/main/java/org/elasticsearch/action/exists/ExistsResponse.java
src/main/java/org/elasticsearch/action/exists/ShardExistsRequest.java
src/main/java/org/elasticsearch/action/exists/ShardExistsResponse.java
src/main/java/org/elasticsearch/action/exists/TransportExistsAction.java
src/main/java/org/elasticsearch/action/exists/package-info.java
src/main/java/org/elasticsearch/action/support/broadcast/TransportBroadcastOperationAction.java
src/main/java/org/elasticsearch/client/Client.java
src/main/java/org/elasticsearch/client/Requests.java
src/main/java/org/elasticsearch/client/support/AbstractClient.java
src/main/java/org/elasticsearch/rest/action/RestActionModule.java
src/main/java/org/elasticsearch/rest/action/exists/RestExistsAction.java
src/main/java/org/elasticsearch/rest/action/search/RestSearchAction.java
src/test/java/org/elasticsearch/exists/SimpleExistsTests.java
src/test/java/org/elasticsearch/test/hamcrest/ElasticsearchAssertions.java
comments:
Search Exists API: Checks if any matching documents exist for a given query

Implements a new Exists API allowing users to do fast exists check on any matched documents for a given query.
This API should be faster then using the Count API as it will:
 - early terminate the search execution once any document is found to exist
 - return the response as soon as the first shard reports matched documents

closes #6995

time:
2014-07-31T17:48:22Z
class:
src/main/java/org/elasticsearch/action/index/IndexRequest.java
src/main/java/org/elasticsearch/cluster/metadata/MappingMetaData.java
src/main/java/org/elasticsearch/index/mapper/internal/TimestampFieldMapper.java
src/test/java/org/elasticsearch/cluster/metadata/MappingMetaDataParserTests.java
src/test/java/org/elasticsearch/index/mapper/timestamp/TimestampMappingTests.java
comments:
Generate timestamp when path is null

Index process fails when having `_timestamp` enabled and `path` option is set.
It fails with a `TimestampParsingException[failed to parse timestamp [null]]` message.

Reproduction:

```
DELETE test
PUT  test
{
    "mappings": {
        "test": {
            "_timestamp" : {
                "enabled" : "yes",
                "path" : "post_date"
            }
        }
    }
}
PUT test/test/1
{
  "foo": "bar"
}
```

You can define a default value for when timestamp is not provided
within the index request or in the `_source` document.

By default, the default value is `now` which means the date the document was processed by the indexing chain.

You can disable that default value by setting `default` to `null`. It means that `timestamp` is mandatory:

```
{
    "tweet" : {
        "_timestamp" : {
            "enabled" : true,
            "default" : null
        }
    }
}
```

If you don't provide any timestamp value, indexation will fail.

You can also set the default value to any date respecting timestamp format:

```
{
    "tweet" : {
        "_timestamp" : {
            "enabled" : true,
            "format" : "YYYY-MM-dd",
            "default" : "1970-01-01"
        }
    }
}
```

If you don't provide any timestamp value, indexation will fail.

Closes #4718.
Closes #7036.

time:
2014-07-31T17:01:30Z
class:
src/test/java/org/elasticsearch/update/UpdateTests.java
comments:
[TEST] Reduce number of updates and wait after 1st NoNodeException.

time:
2014-07-31T15:33:45Z
class:
src/main/java/org/elasticsearch/common/geo/GeoDistance.java
src/main/java/org/elasticsearch/search/aggregations/bucket/range/geodistance/GeoDistanceParser.java
src/main/java/org/elasticsearch/search/sort/GeoDistanceSortBuilder.java
src/main/java/org/elasticsearch/search/sort/GeoDistanceSortParser.java
src/test/java/org/elasticsearch/search/sort/SimpleSortTests.java
src/test/java/org/elasticsearch/search/sort/SortParserTests.java
src/test/java/org/elasticsearch/test/ElasticsearchSingleNodeTest.java
src/test/java/org/elasticsearch/test/TestSearchContext.java
comments:
_geo_distance sort: allow many to many geo point distance

Add computation of disyance to many geo points. Example request:

```
{
  "sort": [
    {
      "_geo_distance": {
        "location": [
          {
            "lat":1.2,
            "lon":3
          },
          {
             "lat":1.2,
            "lon":3
          }
        ],
        "order": "desc",
        "unit": "km",
        "sort_mode": "max"
      }
    }
  ]
}
```

closes #3926

time:
2014-07-31T14:57:49Z
class:
src/main/java/org/elasticsearch/action/bulk/TransportBulkAction.java
src/test/java/org/elasticsearch/cluster/NoMasterNodeTests.java
comments:
cluster block with auto create index bulk action can cause bulk execution to not return
when there is a cluster block (like no master yet discovered), the bulk action doesn't properly catch the exception of inner execute to notify the listener, causing the bulk operation to hang
closes #7086

time:
2014-07-31T14:22:24Z
class:
src/test/java/org/elasticsearch/indices/IndicesOptionsIntegrationTests.java
comments:
[TEST] All shards should be allocated before snapshotting & restoring

time:
2014-07-31T14:22:24Z
class:
src/test/java/org/elasticsearch/indices/store/IndicesStoreIntegrationTests.java
comments:
[TEST] Increased logging and make use of prepareCreate and assertAcked

time:
2014-07-31T13:22:11Z
class:
comments:
[BUILD] Add profile that skips all validations

This commit adds a profile that skips all validation ie.
 - nocommit / tabs checking
 - forbidden API checks
 - license headers

It's not active by default but can easily be activated with
  `mvn -Pdev` or in the `~/.m2/settings.xml`

for reference see:
  http://maven.apache.org/guides/introduction/introduction-to-profiles.html

time:
2014-07-31T12:06:24Z
class:
comments:
Update translog.asciidoc

Documented `index.gateway.local.sync`

time:
2014-07-31T10:56:11Z
class:
comments:
Rewrote post-filter.asciidoc

Closes #5166

time:
2014-07-31T09:56:36Z
class:
src/test/java/org/elasticsearch/percolator/ConcurrentPercolatorTests.java
comments:
[TEST] Concurrent percolation more randomized + safe use of rand

time:
2014-07-30T22:40:47Z
class:
comments:
Docs: Generating ssh keys

There's a much better documentation (including using existing OpenSSH keys like most of us already have for git) on the Azure docs, e.g.:

http://azure.microsoft.com/en-us/documentation/articles/linux-use-ssh-key/

Closes #18.

time:
2014-07-30T22:31:59Z
class:
comments:
Docs: use Oracle Java by default

 Installing Oracle JVM is as easy as:

 ```
 echo debconf shared/accepted-oracle-license-v1-1 select true | \
   sudo debconf-set-selections && echo debconf shared/accepted-oracle-license-v1-1 seen true | \
   sudo debconf-set-selections && sudo add-apt-repository ppa:webupd8team/java && sudo apt-get update && sudo apt-get install oracle-java7-installer
 ```

 See http://www.webupd8.org/2012/01/install-oracle-java-jdk-7-in-ubuntu-via.html

 Closes #19.

time:
2014-07-30T22:14:34Z
class:
src/main/java/org/elasticsearch/cloud/azure/AzureStorageService.java
src/main/java/org/elasticsearch/cloud/azure/AzureStorageServiceImpl.java
src/main/java/org/elasticsearch/cloud/azure/blobstore/AbstractAzureBlobContainer.java
src/test/java/org/elasticsearch/repositories/azure/AzureSnapshotRestoreITest.java
src/test/java/org/elasticsearch/repositories/azure/AzureStorageServiceMock.java
comments:
listBlobsByPrefix uses a wrong path

When listing existing blobs for an azure repository, `path` to look at is incorrectly computed which leads to 404 errors.

Closes #26.

(cherry picked from commit 656fadc)

time:
2014-07-30T22:14:18Z
class:
src/main/java/org/elasticsearch/cloud/azure/blobstore/AbstractAzureBlobContainer.java
src/test/java/org/elasticsearch/repositories/azure/AzureSnapshotRestoreITest.java
comments:
Wrong exception thrown when snapshot doesn't exist

As for https://github.com/elasticsearch/elasticsearch-cloud-aws/issues/86, we should raise a `SnapshotMissingException`.

Closes #23.

(cherry picked from commit 61ddb60)

time:
2014-07-30T22:14:05Z
class:
src/test/java/org/elasticsearch/repositories/azure/AzureSnapshotRestoreITest.java
comments:
`_` is a forbidden character for container (repository)

According to [Containers naming guide](http://msdn.microsoft.com/en-us/library/dd135715.aspx):

> A container name must be a valid DNS name, conforming to the following naming rules:
>
> * Container names must start with a letter or number, and can contain only letters, numbers, and the dash (-) character.
> * Every dash (-) character must be immediately preceded and followed by a letter or number; consecutive dashes are not permitted in container names.
> * All letters in a container name must be lowercase.
> * Container names must be from 3 through 63 characters long.

We need to fix the documentation and control that before calling Azure API.
The validation will come with issue #27.

Closes #21.

(cherry picked from commit 6531165)

time:
2014-07-30T22:13:52Z
class:
comments:
Update to Azure Java SDK 0.4.6

Latest Azure Java SDK is 0.4.6 when looking at http://search.maven.org/#browse%7C-589510877

Closes #25.

(cherry picked from commit 89be7b4)

time:
2014-07-30T22:12:54Z
class:
src/test/java/org/elasticsearch/cloud/azure/AbstractAzureTest.java
src/test/java/org/elasticsearch/discovery/azure/AbstractAzureComputeServiceTest.java
src/test/java/org/elasticsearch/discovery/azure/AzureMinimumMasterNodesTest.java
src/test/java/org/elasticsearch/repositories/azure/AzureSnapshotRestoreITest.java
comments:
Tests: update to Lucene 4.9.0

Closes #24.

(cherry picked from commit 13c60e4)

time:
2014-07-30T18:17:27Z
class:
comments:
Docs: Fix syntax on lang-analyzer

Some of the language analyzer documentation contained invalid json.

Closes #7098

time:
2014-07-30T17:19:24Z
class:
comments:
[TEST] Rest API: cat.count regexp matchers now explicitely test for newline

time:
2014-07-30T16:39:55Z
class:
src/main/java/org/apache/lucene/analysis/CustomAnalyzerWrapper.java
src/main/java/org/apache/lucene/analysis/SimpleAnalyzerWrapper.java
src/main/java/org/apache/lucene/document/XStringField.java
src/main/java/org/apache/lucene/expressions/XSimpleBindings.java
src/main/java/org/apache/lucene/expressions/js/XJavascriptCompiler.java
src/main/java/org/apache/lucene/expressions/js/XJavascriptLexer.java
src/main/java/org/apache/lucene/expressions/js/XJavascriptParser.java
src/main/java/org/apache/lucene/expressions/js/XVariableContext.java
src/main/java/org/apache/lucene/index/XOrdinalMap.java
src/main/java/org/apache/lucene/queryparser/classic/MapperQueryParser.java
src/main/java/org/apache/lucene/search/suggest/analyzing/XAnalyzingSuggester.java
src/main/java/org/apache/lucene/search/suggest/analyzing/XFuzzySuggester.java
src/main/java/org/apache/lucene/search/suggest/analyzing/XSpecialOperations.java
src/main/java/org/apache/lucene/store/BufferedChecksumIndexOutput.java
src/main/java/org/apache/lucene/store/RateLimitedFSDirectory.java
src/main/java/org/apache/lucene/store/StoreUtils.java
src/main/java/org/apache/lucene/store/XNativeFSLockFactory.java
src/main/java/org/elasticsearch/ExceptionsHelper.java
src/main/java/org/elasticsearch/Version.java
src/main/java/org/elasticsearch/action/Action.java
src/main/java/org/elasticsearch/action/ActionModule.java
src/main/java/org/elasticsearch/action/ActionRunnable.java
src/main/java/org/elasticsearch/action/ClientAction.java
src/main/java/org/elasticsearch/action/CompositeIndicesRequest.java
src/main/java/org/elasticsearch/action/IndicesRequest.java
src/main/java/org/elasticsearch/action/TransportActionNodeProxy.java
src/main/java/org/elasticsearch/action/admin/cluster/ClusterAction.java
src/main/java/org/elasticsearch/action/admin/cluster/health/ClusterHealthRequest.java
src/main/java/org/elasticsearch/action/admin/cluster/health/ClusterHealthResponse.java
src/main/java/org/elasticsearch/action/admin/cluster/health/TransportClusterHealthAction.java
src/main/java/org/elasticsearch/action/admin/cluster/node/hotthreads/TransportNodesHotThreadsAction.java
src/main/java/org/elasticsearch/action/admin/cluster/node/info/TransportNodesInfoAction.java
src/main/java/org/elasticsearch/action/admin/cluster/node/restart/TransportNodesRestartAction.java
src/main/java/org/elasticsearch/action/admin/cluster/node/shutdown/TransportNodesShutdownAction.java
src/main/java/org/elasticsearch/action/admin/cluster/node/stats/NodeStats.java
src/main/java/org/elasticsearch/action/admin/cluster/node/stats/TransportNodesStatsAction.java
src/main/java/org/elasticsearch/action/admin/cluster/repositories/delete/TransportDeleteRepositoryAction.java
src/main/java/org/elasticsearch/action/admin/cluster/repositories/get/TransportGetRepositoriesAction.java
src/main/java/org/elasticsearch/action/admin/cluster/repositories/put/TransportPutRepositoryAction.java
src/main/java/org/elasticsearch/action/admin/cluster/reroute/TransportClusterRerouteAction.java
src/main/java/org/elasticsearch/action/admin/cluster/settings/TransportClusterUpdateSettingsAction.java
src/main/java/org/elasticsearch/action/admin/cluster/shards/ClusterSearchShardsRequest.java
src/main/java/org/elasticsearch/action/admin/cluster/shards/TransportClusterSearchShardsAction.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/create/CreateSnapshotRequest.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/create/TransportCreateSnapshotAction.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/delete/TransportDeleteSnapshotAction.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/get/TransportGetSnapshotsAction.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/restore/RestoreSnapshotRequest.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/restore/RestoreSnapshotRequestBuilder.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/restore/TransportRestoreSnapshotAction.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/status/TransportNodesSnapshotsStatus.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/status/TransportSnapshotsStatusAction.java
src/main/java/org/elasticsearch/action/admin/cluster/state/ClusterStateRequest.java
src/main/java/org/elasticsearch/action/admin/cluster/state/TransportClusterStateAction.java
src/main/java/org/elasticsearch/action/admin/cluster/stats/TransportClusterStatsAction.java
src/main/java/org/elasticsearch/action/admin/cluster/tasks/PendingClusterTasksResponse.java
src/main/java/org/elasticsearch/action/admin/cluster/tasks/TransportPendingClusterTasksAction.java
src/main/java/org/elasticsearch/action/admin/indices/IndicesAction.java
src/main/java/org/elasticsearch/action/admin/indices/alias/IndicesAliasesRequest.java
src/main/java/org/elasticsearch/action/admin/indices/alias/TransportIndicesAliasesAction.java
src/main/java/org/elasticsearch/action/admin/indices/alias/exists/TransportAliasesExistAction.java
src/main/java/org/elasticsearch/action/admin/indices/alias/get/GetAliasesRequest.java
src/main/java/org/elasticsearch/action/admin/indices/alias/get/TransportGetAliasesAction.java
src/main/java/org/elasticsearch/action/admin/indices/analyze/AnalyzeRequest.java
src/main/java/org/elasticsearch/action/admin/indices/analyze/TransportAnalyzeAction.java
src/main/java/org/elasticsearch/action/admin/indices/cache/clear/TransportClearIndicesCacheAction.java
src/main/java/org/elasticsearch/action/admin/indices/close/CloseIndexRequest.java
src/main/java/org/elasticsearch/action/admin/indices/close/TransportCloseIndexAction.java
src/main/java/org/elasticsearch/action/admin/indices/create/TransportCreateIndexAction.java
src/main/java/org/elasticsearch/action/admin/indices/delete/DeleteIndexRequest.java
src/main/java/org/elasticsearch/action/admin/indices/delete/TransportDeleteIndexAction.java
src/main/java/org/elasticsearch/action/admin/indices/exists/indices/IndicesExistsRequest.java
src/main/java/org/elasticsearch/action/admin/indices/exists/indices/TransportIndicesExistsAction.java
src/main/java/org/elasticsearch/action/admin/indices/exists/types/TransportTypesExistsAction.java
src/main/java/org/elasticsearch/action/admin/indices/exists/types/TypesExistsRequest.java
src/main/java/org/elasticsearch/action/admin/indices/flush/FlushRequest.java
src/main/java/org/elasticsearch/action/admin/indices/flush/FlushRequestBuilder.java
src/main/java/org/elasticsearch/action/admin/indices/flush/ShardFlushRequest.java
src/main/java/org/elasticsearch/action/admin/indices/flush/TransportFlushAction.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/delete/DeleteMappingRequest.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/delete/TransportDeleteMappingAction.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/get/GetFieldMappingsIndexRequest.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/get/GetFieldMappingsRequest.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/get/TransportGetFieldMappingsAction.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/get/TransportGetFieldMappingsIndexAction.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/get/TransportGetMappingsAction.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/put/PutMappingRequest.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/put/TransportPutMappingAction.java
src/main/java/org/elasticsearch/action/admin/indices/open/OpenIndexRequest.java
src/main/java/org/elasticsearch/action/admin/indices/open/TransportOpenIndexAction.java
src/main/java/org/elasticsearch/action/admin/indices/optimize/TransportOptimizeAction.java
src/main/java/org/elasticsearch/action/admin/indices/recovery/TransportRecoveryAction.java
src/main/java/org/elasticsearch/action/admin/indices/refresh/TransportRefreshAction.java
src/main/java/org/elasticsearch/action/admin/indices/segments/TransportIndicesSegmentsAction.java
src/main/java/org/elasticsearch/action/admin/indices/settings/get/GetSettingsRequest.java
src/main/java/org/elasticsearch/action/admin/indices/settings/get/TransportGetSettingsAction.java
src/main/java/org/elasticsearch/action/admin/indices/settings/put/TransportUpdateSettingsAction.java
src/main/java/org/elasticsearch/action/admin/indices/settings/put/UpdateSettingsRequest.java
src/main/java/org/elasticsearch/action/admin/indices/stats/TransportIndicesStatsAction.java
src/main/java/org/elasticsearch/action/admin/indices/template/delete/TransportDeleteIndexTemplateAction.java
src/main/java/org/elasticsearch/action/admin/indices/template/get/TransportGetIndexTemplatesAction.java
src/main/java/org/elasticsearch/action/admin/indices/template/put/TransportPutIndexTemplateAction.java
src/main/java/org/elasticsearch/action/admin/indices/validate/query/TransportValidateQueryAction.java
src/main/java/org/elasticsearch/action/admin/indices/warmer/delete/DeleteWarmerRequest.java
src/main/java/org/elasticsearch/action/admin/indices/warmer/delete/TransportDeleteWarmerAction.java
src/main/java/org/elasticsearch/action/admin/indices/warmer/get/TransportGetWarmersAction.java
src/main/java/org/elasticsearch/action/admin/indices/warmer/put/PutWarmerRequest.java
src/main/java/org/elasticsearch/action/admin/indices/warmer/put/TransportPutWarmerAction.java
src/main/java/org/elasticsearch/action/bench/AbortBenchmarkAction.java
src/main/java/org/elasticsearch/action/bench/BenchmarkAction.java
src/main/java/org/elasticsearch/action/bench/BenchmarkRequest.java
src/main/java/org/elasticsearch/action/bench/TransportAbortBenchmarkAction.java
src/main/java/org/elasticsearch/action/bench/TransportBenchmarkAction.java
src/main/java/org/elasticsearch/action/bench/TransportBenchmarkStatusAction.java
src/main/java/org/elasticsearch/action/bulk/BulkAction.java
src/main/java/org/elasticsearch/action/bulk/BulkProcessor.java
src/main/java/org/elasticsearch/action/bulk/BulkRequest.java
src/main/java/org/elasticsearch/action/bulk/TransportBulkAction.java
src/main/java/org/elasticsearch/action/bulk/TransportShardBulkAction.java
src/main/java/org/elasticsearch/action/count/CountAction.java
src/main/java/org/elasticsearch/action/count/CountRequest.java
src/main/java/org/elasticsearch/action/count/CountRequestBuilder.java
src/main/java/org/elasticsearch/action/count/CountResponse.java
src/main/java/org/elasticsearch/action/count/ShardCountRequest.java
src/main/java/org/elasticsearch/action/count/ShardCountResponse.java
src/main/java/org/elasticsearch/action/count/TransportCountAction.java
src/main/java/org/elasticsearch/action/delete/DeleteAction.java
src/main/java/org/elasticsearch/action/delete/TransportDeleteAction.java
src/main/java/org/elasticsearch/action/delete/index/TransportIndexDeleteAction.java
src/main/java/org/elasticsearch/action/delete/index/TransportShardDeleteAction.java
src/main/java/org/elasticsearch/action/deletebyquery/DeleteByQueryAction.java
src/main/java/org/elasticsearch/action/deletebyquery/TransportDeleteByQueryAction.java
src/main/java/org/elasticsearch/action/deletebyquery/TransportIndexDeleteByQueryAction.java
src/main/java/org/elasticsearch/action/deletebyquery/TransportShardDeleteByQueryAction.java
src/main/java/org/elasticsearch/action/explain/ExplainAction.java
src/main/java/org/elasticsearch/action/explain/TransportExplainAction.java
src/main/java/org/elasticsearch/action/get/GetAction.java
comments:
Merge branch 'master' of https://github.com/elasticsearch/elasticsearch

time:
2014-07-30T15:44:37Z
class:
src/main/java/org/elasticsearch/action/termvector/MultiTermVectorsRequest.java
src/main/java/org/elasticsearch/action/termvector/TermVectorRequest.java
src/main/java/org/elasticsearch/index/termvectors/ShardTermVectorService.java
src/test/java/org/elasticsearch/action/termvector/GetTermVectorTests.java
comments:
Term Vectors API: adds support for wildcards in selected fields

This could useful to generate all term vectors or a chosen set of them.

Closes #7061

time:
2014-07-30T13:01:06Z
class:
comments:
Packaging: Dont remove ancestors on deb removal

The used -p option could result in accidentally deleting more directories
than /var/lib/elasticsearch - so this option was removed

Note: This only happens if the directories are empty, but still isnt needed.

Relates #5770

time:
2014-07-30T11:41:31Z
class:
src/main/java/org/elasticsearch/cloud/aws/blobstore/S3ImmutableBlobContainer.java
src/test/java/org/elasticsearch/cloud/aws/AbstractAwsTest.java
src/test/java/org/elasticsearch/repositories/s3/S3SnapshotRestoreTest.java
comments:
Tests: update to Lucene 4.9.0

Closes #107.

(cherry picked from commit c3c9a44)

time:
2014-07-30T10:02:16Z
class:
src/test/java/org/elasticsearch/common/breaker/MemoryCircuitBreakerTests.java
comments:
[TEST] randomize byte size and thread count in breaker tests

time:
2014-07-29T15:54:45Z
class:
src/test/java/org/elasticsearch/indices/settings/UpdateSettingsTests.java
comments:
Test: finish all merges before test returns to side step 'Delete Index failed - not acked' failure

time:
2014-07-29T12:29:56Z
class:
comments:
[TEST] Pick random version from backwards directory

The upgrade tests required to specify the lower and the upper version
that it should run against. This commit adds support for random picks
if either the lower or the upper or both are not specified.

time:
2014-07-29T11:48:50Z
class:
src/test/java/org/elasticsearch/search/basic/SearchWithRandomExceptionsTests.java
src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java
comments:
[TEST] Make default flush opertion blocking

time:
2014-07-29T11:48:42Z
class:
src/test/java/org/elasticsearch/bwcompat/BasicBackwardsCompatibilityTest.java
comments:
[TEST] wait for yellow after index was created in BWC tests

time:
2014-07-29T11:26:53Z
class:
src/test/java/org/elasticsearch/common/util/BigArraysTests.java
src/test/java/org/elasticsearch/common/util/BytesRefHashTests.java
src/test/java/org/elasticsearch/common/util/DoubleObjectHashMapTests.java
src/test/java/org/elasticsearch/common/util/LongHashTests.java
src/test/java/org/elasticsearch/common/util/LongObjectHashMapTests.java
comments:
[TESTS] Don't create an unclosed threadpool in BigArraysTests.

time:
2014-07-29T11:00:59Z
class:
comments:
[TEST] Add basic upgrade test script

This commit adds a basic full cluster restart upgrade script that tests
upgrades of elasticsearch across major version. In contrast to the BWC
tests we are running using the java test framework this test uses a python
script as well as the REST APIs to ensure upgrades across major version work and
indices are compatible.

The upgrade test starts 2 or more nodes of an old elasticserach version, indexes
a random number of documents into the running nodes and executes a full cluster restart.
After the nodes are recovered a small set of basic checks are executed to ensure all
documents are still searchable and field data can be loaded etc.

Closes #7074

time:
2014-07-29T10:41:41Z
class:
src/main/java/org/elasticsearch/index/query/SimpleQueryStringBuilder.java
src/main/java/org/elasticsearch/index/query/SimpleQueryStringParser.java
src/test/java/org/elasticsearch/search/query/SimpleQueryTests.java
comments:
Add support for the `_name` parameter to the simple_query_string query

time:
2014-07-29T10:30:09Z
class:
comments:
Docs: Fix typo in scripting.asciidoc

Replace the mvel by groovy in the forgotten place.
I add the previous change in this one.
Sorry for the spam!

Closes #7071

time:
2014-07-29T10:28:41Z
class:
comments:
Docs: Fix typo in scripting.asciidoc

Closes #7070

time:
2014-07-29T09:26:34Z
class:
src/test/java/org/elasticsearch/test/InternalTestCluster.java
comments:
[TESTS] spin in a loop checking request breaker, because multiple clusters could be running

time:
2014-07-29T07:08:23Z
class:
comments:
Docs: Correct JSONP comment in config file

Due to the change of disabling JSONP by default in 1.3 we also need to
change the description in the configuration file.

Closes #7069

time:
2014-07-29T03:48:29Z
class:
comments:
[Docs] Add link to .NET client docs

time:
2014-07-29T02:01:13Z
class:
comments:
Remove NEST from community clients

time:
2014-07-28T19:48:03Z
class:
src/main/java/org/elasticsearch/client/transport/TransportClientNodesService.java
comments:
Transport client: don't add listed nodes to connected nodes list in sniff mode

This commit effectively reverts e1aa91d , as it is not needed anymore to add the original listed nodes. The cluster state local call made will in fact always return at least the local node (see #6811).

There were a couple of downsides caused by putting the original listed nodes among the connected nodes:
1) in the following retries, they weren't seen as listed nodes anymore, thus the light connect wasn't used
2) among the connected nodes some were "bad" duplicates as they are already there and don't contain all needed info for each node. This was causing serialization problems for instance given that the node version was missing on the `DiscoveryNode` object.

Closes #7067

time:
2014-07-28T18:34:46Z
class:
src/main/java/org/elasticsearch/action/TransportActionNodeProxy.java
src/main/java/org/elasticsearch/client/transport/TransportClientNodesService.java
src/main/java/org/elasticsearch/client/transport/support/InternalTransportAdminClient.java
src/main/java/org/elasticsearch/client/transport/support/InternalTransportClient.java
src/main/java/org/elasticsearch/client/transport/support/InternalTransportClusterAdminClient.java
src/main/java/org/elasticsearch/client/transport/support/InternalTransportIndicesAdminClient.java
src/main/java/org/elasticsearch/transport/TransportService.java
src/test/java/org/elasticsearch/client/transport/FailAndRetryMockTransport.java
src/test/java/org/elasticsearch/client/transport/InternalTransportClientTests.java
src/test/java/org/elasticsearch/client/transport/TransportClientNodesServiceTests.java
src/test/java/org/elasticsearch/client/transport/TransportClientRetryTests.java
src/test/java/org/elasticsearch/test/InternalTestCluster.java
comments:
Transport Client: fixed the node retry mechanism which could fail without trying all the connected nodes

The RetryListener was notified twice for each single failure, which caused some additional retries, but more importantly was making the client reach the maximum number of retries (number of connected nodes) too quickly, meanwhile ongoing retries which could succeed were not completed yet.

The TransportService used to throw ConnectTransportException due to throwConnectException set to true, and also notify the listener of any exception received from a separate thread through the request holder.

Simplified exception handling by just removing the throwConnectException option from the TransportService, used only in the transport client. The transport client now relies solely on the request holder to notify of failures and eventually retry.

Closes #6829

time:
2014-07-28T15:22:18Z
class:
src/main/java/org/elasticsearch/Version.java
comments:
Add [1.3.2] version constant

time:
2014-07-28T15:18:24Z
class:
src/main/java/org/elasticsearch/action/admin/cluster/node/stats/NodeStats.java
src/main/java/org/elasticsearch/cluster/settings/ClusterDynamicSettingsModule.java
src/main/java/org/elasticsearch/common/util/BigArrays.java
src/main/java/org/elasticsearch/indices/breaker/CircuitBreakerService.java
src/main/java/org/elasticsearch/indices/breaker/HierarchyCircuitBreakerService.java
src/main/java/org/elasticsearch/indices/breaker/InternalCircuitBreakerService.java
src/test/java/org/elasticsearch/test/CompositeTestCluster.java
src/test/java/org/elasticsearch/test/ExternalTestCluster.java
src/test/java/org/elasticsearch/test/InternalTestCluster.java
src/test/java/org/elasticsearch/test/TestCluster.java
comments:
[TESTS] fix circuit breaker tests for remote clusters and bwc

Adds additional version checks in NodeStats for older versions

When using an external cluster (backwards compatibility tests), the act
of checking the request breaker requires a network buffer, which
increments the breaker. This change only checks the request breaker in
InternalTestCluster and uses Guice to retrieve it instead of
a (possible) network request.

Also removed the now unused InternalCircuitBreakerService class

time:
2014-07-28T14:54:42Z
class:
src/main/java/org/elasticsearch/rest/RestController.java
src/test/java/org/elasticsearch/rest/RestFilterChainTests.java
comments:
Rest: fixed filters execution order to be from lowest to highest rather than the other way around

Closes #7019

time:
2014-07-28T14:54:42Z
class:
src/main/java/org/elasticsearch/action/support/TransportAction.java
src/main/java/org/elasticsearch/rest/RestController.java
src/test/java/org/elasticsearch/action/support/TransportActionFilterChainTests.java
src/test/java/org/elasticsearch/rest/FakeRestRequest.java
src/test/java/org/elasticsearch/rest/HeadersCopyClientTests.java
src/test/java/org/elasticsearch/rest/RestFilterChainTests.java
comments:
Internal: use AtomicInteger instead of volatile int for the current action filter position

Also improved filter chain tests to not rely on execution time, and made filter chain tests look more similar to what happens in reality by removing multiple threads creation in testTooManyContinueProcessing (something we don't support anyway, makes little sense to test it).

Closes #7021

time:
2014-07-28T14:38:44Z
class:
src/main/java/org/elasticsearch/plugins/PluginsService.java
comments:
Plugin Lucene version checker: use `Lucene.parseVersionLenient`

With commit 07c632a2d4dbefe44e8f25dc4ded6cf143d60e41, we now have a new Lucene.parseVersionLenient(String, Version) method which tries to find an existing Lucene version based on the two first digits X.Y of X.Y.Z String.

time:
2014-07-28T14:32:15Z
class:
comments:
Updated es_release_notes script to replace backticks with code tags

time:
2014-07-28T13:22:49Z
class:
comments:
Docs: Add links to the equivalent aggs in facets documentation.

time:
2014-07-28T13:13:23Z
class:
src/main/java/org/elasticsearch/search/aggregations/metrics/InternalNumericMetricsAggregation.java
comments:
Aggregations: Stops direct subclassing of InternalNumericMetricsAggregation

Must subclass either InternalNumericMetricsAggregation.SingleValue or InternalNumericMetricsAggregation.MultiValue

time:
2014-07-28T12:53:04Z
class:
src/main/java/org/elasticsearch/search/fetch/source/FetchSourceParseElement.java
src/main/java/org/elasticsearch/search/highlight/HighlighterParseElement.java
src/main/java/org/elasticsearch/search/rescore/RescoreParseElement.java
comments:
[QUERY] Separate parsing impl from setter in SearchParseElement

This commit makes it easier to reuse the inner highlighting, fetch
and rescore parsing logic by plugins or other internal parts.

Closes #3602

time:
2014-07-28T12:33:51Z
class:
src/main/java/org/elasticsearch/common/lucene/Lucene.java
comments:
add missing import

time:
2014-07-28T12:04:39Z
class:
src/main/java/org/elasticsearch/common/lucene/Lucene.java
src/test/java/org/elasticsearch/VersionTests.java
comments:
[CORE] Support alpha/beta releases in version parsing too

Pull Request #7055 fixed Version parsing for bugfix releases
causing problems with minor version in segments files. Even though
we never release anything with lucene in alpha / beta status this
commit fixes lenient parsing for these cases.

Relates to #7055

time:
2014-07-28T11:02:00Z
class:
src/main/java/org/elasticsearch/common/lucene/Lucene.java
src/main/java/org/elasticsearch/index/snapshots/blobstore/BlobStoreIndexShardSnapshot.java
src/main/java/org/elasticsearch/index/store/Store.java
src/main/java/org/elasticsearch/index/store/StoreFileMetaData.java
src/main/java/org/elasticsearch/indices/recovery/RecoveryFileChunkRequest.java
src/main/java/org/elasticsearch/plugins/PluginsService.java
src/test/java/org/elasticsearch/VersionTests.java
comments:
[CORE] Support parsing lucene minor version strings

We parse the version that is shipped with the Lucene segments in order
to find the version of lucene that wrote a particular segment. Yet, some lucene
version ie:
 * 4.3.1 (Elasticsearch 0.90.2)
 * 4.5.1 (Elasticsearch 0.90.7)
 * 3.6.1 (pre Elasticsearch 0.90.0)

wrote illegal strings containing the minor version which causes IAE exceptions
being thrown from lucenes parsing method.

Closes #7055

time:
2014-07-28T10:10:13Z
class:
src/main/java/org/elasticsearch/common/breaker/ChildMemoryCircuitBreaker.java
src/main/java/org/elasticsearch/common/breaker/MemoryCircuitBreaker.java
comments:
Change logging level for circuit breaking to warn

time:
2014-07-28T09:27:33Z
class:
src/main/java/org/elasticsearch/action/admin/cluster/node/stats/NodeStats.java
src/main/java/org/elasticsearch/client/transport/TransportClient.java
src/main/java/org/elasticsearch/cluster/settings/ClusterDynamicSettingsModule.java
src/main/java/org/elasticsearch/common/breaker/ChildMemoryCircuitBreaker.java
src/main/java/org/elasticsearch/common/breaker/CircuitBreaker.java
src/main/java/org/elasticsearch/common/breaker/CircuitBreakingException.java
src/main/java/org/elasticsearch/common/breaker/MemoryCircuitBreaker.java
src/main/java/org/elasticsearch/common/unit/MemorySizeValue.java
src/main/java/org/elasticsearch/common/util/AbstractArray.java
src/main/java/org/elasticsearch/common/util/BigArrays.java
src/main/java/org/elasticsearch/index/fielddata/IndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/IndexFieldDataService.java
src/main/java/org/elasticsearch/index/fielddata/RamAccountingTermsEnum.java
src/main/java/org/elasticsearch/index/fielddata/ordinals/GlobalOrdinalsBuilder.java
src/main/java/org/elasticsearch/index/fielddata/plain/AbstractIndexOrdinalsFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/BytesBinaryDVIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/DisabledIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/DocValuesIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/DoubleArrayIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/FSTBytesIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/FloatArrayIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/GeoPointBinaryDVIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/GeoPointCompressedIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/GeoPointDoubleArrayIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/IndexIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/NonEstimatingEstimator.java
src/main/java/org/elasticsearch/index/fielddata/plain/PackedArrayIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/PagedBytesIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/ParentChildIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/SortedSetDVOrdinalsIndexFieldData.java
src/main/java/org/elasticsearch/indices/IndicesModule.java
src/main/java/org/elasticsearch/indices/breaker/AllCircuitBreakerStats.java
src/main/java/org/elasticsearch/indices/breaker/BreakerSettings.java
src/main/java/org/elasticsearch/indices/breaker/CircuitBreakerModule.java
src/main/java/org/elasticsearch/indices/breaker/CircuitBreakerService.java
src/main/java/org/elasticsearch/indices/breaker/CircuitBreakerStats.java
src/main/java/org/elasticsearch/indices/breaker/HierarchyCircuitBreakerService.java
src/main/java/org/elasticsearch/indices/breaker/InternalCircuitBreakerService.java
src/main/java/org/elasticsearch/indices/breaker/NoneCircuitBreakerService.java
src/main/java/org/elasticsearch/indices/fielddata/cache/IndicesFieldDataCacheListener.java
src/main/java/org/elasticsearch/node/internal/InternalNode.java
src/main/java/org/elasticsearch/node/service/NodeService.java
src/main/java/org/elasticsearch/percolator/PercolateContext.java
src/main/java/org/elasticsearch/search/internal/DefaultSearchContext.java
src/test/java/org/elasticsearch/benchmark/fielddata/LongFieldDataBenchmark.java
src/test/java/org/elasticsearch/common/breaker/MemoryCircuitBreakerTests.java
src/test/java/org/elasticsearch/common/bytes/PagedBytesReferenceTest.java
src/test/java/org/elasticsearch/common/util/BigArraysTests.java
src/test/java/org/elasticsearch/index/query/TemplateQueryParserTest.java
src/test/java/org/elasticsearch/index/query/plugin/IndexQueryParserPlugin2Tests.java
src/test/java/org/elasticsearch/index/query/plugin/IndexQueryParserPluginTests.java
src/test/java/org/elasticsearch/indices/fielddata/breaker/CircuitBreakerServiceTests.java
src/test/java/org/elasticsearch/indices/memory/breaker/CircuitBreakerServiceTests.java
src/test/java/org/elasticsearch/indices/memory/breaker/CircuitBreakerUnitTests.java
src/test/java/org/elasticsearch/indices/memory/breaker/RandomExceptionCircuitBreakerTests.java
src/test/java/org/elasticsearch/test/TestCluster.java
src/test/java/org/elasticsearch/test/TestSearchContext.java
src/test/java/org/elasticsearch/test/cache/recycler/MockBigArrays.java
comments:
Add HierarchyCircuitBreakerService

Adds a breaker for request BigArrays, which are used for parent/child
queries as well as some aggregations. Certain operations like Netty HTTP
responses and transport responses increment the breaker, but will not
trip.

This also changes the output of the nodes' stats endpoint to show the
parent breaker as well as the fielddata and request breakers.

There are a number of new settings for breakers now:

`indices.breaker.total.limit`: starting limit for all memory-use breaker,
defaults to 70%

`indices.breaker.fielddata.limit`: starting limit for fielddata breaker,
defaults to 60%
`indices.breaker.fielddata.overhead`: overhead for fielddata breaker
estimations, defaults to 1.03

(the fielddata breaker settings also use the backwards-compatible
setting `indices.fielddata.breaker.limit` and
`indices.fielddata.breaker.overhead`)

`indices.breaker.request.limit`: starting limit for request breaker,
defaults to 40%
`indices.breaker.request.overhead`: request breaker estimation overhead,
defaults to 1.0

The breaker service infrastructure is now generic and opens the path to
adding additional circuit breakers in the future.

Fixes #6129

Conflicts:
	src/main/java/org/elasticsearch/index/fielddata/IndexFieldData.java
	src/main/java/org/elasticsearch/index/fielddata/IndexFieldDataService.java
	src/main/java/org/elasticsearch/index/fielddata/RamAccountingTermsEnum.java
	src/main/java/org/elasticsearch/index/fielddata/ordinals/GlobalOrdinalsBuilder.java
	src/main/java/org/elasticsearch/index/fielddata/ordinals/InternalGlobalOrdinalsBuilder.java
	src/main/java/org/elasticsearch/index/fielddata/plain/AbstractIndexOrdinalsFieldData.java
	src/main/java/org/elasticsearch/index/fielddata/plain/DisabledIndexFieldData.java
	src/main/java/org/elasticsearch/index/fielddata/plain/IndexIndexFieldData.java
	src/main/java/org/elasticsearch/index/fielddata/plain/NonEstimatingEstimator.java
	src/main/java/org/elasticsearch/index/fielddata/plain/PackedArrayIndexFieldData.java
	src/main/java/org/elasticsearch/index/fielddata/plain/ParentChildIndexFieldData.java
	src/main/java/org/elasticsearch/index/fielddata/plain/SortedSetDVOrdinalsIndexFieldData.java
	src/main/java/org/elasticsearch/node/internal/InternalNode.java
	src/test/java/org/elasticsearch/index/aliases/IndexAliasesServiceTests.java
	src/test/java/org/elasticsearch/index/codec/CodecTests.java
	src/test/java/org/elasticsearch/index/fielddata/AbstractFieldDataTests.java
	src/test/java/org/elasticsearch/index/fielddata/IndexFieldDataServiceTests.java
	src/test/java/org/elasticsearch/index/mapper/MapperTestUtils.java
	src/test/java/org/elasticsearch/index/query/IndexQueryParserFilterCachingTests.java
	src/test/java/org/elasticsearch/index/query/SimpleIndexQueryParserTests.java
	src/test/java/org/elasticsearch/index/query/guice/IndexQueryParserModuleTests.java
	src/test/java/org/elasticsearch/index/search/FieldDataTermsFilterTests.java
	src/test/java/org/elasticsearch/index/search/child/ChildrenConstantScoreQueryTests.java
	src/test/java/org/elasticsearch/index/similarity/SimilarityTests.java

time:
2014-07-28T09:08:59Z
class:
comments:
Update request-body.asciidoc

Added link from `timeout` to time-units

Closes #6361

time:
2014-07-28T08:48:35Z
class:
src/test/java/org/elasticsearch/indices/IndicesOptionsIntegrationTests.java
comments:
[TEST] All shards should be allocated before snapshotting.

time:
2014-07-28T08:46:56Z
class:
comments:
Docs: Add Drupal Search API Elasticsearch module

The module at drupal.org/project/elasticsearch has been abandoned. The Search API Elasticsearch module allows Drupal to use Elasticsearch as a backend for Search API.

Closes #7001

time:
2014-07-28T08:40:25Z
class:
src/test/java/org/elasticsearch/index/search/child/AbstractChildTests.java
comments:
[TEST] Ignore Lucene40 codec

time:
2014-07-28T08:19:01Z
class:
src/main/java/org/elasticsearch/search/aggregations/metrics/valuecount/InternalValueCount.java
comments:
Aggregations: fixed value count so it can be used in terms order

Closes #7050

time:
2014-07-28T08:07:57Z
class:
src/main/java/org/elasticsearch/search/aggregations/bucket/nested/NestedAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/nested/ReverseNestedAggregator.java
src/test/java/org/elasticsearch/search/aggregations/bucket/ReverseNestedTests.java
comments:
The `nested` aggregator should also resolve and use the parentFilter of the closest `reverse_nested` aggregator.

Closes #6994
Closes #7048

time:
2014-07-27T22:39:29Z
class:
comments:
Docs: fix documentation for bloom filter defaults

time:
2014-07-26T20:32:28Z
class:
comments:
Update nested-query.asciidoc

Changed score_mode `total` to `sum` to be consistent with parent-child etc

time:
2014-07-26T13:05:53Z
class:
comments:
Docs: Fixed path to search-shards

time:
2014-07-26T12:52:50Z
class:
comments:
Docs: Removed search-shards from request-body

time:
2014-07-26T12:51:44Z
class:
comments:
Docs: Reorganised the search-shards API docs

time:
2014-07-26T08:42:26Z
class:
src/test/java/org/elasticsearch/versioning/SimpleVersioningTests.java
comments:
Test: more verbosity for this test on failure

time:
2014-07-25T22:33:50Z
class:
src/main/java/org/elasticsearch/index/mapper/attachment/AttachmentMapper.java
src/test/java/org/elasticsearch/index/mapper/xcontent/MultifieldAttachmentMapperTests.java
comments:
Remove old `content` deprecated field

In #73, we deprecated `content` field in favor of `_content` field.

In plugin version 2.4.0, we can now remove the old field name.

Closes #75.

(cherry picked from commit 7a0f838)

time:
2014-07-25T22:27:49Z
class:
src/main/java/org/elasticsearch/index/mapper/attachment/AttachmentMapper.java
comments:
Log tika exceptions

Currently tika exceptions are swallowed with no log message.
We'd like to be able to know when/if this occurs and for what reason.

Closes #78.

(cherry picked from commit 36b0117)

time:
2014-07-25T22:27:28Z
class:
src/main/java/org/elasticsearch/index/mapper/attachment/AttachmentMapper.java
src/test/java/org/elasticsearch/index/mapper/xcontent/MapperTestUtils.java
src/test/java/org/elasticsearch/index/mapper/xcontent/MultifieldAttachmentMapperTests.java
src/test/java/org/elasticsearch/plugin/mapper/attachments/test/SimpleAttachmentIntegrationTests.java
comments:
Add support for multi-fields

Now https://github.com/elasticsearch/elasticsearch/pull/6867 is merged in elasticsearch core code (branch 1.x - es 1.4),
we can support multi fields in mapper attachment plugin.

```
DELETE /test
PUT /test
{
  "settings": {
    "number_of_shards": 1
  }
}
PUT /test/person/_mapping
{
  "person": {
    "properties": {
      "file": {
        "type": "attachment",
        "path": "full",
        "fields": {
          "file": {
            "type": "string",
            "fields": {
              "store": {
                "type": "string",
                "store": true
              }
            }
          },
          "content_type": {
            "type": "string",
            "fields": {
              "store": {
                "type": "string",
                "store": true
              },
              "untouched": {
                "type": "string",
                "index": "not_analyzed",
                "store": true
              }
            }
          }
        }
      }
    }
  }
}

PUT /test/person/1?refresh=true
{
  "file": "IkdvZCBTYXZlIHRoZSBRdWVlbiIgKGFsdGVybmF0aXZlbHkgIkdvZCBTYXZlIHRoZSBLaW5nIg=="
}

GET /test/person/_search
{
  "fields": [
    "file.store",
    "file.content_type.store"
  ],
  "aggs": {
    "store": {
      "terms": {
        "field": "file.content_type.store"
      }
    },
    "untouched": {
      "terms": {
        "field": "file.content_type.untouched"
      }
    }
  }
}
```

It gives:

```js
{
   "took": 3,
   "timed_out": false,
   "_shards": {
      "total": 1,
      "successful": 1,
      "failed": 0
   },
   "hits": {
      "total": 1,
      "max_score": 1,
      "hits": [
         {
            "_index": "test",
            "_type": "person",
            "_id": "1",
            "_score": 1,
            "fields": {
               "file.store": [
                  "\"God Save the Queen\" (alternatively \"God Save the King\"\n"
               ],
               "file.content_type.store": [
                  "text/plain; charset=ISO-8859-1"
               ]
            }
         }
      ]
   },
   "aggregations": {
      "store": {
         "doc_count_error_upper_bound": 0,
         "buckets": [
            {
               "key": "1",
               "doc_count": 1
            },
            {
               "key": "8859",
               "doc_count": 1
            },
            {
               "key": "charset",
               "doc_count": 1
            },
            {
               "key": "iso",
               "doc_count": 1
            },
            {
               "key": "plain",
               "doc_count": 1
            },
            {
               "key": "text",
               "doc_count": 1
            }
         ]
      },
      "untouched": {
         "doc_count_error_upper_bound": 0,
         "buckets": [
            {
               "key": "text/plain; charset=ISO-8859-1",
               "doc_count": 1
            }
         ]
      }
   }
}
```

Note that using shorter definition works as well:

```
DELETE /test
PUT /test
{
  "settings": {
    "number_of_shards": 1
  }
}
PUT /test/person/_mapping
{
  "person": {
    "properties": {
      "file": {
        "type": "attachment"
      }
    }
  }
}
PUT /test/person/1?refresh=true
{
  "file": "IkdvZCBTYXZlIHRoZSBRdWVlbiIgKGFsdGVybmF0aXZlbHkgIkdvZCBTYXZlIHRoZSBLaW5nIg=="
}

GET /test/person/_search
{
  "query": {
    "match": {
      "file": "king"
    }
  }
}
```

gives:

```js
{
   "took": 53,
   "timed_out": false,
   "_shards": {
      "total": 1,
      "successful": 1,
      "failed": 0
   },
   "hits": {
      "total": 1,
      "max_score": 0.095891505,
      "hits": [
         {
            "_index": "test",
            "_type": "person",
            "_id": "1",
            "_score": 0.095891505,
            "_source": {
               "file": "IkdvZCBTYXZlIHRoZSBRdWVlbiIgKGFsdGVybmF0aXZlbHkgIkdvZCBTYXZlIHRoZSBLaW5nIg=="
            }
         }
      ]
   }
}
```

Closes #57.

(cherry picked from commit 432d7c0)

time:
2014-07-25T22:26:41Z
class:
comments:
Update to elasticsearch 1.4.0

Closes #77.

(cherry picked from commit c58516f)

time:
2014-07-25T19:01:44Z
class:
src/main/java/org/elasticsearch/index/mapper/DocumentMapper.java
src/main/java/org/elasticsearch/index/mapper/Mapper.java
src/main/java/org/elasticsearch/index/mapper/MapperBuilders.java
src/main/java/org/elasticsearch/index/mapper/core/NumberFieldMapper.java
src/test/java/org/elasticsearch/index/fielddata/AbstractFieldDataTests.java
src/test/java/org/elasticsearch/index/fielddata/IndexFieldDataServiceTests.java
src/test/java/org/elasticsearch/index/mapper/multifield/MultiFieldTests.java
src/test/java/org/elasticsearch/index/mapper/simple/SimpleMapperTests.java
src/test/java/org/elasticsearch/index/mapper/string/SimpleStringMappingTests.java
src/test/java/org/elasticsearch/index/search/FieldDataTermsFilterTests.java
comments:
Mappings: Enforce non-null settings.

No that we are using the index created version to make index-time decisions,
assuming that the version is the current version when settings are null is
very error-prone. Instead we should ensure that settings are always non-null
and contain the version when the index was created.

Close #7032

time:
2014-07-25T16:15:37Z
class:
src/main/java/org/elasticsearch/index/mapper/attachment/AttachmentMapper.java
src/test/java/org/elasticsearch/index/mapper/xcontent/LanguageDetectionAttachmentMapperTests.java
src/test/java/org/elasticsearch/index/mapper/xcontent/MetadataMapperTest.java
src/test/java/org/elasticsearch/plugin/mapper/attachments/test/SimpleAttachmentIntegrationTests.java
comments:
Deprecate `content` by `_content`

When we want to force some values, we need to set those using `_field` where `field` is the field name we want to force:

```
{
  "file": {
    "_name": "myfilename.txt"
  }
}
```

But to set the content itself, we use `content` field name.

```
{
  "file": {
    "content": "VGhpcyBpcyBhbiBlbGFzdGljc2VhcmNoIG1hcHBlciBhdHRhY2htZW50IHRlc3Qu",
    "_name": "myfilename.txt"
  }
}
```

For consistency, we set `_content` instead:

```
{
  "file": {
    "_content": "VGhpcyBpcyBhbiBlbGFzdGljc2VhcmNoIG1hcHBlciBhdHRhY2htZW50IHRlc3Qu",
    "_name": "myfilename.txt"
  }
}
```

Closes #73.

(cherry picked from commit 2e6be20)

time:
2014-07-25T16:15:28Z
class:
src/test/java/org/elasticsearch/index/mapper/xcontent/DateAttachmentMapperTests.java
src/test/java/org/elasticsearch/index/mapper/xcontent/EncryptedDocMapperTest.java
src/test/java/org/elasticsearch/index/mapper/xcontent/LanguageDetectionAttachmentMapperTests.java
src/test/java/org/elasticsearch/index/mapper/xcontent/MetadataMapperTest.java
src/test/java/org/elasticsearch/index/mapper/xcontent/MultifieldAttachmentMapperTests.java
src/test/java/org/elasticsearch/index/mapper/xcontent/SimpleAttachmentMapperTests.java
comments:
Update to Lucene 4.9.0

Update to elasticsearch 1.3.0
Move to java 1.7

Related to #67.
Closed #76.

(cherry picked from commit 2303932)

time:
2014-07-25T14:59:42Z
class:
src/main/java/org/elasticsearch/index/mapper/DocumentMapper.java
src/main/java/org/elasticsearch/index/mapper/ParseContext.java
src/main/java/org/elasticsearch/index/mapper/core/AbstractFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/core/Murmur3FieldMapper.java
src/main/java/org/elasticsearch/index/mapper/geo/GeoPointFieldMapper.java
src/test/java/org/elasticsearch/index/mapper/externalvalues/ExternalMapper.java
src/test/java/org/elasticsearch/index/mapper/externalvalues/ExternalValuesMapperIntegrationTests.java
src/test/java/org/elasticsearch/index/mapper/externalvalues/RegisterExternalTypes.java
src/test/java/org/elasticsearch/index/mapper/externalvalues/SimpleExternalMappingTests.java
comments:
Add multi_field support for Mapper externalValue (plugins)

In context of mapper attachment and other mapper plugins, when dealing with multi fields, sub fields never get the `externalValue` although it was set.

Here is a full script which reproduce the issue when used with mapper attachment plugin:

```
DELETE /test

PUT /test
{
    "mappings": {
        "test": {
            "properties": {
                "f": {
                    "type": "attachment",
                    "fields": {
                        "f": {
                            "analyzer": "english",
                            "fields": {
                                "no_stemming": {
                                    "type": "string",
                                    "store": "yes",
                                    "analyzer": "standard"
                                }
                            }
                        }
                    }
                }
            }
        }
    }
}

PUT /test/test/1
{
    "f": "VGhlIHF1aWNrIGJyb3duIGZveGVz"
}

GET /test/_search
{
    "query": {
        "match": {
           "f": "quick"
        }
    }
}

GET /test/_search
{
    "query": {
        "match": {
           "f.no_stemming": "quick"
        }
    }
}

GET /test/test/1?fields=f.no_stemming
```

Related to https://github.com/elasticsearch/elasticsearch-mapper-attachments/issues/57

Closes #5402.

time:
2014-07-25T13:24:24Z
class:
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/GlobalOrdinalsSignificantTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantLongTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantStringTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/AbstractStringTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/AbstractTermsParametersParser.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/DoubleTerms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/DoubleTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/GlobalOrdinalsStringTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/InternalTerms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/LongTerms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/LongTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/StringTerms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/StringTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/Terms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/TermsAggregatorFactory.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/TermsBuilder.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/TermsParametersParser.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/TermsParser.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/UnmappedTerms.java
src/test/java/org/elasticsearch/search/aggregations/bucket/SignificantTermsSignificanceScoreTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/SignificantTermsTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/TermsDocCountErrorTests.java
comments:
Aggregations: Added an option to show the upper bound of the error for the terms aggregation.

This is only applicable when the order is set to _count.  The upper bound of the error in the doc count is calculated by summing the doc count of the last term on each shard which did not return the term.  The implementation calculates the error by summing the doc count for the last term on each shard for which the term IS returned and then subtracts this value from the sum of the doc counts for the last term from ALL shards.

Closes #6696

time:
2014-07-25T10:50:59Z
class:
comments:
Docs: Changing ES_MAX_MEM default from '1gb' to '1g'

If you set ES_HEAP_SIZE to '1gb' as suggested, Java will yield an "Invalid initial heap size".

Closes #6824

time:
2014-07-25T10:49:50Z
class:
comments:
Docs: Added new entry for the SIREn plugin.

Closes #6961

time:
2014-07-25T08:51:22Z
class:
src/main/java/org/elasticsearch/http/netty/HttpRequestHandler.java
src/main/java/org/elasticsearch/http/netty/NettyHttpChannel.java
src/main/java/org/elasticsearch/rest/support/RestUtils.java
src/test/java/org/elasticsearch/rest/CorsRegexDefaultTests.java
src/test/java/org/elasticsearch/rest/CorsRegexTests.java
src/test/java/org/elasticsearch/rest/util/RestUtilsTests.java
src/test/java/org/elasticsearch/test/rest/client/http/HttpRequestBuilder.java
comments:
CORS: Support regular expressions for origin to match against

This commit adds regular expression support for the allow-origin
header depending on the value of the request `Origin` header.

The existing HttpRequestBuilder is also extended to support the
OPTIONS HTTP method.

Relates #5601
Closes #6891

time:
2014-07-25T08:39:33Z
class:
comments:
[DOCS] correct documentation about groovy/mvel defaults and deprecations

time:
2014-07-25T08:26:52Z
class:
src/main/java/org/elasticsearch/http/HttpServer.java
src/test/java/org/elasticsearch/options/jsonp/JsonpOptionDisabledTest.java
src/test/java/org/elasticsearch/options/jsonp/JsonpOptionEnabledTest.java
src/test/java/org/elasticsearch/plugin/PluginManagerTests.java
src/test/java/org/elasticsearch/plugin/ResponseHeaderPluginTests.java
src/test/java/org/elasticsearch/plugin/SitePluginTests.java
src/test/java/org/elasticsearch/rest/helper/HttpClient.java
src/test/java/org/elasticsearch/rest/helper/HttpClientResponse.java
src/test/java/org/elasticsearch/test/rest/client/http/HttpRequestBuilder.java
src/test/java/org/elasticsearch/test/rest/client/http/HttpResponse.java
comments:
Tests: Remove HttpClient to only use one Http client

The HTTP client implementation used by the Elasticsearch REST tests is
backed by apache http client instead of a self written helper class,
that uses HttpUrlConnection. This commit removes the old simple HttpClient
class and uses the more powerful and reliable one for all tests.

It also fixes a minor bug, that when sending a 301 redirect, a Location
header needs to be added as well, which was uncovered by the switching
to the new client.

Closes #7003

time:
2014-07-25T07:12:01Z
class:
src/test/java/org/elasticsearch/common/lucene/index/FreqTermsEnumTests.java
comments:
[TESTS] Fix NPE in FreqTermsEnumTests.

time:
2014-07-24T23:16:32Z
class:
src/test/java/org/elasticsearch/indices/store/IndicesStoreIntegrationTests.java
comments:
[TEST] more logging

time:
2014-07-24T17:04:22Z
class:
src/main/java/org/elasticsearch/index/fielddata/plain/IndexIndexFieldData.java
comments:
Fielddata: Fix thread safety issue with field data on the `_index` field.

time:
2014-07-24T15:23:52Z
class:
src/main/java/org/elasticsearch/index/fielddata/IndexFieldDataService.java
src/main/java/org/elasticsearch/indices/fielddata/cache/IndicesFieldDataCache.java
comments:
Add a periodic cleanup thread for IndexFieldCache caches

Fixes #7010

time:
2014-07-24T14:23:42Z
class:
src/main/java/org/elasticsearch/action/update/TransportUpdateAction.java
comments:
Core: Use the provided cluster state instead of fetching a new cluster state from cluster service.

Close #7013

time:
2014-07-24T14:17:55Z
class:
src/main/java/org/elasticsearch/common/geo/builders/ShapeBuilder.java
src/test/java/org/elasticsearch/common/geo/ShapeBuilderTests.java
comments:
Geo: Fixes parse error with complex shapes

The bug reproduces when the point under test for the placement of the hole of the polygon has an x coordinate which only intersects with the ends of edges in the main polygon. The previous code threw out these cases as not relevant but an intersect at 1.0 of the distance from the start to the end of an edge is just as valid as an intersect at any other point along the edge.  The fix corrects this and adds a test.

Closes #5773

time:
2014-07-24T13:34:53Z
class:
src/main/java/org/elasticsearch/action/admin/indices/flush/FlushRequest.java
src/main/java/org/elasticsearch/action/admin/indices/flush/FlushRequestBuilder.java
src/main/java/org/elasticsearch/action/admin/indices/flush/ShardFlushRequest.java
src/main/java/org/elasticsearch/action/admin/indices/flush/TransportFlushAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/flush/RestFlushAction.java
src/test/java/org/elasticsearch/index/store/CorruptedFileTest.java
src/test/java/org/elasticsearch/indices/FlushTest.java
comments:
Add `wait_if_ongoing` option to _flush requests

This commit adds the ability to force blocking on the flush operaition
to make sure all files have been written and synced to disk. Without
this option a flush might be executing at the same time causing the
current flush to fail and return before all files being synced.

Closes #6996

time:
2014-07-24T13:32:33Z
class:
src/main/java/org/elasticsearch/common/rounding/Rounding.java
src/main/java/org/elasticsearch/common/rounding/TimeZoneRounding.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/DateHistogramParser.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/HistogramBuilder.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/HistogramParser.java
src/main/java/org/elasticsearch/search/facet/datehistogram/CountDateHistogramFacetExecutor.java
src/main/java/org/elasticsearch/search/facet/datehistogram/DateHistogramFacetParser.java
src/main/java/org/elasticsearch/search/facet/datehistogram/ValueDateHistogramFacetExecutor.java
src/main/java/org/elasticsearch/search/facet/datehistogram/ValueScriptDateHistogramFacetExecutor.java
src/test/java/org/elasticsearch/common/rounding/TimeZoneRoundingTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/HistogramTests.java
comments:
Aggregations: Added pre and post offset to histogram aggregation

Added preOffset and postOffset parameters to the API for the histogram aggregation which work in the same way as in the date histogram

Closes #6605

time:
2014-07-24T13:21:20Z
class:
src/test/java/org/elasticsearch/search/facet/SimpleFacetsTests.java
comments:
[TESTS] Ensure yellow in SimpleFacetsTests.testFilterFacetWithFacetFilterPostMode.

time:
2014-07-24T13:00:30Z
class:
src/main/java/org/elasticsearch/indices/cache/filter/IndicesFilterCache.java
comments:
remove use of recycled set in filters eviction
closes #7012

time:
2014-07-24T12:42:40Z
class:
src/main/java/org/elasticsearch/action/CompositeIndicesRequest.java
src/main/java/org/elasticsearch/action/IndicesRequest.java
src/main/java/org/elasticsearch/action/admin/cluster/health/ClusterHealthRequest.java
src/main/java/org/elasticsearch/action/admin/cluster/health/TransportClusterHealthAction.java
src/main/java/org/elasticsearch/action/admin/cluster/shards/ClusterSearchShardsRequest.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/create/CreateSnapshotRequest.java
src/main/java/org/elasticsearch/action/admin/cluster/state/ClusterStateRequest.java
src/main/java/org/elasticsearch/action/admin/cluster/state/TransportClusterStateAction.java
src/main/java/org/elasticsearch/action/admin/indices/alias/IndicesAliasesRequest.java
src/main/java/org/elasticsearch/action/admin/indices/alias/get/GetAliasesRequest.java
src/main/java/org/elasticsearch/action/admin/indices/analyze/AnalyzeRequest.java
src/main/java/org/elasticsearch/action/admin/indices/analyze/TransportAnalyzeAction.java
src/main/java/org/elasticsearch/action/admin/indices/close/CloseIndexRequest.java
src/main/java/org/elasticsearch/action/admin/indices/delete/DeleteIndexRequest.java
src/main/java/org/elasticsearch/action/admin/indices/exists/indices/IndicesExistsRequest.java
src/main/java/org/elasticsearch/action/admin/indices/exists/types/TypesExistsRequest.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/delete/DeleteMappingRequest.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/get/GetFieldMappingsIndexRequest.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/get/GetFieldMappingsRequest.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/put/PutMappingRequest.java
src/main/java/org/elasticsearch/action/admin/indices/open/OpenIndexRequest.java
src/main/java/org/elasticsearch/action/admin/indices/settings/get/GetSettingsRequest.java
src/main/java/org/elasticsearch/action/admin/indices/settings/put/UpdateSettingsRequest.java
src/main/java/org/elasticsearch/action/admin/indices/warmer/delete/DeleteWarmerRequest.java
src/main/java/org/elasticsearch/action/admin/indices/warmer/put/PutWarmerRequest.java
src/main/java/org/elasticsearch/action/bench/BenchmarkRequest.java
src/main/java/org/elasticsearch/action/bulk/BulkRequest.java
src/main/java/org/elasticsearch/action/bulk/TransportBulkAction.java
src/main/java/org/elasticsearch/action/delete/TransportDeleteAction.java
src/main/java/org/elasticsearch/action/explain/TransportExplainAction.java
src/main/java/org/elasticsearch/action/get/MultiGetRequest.java
src/main/java/org/elasticsearch/action/get/TransportGetAction.java
src/main/java/org/elasticsearch/action/get/TransportMultiGetAction.java
src/main/java/org/elasticsearch/action/index/TransportIndexAction.java
src/main/java/org/elasticsearch/action/indexedscripts/delete/DeleteIndexedScriptRequest.java
src/main/java/org/elasticsearch/action/indexedscripts/get/GetIndexedScriptRequest.java
src/main/java/org/elasticsearch/action/indexedscripts/put/PutIndexedScriptRequest.java
src/main/java/org/elasticsearch/action/mlt/MoreLikeThisRequest.java
src/main/java/org/elasticsearch/action/mlt/TransportMoreLikeThisAction.java
src/main/java/org/elasticsearch/action/percolate/MultiPercolateRequest.java
src/main/java/org/elasticsearch/action/percolate/PercolateRequest.java
src/main/java/org/elasticsearch/action/percolate/TransportShardMultiPercolateAction.java
src/main/java/org/elasticsearch/action/search/MultiSearchRequest.java
src/main/java/org/elasticsearch/action/search/SearchRequest.java
src/main/java/org/elasticsearch/action/support/broadcast/BroadcastOperationRequest.java
src/main/java/org/elasticsearch/action/support/broadcast/BroadcastShardOperationRequest.java
src/main/java/org/elasticsearch/action/support/master/info/ClusterInfoRequest.java
src/main/java/org/elasticsearch/action/support/replication/IndexReplicationOperationRequest.java
src/main/java/org/elasticsearch/action/support/replication/IndicesReplicationOperationRequest.java
src/main/java/org/elasticsearch/action/support/replication/ShardReplicationOperationRequest.java
src/main/java/org/elasticsearch/action/support/replication/TransportIndexReplicationOperationAction.java
src/main/java/org/elasticsearch/action/support/replication/TransportShardReplicationOperationAction.java
src/main/java/org/elasticsearch/action/support/single/instance/InstanceShardOperationRequest.java
src/main/java/org/elasticsearch/action/support/single/instance/TransportInstanceSingleOperationAction.java
src/main/java/org/elasticsearch/action/support/single/shard/SingleShardOperationRequest.java
src/main/java/org/elasticsearch/action/support/single/shard/TransportShardSingleOperationAction.java
src/main/java/org/elasticsearch/action/termvector/MultiTermVectorsRequest.java
src/main/java/org/elasticsearch/action/termvector/TransportMultiTermVectorsAction.java
src/main/java/org/elasticsearch/action/termvector/TransportSingleShardTermVectorAction.java
src/main/java/org/elasticsearch/action/update/TransportUpdateAction.java
src/main/java/org/elasticsearch/cluster/action/index/MappingUpdatedAction.java
src/main/java/org/elasticsearch/cluster/action/index/NodeMappingRefreshAction.java
src/main/java/org/elasticsearch/cluster/metadata/MetaData.java
src/main/java/org/elasticsearch/search/internal/ShardSearchRequest.java
comments:
Internal: expose the indices names every action relates to if applicable

Added two new interfaces:
1) IndicesRequest that allows to retrieve the indices the request relates to in a generic manner, together with the indices options that tell how they are going to get resolved and expanded
2) CompositeIndicesRequest for compound requests that hold multiple indices request like MultiSearchRequest, MultiGetRequest, MultiTermVectorsRequest, BulkRequest, BenchmarkRequest, PercolateRequest, MultiPercolateRequest and MoreLikeThisRequest

Taken the chance to streamline the indices options and add them to every request where it makes sense (although they can't be changed from the outside), rather than leaving them implicit in the related TransportAction when indices get expanded (tipycally MetaData#concreteIndices or MetaData#concreteSingleIndex). Added IndicesOptions parameter to MetaData#concreteSingleIndex to make sure it is taken from the request, where the information belongs, instead of hardcoded within MetaData. The concreteSingleIndex method remains but it's just a utility method that returns a single index instead of an array and complains otherwise.

Also made sure NPE is never thrown when setting indices(null) to IndicesAliasesRequest, similar to what SearchRequest does.

Closes #6933

time:
2014-07-24T12:35:47Z
class:
src/test/java/org/elasticsearch/benchmark/search/aggregations/TermsAggregationSearchBenchmark.java
comments:
[Benchmark] Make TermsAggregationSearchBenchmark fairer to uninverted field data.

The benchmark indexes 200 unique full-width longs. For uninverted field data
we try to use the most memory-efficient storage, and in that case it would use
two arrays: one for the doc->ordinals mapping and one for the ordinal->value
mapping. Which is slower than what doc values do by storing directly the
mapping from docs to values.

time:
2014-07-24T11:02:40Z
class:
src/main/java/org/elasticsearch/search/aggregations/InternalAggregation.java
src/main/java/org/elasticsearch/search/aggregations/bucket/InternalSingleBucketAggregation.java
src/main/java/org/elasticsearch/search/aggregations/bucket/geogrid/InternalGeoHashGrid.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/InternalHistogram.java
src/main/java/org/elasticsearch/search/aggregations/bucket/range/InternalRange.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantLongTerms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantStringTerms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/UnmappedSignificantTerms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/DoubleTerms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/LongTerms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/StringTerms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/UnmappedTerms.java
src/main/java/org/elasticsearch/search/aggregations/metrics/avg/InternalAvg.java
src/main/java/org/elasticsearch/search/aggregations/metrics/cardinality/InternalCardinality.java
src/main/java/org/elasticsearch/search/aggregations/metrics/geobounds/InternalGeoBounds.java
src/main/java/org/elasticsearch/search/aggregations/metrics/max/InternalMax.java
src/main/java/org/elasticsearch/search/aggregations/metrics/min/InternalMin.java
src/main/java/org/elasticsearch/search/aggregations/metrics/percentiles/AbstractInternalPercentiles.java
src/main/java/org/elasticsearch/search/aggregations/metrics/stats/InternalStats.java
src/main/java/org/elasticsearch/search/aggregations/metrics/sum/InternalSum.java
src/main/java/org/elasticsearch/search/aggregations/metrics/tophits/InternalTopHits.java
src/main/java/org/elasticsearch/search/aggregations/metrics/valuecount/InternalValueCount.java
src/test/java/org/elasticsearch/search/aggregations/bucket/SignificantTermsSignificanceScoreTests.java
comments:
Aggregations: Better JSON output scoping

Before this change each aggregation had to output an object field with its name and write its JSON inside that object.  This allowed for badly behaved aggregations which could write JSON content in the root of the 'aggs' object.  this change move the writing of the aggregation name to a level above the aggregation itself, ensuring that aggregations can only write within there own scope in the JSON output.

Closes #7004

time:
2014-07-24T10:27:59Z
class:
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/BytesRefFieldComparatorSource.java
src/test/java/org/elasticsearch/index/fielddata/fieldcomparator/TestReplaceMissing.java
comments:
Speed up string sort with custom missing value

Today if the user supplies a custom missing value for a string sort,
we do it in an extremely slow way, not using ordinals but dereferencing
bytes for every document. Ordinals are only used if the missing value
is _first or _last.

Instead, use ordinals with custom missing values too.

Closes #7005

time:
2014-07-24T09:36:31Z
class:
src/test/java/org/elasticsearch/test/client/RandomizingClient.java
comments:
[TEST] Don't randomize preference PRIMARY it might not try replicas depending on the clusterstate

time:
2014-07-24T09:23:59Z
class:
src/main/java/org/elasticsearch/search/aggregations/metrics/tophits/TopHitsParser.java
comments:
Made `_source` parsing in `top_hits` aggregation consistent with regular `_source` parsing in search api.

Closes #6997

time:
2014-07-24T09:13:53Z
class:
src/test/java/org/elasticsearch/search/facet/SimpleFacetsTests.java
comments:
[TESTS] Add more assertions to SimpleFacetsTests.

time:
2014-07-24T10:05:29Z
class:
src/main/java/org/elasticsearch/action/admin/indices/mapping/get/TransportGetFieldMappingsAction.java
src/main/java/org/elasticsearch/action/bulk/TransportBulkAction.java
src/main/java/org/elasticsearch/action/get/TransportMultiGetAction.java
src/main/java/org/elasticsearch/action/mlt/TransportMoreLikeThisAction.java
src/main/java/org/elasticsearch/action/percolate/TransportMultiPercolateAction.java
src/main/java/org/elasticsearch/action/search/TransportClearScrollAction.java
src/main/java/org/elasticsearch/action/search/TransportMultiSearchAction.java
src/main/java/org/elasticsearch/action/search/TransportSearchAction.java
src/main/java/org/elasticsearch/action/search/TransportSearchScrollAction.java
src/main/java/org/elasticsearch/action/termvector/TransportMultiTermVectorsAction.java
comments:
[REFACTOR] TransportActions

Get rid of boilerplate code for handling transport actions.
Make these transport actions extend HandledTransportAction where this code
now lives.

time:
2014-07-24T08:33:58Z
class:
src/main/java/org/elasticsearch/action/support/IndicesOptions.java
src/main/java/org/elasticsearch/cluster/metadata/MetaData.java
src/test/java/org/elasticsearch/cluster/metadata/MetaDataTests.java
src/test/java/org/elasticsearch/gateway/local/LocalGatewayIndexStateTests.java
src/test/java/org/elasticsearch/indices/state/SimpleIndexStateTests.java
comments:
Internal: streamline use of IndexClosedException when executing operation on closed indices

Single index operations to use the newly added IndexClosedException introduced with #6475. This way we can also fail faster when we are trying to execute operations on closed indices and their use is not allowed (depending on indices options). Indices blocks are still checked but we can already throw error while resolving indices (MetaData#concreteIndices).

Effectively this change also affects what we return when using one of the following apis: analyze, bulk, index, update, delete, explain, get, multi_get, mlt, term vector, multi_term vector. We now return `{"error":"IndexClosedException[[test] closed]","status":403}` instead of `{"error":"ClusterBlockException[blocked by: [FORBIDDEN/4/index closed];]","status":403}`.

Closes #6988

time:
2014-07-24T06:55:09Z
class:
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/TermsParser.java
src/test/java/org/elasticsearch/search/aggregations/bucket/ShardSizeTermsTests.java
comments:
Aggregations: change to default shard_size in terms aggregation

The default shard size in the terms aggregation now uses BucketUtils.suggestShardSideQueueSize() to set the shard size if the user does not specify it as a parameter.

Closes #6857

time:
2014-07-23T22:45:54Z
class:
src/main/java/org/elasticsearch/script/javascript/JavaScriptScriptEngineService.java
comments:
Update to elasticsearch 1.4.0

Closes #24.
(cherry picked from commit e03a16b)

time:
2014-07-23T22:45:17Z
class:
comments:
Update to Lucene 4.9.0 / elasticsearch 1.3.0

Related to #21.
Closes #22.
(cherry picked from commit c3964ad)

time:
2014-07-23T22:15:45Z
class:
src/main/java/org/elasticsearch/script/python/PythonScriptEngineService.java
comments:
Update to elasticsearch 1.4.0

Related to #14.

(cherry picked from commit 964de0d)

time:
2014-07-23T21:53:55Z
class:
comments:
Update to elasticsearch 1.4.0

Closes #14.

(cherry picked from commit 8d677aa)

time:
2014-07-23T21:52:50Z
class:
src/test/java/org/elasticsearch/script/python/PythonScriptSearchTests.java
comments:
Update to Lucene 4.9.0 / elasticsearch 1.3.0

Closes #15.
Related to #13.

(cherry picked from commit 8f077d6)

time:
2014-07-23T19:10:15Z
class:
src/main/java/org/elasticsearch/action/count/CountRequest.java
src/main/java/org/elasticsearch/action/count/CountRequestBuilder.java
src/main/java/org/elasticsearch/action/count/CountResponse.java
src/main/java/org/elasticsearch/action/count/ShardCountRequest.java
src/main/java/org/elasticsearch/action/count/ShardCountResponse.java
src/main/java/org/elasticsearch/action/count/TransportCountAction.java
src/main/java/org/elasticsearch/action/search/SearchRequestBuilder.java
src/main/java/org/elasticsearch/action/search/SearchResponse.java
src/main/java/org/elasticsearch/action/search/type/TransportSearchScrollScanAction.java
src/main/java/org/elasticsearch/common/lucene/Lucene.java
src/main/java/org/elasticsearch/percolator/PercolateContext.java
src/main/java/org/elasticsearch/percolator/PercolatorService.java
src/main/java/org/elasticsearch/percolator/QueryCollector.java
src/main/java/org/elasticsearch/rest/action/count/RestCountAction.java
src/main/java/org/elasticsearch/rest/action/search/RestSearchAction.java
src/main/java/org/elasticsearch/search/aggregations/metrics/tophits/TopHitsContext.java
src/main/java/org/elasticsearch/search/builder/SearchSourceBuilder.java
src/main/java/org/elasticsearch/search/controller/SearchPhaseController.java
src/main/java/org/elasticsearch/search/internal/ContextIndexSearcher.java
src/main/java/org/elasticsearch/search/internal/DefaultSearchContext.java
src/main/java/org/elasticsearch/search/internal/InternalSearchResponse.java
src/main/java/org/elasticsearch/search/internal/SearchContext.java
src/main/java/org/elasticsearch/search/query/QueryPhase.java
src/main/java/org/elasticsearch/search/query/QuerySearchResult.java
src/main/java/org/elasticsearch/search/query/TerminateAfterParseElement.java
src/main/java/org/elasticsearch/search/suggest/phrase/PhraseSuggester.java
src/test/java/org/elasticsearch/count/simple/SimpleCountTests.java
src/test/java/org/elasticsearch/search/simple/SimpleSearchTests.java
src/test/java/org/elasticsearch/test/TestSearchContext.java
comments:
Search & Count: Add option to early terminate doc collection

Allow users to control document collection termination, if a specified terminate_after number is
set. Upon setting the newly added parameter, the response will include a boolean terminated_early
flag, indicating if the document collection for any shard terminated early.

closes #6876

time:
2014-07-23T18:55:03Z
class:
src/main/java/org/elasticsearch/index/fielddata/plain/DocValuesIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/SortedNumericDVIndexFieldData.java
src/main/java/org/elasticsearch/index/mapper/core/ByteFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/core/DateFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/core/DoubleFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/core/FloatFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/core/IntegerFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/core/LongFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/core/NumberFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/core/ShortFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/ip/IpFieldMapper.java
src/test/java/org/elasticsearch/index/fielddata/AbstractFieldDataTests.java
src/test/java/org/elasticsearch/index/fielddata/DuelFieldDataTests.java
src/test/java/org/elasticsearch/index/fielddata/IndexFieldDataServiceTests.java
src/test/java/org/elasticsearch/index/mapper/numeric/SimpleNumericTests.java
comments:
Change numeric data types to use SORTED_NUMERIC docvalues type
instead of a custom encoding in BINARY.

In low level benchmarks this is 2x to 5x faster: its also optimized
for the common case where fields actually only contain at most one
value for each document.

Additionally SORTED_NUMERIC doesn't lose values if they appear more
than once, so mathematical computations such as averages are correct.

Closes #6967

time:
2014-07-23T18:20:16Z
class:
src/main/java/org/elasticsearch/search/facet/terms/strings/TermsStringOrdinalsFacetExecutor.java
comments:
[TEST] Don't recycle in facets.

The recycling happening in facets is done manually and arrays are sometimes not
released. Aggregations do it in a less error-prone way by registering on to the
SearchContext.

time:
2014-07-23T18:08:36Z
class:
src/main/java/org/elasticsearch/index/fielddata/FieldData.java
src/main/java/org/elasticsearch/index/fielddata/IndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/BytesRefFieldComparatorSource.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/BytesRefOrdValComparator.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/BytesRefValComparator.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/DoubleScriptDataComparator.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/DoubleValuesComparator.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/DoubleValuesComparatorBase.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/DoubleValuesComparatorSource.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/FloatValuesComparator.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/FloatValuesComparatorSource.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/LongValuesComparator.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/LongValuesComparatorBase.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/LongValuesComparatorSource.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/NestedWrappableComparator.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/NumberComparatorBase.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/StringScriptDataComparator.java
src/main/java/org/elasticsearch/index/fielddata/ordinals/GlobalOrdinalsIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/AbstractIndexGeoPointFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/AbstractIndexOrdinalsFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/BinaryDVIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/BinaryDVNumericIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/BytesBinaryDVIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/DisabledIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/DoubleArrayIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/FloatArrayIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/GeoPointBinaryDVIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/NumericDVIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/PackedArrayIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/ParentChildAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/ParentChildIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/SortedSetDVOrdinalsIndexFieldData.java
src/main/java/org/elasticsearch/index/search/nested/NestedFieldComparatorSource.java
src/main/java/org/elasticsearch/search/MultiValueMode.java
src/main/java/org/elasticsearch/search/sort/GeoDistanceSortParser.java
src/main/java/org/elasticsearch/search/sort/ScriptSortParser.java
src/main/java/org/elasticsearch/search/sort/SortParseElement.java
src/test/java/org/elasticsearch/deps/lucene/SimpleLuceneTests.java
src/test/java/org/elasticsearch/index/fielddata/AbstractFieldDataImplTests.java
src/test/java/org/elasticsearch/index/fielddata/AbstractNumericFieldDataTests.java
src/test/java/org/elasticsearch/index/fielddata/AbstractStringFieldDataTests.java
src/test/java/org/elasticsearch/index/fielddata/NoOrdinalsStringFieldDataTests.java
src/test/java/org/elasticsearch/index/fielddata/ParentChildFieldDataTests.java
src/test/java/org/elasticsearch/index/fielddata/ordinals/MultiOrdinalsTests.java
src/test/java/org/elasticsearch/index/search/nested/AbstractNumberNestedSortingTests.java
src/test/java/org/elasticsearch/index/search/nested/DoubleNestedSortingTests.java
src/test/java/org/elasticsearch/index/search/nested/FloatNestedSortingTests.java
src/test/java/org/elasticsearch/index/search/nested/LongNestedSortingTests.java
src/test/java/org/elasticsearch/index/search/nested/NestedSortingTests.java
src/test/java/org/elasticsearch/nested/SimpleNestedTests.java
src/test/java/org/elasticsearch/search/MultiValueModeTests.java
src/test/java/org/elasticsearch/test/ElasticsearchTestCase.java
comments:
Fielddata: goodbye comparators.

This commit removes custom comparators in favor of the ones that are in Lucene.

The major change is for nested documents: instead of having a comparator wrapper
that deals with nested documents, this is done at the fielddata level by having
a selector that returns the value to use for comparison.

Sorting with custom missing string values might be slower since it is using
TermValComparator since Lucene's TermOrdValComparator only supports sorting
missing values first or last. But other than this particular case, this change
will allow us to benefit from improvements on comparators from the Lucene side.

Close #5980

time:
2014-07-23T16:34:27Z
class:
comments:
[DOCS] Fix nested root object indexing documentation

Types can no longer be specified when indexing, see:
https://github.com/elasticsearch/elasticsearch/pull/4552

time:
2014-07-23T15:39:43Z
class:
src/main/java/org/elasticsearch/index/fielddata/ordinals/MultiOrdinals.java
src/main/java/org/elasticsearch/index/fielddata/ordinals/OrdinalsBuilder.java
src/test/java/org/elasticsearch/index/fielddata/FSTPackedBytesStringFieldDataTests.java
src/test/java/org/elasticsearch/index/fielddata/PagedBytesStringFieldDataTests.java
comments:
Fielddata: Fix the ordinals impl for sparse fields.

Caused by #6908

time:
2014-07-23T15:33:22Z
class:
comments:
[doc] Correct decay function equations in function_score description

Impact of decay and scale was missing from the equations.

Closes #6983

time:
2014-07-23T15:28:49Z
class:
comments:
Update named-queries-and-filters.asciidoc

time:
2014-07-23T14:37:19Z
class:
comments:
[DOCS] move all coming tags to added in master

time:
2014-07-23T14:32:32Z
class:
comments:
Docs: Update query-string-syntax.asciidoc

Closes #6253

time:
2014-07-23T14:26:48Z
class:
src/main/java/org/elasticsearch/Version.java
comments:
Add version 1.2.4 and 1.3.1 to the version table

time:
2014-07-23T14:18:37Z
class:
comments:
[DOCS] clarify /_cat/fielddata REST api documentation

time:
2014-07-23T13:49:03Z
class:
comments:
Reflect that 'field_value_factor' is only in 1.2.x

While the blogpost http://www.elasticsearch.org/blog/2014-04-02-this-week-in-elasticsearch/ states, that feature #5519 was
added to 1.x, the release notes for, e.g. v1.1.2, however tell otherwise.
Only the release notes for 1.2.0 list #5519 as a new feature.

Since the 1.x docs deprecate/discourage from using `_boost`, and seemingly give a migration example at
http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/mapping-boost-field.html#function-score-instead-of-boost
users of 1.1.x should be warned.

time:
2014-07-23T12:54:28Z
class:
comments:
[BUILD] skip bwc version check if directory doesn't exists or is not a directory

time:
2014-07-23T12:44:08Z
class:
src/test/java/org/elasticsearch/test/ElasticsearchSingleNodeTest.java
src/test/java/org/elasticsearch/threadpool/SimpleThreadPoolTests.java
comments:
[TEST] Fix SimpleThreadPoolTests to exclude test infra threads

time:
2014-07-23T10:43:43Z
class:
comments:
Docs: typo

example fails in bash

Closes #6977

time:
2014-07-23T09:58:41Z
class:
src/main/java/org/elasticsearch/index/codec/CodecService.java
src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java
comments:
Core: don't load bloom filters by default

This change just changes the default for index.codec.bloom.load to
false: with recent performance improvements to ID lookup, such as
#6298, bloom filters don't give much of a performance gain anymore,
and they can consume non-trivial RAM when there are many tiny
documents.

For now, we still index the bloom filters, so if a given app wants
them back, it can just update the index.codec.bloom.load to true.

Closes #6959

time:
2014-07-23T09:55:35Z
class:
comments:
Docs: Made current version, branch and jdk into asciidoc attributes

time:
2014-07-23T09:47:58Z
class:
src/test/java/org/elasticsearch/test/junit/listeners/ReproduceInfoPrinter.java
comments:
[TEST] Maven reproductions should always include 'clean' target

time:
2014-07-23T09:35:52Z
class:
src/test/java/org/elasticsearch/indices/settings/UpdateSettingsTests.java
comments:
Test: make test less evil

time:
2014-07-23T09:23:15Z
class:
src/test/java/org/elasticsearch/versioning/SimpleVersioningTests.java
comments:
Test: add more verbosity when this test fails

time:
2014-07-23T09:13:03Z
class:
comments:
Docs: Change public signing key instructions to work with sudo

Closes #6823

time:
2014-07-23T09:00:46Z
class:
comments:
Docs: Added Tiki Wiki integration

Closes #6746

time:
2014-07-23T08:57:09Z
class:
comments:
Docs: Added Tiki Wiki integration

Closes #6746

time:
2014-07-23T07:58:38Z
class:
src/test/java/org/elasticsearch/script/GroovyScriptTests.java
comments:
[TEST] Add test for _score and doc[] access in Groovy scripts

time:
2014-07-23T07:30:51Z
class:
comments:
Build: Remove UnsafeUtils from forbidden-apis exclusion list.

time:
2014-07-23T07:16:35Z
class:
src/main/java/org/elasticsearch/index/mapper/internal/AllFieldMapper.java
src/test/java/org/elasticsearch/get/GetActionTests.java
comments:
Make _all field accessible with GET

GET only returned null even when stored if requested with GET like this:

`curl -XGET "http://localhost:9200/test/test/1?fields=_all"`

Instead, it should simply behave like a String field and return the
concatenated fields as String.

closes #6924

time:
2014-07-23T06:41:11Z
class:
src/main/java/org/elasticsearch/common/bytes/BytesReference.java
src/main/java/org/elasticsearch/common/hash/MurmurHash3.java
src/main/java/org/elasticsearch/common/util/BytesRefHash.java
src/main/java/org/elasticsearch/common/util/UnsafeUtils.java
src/main/java/org/elasticsearch/search/aggregations/metrics/cardinality/HyperLogLogPlusPlus.java
src/test/java/org/elasticsearch/benchmark/common/util/BytesRefComparisonsBenchmark.java
src/test/java/org/elasticsearch/common/bytes/BytesReferenceTests.java
comments:
Core: Drop UnsafeUtils.

This class potentially does unaligned memory access and does not bring much
now that we switched to global ords for terms aggregations.

Close #6962

time:
2014-07-22T21:17:15Z
class:
src/main/java/org/elasticsearch/search/suggest/Suggest.java
src/main/java/org/elasticsearch/search/suggest/phrase/PhraseSuggestParser.java
src/main/java/org/elasticsearch/search/suggest/phrase/PhraseSuggester.java
src/main/java/org/elasticsearch/search/suggest/phrase/PhraseSuggestionBuilder.java
src/main/java/org/elasticsearch/search/suggest/phrase/PhraseSuggestionContext.java
src/test/java/org/elasticsearch/search/suggest/SuggestSearchTests.java
src/test/java/org/elasticsearch/test/hamcrest/ElasticsearchAssertions.java
comments:
PhraseSuggester: Collate option should allow returning phrases with no matching docs

A new option `prune` has been added to allow users to control phrase suggestion pruning when `collate`
is set. If the new option is set, the phrase suggestion option will contain a boolean `collate_match`
indicating whether the respective result had hits in collation.

CLoses #6927

time:
2014-07-22T20:22:09Z
class:
src/test/java/org/elasticsearch/bwcompat/BasicBackwardsCompatibilityTest.java
comments:
[TEST] Add simple sort assertions for bwc tests

Today we only do count searches to ensure sane results are returned
after upgrading etc. This change adds sorting to the picture asserting
on simple numeric sorting that uses field data etc. after upgrading.

Relates to #6967

time:
2014-07-22T19:29:57Z
class:
src/main/java/org/elasticsearch/discovery/zen/ping/unicast/UnicastZenPing.java
comments:
Unicast discovery: only disconnect from temporary connected nodes
In unicast discovery, we try to reuse existing discovery nodes based on the node address they have. If we find an existing node based on its address, and for some reason its not connected, don't add it to the list of nodes to disconnect from, as that (full) connection is useful down the road
closes #6966

time:
2014-07-22T17:48:47Z
class:
src/main/java/org/elasticsearch/transport/netty/NettyTransport.java
comments:
Fix connect concurrency, can cause connection nodes to close
Looking at the connect code, if 2 threads at the same time try and connect to a node, and both enter sequentially the connectLock code block, the second one would try and put the connection in the map, and close the replaced channels, which will cause the existing connection to close as well (since it removes the node from the connectedNodes map)
To fix this, simply make sure we properly check the existence of the connection within the connectionLock block, so there won't be concurrent connections going on.
While doing this, also went over all the mutation code that handles disconnections, and made sure they are properly done only within a connection lock.
closes #6964

time:
2014-07-22T17:06:04Z
class:
src/test/java/org/elasticsearch/indices/settings/UpdateSettingsTests.java
comments:
Test: make sure randomizer doesn't swap in SerialMergeScheduler on us

time:
2014-07-22T15:23:46Z
class:
src/main/java/org/elasticsearch/index/merge/scheduler/ConcurrentMergeSchedulerProvider.java
src/main/java/org/elasticsearch/index/settings/IndexDynamicSettingsModule.java
src/test/java/org/elasticsearch/indices/settings/UpdateSettingsTests.java
comments:
Core: allow index.merge.scheduler.max_thread_count to be updated dynamically

Lucene allows the max_thread_count to be updated, but this wasn't
fully exposed in Elasticsearch.

Closes #6925

time:
2014-07-22T13:54:09Z
class:
src/main/java/org/elasticsearch/index/mapper/core/AbstractFieldMapper.java
comments:
Fixed typo in AbstractFieldMapper

    similariry -> similarity

time:
2014-07-22T13:51:31Z
class:
comments:
[DOCS] Fix typo

time:
2014-07-22T13:49:45Z
class:
comments:
[DOCS] Fix indentation

time:
2014-07-22T13:45:46Z
class:
comments:
[DOCS] Update examples to groovy.

time:
2014-07-22T13:22:57Z
class:
src/main/java/org/elasticsearch/action/update/UpdateRequest.java
comments:
[FIX] Fix update parser to accept script_id

time:
2014-07-22T13:16:24Z
class:
src/main/java/org/elasticsearch/common/geo/GeoDistance.java
src/main/java/org/elasticsearch/common/lucene/search/function/FieldValueFactorFunction.java
src/main/java/org/elasticsearch/index/fielddata/AbstractAtomicNumericFieldData.java
src/main/java/org/elasticsearch/index/fielddata/AbstractRandomAccessOrds.java
src/main/java/org/elasticsearch/index/fielddata/AtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/AtomicGeoPointFieldData.java
src/main/java/org/elasticsearch/index/fielddata/AtomicNumericFieldData.java
src/main/java/org/elasticsearch/index/fielddata/AtomicOrdinalsFieldData.java
src/main/java/org/elasticsearch/index/fielddata/AtomicParentChildFieldData.java
src/main/java/org/elasticsearch/index/fielddata/BytesValues.java
src/main/java/org/elasticsearch/index/fielddata/DoubleValues.java
src/main/java/org/elasticsearch/index/fielddata/FieldData.java
src/main/java/org/elasticsearch/index/fielddata/GeoPointValues.java
src/main/java/org/elasticsearch/index/fielddata/IndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/IndexFieldDataCache.java
src/main/java/org/elasticsearch/index/fielddata/IndexFieldDataService.java
src/main/java/org/elasticsearch/index/fielddata/IndexGeoPointFieldData.java
src/main/java/org/elasticsearch/index/fielddata/IndexNumericFieldData.java
src/main/java/org/elasticsearch/index/fielddata/IndexOrdinalsFieldData.java
src/main/java/org/elasticsearch/index/fielddata/IndexParentChildFieldData.java
src/main/java/org/elasticsearch/index/fielddata/LongValues.java
src/main/java/org/elasticsearch/index/fielddata/MultiGeoPointValues.java
src/main/java/org/elasticsearch/index/fielddata/MurmurHash3Values.java
src/main/java/org/elasticsearch/index/fielddata/NumericDoubleValues.java
src/main/java/org/elasticsearch/index/fielddata/RamAccountingTermsEnum.java
src/main/java/org/elasticsearch/index/fielddata/ScriptDocValues.java
src/main/java/org/elasticsearch/index/fielddata/SingletonMultiGeoPointValues.java
src/main/java/org/elasticsearch/index/fielddata/SingletonSortedBinaryDocValues.java
src/main/java/org/elasticsearch/index/fielddata/SingletonSortedNumericDoubleValues.java
src/main/java/org/elasticsearch/index/fielddata/SortedBinaryDocValues.java
src/main/java/org/elasticsearch/index/fielddata/SortedNumericDoubleValues.java
src/main/java/org/elasticsearch/index/fielddata/SortingBinaryDocValues.java
src/main/java/org/elasticsearch/index/fielddata/SortingNumericDocValues.java
src/main/java/org/elasticsearch/index/fielddata/SortingNumericDoubleValues.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/BytesRefFieldComparatorSource.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/BytesRefOrdValComparator.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/BytesRefValComparator.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/DoubleValuesComparator.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/DoubleValuesComparatorBase.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/DoubleValuesComparatorSource.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/FloatValuesComparator.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/FloatValuesComparatorSource.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/GeoDistanceComparator.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/GeoDistanceComparatorSource.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/LongValuesComparator.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/LongValuesComparatorBase.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/LongValuesComparatorSource.java
src/main/java/org/elasticsearch/index/fielddata/ordinals/GlobalOrdinalMapping.java
src/main/java/org/elasticsearch/index/fielddata/ordinals/GlobalOrdinalsBuilder.java
src/main/java/org/elasticsearch/index/fielddata/ordinals/GlobalOrdinalsIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/ordinals/InternalGlobalOrdinalsBuilder.java
src/main/java/org/elasticsearch/index/fielddata/ordinals/InternalGlobalOrdinalsIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/ordinals/MultiOrdinals.java
src/main/java/org/elasticsearch/index/fielddata/ordinals/Ordinals.java
src/main/java/org/elasticsearch/index/fielddata/ordinals/OrdinalsBuilder.java
src/main/java/org/elasticsearch/index/fielddata/ordinals/SinglePackedOrdinals.java
src/main/java/org/elasticsearch/index/fielddata/plain/AbstractAtomicGeoPointFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/AbstractAtomicOrdinalsFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/AbstractAtomicParentChildFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/AbstractIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/AbstractIndexGeoPointFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/AbstractIndexOrdinalsFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/AtomicDoubleFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/AtomicLongFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/BinaryDVAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/BinaryDVIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/BinaryDVNumericAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/BinaryDVNumericIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/BytesBinaryDVAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/BytesBinaryDVIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/BytesValuesWithOrdinalsTermsEnum.java
src/main/java/org/elasticsearch/index/fielddata/plain/DisabledIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/DocValuesIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/DoubleArrayAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/DoubleArrayIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/FSTBytesAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/FSTBytesIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/FloatArrayAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/FloatArrayIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/GeoPointBinaryDVAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/GeoPointBinaryDVIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/GeoPointCompressedAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/GeoPointCompressedIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/GeoPointDoubleArrayAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/GeoPointDoubleArrayIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/IndexIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/NonEstimatingEstimator.java
src/main/java/org/elasticsearch/index/fielddata/plain/NumericDVAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/NumericDVIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/PackedArrayAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/PackedArrayIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/PagedBytesAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/PagedBytesIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/ParentChildAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/ParentChildIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/SortedSetDVAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/SortedSetDVBytesAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/SortedSetDVOrdinalsIndexFieldData.java
src/main/java/org/elasticsearch/index/mapper/core/DateFieldMapper.java
src/main/java/org/elasticsearch/index/percolator/QueriesLoaderCollector.java
src/main/java/org/elasticsearch/index/query/GeoBoundingBoxFilterParser.java
src/main/java/org/elasticsearch/index/query/GeoDistanceFilterParser.java
src/main/java/org/elasticsearch/index/query/GeoDistanceRangeFilterParser.java
src/main/java/org/elasticsearch/index/query/GeoPolygonFilterParser.java
src/main/java/org/elasticsearch/index/query/functionscore/DecayFunctionParser.java
src/main/java/org/elasticsearch/index/search/FieldDataTermsFilter.java
src/main/java/org/elasticsearch/index/search/NumericRangeFieldDataFilter.java
src/main/java/org/elasticsearch/index/search/child/ChildrenConstantScoreQuery.java
src/main/java/org/elasticsearch/index/search/child/ChildrenQuery.java
src/main/java/org/elasticsearch/index/search/child/ParentConstantScoreQuery.java
src/main/java/org/elasticsearch/index/search/child/ParentIdsFilter.java
src/main/java/org/elasticsearch/index/search/child/ParentQuery.java
src/main/java/org/elasticsearch/index/search/child/TopChildrenQuery.java
src/main/java/org/elasticsearch/index/search/geo/GeoDistanceFilter.java
src/main/java/org/elasticsearch/index/search/geo/GeoDistanceRangeFilter.java
src/main/java/org/elasticsearch/index/search/geo/GeoPolygonFilter.java
src/main/java/org/elasticsearch/index/search/geo/InMemoryGeoBoundingBoxFilter.java
src/main/java/org/elasticsearch/indices/fielddata/cache/IndicesFieldDataCache.java
src/main/java/org/elasticsearch/percolator/PercolatorService.java
src/main/java/org/elasticsearch/percolator/QueryCollector.java
src/main/java/org/elasticsearch/script/expression/FieldDataFunctionValues.java
src/main/java/org/elasticsearch/search/MultiValueMode.java
src/main/java/org/elasticsearch/search/SearchService.java
src/main/java/org/elasticsearch/search/aggregations/bucket/BucketsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/geogrid/GeoHashGridAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/geogrid/GeoHashGridParser.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/HistogramAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/missing/MissingAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/nested/NestedAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/range/RangeAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/range/geodistance/GeoDistanceParser.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/GlobalOrdinalsSignificantTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/DoubleTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/GlobalOrdinalsStringTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/LongTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/StringTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/TermsAggregatorFactory.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/support/IncludeExclude.java
src/main/java/org/elasticsearch/search/aggregations/metrics/avg/AvgAggregator.java
src/main/java/org/elasticsearch/search/aggregations/metrics/cardinality/CardinalityAggregator.java
src/main/java/org/elasticsearch/search/aggregations/metrics/geobounds/GeoBoundsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/metrics/max/MaxAggregator.java
src/main/java/org/elasticsearch/search/aggregations/metrics/min/MinAggregator.java
src/main/java/org/elasticsearch/search/aggregations/metrics/percentiles/AbstractPercentilesAggregator.java
src/main/java/org/elasticsearch/search/aggregations/metrics/stats/StatsAggegator.java
src/main/java/org/elasticsearch/search/aggregations/metrics/stats/extended/ExtendedStatsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/metrics/sum/SumAggregator.java
src/main/java/org/elasticsearch/search/aggregations/metrics/valuecount/ValueCountAggregator.java
src/main/java/org/elasticsearch/search/aggregations/support/AggregationContext.java
src/main/java/org/elasticsearch/search/aggregations/support/ValuesSource.java
src/main/java/org/elasticsearch/search/aggregations/support/ValuesSourceConfig.java
src/main/java/org/elasticsearch/search/aggregations/support/ValuesSourceParser.java
src/main/java/org/elasticsearch/search/aggregations/support/values/ScriptBytesValues.java
src/main/java/org/elasticsearch/search/aggregations/support/values/ScriptDoubleValues.java
src/main/java/org/elasticsearch/search/aggregations/support/values/ScriptLongValues.java
src/main/java/org/elasticsearch/search/facet/DoubleFacetAggregatorBase.java
src/main/java/org/elasticsearch/search/facet/LongFacetAggregatorBase.java
src/main/java/org/elasticsearch/search/facet/datehistogram/CountDateHistogramFacetExecutor.java
src/main/java/org/elasticsearch/search/facet/datehistogram/ValueDateHistogramFacetExecutor.java
src/main/java/org/elasticsearch/search/facet/datehistogram/ValueScriptDateHistogramFacetExecutor.java
src/main/java/org/elasticsearch/search/facet/geodistance/GeoDistanceFacetExecutor.java
src/main/java/org/elasticsearch/search/facet/geodistance/ValueGeoDistanceFacetExecutor.java
src/main/java/org/elasticsearch/search/facet/histogram/CountHistogramFacetExecutor.java
src/main/java/org/elasticsearch/search/facet/histogram/FullHistogramFacetExecutor.java
src/main/java/org/elasticsearch/search/facet/histogram/ValueHistogramFacetExecutor.java
src/main/java/org/elasticsearch/search/facet/histogram/ValueScriptHistogramFacetExecutor.java
src/main/java/org/elasticsearch/search/facet/range/KeyValueRangeFacetExecutor.java
src/main/java/org/elasticsearch/search/facet/range/RangeFacetExecutor.java
src/main/java/org/elasticsearch/search/facet/statistical/StatisticalFacetExecutor.java
src/main/java/org/elasticsearch/search/facet/statistical/StatisticalFieldsFacetExecutor.java
src/main/java/org/elasticsearch/search/facet/terms/TermsFacetParser.java
src/main/java/org/elasticsearch/search/facet/terms/doubles/TermsDoubleFacetExecutor.java
src/main/java/org/elasticsearch/search/facet/terms/longs/TermsLongFacetExecutor.java
src/main/java/org/elasticsearch/search/facet/terms/strings/FieldsTermsStringFacetExecutor.java
src/main/java/org/elasticsearch/search/facet/terms/strings/HashedAggregator.java
src/main/java/org/elasticsearch/search/facet/terms/strings/HashedScriptAggregator.java
src/main/java/org/elasticsearch/search/facet/terms/strings/TermsStringFacetExecutor.java
src/main/java/org/elasticsearch/search/facet/terms/strings/TermsStringOrdinalsFacetExecutor.java
src/main/java/org/elasticsearch/search/facet/termsstats/doubles/TermsStatsDoubleFacetExecutor.java
src/main/java/org/elasticsearch/search/facet/termsstats/longs/TermsStatsLongFacetExecutor.java
src/main/java/org/elasticsearch/search/facet/termsstats/strings/TermsStatsStringFacetExecutor.java
src/main/java/org/elasticsearch/search/sort/GeoDistanceSortParser.java
src/test/java/org/elasticsearch/benchmark/fielddata/LongFieldDataBenchmark.java
src/test/java/org/elasticsearch/index/fielddata/AbstractFieldDataImplTests.java
src/test/java/org/elasticsearch/index/fielddata/AbstractNumericFieldDataTests.java
src/test/java/org/elasticsearch/index/fielddata/AbstractStringFieldDataTests.java
src/test/java/org/elasticsearch/index/fielddata/BinaryDVFieldDataTests.java
src/test/java/org/elasticsearch/index/fielddata/DuelFieldDataTests.java
src/test/java/org/elasticsearch/index/fielddata/FilterFieldDataTest.java
src/test/java/org/elasticsearch/index/fielddata/IndexFieldDataServiceTests.java
src/test/java/org/elasticsearch/index/fielddata/LongFieldDataTests.java
src/test/java/org/elasticsearch/index/fielddata/NoOrdinalsStringFieldDataTests.java
src/test/java/org/elasticsearch/index/fielddata/ParentChildFieldDataTests.java
src/test/java/org/elasticsearch/index/fielddata/ordinals/MultiOrdinalsTests.java
src/test/java/org/elasticsearch/index/fielddata/ordinals/SingleOrdinalsTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/StringTermsTests.java
src/test/java/org/elasticsearch/search/aggregations/metrics/ValueCountTests.java
src/test/java/org/elasticsearch/search/aggregations/support/FieldDataSourceTests.java
src/test/java/org/elasticsearch/search/aggregations/support/ScriptValuesTests.java
src/test/java/org/elasticsearch/search/facet/SimpleFacetsTests.java
src/test/java/org/elasticsearch/search/sort/SimpleSortTests.java
src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java
comments:
Fielddata: Switch to Lucene DV APIs.

This commits removes BytesValues/LongValues/DoubleValues/... and tries to use
Lucene's APIs such as NumericDocValues or RandomAccessOrds instead whenever
possible.

The next step would be to take advantage of the fact that APIs are the same in
Lucene and Elasticsearch in order to remove our custom comparators and use
Lucene's.

There are a few side-effects to this change:
 - GeoDistanceComparator has been removed, DoubleValuesComparator is used instead
   on top of dynamically computed values (was easier than migrating
   GeoDistanceComparator).
 - SortedNumericDocValues doesn't guarantee uniqueness so long/double terms
   aggregators have been updated to make sure a document cannot fall twice in
   the same bucket.
 - Sorting by maximum value of a field or running a `max` aggregation is
   potentially significantly faster thanks to the random-access API.

Our aggs and p/c aggregations benchmarks don't report differences with this
change on uninverted field data. However the fact that doc values don't need
to be wrapped anymore seems to help a lot. For example
TermsAggregationSearchBenchmark reports ~30% faster terms aggregations on doc
values on string fields with this change, which are now only ~18% slower than
uninverted field data although stored on disk.

Close #6908

time:
2014-07-22T12:58:07Z
class:
src/test/java/org/elasticsearch/script/IndexedScriptTests.java
comments:
[TEST] Fix indexed script test.

time:
2014-07-22T12:55:34Z
class:
src/main/java/org/elasticsearch/action/bulk/TransportShardBulkAction.java
src/main/java/org/elasticsearch/action/update/TransportUpdateAction.java
src/main/java/org/elasticsearch/action/update/UpdateHelper.java
src/main/java/org/elasticsearch/action/update/UpdateRequest.java
src/main/java/org/elasticsearch/action/update/UpdateRequestBuilder.java
src/main/java/org/elasticsearch/common/xcontent/XContentHelper.java
src/main/java/org/elasticsearch/index/indexing/IndexingStats.java
src/main/java/org/elasticsearch/index/indexing/ShardIndexingService.java
src/test/java/org/elasticsearch/update/UpdateNoopTests.java
comments:
Update: Detect noop updates sent with doc_as_upsert

This should help prevent spurious updates that just cause extra writing
and cache invalidation for no real reason.

Close #6822

time:
2014-07-22T12:49:31Z
class:
src/main/java/org/elasticsearch/index/query/ScriptFilterParser.java
src/main/java/org/elasticsearch/index/query/functionscore/script/ScriptScoreFunctionParser.java
src/main/java/org/elasticsearch/search/facet/statistical/StatisticalFacetParser.java
src/main/java/org/elasticsearch/search/fetch/script/ScriptFieldsParseElement.java
comments:
[FIX] Indexed scripts should always use script_id.

time:
2014-07-22T12:43:31Z
class:
src/main/java/org/elasticsearch/search/internal/InternalSearchHits.java
src/test/java/org/elasticsearch/search/sort/SimpleSortTests.java
src/test/java/org/elasticsearch/test/hamcrest/ElasticsearchAssertions.java
comments:
Revert "Fix InternalSearchHits serialization to be deterministic"

This reverts commit 8db7b2b20ba332c3b69fb7b686ab6273c5abece0.

time:
2014-07-22T12:14:31Z
class:
src/main/java/org/elasticsearch/search/internal/InternalSearchHits.java
src/test/java/org/elasticsearch/search/sort/SimpleSortTests.java
src/test/java/org/elasticsearch/test/hamcrest/ElasticsearchAssertions.java
comments:
Fix InternalSearchHits serialization to be deterministic

The assertion on binary equality for streamable serialization
sometimes fails due to the usage of identify hashmaps inside
the InternalSearchHits serialization. This only happens if
the number of shards the result set is composed of is very high.
This commit makes the serialziation deterministic and removes
the need to serialize the ordinal due to in-order serialization.

time:
2014-07-22T10:16:32Z
class:
src/test/java/org/elasticsearch/update/UpdateTests.java
comments:
[TEST] Reduce the number of threads in StressUpdateDelete test.

time:
2014-07-22T09:36:40Z
class:
comments:
Update scripting.asciidoc

Added an ID for native java scripts

time:
2014-07-22T09:11:44Z
class:
comments:
[BUILD] Add BWC tests to release script

This commit adds the ability to run bwc tests during the release
process to ensure the current release is backwards compatible with
the latest installed previous version. Installed means available
in the configured bwc test path.

Closes #6953

time:
2014-07-22T04:47:40Z
class:
src/main/java/org/elasticsearch/indices/store/IndicesStore.java
comments:
IndicesStore fix logging format

time:
2014-07-21T21:43:01Z
class:
src/main/java/org/elasticsearch/discovery/zen/membership/MembershipAction.java
comments:
[Discovery] fix MembershipAction.sendJoinRequestBlocking should now expect an empty response

The change introduced in #6949 (do not serialize the cluster state) also means master now responds with an empty response rather then a JoinResponse. However, sendJoinRequestBlocking still expected a JoinRequest.

time:
2014-07-21T20:41:15Z
class:
comments:
Test: Set number_of_replicas to zero so that wait_for_green succeeds in search.aggregations

time:
2014-07-21T20:30:07Z
class:
src/main/java/org/elasticsearch/discovery/zen/ZenDiscovery.java
src/main/java/org/elasticsearch/discovery/zen/membership/MembershipAction.java
comments:
[Discovery] remove unneeded cluster state serialization during cluster join process

At the moment we serialize the cluster state in JoinResponse and ValidateJoinRequest. However this state is not used anywhere and can be removed to save on network overhead

Closes #6949

time:
2014-07-21T20:16:41Z
class:
src/test/java/org/elasticsearch/update/UpdateTests.java
comments:
[TEST] Stress update/delete

Reduce top end of scaling parameters to avoid OOMs on nightly runs.

time:
2014-07-21T19:31:37Z
class:
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/HistogramParser.java
src/main/java/org/elasticsearch/search/aggregations/metrics/cardinality/CardinalityParser.java
comments:
More lenient type parsing in histo/cardinality aggs
closes #6948
closes #6893

time:
2014-07-21T19:11:05Z
class:
src/test/java/org/elasticsearch/update/UpdateTests.java
comments:
[TEST] Stress Update/Delete

Create the test index with merging disabled so deletes don't get merged away
this was breaking the version calculation.

time:
2014-07-21T17:09:22Z
class:
comments:
typo

causes the example to fail in bash

time:
2014-07-21T16:51:49Z
class:
comments:
Docs: Typo

time:
2014-07-21T16:55:51Z
class:
src/test/java/org/elasticsearch/action/update/InternalEngineWithControllableTimingForTesting.java
src/test/java/org/elasticsearch/action/update/InternalEngineWithControllableTimingForTestingModule.java
src/test/java/org/elasticsearch/action/update/TransportUpdateActionTest.java
comments:
[TEST] Remove TransportUpdateActionTest

This test has been made obselete by the UpdateTests.

time:
2014-07-21T15:26:29Z
class:
comments:
Merge branch 'master' of github.com:elasticsearch/elasticsearch

time:
2014-07-21T15:25:31Z
class:
src/test/java/org/elasticsearch/plugin/PluginManagerTests.java
comments:
[TEST] Plugin Manager

Undo removal of change.

time:
2014-07-21T15:11:12Z
class:
src/test/java/org/elasticsearch/plugin/PluginManagerTests.java
comments:
Merge branch 'master' of github.com:elasticsearch/elasticsearch

time:
2014-07-21T15:04:21Z
class:
src/test/java/org/elasticsearch/update/UpdateTests.java
comments:
[TEST] Stress test for update and delete concurrency.

This test deletes and updates using upserts documents over several threads in a
tight loop. It counts the number of responses and verifies that the versions at
the end are correct.

time:
2014-07-21T14:55:42Z
class:
src/test/java/org/elasticsearch/plugin/PluginManagerTests.java
comments:
[TEST] Activate test in PluginManagerTests that is supposed to be fixed

time:
2014-07-21T14:15:53Z
class:
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
src/main/java/org/elasticsearch/index/snapshots/IndexShardSnapshotAndRestoreService.java
src/main/java/org/elasticsearch/index/snapshots/blobstore/BlobStoreIndexShardRepository.java
src/main/java/org/elasticsearch/index/store/Store.java
src/main/java/org/elasticsearch/snapshots/RestoreService.java
src/test/java/org/elasticsearch/index/store/CorruptedFileTest.java
comments:
[RESTORE] Fail restore if snapshot is corrupted

today if a snapshot is corrupted the restore operation
never terminates. Yet, if the snapshot is corrupted there
is no way to restore it anyway. If such a snapshot is restored
today the only way to cancle it is to delete the entire index which
might cause dataloss. This commit also fixes an issue in InternalEngine
where a deadlock can occur if a corruption is detected during flush
since the InternalEngine#snapshotIndex aqcuires a topLevel read lock
which prevents closing the engine.

Closes #6938

time:
2014-07-21T12:59:44Z
class:
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
src/main/java/org/elasticsearch/index/settings/IndexDynamicSettingsModule.java
src/test/java/org/elasticsearch/index/engine/internal/InternalEngineTests.java
src/test/java/org/elasticsearch/index/store/CorruptedFileTest.java
comments:
[Engine] `index.fail_on_corruption` is not updateable

The `index.fail_on_corruption` was not updateable via the index settings
API. This commit also fixed the setting prefix to be consistent with other
setting on the engine. Yet, this feature is unreleased so this won't break anything.

Closes #6941

time:
2014-07-21T09:55:57Z
class:
comments:
Docs: Update documentation about execution hints for the terms aggregation.

time:
2014-07-21T09:21:50Z
class:
src/test/java/org/elasticsearch/search/aggregations/bucket/TopHitsTests.java
comments:
[TEST] top_hits aggs with breath_first collect mode only fails if scoring is used (score based sort or track_scores)

time:
2014-07-21T08:03:42Z
class:
src/main/java/org/elasticsearch/search/aggregations/metrics/tophits/TopHitsAggregator.java
src/test/java/org/elasticsearch/search/aggregations/bucket/TopHitsTests.java
comments:
Aggregations: Track scores should be applied properly for `top_hits` aggregation.

Closes #6934

time:
2014-07-21T07:57:03Z
class:
src/test/java/org/elasticsearch/action/update/TransportUpdateActionTest.java
comments:
[TEST] Temporarily ignore transport update tests.

time:
2014-07-20T17:20:18Z
class:
src/test/java/org/elasticsearch/index/store/DistributorDirectoryTest.java
comments:
[TEST] Add SuppressSysoutChecks to DistributorDirectoryTest

time:
2014-07-20T08:44:24Z
class:
src/test/java/org/elasticsearch/index/store/CorruptedFileTest.java
comments:
[TEST] an active shard might also be relocating

time:
2014-07-18T14:30:31Z
class:
src/main/java/org/elasticsearch/http/netty/NettyHttpServerTransport.java
src/main/java/org/elasticsearch/transport/netty/MessageChannelHandler.java
src/main/java/org/elasticsearch/transport/netty/NettyTransport.java
src/test/java/org/elasticsearch/test/transport/ConfigurableErrorNettyTransportModule.java
src/test/java/org/elasticsearch/test/transport/NettyTransportTests.java
comments:
Netty: Refactoring to make MessageChannelHandler extensible

Small refactorings to make the MessageChannelHandler more extensible.
Also allowed access to the different netty pipelines

This is the fix after the first version had problems with the HTTP
transport due to wrong reusing channel handlers, which is the reason
why tests failed.

Relates #6889
Closes #6915

time:
2014-07-18T14:18:50Z
class:
src/main/java/org/elasticsearch/action/ActionModule.java
src/main/java/org/elasticsearch/action/admin/cluster/health/TransportClusterHealthAction.java
src/main/java/org/elasticsearch/action/admin/cluster/node/hotthreads/TransportNodesHotThreadsAction.java
src/main/java/org/elasticsearch/action/admin/cluster/node/info/TransportNodesInfoAction.java
src/main/java/org/elasticsearch/action/admin/cluster/node/restart/TransportNodesRestartAction.java
src/main/java/org/elasticsearch/action/admin/cluster/node/shutdown/TransportNodesShutdownAction.java
src/main/java/org/elasticsearch/action/admin/cluster/node/stats/TransportNodesStatsAction.java
src/main/java/org/elasticsearch/action/admin/cluster/repositories/delete/TransportDeleteRepositoryAction.java
src/main/java/org/elasticsearch/action/admin/cluster/repositories/get/TransportGetRepositoriesAction.java
src/main/java/org/elasticsearch/action/admin/cluster/repositories/put/TransportPutRepositoryAction.java
src/main/java/org/elasticsearch/action/admin/cluster/reroute/TransportClusterRerouteAction.java
src/main/java/org/elasticsearch/action/admin/cluster/settings/TransportClusterUpdateSettingsAction.java
src/main/java/org/elasticsearch/action/admin/cluster/shards/TransportClusterSearchShardsAction.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/create/TransportCreateSnapshotAction.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/delete/TransportDeleteSnapshotAction.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/get/TransportGetSnapshotsAction.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/restore/TransportRestoreSnapshotAction.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/status/TransportNodesSnapshotsStatus.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/status/TransportSnapshotsStatusAction.java
src/main/java/org/elasticsearch/action/admin/cluster/state/TransportClusterStateAction.java
src/main/java/org/elasticsearch/action/admin/cluster/stats/TransportClusterStatsAction.java
src/main/java/org/elasticsearch/action/admin/cluster/tasks/TransportPendingClusterTasksAction.java
src/main/java/org/elasticsearch/action/admin/indices/alias/TransportIndicesAliasesAction.java
src/main/java/org/elasticsearch/action/admin/indices/alias/exists/TransportAliasesExistAction.java
src/main/java/org/elasticsearch/action/admin/indices/alias/get/TransportGetAliasesAction.java
src/main/java/org/elasticsearch/action/admin/indices/analyze/TransportAnalyzeAction.java
src/main/java/org/elasticsearch/action/admin/indices/cache/clear/TransportClearIndicesCacheAction.java
src/main/java/org/elasticsearch/action/admin/indices/close/TransportCloseIndexAction.java
src/main/java/org/elasticsearch/action/admin/indices/create/TransportCreateIndexAction.java
src/main/java/org/elasticsearch/action/admin/indices/delete/TransportDeleteIndexAction.java
src/main/java/org/elasticsearch/action/admin/indices/exists/indices/TransportIndicesExistsAction.java
src/main/java/org/elasticsearch/action/admin/indices/exists/types/TransportTypesExistsAction.java
src/main/java/org/elasticsearch/action/admin/indices/flush/TransportFlushAction.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/delete/TransportDeleteMappingAction.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/get/TransportGetFieldMappingsAction.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/get/TransportGetFieldMappingsIndexAction.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/get/TransportGetMappingsAction.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/put/TransportPutMappingAction.java
src/main/java/org/elasticsearch/action/admin/indices/open/TransportOpenIndexAction.java
src/main/java/org/elasticsearch/action/admin/indices/optimize/TransportOptimizeAction.java
src/main/java/org/elasticsearch/action/admin/indices/recovery/TransportRecoveryAction.java
src/main/java/org/elasticsearch/action/admin/indices/refresh/TransportRefreshAction.java
src/main/java/org/elasticsearch/action/admin/indices/segments/TransportIndicesSegmentsAction.java
src/main/java/org/elasticsearch/action/admin/indices/settings/get/TransportGetSettingsAction.java
src/main/java/org/elasticsearch/action/admin/indices/settings/put/TransportUpdateSettingsAction.java
src/main/java/org/elasticsearch/action/admin/indices/stats/TransportIndicesStatsAction.java
src/main/java/org/elasticsearch/action/admin/indices/template/delete/TransportDeleteIndexTemplateAction.java
src/main/java/org/elasticsearch/action/admin/indices/template/get/TransportGetIndexTemplatesAction.java
src/main/java/org/elasticsearch/action/admin/indices/template/put/TransportPutIndexTemplateAction.java
src/main/java/org/elasticsearch/action/admin/indices/validate/query/TransportValidateQueryAction.java
src/main/java/org/elasticsearch/action/admin/indices/warmer/delete/TransportDeleteWarmerAction.java
src/main/java/org/elasticsearch/action/admin/indices/warmer/get/TransportGetWarmersAction.java
src/main/java/org/elasticsearch/action/admin/indices/warmer/put/TransportPutWarmerAction.java
src/main/java/org/elasticsearch/action/bench/TransportAbortBenchmarkAction.java
src/main/java/org/elasticsearch/action/bench/TransportBenchmarkAction.java
src/main/java/org/elasticsearch/action/bench/TransportBenchmarkStatusAction.java
src/main/java/org/elasticsearch/action/bulk/TransportBulkAction.java
src/main/java/org/elasticsearch/action/bulk/TransportShardBulkAction.java
src/main/java/org/elasticsearch/action/count/TransportCountAction.java
src/main/java/org/elasticsearch/action/delete/TransportDeleteAction.java
src/main/java/org/elasticsearch/action/delete/index/TransportIndexDeleteAction.java
src/main/java/org/elasticsearch/action/delete/index/TransportShardDeleteAction.java
src/main/java/org/elasticsearch/action/deletebyquery/TransportDeleteByQueryAction.java
src/main/java/org/elasticsearch/action/deletebyquery/TransportIndexDeleteByQueryAction.java
src/main/java/org/elasticsearch/action/deletebyquery/TransportShardDeleteByQueryAction.java
src/main/java/org/elasticsearch/action/explain/TransportExplainAction.java
src/main/java/org/elasticsearch/action/get/TransportGetAction.java
src/main/java/org/elasticsearch/action/get/TransportMultiGetAction.java
src/main/java/org/elasticsearch/action/get/TransportShardMultiGetAction.java
src/main/java/org/elasticsearch/action/index/TransportIndexAction.java
src/main/java/org/elasticsearch/action/indexedscripts/delete/TransportDeleteIndexedScriptAction.java
src/main/java/org/elasticsearch/action/indexedscripts/get/TransportGetIndexedScriptAction.java
src/main/java/org/elasticsearch/action/indexedscripts/put/TransportPutIndexedScriptAction.java
src/main/java/org/elasticsearch/action/mlt/TransportMoreLikeThisAction.java
src/main/java/org/elasticsearch/action/percolate/TransportMultiPercolateAction.java
src/main/java/org/elasticsearch/action/percolate/TransportPercolateAction.java
src/main/java/org/elasticsearch/action/percolate/TransportShardMultiPercolateAction.java
src/main/java/org/elasticsearch/action/search/TransportClearScrollAction.java
src/main/java/org/elasticsearch/action/search/TransportMultiSearchAction.java
src/main/java/org/elasticsearch/action/search/TransportSearchAction.java
src/main/java/org/elasticsearch/action/search/TransportSearchScrollAction.java
src/main/java/org/elasticsearch/action/search/type/TransportSearchCountAction.java
src/main/java/org/elasticsearch/action/search/type/TransportSearchDfsQueryAndFetchAction.java
src/main/java/org/elasticsearch/action/search/type/TransportSearchDfsQueryThenFetchAction.java
src/main/java/org/elasticsearch/action/search/type/TransportSearchQueryAndFetchAction.java
src/main/java/org/elasticsearch/action/search/type/TransportSearchQueryThenFetchAction.java
src/main/java/org/elasticsearch/action/search/type/TransportSearchScanAction.java
src/main/java/org/elasticsearch/action/search/type/TransportSearchTypeAction.java
src/main/java/org/elasticsearch/action/suggest/TransportSuggestAction.java
src/main/java/org/elasticsearch/action/support/ActionFilter.java
src/main/java/org/elasticsearch/action/support/ActionFilterChain.java
src/main/java/org/elasticsearch/action/support/ActionFilters.java
src/main/java/org/elasticsearch/action/support/HandledTransportAction.java
src/main/java/org/elasticsearch/action/support/TransportAction.java
src/main/java/org/elasticsearch/action/support/broadcast/TransportBroadcastOperationAction.java
src/main/java/org/elasticsearch/action/support/master/TransportMasterNodeOperationAction.java
src/main/java/org/elasticsearch/action/support/master/TransportMasterNodeReadOperationAction.java
src/main/java/org/elasticsearch/action/support/master/info/TransportClusterInfoAction.java
src/main/java/org/elasticsearch/action/support/nodes/TransportNodesOperationAction.java
src/main/java/org/elasticsearch/action/support/replication/TransportIndexReplicationOperationAction.java
src/main/java/org/elasticsearch/action/support/replication/TransportIndicesReplicationOperationAction.java
src/main/java/org/elasticsearch/action/support/replication/TransportShardReplicationOperationAction.java
src/main/java/org/elasticsearch/action/support/single/custom/TransportSingleCustomOperationAction.java
src/main/java/org/elasticsearch/action/support/single/instance/TransportInstanceSingleOperationAction.java
src/main/java/org/elasticsearch/action/support/single/shard/TransportShardSingleOperationAction.java
src/main/java/org/elasticsearch/action/termvector/TransportMultiTermVectorsAction.java
src/main/java/org/elasticsearch/action/termvector/TransportSingleShardMultiTermsVectorAction.java
src/main/java/org/elasticsearch/action/termvector/TransportSingleShardTermVectorAction.java
src/main/java/org/elasticsearch/action/update/TransportUpdateAction.java
src/main/java/org/elasticsearch/cluster/action/index/MappingUpdatedAction.java
src/main/java/org/elasticsearch/gateway/local/state/meta/TransportNodesListGatewayMetaState.java
src/main/java/org/elasticsearch/gateway/local/state/shards/TransportNodesListGatewayStartedShards.java
src/main/java/org/elasticsearch/indices/store/TransportNodesListShardStoreMetaData.java
src/test/java/org/elasticsearch/action/support/TransportActionFilterChainTests.java
comments:
Plugins: Introduced pluggable filter chain to be able to filter transport actions execution

It's now possible to inject action filters from plugins via `ActionModule#registerFilter` through the following code:

```
    public void onModule(ActionModule actionModule) {
          actionModule.registerFilter(MyFilter.class);
    }
```

Also made `TransportAction#execute` methods final to enforce the execution of the filter chain. By default the chain is empty though.

Note that the action filter chain is executed right after the request validation, as the filters might rely on a valid request to do their work.

Closes #6921

time:
2014-07-18T12:35:00Z
class:
src/test/java/org/elasticsearch/index/analysis/PreBuiltAnalyzerTests.java
src/test/java/org/elasticsearch/index/codec/CodecTests.java
src/test/java/org/elasticsearch/index/fielddata/AbstractFieldDataTests.java
src/test/java/org/elasticsearch/index/fielddata/BinaryDVFieldDataTests.java
src/test/java/org/elasticsearch/index/fielddata/DuelFieldDataTests.java
src/test/java/org/elasticsearch/index/fielddata/IndexFieldDataServiceTests.java
src/test/java/org/elasticsearch/index/fielddata/ParentChildFieldDataTests.java
src/test/java/org/elasticsearch/index/mapper/MapperTestUtils.java
src/test/java/org/elasticsearch/index/mapper/all/SimpleAllMapperTests.java
src/test/java/org/elasticsearch/index/mapper/analyzer/AnalyzerMapperTests.java
src/test/java/org/elasticsearch/index/mapper/binary/BinaryMappingTests.java
src/test/java/org/elasticsearch/index/mapper/boost/BoostMappingTests.java
src/test/java/org/elasticsearch/index/mapper/boost/CustomBoostMappingTests.java
src/test/java/org/elasticsearch/index/mapper/boost/FieldLevelBoostTests.java
src/test/java/org/elasticsearch/index/mapper/camelcase/CamelCaseFieldNameTests.java
src/test/java/org/elasticsearch/index/mapper/completion/CompletionFieldMapperTests.java
src/test/java/org/elasticsearch/index/mapper/compound/CompoundTypesTests.java
src/test/java/org/elasticsearch/index/mapper/copyto/CopyToMapperTests.java
src/test/java/org/elasticsearch/index/mapper/core/TokenCountFieldMapperTests.java
src/test/java/org/elasticsearch/index/mapper/date/SimpleDateMappingTests.java
src/test/java/org/elasticsearch/index/mapper/dynamic/DynamicMappingTests.java
src/test/java/org/elasticsearch/index/mapper/dynamictemplate/genericstore/GenericStoreDynamicTemplateTests.java
src/test/java/org/elasticsearch/index/mapper/dynamictemplate/pathmatch/PathMatchDynamicTemplateTests.java
src/test/java/org/elasticsearch/index/mapper/dynamictemplate/simple/SimpleDynamicTemplatesTests.java
src/test/java/org/elasticsearch/index/mapper/geo/GeoShapeFieldMapperTests.java
src/test/java/org/elasticsearch/index/mapper/geo/GeohashMappingGeoPointTests.java
src/test/java/org/elasticsearch/index/mapper/geo/LatLonAndGeohashMappingGeoPointTests.java
src/test/java/org/elasticsearch/index/mapper/geo/LatLonMappingGeoPointTests.java
src/test/java/org/elasticsearch/index/mapper/id/IdMappingTests.java
src/test/java/org/elasticsearch/index/mapper/index/IndexTypeMapperTests.java
src/test/java/org/elasticsearch/index/mapper/internal/FieldNamesFieldMapperTests.java
src/test/java/org/elasticsearch/index/mapper/lucene/DoubleIndexingDocTest.java
src/test/java/org/elasticsearch/index/mapper/lucene/StoredNumericValuesTest.java
src/test/java/org/elasticsearch/index/mapper/merge/TestMergeMapperTests.java
src/test/java/org/elasticsearch/index/mapper/multifield/MultiFieldTests.java
src/test/java/org/elasticsearch/index/mapper/multifield/merge/JavaMultiFieldMergeTests.java
src/test/java/org/elasticsearch/index/mapper/nested/NestedMappingTests.java
src/test/java/org/elasticsearch/index/mapper/numeric/SimpleNumericTests.java
src/test/java/org/elasticsearch/index/mapper/object/NullValueObjectMappingTests.java
src/test/java/org/elasticsearch/index/mapper/object/SimpleObjectMappingTests.java
src/test/java/org/elasticsearch/index/mapper/parent/ParentMappingTests.java
src/test/java/org/elasticsearch/index/mapper/path/PathMapperTests.java
src/test/java/org/elasticsearch/index/mapper/routing/RoutingTypeMapperTests.java
src/test/java/org/elasticsearch/index/mapper/simple/SimpleMapperTests.java
src/test/java/org/elasticsearch/index/mapper/size/SizeMappingTests.java
src/test/java/org/elasticsearch/index/mapper/source/CompressSourceMappingTests.java
src/test/java/org/elasticsearch/index/mapper/source/DefaultSourceMappingTests.java
src/test/java/org/elasticsearch/index/mapper/string/SimpleStringMappingTests.java
src/test/java/org/elasticsearch/index/mapper/timestamp/TimestampMappingTests.java
src/test/java/org/elasticsearch/index/mapper/ttl/TTLMappingTests.java
src/test/java/org/elasticsearch/index/mapper/typelevels/ParseDocumentTypeLevelsTests.java
src/test/java/org/elasticsearch/index/mapper/typelevels/ParseMappingTypeLevelTests.java
src/test/java/org/elasticsearch/index/query/IndexQueryParserFilterCachingTests.java
src/test/java/org/elasticsearch/index/query/SimpleIndexQueryParserTests.java
src/test/java/org/elasticsearch/index/query/TemplateQueryParserTest.java
src/test/java/org/elasticsearch/index/query/guice/IndexQueryParserModuleTests.java
src/test/java/org/elasticsearch/index/search/FieldDataTermsFilterTests.java
src/test/java/org/elasticsearch/index/search/child/AbstractChildTests.java
src/test/java/org/elasticsearch/index/search/child/ChildrenConstantScoreQueryTests.java
src/test/java/org/elasticsearch/index/search/child/ChildrenQueryTests.java
src/test/java/org/elasticsearch/index/search/child/ParentConstantScoreQueryTests.java
src/test/java/org/elasticsearch/index/search/child/ParentQueryTests.java
src/test/java/org/elasticsearch/index/search/child/TopChildrenQueryTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/significant/SignificanceHeuristicTests.java
src/test/java/org/elasticsearch/test/ElasticsearchSingleNodeLuceneTestCase.java
src/test/java/org/elasticsearch/test/ElasticsearchSingleNodeTest.java
src/test/java/org/elasticsearch/test/TestSearchContext.java
src/test/java/org/elasticsearch/test/index/service/StubIndexService.java
comments:
[TESTS] Switch more tests to ElasticsearchSingleNodeTest.

This avoids loading modules manually all the time.

time:
2014-07-18T12:02:50Z
class:
comments:
Plugin Manager: Properly quote $JAVA in bin/plugin

The all new Oracle Java 7 on OSX has a space in its path
resulting in bin/plugin failing to work

Closes #5765

time:
2014-07-18T11:55:47Z
class:
comments:
Docs: Add links to client helper classes for bulk/scroll/reindexing

time:
2014-07-18T11:49:38Z
class:
src/main/java/org/elasticsearch/transport/netty/SizeHeaderFrameDecoder.java
comments:
Better message for invalid internal transport message format
closes ##6916

time:
2014-07-18T10:45:29Z
class:
comments:
[DOCS]: Added link to saltstack module

time:
2014-07-18T10:30:53Z
class:
src/test/java/org/elasticsearch/test/client/RandomizingClient.java
comments:
[TEST] Randomize Preference in search requests

Closes #6863

time:
2014-07-18T09:51:42Z
class:
src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java
comments:
[TEST] Randomize FS Translog implementation

Closes #6658

time:
2014-07-18T09:31:15Z
class:
src/main/java/org/elasticsearch/Version.java
src/main/java/org/elasticsearch/client/transport/TransportClient.java
src/main/java/org/elasticsearch/client/transport/TransportClientNodesService.java
src/test/java/org/elasticsearch/VersionTests.java
src/test/java/org/elasticsearch/client/transport/TransportClientTests.java
comments:
[CLIENT] Unknown node version should be a lower bound

Today when we start a `TransportClient` we use the given transport
addresses and create a `DiscoveryNode` from it without knowing the
actual nodes version. We just use the `Version.CURRENT` which is an
upper bound. Yet, the other node might be a version less than the
currently running and serialisation of the nodes info might break. We
should rather use a lower bound here which is the version of the first
release with the same major version as `Version.CURRENT` since this is
what we officially support.

This commit moves to use the minimum major version or an RC / Snapshot
if the current version is a snapshot.

Closes #6894

time:
2014-07-17T21:29:05Z
class:
src/main/java/org/elasticsearch/action/termvector/TermVectorWriter.java
src/main/java/org/elasticsearch/index/termvectors/ShardTermVectorService.java
src/test/java/org/elasticsearch/action/termvector/GetTermVectorTests.java
comments:
Term Vectors API: Computes term vectors on the fly if not stored in the index.

Adds the ability to the Term Vector API to generate term vectors for some
chosen fields, even though they haven't been explicitely stored in the index.

Relates to #5184
Closes #6567

time:
2014-07-17T19:25:34Z
class:
comments:
[DOCS] Fixed typos

time:
2014-07-17T14:47:46Z
class:
src/main/java/org/elasticsearch/http/netty/NettyHttpServerTransport.java
src/main/java/org/elasticsearch/transport/TransportService.java
comments:
Return null info if service is not started

Closes #6906

time:
2014-07-17T14:24:43Z
class:
src/main/java/org/elasticsearch/action/bulk/BulkProcessor.java
src/test/java/org/elasticsearch/action/bulk/BulkProcessorTests.java
comments:
[Bulk] Release semaphore again after close

The bulk processor tries to acquire all leases for the semaphore to wait
for all pending requests. Yet, we should release them afterwards again to
ensure we don't ever deadlock if there is a bug in the processor.
This commit also adds a testcase for this method

time:
2014-07-17T13:57:45Z
class:
src/main/java/org/elasticsearch/action/bulk/BulkProcessor.java
comments:
[Bulk] Add blocking close method to BulkProcessor

Blocks until all bulk requests have completed.

Closes #4158
Closes #6314

time:
2014-07-17T12:57:53Z
class:
src/main/java/org/elasticsearch/watcher/ResourceWatcherService.java
src/main/java/org/elasticsearch/watcher/WatcherHandle.java
src/test/java/org/elasticsearch/watcher/ResourceWatcherServiceTests.java
comments:
Added three frequency levels for resource watching

 It's now possible to register watchers along with a specified check frequency. There are three frequencies: low, medium, high. Each one is associated with a check interval that determines how frequent the watchers will check for changes and notify listeners if needed. By default, the intervals are 5s, 30s and 60s respectively, but they can also be customized in the settings. also:

  - Added the WatcherHandle construct by which one can stop it (remove it) and resume it (re add it). Also provices access to the watchers itself and the frequency by which it's checked
  - Change the default frequency to 30 seconds interval (used to be 60 seconds). The only watcher that is currently effected by this is the script watcher (now auto-loading scripts will auto-load every 30 seconds if changed)

time:
2014-07-17T12:51:07Z
class:
src/main/java/org/elasticsearch/indices/store/IndicesStore.java
comments:
[Store] delete unallocated shards under a cluster state task

This is to prevent a rare racing condition where the very same shard gets allocated to the node after our sanity check that the cluster state didn't check and the actual deletion of the files.

Closes #6902

time:
2014-07-17T12:49:15Z
class:
src/main/java/org/elasticsearch/http/netty/NettyHttpServerTransport.java
src/main/java/org/elasticsearch/transport/netty/MessageChannelHandler.java
src/main/java/org/elasticsearch/transport/netty/NettyTransport.java
src/test/java/org/elasticsearch/test/transport/ConfigurableErrorNettyTransportModule.java
src/test/java/org/elasticsearch/test/transport/NettyTransportTests.java
comments:
Revert "Netty: Refactoring to make MessageChannelHandler extensible"

This results in unstable tests, most likely due to Channels being mixed
up by wrongly creating the pipelines. Needs investigation and a test.

This reverts commit db7f0d36af6692b1648cbea6e1e7147e7cfa70dc.

time:
2014-07-17T12:31:38Z
class:
src/main/java/org/elasticsearch/indices/memory/IndexingMemoryController.java
src/test/java/org/elasticsearch/indices/memory/IndexMemoryControllerTests.java
src/test/java/org/elasticsearch/indices/memory/IndexingMemoryControllerTests.java
comments:
[Infra] remove indicesLifecycle.Listener from IndexingMemoryController

The IndexingMemoryController determines the amount of indexing buffer size and translog buffer size each shard should have. It takes memory from inactive shards (indexing wise) and assigns it to other shards. To do so it needs to know about the addition and closing of shards. The current implementation hooks into the indicesService.indicesLifecycle() mechanism to receive call backs, such shard entered the POST_RECOVERY state. Those call backs are typically run on the thread that actually made the change. A mutex was used to synchronize those callbacks with IndexingMemoryController's background thread, which updates the internal engines memory usage on a regular interval. This introduced a dependency between those threads and the locks of the internal engines hosted on the node. In a *very* rare situation (two tests runs locally) this can cause recovery time outs where two nodes are recovering replicas from each other.

 This commit introduces a a lock free approach that updates the internal data structures during iterations in the background thread.

Closes #6892

time:
2014-07-17T10:42:18Z
class:
src/main/java/org/elasticsearch/index/mapper/FieldMapper.java
src/main/java/org/elasticsearch/index/mapper/core/AbstractFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/core/NumberFieldMapper.java
src/main/java/org/elasticsearch/index/query/TermsFilterParser.java
src/test/java/org/elasticsearch/index/search/FieldDataTermsFilterTests.java
comments:
Refactoring: Rename FieldMapper.termsFilter to fieldDataTermsFilter.

FieldMapper has two methods
`Filter termsFilter(List values, @Nullable QueryParseContext)` which is supposed
to work on the inverted index and
`Filter termsFilter(QueryParseContext, List, QueryParseContext)` which is
supposed to work on field data. Let's rename the second one to
`fieldDataTermsFilter` and remove the unused `QueryParseContext`.

Close #6888

time:
2014-07-17T08:05:58Z
class:
comments:
[TEST] Fixed intermittent failure due to lack of mapping

time:
2014-07-17T07:39:51Z
class:
src/test/java/org/elasticsearch/nested/SimpleNestedTests.java
comments:
[TEST] Use array* helper assert methods instead of verifying the array directly

time:
2014-07-17T06:57:01Z
class:
src/main/java/org/elasticsearch/plugins/PluginManager.java
src/test/java/org/elasticsearch/plugin/PluginManagerTests.java
comments:
bin/plugin removes itself

If you call `bin/plugin --remove es-plugin` the plugin got removed but the file `bin/plugin` itself was also deleted.

We now don't allow the following plugin names:

* elasticsearch
* plugin
* elasticsearch.bat
* plugin.bat
* elasticsearch.in.sh
* service.bat

Closes #6745

time:
2014-07-17T06:28:55Z
class:
src/main/java/org/elasticsearch/http/netty/NettyHttpServerTransport.java
src/main/java/org/elasticsearch/transport/netty/MessageChannelHandler.java
src/main/java/org/elasticsearch/transport/netty/NettyTransport.java
src/test/java/org/elasticsearch/test/transport/ConfigurableErrorNettyTransportModule.java
src/test/java/org/elasticsearch/test/transport/NettyTransportTests.java
comments:
Netty: Refactoring to make MessageChannelHandler extensible

Small refactorings to make the MessageChannelHandler more extensible.
Also allowed access to the different netty pipelines

Closes #6889

time:
2014-07-17T06:05:10Z
class:
src/main/java/org/elasticsearch/script/groovy/GroovyScriptEngineService.java
comments:
[Scripts] GroovyScriptEngineService don't create ScoreAccess if lookup is null

time:
2014-07-16T23:33:04Z
class:
src/main/java/org/elasticsearch/script/ScoreAccessor.java
src/main/java/org/elasticsearch/script/groovy/GroovyScriptEngineService.java
comments:
Scripts: Make ScoreAccessor utility available for other script engines.

With the removal of setNextScore in #6864, script engines must use
the Scorer to find the score of a document.  The DocLookup is updated
appropriately to do this, but most script engines require a Number to be
bound for numeric variables.  Groovy already had an encapsulation for
this funtionality, and this moves it out to be shared with other script
engines.

closes #6898

time:
2014-07-16T22:10:01Z
class:
src/main/java/org/elasticsearch/common/lucene/search/function/ScriptScoreFunction.java
src/main/java/org/elasticsearch/script/AbstractSearchScript.java
src/main/java/org/elasticsearch/script/SearchScript.java
src/main/java/org/elasticsearch/script/expression/ExpressionScript.java
src/main/java/org/elasticsearch/script/groovy/GroovyScriptEngineService.java
src/main/java/org/elasticsearch/script/groovy/GroovyScriptExecutionException.java
src/test/java/org/elasticsearch/search/aggregations/support/FieldDataSourceTests.java
src/test/java/org/elasticsearch/search/aggregations/support/ScriptValuesTests.java
comments:
Scripting: Remove setNextScore in SearchScript.

While it would be nice to do this all the way up the chain (into
score functions), this at least removes the weird dual
setNextScore/setScorer for SearchScripts.

closes #6864

time:
2014-07-16T22:01:06Z
class:
src/main/java/org/elasticsearch/index/search/child/TopChildrenQuery.java
comments:
Query: When parent doc is found stop iterating over segments and continue with the next top matching child doc.

The parent doc has been found and there is no need to check subsequent segments.

Closes #6895
Closes #1843

time:
2014-07-16T21:43:18Z
class:
src/main/java/org/elasticsearch/search/fetch/matchedqueries/MatchedQueriesFetchSubPhase.java
src/test/java/org/elasticsearch/nested/SimpleNestedTests.java
comments:
Search: Added support for named filters/queries inside nested filters and queries.

Closes #6293

time:
2014-07-16T21:03:59Z
class:
comments:
[BUILD] Randomization script refactoring

1) Refactored randomization logic to the top
2) Add logics to support window platforms

time:
2014-07-16T15:58:32Z
class:
src/main/java/org/elasticsearch/threadpool/ThreadPool.java
comments:
Serialization: Fix bwc issue by falling back to old threadpool serialization

This fixes an issue introduced by the serialization changes in #6486
which are not needed at all. Node that the serialization itself is not broken
but the TransportClient uses its own version on initial connect and getting
the NodeInfos.

time:
2014-07-16T15:31:31Z
class:
comments:
REST: Fixed indexed script/template tests

The clients don't have access to the error message
for matching purposes.  Rewritten tests to work
with the clients

time:
2014-07-16T15:31:26Z
class:
comments:
REST: Renamed indexed_script and indexed_template specs

The file name of the REST specs should be the same as
the endpoint which it documents.

time:
2014-07-16T13:49:17Z
class:
src/main/java/org/elasticsearch/ExceptionsHelper.java
src/main/java/org/elasticsearch/index/fielddata/IndexFieldDataService.java
comments:
[FIELDDATA] Use KeyedLock in IndexFieldDataService

Today we synchronize when updating the IndexFieldDataService
datastructures. This might unnecessarily block progress if multiple
request need different fielddata instance for different fields.

This commit also fixes clear calls to actually consistently clear
the caches in the case of an exception.

Closes #6855

time:
2014-07-16T13:49:00Z
class:
src/main/java/org/elasticsearch/common/util/concurrent/KeyedLock.java
src/test/java/org/elasticsearch/transport/netty/KeyedLockTests.java
comments:
Add read/write lock semantics to KeyedLock

time:
2014-07-16T13:25:53Z
class:
src/main/java/org/elasticsearch/common/unit/SizeValue.java
src/main/java/org/elasticsearch/threadpool/ThreadPool.java
src/test/java/org/elasticsearch/common/unit/SizeValueTests.java
src/test/java/org/elasticsearch/threadpool/ThreadPoolSerializationTests.java
comments:
Threadpool Info: Allow to serialize negative thread pool sizes

As a SizeValue is used for serializing the thread pool size, a negative number
resulted in throwing an exception when deserializing (using -ea an assertionerror
was thrown).

This fixes a check for changing the serialization logic, so that negative numbers are read correctly, by adding an internal UNBOUNDED value.

Closes #6325
Closes #5357

time:
2014-07-16T13:02:20Z
class:
comments:
[DOCS] Move benchmark API to 1.4

time:
2014-07-16T11:48:39Z
class:
src/test/java/org/elasticsearch/search/child/SimpleChildQuerySearchTests.java
comments:
[TEST] Verify if clear cache request went to all shards.

time:
2014-07-16T10:36:48Z
class:
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/InternalHistogram.java
comments:
Aggregations: Fixed Histogram key_as_string bug

The key as string field in the response for the histogram aggregation will now only show if format is specified on the request.

Closes #6655
Since the endpoint here is `search`, shouldn't the directory also be named `search` instead of `search.aggregation`? Seems like most other tests follow this convention (~90 vs ~5)

time:
2014-07-16T10:24:18Z
class:
comments:
[DOCS][FIX] Fix reference check in indexed scripts/templates doc.

time:
2014-07-16T10:18:21Z
class:
comments:
[DOCS][FIX] Fix doc parsing, broken closing block

time:
2014-07-16T09:49:02Z
class:
src/main/java/org/elasticsearch/rest/action/script/RestDeleteIndexedScriptAction.java
src/main/java/org/elasticsearch/rest/action/script/RestGetIndexedScriptAction.java
src/main/java/org/elasticsearch/rest/action/script/RestPutIndexedScriptAction.java
comments:
[DOCS] : Indexed scripts/templates

These are the docs for the indexed scripts/templates feature.
Also moved the namespace for the REST endpoints.

Closes #6851

time:
2014-07-16T08:37:25Z
class:
src/test/java/org/elasticsearch/index/fielddata/DisabledFieldDataFormatTests.java
comments:
[TESTS] Stabilize DisabledFieldDataFormatTests by setting number_of_replicas to 0.

time:
2014-07-16T08:01:01Z
class:
src/main/java/org/elasticsearch/indices/cluster/IndicesClusterStateService.java
comments:
[Recovery] don't start a gateway recovery if source node is not found

Due to change introduced in #6825, we now start a local gateway recovery for replicas, if the source node can not be found. The recovery then fails because we never recover replicas from disk.

Closes #6879

time:
2014-07-16T07:59:49Z
class:
src/main/java/org/elasticsearch/cluster/action/shard/ShardStateAction.java
src/main/java/org/elasticsearch/indices/cluster/IndicesClusterStateService.java
comments:
[Infra] re-send failed shard messages when receiving a cluster state that still refers to them

In rare cases we may fail to send a shard failure event to the master, or there is no known master when the shard has failed (ex. a couple of node leave the cluster canceling recoveries and causing a master to step down at the same time). When that happens and a cluster state arrives from the (new) master we should resend the shard failure in order for the master to remove the shard from this node.

Closes #6881

time:
2014-07-16T07:32:53Z
class:
comments:
Update to elasticsearch 1.4.0

Closes #29.

(cherry picked from commit 4a87b6b)

time:
2014-07-16T07:29:35Z
class:
comments:
Update to elasticsearch 1.4.0

Closes #38.

(cherry picked from commit 7ee03e7)

time:
2014-07-16T07:25:09Z
class:
comments:
Update to elasticsearch 1.4.0

Closes #34.

(cherry picked from commit ddd941b)

time:
2014-07-16T07:23:32Z
class:
src/main/java/org/elasticsearch/indices/store/IndicesStore.java
comments:
Store: Only send shard exists requests if shards exist locally on disk and are not allocated on that node according to the cluster state.

Closes #6870

time:
2014-07-16T07:20:55Z
class:
comments:
Update to elasticsearch 1.4.0

Closes #25.

(cherry picked from commit c299ce4)

time:
2014-07-16T07:16:35Z
class:
comments:
Update to elasticsearch 1.4.0

Closes #30.

(cherry picked from commit fad6ebf)

time:
2014-07-15T21:40:12Z
class:
src/main/java/org/elasticsearch/search/aggregations/support/ValuesSource.java
comments:
[AGGS] Pass current docid being processed to scripts.

Scripts may internally cache based on docid (as expressions do). This
change makes numeric aggregations using scripts pass the docid when
it changes.

time:
2014-07-15T19:28:03Z
class:
src/main/java/org/elasticsearch/cluster/metadata/MetaDataCreateIndexService.java
src/main/java/org/elasticsearch/common/xcontent/XContentBuilder.java
src/main/java/org/elasticsearch/common/xcontent/XContentParser.java
src/main/java/org/elasticsearch/gateway/local/state/shards/LocalGatewayShardsState.java
src/main/java/org/elasticsearch/search/SearchService.java
comments:
Releasable XContentBuilder
make the builder releasable (auto closeable), and use it in shards state
also make XContentParser releasable (AutoCloseable) and not closeable since it doesn't throw an IOException
closes #6869

time:
2014-07-15T19:24:52Z
class:
src/main/java/org/elasticsearch/index/analysis/NumericDateAnalyzer.java
src/main/java/org/elasticsearch/index/mapper/core/DateFieldMapper.java
src/test/java/org/elasticsearch/benchmark/mapping/ManyMappingsBenchmark.java
comments:
Share numeric data analyzer instances between mappings
use similar mechanism that shares numeric analyzers for long/double/... for dates as well. This has nice memory save properties with many date fields mapping case, as well as analysis saves (thread local resources)
closes #6843

time:
2014-07-15T18:18:13Z
class:
src/test/java/org/elasticsearch/script/expression/ExpressionScriptTests.java
comments:
Fix transient testScore failure by making DF consistent for query.

time:
2014-07-15T17:14:48Z
class:
src/main/java/org/elasticsearch/action/update/UpdateRequest.java
comments:
[FIX] normalize serialization of ScriptType in UpdateRequest

time:
2014-07-15T16:40:46Z
class:
src/main/java/org/elasticsearch/action/get/GetRequestBuilder.java
src/main/java/org/elasticsearch/cluster/metadata/MappingMetaData.java
src/main/java/org/elasticsearch/index/get/ShardGetService.java
src/main/java/org/elasticsearch/index/mapper/DocumentMapper.java
src/main/java/org/elasticsearch/index/mapper/DocumentMapperParser.java
src/main/java/org/elasticsearch/index/mapper/MapperService.java
src/main/java/org/elasticsearch/search/fetch/source/FetchSourceContext.java
src/test/java/org/elasticsearch/index/codec/CodecTests.java
src/test/java/org/elasticsearch/index/mapper/MapperTestUtils.java
src/test/java/org/elasticsearch/index/mapper/TransformOnIndexMapperIntegrationTest.java
src/test/java/org/elasticsearch/test/ElasticsearchSingleNodeTest.java
comments:
Mappings: Add transform to document before index.

Closes #6566
Please consider the opposite use case where transformed source nneds to be stored while the original indexed.
The use would be for soirce carrying payloads such as boost per fragment of text which would need to be stripped from stored source. On the other hand if analysis process itself did the stripping we qould not need this.

As discussed on the pull request, we want to store the original document in order to be able to reindex from source.


time:
2014-07-15T15:38:43Z
class:
comments:
Docs: explain that SerialMergeScheduler just maps to CMS for back compat

Closes #6878

time:
2014-07-15T15:26:52Z
class:
src/test/java/org/elasticsearch/test/ElasticsearchSingleNodeTest.java
comments:
[TEST] Enforce that the node from ElasticsearchSingleNodeTest is alone in its cluster.

In particular, this removes the ability to create new node and adds the ability
to get a reference to the single node that the cluster is made of.

time:
2014-07-15T15:19:18Z
class:
src/test/java/org/elasticsearch/indices/settings/UpdateSettingsTests.java
comments:
Test: make test less evil so it doesn't take so long

time:
2014-07-15T15:06:20Z
class:
src/test/java/org/elasticsearch/test/ElasticsearchSingleNodeTest.java
comments:
[TEST] Enforce provided settings in test base classes

Enviorment variables might override the tests settings even if
they are explicitly set. Other base classes like InternalTestCluster
also specify `config.ignore_system_properties: true` to ensure `what
we set is what we get`

time:
2014-07-15T14:49:01Z
class:
src/main/java/org/apache/lucene/expressions/XSimpleBindings.java
src/main/java/org/apache/lucene/expressions/js/XJavascriptCompiler.java
src/main/java/org/apache/lucene/expressions/js/XJavascriptLexer.java
src/main/java/org/apache/lucene/expressions/js/XJavascriptParser.java
src/main/java/org/apache/lucene/expressions/js/XVariableContext.java
src/main/java/org/elasticsearch/script/ScriptModule.java
src/main/java/org/elasticsearch/script/SearchScript.java
src/main/java/org/elasticsearch/script/expression/ExpressionScript.java
src/main/java/org/elasticsearch/script/expression/ExpressionScriptCompilationException.java
src/main/java/org/elasticsearch/script/expression/ExpressionScriptEngineService.java
src/main/java/org/elasticsearch/script/expression/ExpressionScriptExecutionException.java
src/main/java/org/elasticsearch/script/expression/FieldDataFunctionValues.java
src/main/java/org/elasticsearch/script/expression/FieldDataValueSource.java
src/main/java/org/elasticsearch/script/expression/ReplaceableConstValueSource.java
src/main/java/org/elasticsearch/search/lookup/DocLookup.java
src/test/java/org/elasticsearch/benchmark/scripts/expression/NativeScript1.java
src/test/java/org/elasticsearch/benchmark/scripts/expression/NativeScript2.java
src/test/java/org/elasticsearch/benchmark/scripts/expression/NativeScript3.java
src/test/java/org/elasticsearch/benchmark/scripts/expression/NativeScript4.java
src/test/java/org/elasticsearch/benchmark/scripts/expression/NativeScriptPlugin.java
src/test/java/org/elasticsearch/benchmark/scripts/expression/ScriptComparisonBenchmark.java
src/test/java/org/elasticsearch/script/expression/ExpressionScriptTests.java
comments:
Scripting: Add script engine for lucene expressions.

These are javascript expressions, which can only access numeric
fielddata, parameters, and _score. They can only be used for searches (not document updates).

closes #6818

time:
2014-07-15T14:16:50Z
class:
src/main/java/org/elasticsearch/Version.java
comments:
Added [1.4.0] version

time:
2014-07-15T13:42:58Z
class:
src/test/java/org/elasticsearch/index/aliases/IndexAliasesServiceTests.java
src/test/java/org/elasticsearch/index/query/IndexQueryParserFilterCachingTests.java
src/test/java/org/elasticsearch/index/query/SimpleIndexQueryParserTests.java
src/test/java/org/elasticsearch/index/similarity/SimilarityTests.java
src/test/java/org/elasticsearch/test/ElasticsearchSingleNodeTest.java
comments:
[TESTS] Add ElasticsearchSingleNodeTest.

This test makes it easy to create a lightweight node (no http, indices stored
in RAM, ...) whose main purpose is to get an instance of the Guice injector
for unit tests.

This should help not have to update lots of unit tests when we add a new
Guice dependency.

time:
2014-07-15T12:52:29Z
class:
src/main/java/org/elasticsearch/action/ActionRunnable.java
src/main/java/org/elasticsearch/action/update/TransportUpdateAction.java
src/test/java/org/elasticsearch/action/update/InternalEngineWithControllableTimingForTesting.java
src/test/java/org/elasticsearch/action/update/InternalEngineWithControllableTimingForTestingModule.java
src/test/java/org/elasticsearch/action/update/TransportUpdateActionTest.java
comments:
[UPDATE] Handle document missing exception on retry correctly.

Throwables thrown on update retries are now caught and handled via
the provided callback. This commit also contains an integration test
demonstrating the bug and validating the fix.

Closes #6355
Closes #6724

time:
2014-07-15T12:35:35Z
class:
src/main/java/org/elasticsearch/action/admin/cluster/health/TransportClusterHealthAction.java
src/main/java/org/elasticsearch/action/admin/cluster/node/hotthreads/TransportNodesHotThreadsAction.java
src/main/java/org/elasticsearch/action/admin/cluster/node/info/TransportNodesInfoAction.java
src/main/java/org/elasticsearch/action/admin/cluster/node/restart/TransportNodesRestartAction.java
src/main/java/org/elasticsearch/action/admin/cluster/node/shutdown/TransportNodesShutdownAction.java
src/main/java/org/elasticsearch/action/admin/cluster/node/stats/TransportNodesStatsAction.java
src/main/java/org/elasticsearch/action/admin/cluster/repositories/delete/TransportDeleteRepositoryAction.java
src/main/java/org/elasticsearch/action/admin/cluster/repositories/get/TransportGetRepositoriesAction.java
src/main/java/org/elasticsearch/action/admin/cluster/repositories/put/TransportPutRepositoryAction.java
src/main/java/org/elasticsearch/action/admin/cluster/reroute/TransportClusterRerouteAction.java
src/main/java/org/elasticsearch/action/admin/cluster/settings/TransportClusterUpdateSettingsAction.java
src/main/java/org/elasticsearch/action/admin/cluster/shards/TransportClusterSearchShardsAction.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/create/TransportCreateSnapshotAction.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/delete/TransportDeleteSnapshotAction.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/get/TransportGetSnapshotsAction.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/restore/TransportRestoreSnapshotAction.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/status/TransportNodesSnapshotsStatus.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/status/TransportSnapshotsStatusAction.java
src/main/java/org/elasticsearch/action/admin/cluster/state/TransportClusterStateAction.java
src/main/java/org/elasticsearch/action/admin/cluster/stats/TransportClusterStatsAction.java
src/main/java/org/elasticsearch/action/admin/cluster/tasks/TransportPendingClusterTasksAction.java
src/main/java/org/elasticsearch/action/admin/indices/alias/TransportIndicesAliasesAction.java
src/main/java/org/elasticsearch/action/admin/indices/alias/exists/TransportAliasesExistAction.java
src/main/java/org/elasticsearch/action/admin/indices/alias/get/TransportGetAliasesAction.java
src/main/java/org/elasticsearch/action/admin/indices/analyze/TransportAnalyzeAction.java
src/main/java/org/elasticsearch/action/admin/indices/cache/clear/TransportClearIndicesCacheAction.java
src/main/java/org/elasticsearch/action/admin/indices/close/TransportCloseIndexAction.java
src/main/java/org/elasticsearch/action/admin/indices/create/TransportCreateIndexAction.java
src/main/java/org/elasticsearch/action/admin/indices/delete/TransportDeleteIndexAction.java
src/main/java/org/elasticsearch/action/admin/indices/exists/indices/TransportIndicesExistsAction.java
src/main/java/org/elasticsearch/action/admin/indices/exists/types/TransportTypesExistsAction.java
src/main/java/org/elasticsearch/action/admin/indices/flush/TransportFlushAction.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/delete/TransportDeleteMappingAction.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/get/TransportGetFieldMappingsAction.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/get/TransportGetFieldMappingsIndexAction.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/get/TransportGetMappingsAction.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/put/TransportPutMappingAction.java
src/main/java/org/elasticsearch/action/admin/indices/open/TransportOpenIndexAction.java
src/main/java/org/elasticsearch/action/admin/indices/optimize/TransportOptimizeAction.java
src/main/java/org/elasticsearch/action/admin/indices/recovery/TransportRecoveryAction.java
src/main/java/org/elasticsearch/action/admin/indices/refresh/TransportRefreshAction.java
src/main/java/org/elasticsearch/action/admin/indices/segments/TransportIndicesSegmentsAction.java
src/main/java/org/elasticsearch/action/admin/indices/settings/get/TransportGetSettingsAction.java
src/main/java/org/elasticsearch/action/admin/indices/settings/put/TransportUpdateSettingsAction.java
src/main/java/org/elasticsearch/action/admin/indices/stats/TransportIndicesStatsAction.java
src/main/java/org/elasticsearch/action/admin/indices/template/delete/TransportDeleteIndexTemplateAction.java
src/main/java/org/elasticsearch/action/admin/indices/template/get/TransportGetIndexTemplatesAction.java
src/main/java/org/elasticsearch/action/admin/indices/template/put/TransportPutIndexTemplateAction.java
src/main/java/org/elasticsearch/action/admin/indices/validate/query/TransportValidateQueryAction.java
src/main/java/org/elasticsearch/action/admin/indices/warmer/delete/TransportDeleteWarmerAction.java
src/main/java/org/elasticsearch/action/admin/indices/warmer/get/TransportGetWarmersAction.java
src/main/java/org/elasticsearch/action/admin/indices/warmer/put/TransportPutWarmerAction.java
src/main/java/org/elasticsearch/action/bench/TransportAbortBenchmarkAction.java
src/main/java/org/elasticsearch/action/bench/TransportBenchmarkAction.java
src/main/java/org/elasticsearch/action/bench/TransportBenchmarkStatusAction.java
src/main/java/org/elasticsearch/action/bulk/TransportBulkAction.java
src/main/java/org/elasticsearch/action/bulk/TransportShardBulkAction.java
src/main/java/org/elasticsearch/action/count/TransportCountAction.java
src/main/java/org/elasticsearch/action/delete/TransportDeleteAction.java
src/main/java/org/elasticsearch/action/delete/index/TransportIndexDeleteAction.java
src/main/java/org/elasticsearch/action/delete/index/TransportShardDeleteAction.java
src/main/java/org/elasticsearch/action/deletebyquery/TransportDeleteByQueryAction.java
src/main/java/org/elasticsearch/action/deletebyquery/TransportIndexDeleteByQueryAction.java
src/main/java/org/elasticsearch/action/deletebyquery/TransportShardDeleteByQueryAction.java
src/main/java/org/elasticsearch/action/explain/TransportExplainAction.java
src/main/java/org/elasticsearch/action/get/TransportGetAction.java
src/main/java/org/elasticsearch/action/get/TransportMultiGetAction.java
src/main/java/org/elasticsearch/action/get/TransportShardMultiGetAction.java
src/main/java/org/elasticsearch/action/index/TransportIndexAction.java
src/main/java/org/elasticsearch/action/indexedscripts/delete/TransportDeleteIndexedScriptAction.java
src/main/java/org/elasticsearch/action/indexedscripts/get/TransportGetIndexedScriptAction.java
src/main/java/org/elasticsearch/action/indexedscripts/put/TransportPutIndexedScriptAction.java
src/main/java/org/elasticsearch/action/mlt/TransportMoreLikeThisAction.java
src/main/java/org/elasticsearch/action/percolate/TransportMultiPercolateAction.java
src/main/java/org/elasticsearch/action/percolate/TransportPercolateAction.java
src/main/java/org/elasticsearch/action/percolate/TransportShardMultiPercolateAction.java
src/main/java/org/elasticsearch/action/search/TransportClearScrollAction.java
src/main/java/org/elasticsearch/action/search/TransportMultiSearchAction.java
src/main/java/org/elasticsearch/action/search/TransportSearchAction.java
src/main/java/org/elasticsearch/action/search/TransportSearchScrollAction.java
src/main/java/org/elasticsearch/action/search/type/TransportSearchTypeAction.java
src/main/java/org/elasticsearch/action/suggest/TransportSuggestAction.java
src/main/java/org/elasticsearch/action/support/HandledTransportAction.java
src/main/java/org/elasticsearch/action/support/TransportAction.java
src/main/java/org/elasticsearch/action/support/broadcast/TransportBroadcastOperationAction.java
src/main/java/org/elasticsearch/action/support/master/TransportMasterNodeOperationAction.java
src/main/java/org/elasticsearch/action/support/master/TransportMasterNodeReadOperationAction.java
src/main/java/org/elasticsearch/action/support/master/info/TransportClusterInfoAction.java
src/main/java/org/elasticsearch/action/support/nodes/TransportNodesOperationAction.java
src/main/java/org/elasticsearch/action/support/replication/TransportIndexReplicationOperationAction.java
src/main/java/org/elasticsearch/action/support/replication/TransportIndicesReplicationOperationAction.java
src/main/java/org/elasticsearch/action/support/replication/TransportShardReplicationOperationAction.java
src/main/java/org/elasticsearch/action/support/single/custom/TransportSingleCustomOperationAction.java
src/main/java/org/elasticsearch/action/support/single/instance/TransportInstanceSingleOperationAction.java
src/main/java/org/elasticsearch/action/support/single/shard/TransportShardSingleOperationAction.java
src/main/java/org/elasticsearch/action/termvector/TransportMultiTermVectorsAction.java
src/main/java/org/elasticsearch/action/termvector/TransportSingleShardMultiTermsVectorAction.java
src/main/java/org/elasticsearch/action/termvector/TransportSingleShardTermVectorAction.java
src/main/java/org/elasticsearch/action/update/TransportUpdateAction.java
src/main/java/org/elasticsearch/cluster/action/index/MappingUpdatedAction.java
src/main/java/org/elasticsearch/gateway/local/state/meta/TransportNodesListGatewayMetaState.java
src/main/java/org/elasticsearch/gateway/local/state/shards/TransportNodesListGatewayStartedShards.java
src/main/java/org/elasticsearch/indices/store/TransportNodesListShardStoreMetaData.java
comments:
Internal: make transport action name available in TransportAction base class

Each transport action is associated with at least an action name, which is the action name that gets serialized together with the request and identifies what to do with the request itself. Also, the action name is the name of the registered transport handler that handles incoming request for the transport action.

This commit makes the action name available in a generic manner in the TransportAction base class, so that it can be used when needed by subclasses, or in the base class for instance for action filtering.

Closes #6860

time:
2014-07-15T12:32:30Z
class:
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
comments:
Core: don't close/reopen IndexWriter when changing RAM buffer size

Today we close/reopen IW when we change the RAM buffer but that's
costly because it means the next NRT reader is a full reopen.  The RAM
buffer size setting is a live one in IndexWriter, even if there are no
buffered docs in RAM when you call it.

Separately it would be nice if Lucene let you manage a "reader pool"
that could outlive individual IW instances ...

Closes #6856

time:
2014-07-15T10:44:35Z
class:
src/main/java/org/elasticsearch/common/lucene/index/FilterableTermsEnum.java
comments:
[SEARCH] Wrap filter only once in ApplyAcceptedDocsFilter

We potentially wrap the given filter multiple times when iterating the
subreaders. We only need to do this once.

Closes #6873

time:
2014-07-15T10:26:51Z
class:
src/test/java/org/elasticsearch/common/lucene/index/FreqTermsEnumTests.java
comments:
[TEST] Fix test to use keyword analyzer since it relies on exact terms without processing

time:
2014-07-15T10:13:45Z
class:
src/main/java/org/elasticsearch/action/update/UpdateRequest.java
comments:
Added missing version based serialization

time:
2014-07-15T09:49:39Z
class:
src/main/java/org/elasticsearch/action/update/UpdateRequestBuilder.java
src/main/java/org/elasticsearch/script/ScriptService.java
src/test/java/org/elasticsearch/cluster/NoMasterNodeTests.java
src/test/java/org/elasticsearch/document/BulkTests.java
src/test/java/org/elasticsearch/routing/AliasRoutingTests.java
src/test/java/org/elasticsearch/update/UpdateByNativeScriptTests.java
src/test/java/org/elasticsearch/update/UpdateTests.java
comments:
Indexed Scripts/Templates: cleanup

This commit cleans up some code around the indexed script/templates feature.
Remove dead code in ScriptService.
Remove setXScript methods for UpdateRequestBuilder and use setScript(script,type) instead

time:
2014-07-15T08:16:08Z
class:
src/main/java/org/elasticsearch/action/update/UpdateRequest.java
comments:
Add version check before reading script type in UpdateRequest

time:
2014-07-15T07:56:41Z
class:
src/test/java/org/elasticsearch/index/store/CorruptedFileTest.java
comments:
[TEST] use higher timeout to wait for balanced cluster

CorruptFileTest sometimes hits conditions where lots of rebalancing
happens. In such a case the default timeout is just not enough - this
timeout just makes sure that the cluster has enough time to balance
itself.

time:
2014-07-15T00:15:00Z
class:
src/test/java/org/elasticsearch/search/functionscore/RandomScoreFunctionTests.java
src/test/java/org/elasticsearch/search/simple/SimpleSearchTests.java
comments:
[TEST] fix random preference string tests to accomodate for the new more strict preference type

time:
2014-07-14T23:46:12Z
class:
src/main/java/org/elasticsearch/index/engine/SegmentsStats.java
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
src/main/java/org/elasticsearch/rest/action/cat/RestIndicesAction.java
src/main/java/org/elasticsearch/rest/action/cat/RestNodesAction.java
src/main/java/org/elasticsearch/rest/action/cat/RestShardsAction.java
src/test/java/org/elasticsearch/indices/stats/SimpleIndexStatsTests.java
comments:
Stats: Expose IndexWriter and VersionMap RAM usage to ShardStats and _cat endpoint

This commit adds the RAM usage of IndexWriter and VersionMap

Closes #6483

time:
2014-07-14T23:01:04Z
class:
src/test/java/org/elasticsearch/count/simple/SimpleCountTests.java
comments:
[TEST] fix random preference string test to accomodate for the new more strict preference type

time:
2014-07-14T21:12:51Z
class:
src/test/java/org/elasticsearch/search/suggest/SuggestSearchTests.java
comments:
[TEST] fix PhraseInIndex test bug for shard failure

time:
2014-07-14T20:07:52Z
class:
src/main/java/org/elasticsearch/cluster/routing/operation/plain/PlainOperationRouting.java
src/main/java/org/elasticsearch/cluster/routing/operation/plain/Preference.java
src/main/java/org/elasticsearch/index/query/BytesFilterBuilder.java
src/main/java/org/elasticsearch/index/query/FilterBuilders.java
src/main/java/org/elasticsearch/search/suggest/phrase/PhraseSuggestParser.java
src/main/java/org/elasticsearch/search/suggest/phrase/PhraseSuggester.java
src/main/java/org/elasticsearch/search/suggest/phrase/PhraseSuggestionBuilder.java
src/main/java/org/elasticsearch/search/suggest/phrase/PhraseSuggestionContext.java
src/test/java/org/elasticsearch/search/suggest/SuggestSearchTests.java
comments:
Phrase Suggester: Add collate option to PhraseSuggester

The newly added collate option will let the user provide a template query/filter which will be executed for every phrase suggestions generated to ensure that the suggestion matches at least one document for the filter/query.
The user can also add routing preference `preference` to route the collate query/filter and additional `params` to inject into the collate template.

Closes #3482

time:
2014-07-14T20:00:03Z
class:
src/test/java/org/elasticsearch/index/store/StoreTest.java
comments:
[TEST] close IW before listing directory content

time:
2014-07-14T18:25:35Z
class:
src/main/java/org/elasticsearch/common/settings/ImmutableSettings.java
src/main/java/org/elasticsearch/common/settings/Settings.java
src/test/java/org/elasticsearch/common/settings/ImmutableSettingsTests.java
comments:
Added more utility methods to Settings

- names() to return the direct settings names
- getAsSettings(String) to return the settings mapped to the given name (like getByPrefix(...) except no need to provide a tailing '.')

time:
2014-07-14T17:48:56Z
class:
src/test/java/org/elasticsearch/versioning/SimpleVersioningTests.java
comments:
Test: add diagnostics to get some details next time this test fails

time:
2014-07-14T16:06:23Z
class:
comments:
[TEST] Fix test relying on order of json for matching

time:
2014-07-14T15:51:17Z
class:
src/test/java/org/elasticsearch/script/IndexedScriptTests.java
comments:
[TEST] Fix test issues with branches still using mvel as default scripting language

time:
2014-07-14T15:17:24Z
class:
src/test/java/org/elasticsearch/script/IndexedScriptTests.java
src/test/java/org/elasticsearch/script/OnDiskScriptTests.java
comments:
[TEST] fix compile problems on Java 8

time:
2014-07-14T14:35:17Z
class:
comments:
Docs: Update query-string-syntax.asciidoc

Closes #6853

time:
2014-07-14T13:37:55Z
class:
src/main/java/org/elasticsearch/action/ActionModule.java
src/main/java/org/elasticsearch/action/get/GetResponse.java
src/main/java/org/elasticsearch/action/index/IndexRequest.java
src/main/java/org/elasticsearch/action/index/IndexRequestBuilder.java
src/main/java/org/elasticsearch/action/indexedscripts/delete/DeleteIndexedScriptAction.java
src/main/java/org/elasticsearch/action/indexedscripts/delete/DeleteIndexedScriptRequest.java
src/main/java/org/elasticsearch/action/indexedscripts/delete/DeleteIndexedScriptRequestBuilder.java
src/main/java/org/elasticsearch/action/indexedscripts/delete/DeleteIndexedScriptResponse.java
src/main/java/org/elasticsearch/action/indexedscripts/delete/TransportDeleteIndexedScriptAction.java
src/main/java/org/elasticsearch/action/indexedscripts/delete/package-info.java
src/main/java/org/elasticsearch/action/indexedscripts/get/GetIndexedScriptAction.java
src/main/java/org/elasticsearch/action/indexedscripts/get/GetIndexedScriptRequest.java
src/main/java/org/elasticsearch/action/indexedscripts/get/GetIndexedScriptRequestBuilder.java
src/main/java/org/elasticsearch/action/indexedscripts/get/GetIndexedScriptResponse.java
src/main/java/org/elasticsearch/action/indexedscripts/get/TransportGetIndexedScriptAction.java
src/main/java/org/elasticsearch/action/indexedscripts/get/package-info.java
src/main/java/org/elasticsearch/action/indexedscripts/put/PutIndexedScriptAction.java
src/main/java/org/elasticsearch/action/indexedscripts/put/PutIndexedScriptRequest.java
src/main/java/org/elasticsearch/action/indexedscripts/put/PutIndexedScriptRequestBuilder.java
src/main/java/org/elasticsearch/action/indexedscripts/put/PutIndexedScriptResponse.java
src/main/java/org/elasticsearch/action/indexedscripts/put/TransportPutIndexedScriptAction.java
src/main/java/org/elasticsearch/action/indexedscripts/put/package-info.java
src/main/java/org/elasticsearch/action/search/SearchRequest.java
src/main/java/org/elasticsearch/action/search/SearchRequestBuilder.java
src/main/java/org/elasticsearch/action/support/DelegatingActionListener.java
src/main/java/org/elasticsearch/action/support/HandledTransportAction.java
src/main/java/org/elasticsearch/action/update/UpdateHelper.java
src/main/java/org/elasticsearch/action/update/UpdateRequest.java
src/main/java/org/elasticsearch/action/update/UpdateRequestBuilder.java
src/main/java/org/elasticsearch/client/Client.java
src/main/java/org/elasticsearch/client/support/AbstractClient.java
src/main/java/org/elasticsearch/client/transport/support/InternalTransportClient.java
src/main/java/org/elasticsearch/common/Strings.java
src/main/java/org/elasticsearch/index/mapper/MapperService.java
src/main/java/org/elasticsearch/index/query/ScriptFilterParser.java
src/main/java/org/elasticsearch/index/query/TemplateQueryBuilder.java
src/main/java/org/elasticsearch/index/query/TemplateQueryParser.java
src/main/java/org/elasticsearch/index/query/functionscore/script/ScriptScoreFunctionParser.java
src/main/java/org/elasticsearch/rest/action/RestActionModule.java
src/main/java/org/elasticsearch/rest/action/index/RestIndexAction.java
src/main/java/org/elasticsearch/rest/action/script/RestDeleteIndexedScriptAction.java
src/main/java/org/elasticsearch/rest/action/script/RestGetIndexedScriptAction.java
src/main/java/org/elasticsearch/rest/action/script/RestPutIndexedScriptAction.java
src/main/java/org/elasticsearch/rest/action/template/RestDeleteSearchTemplateAction.java
src/main/java/org/elasticsearch/rest/action/template/RestGetSearchTemplateAction.java
src/main/java/org/elasticsearch/rest/action/template/RestPutSearchTemplateAction.java
src/main/java/org/elasticsearch/rest/action/update/RestUpdateAction.java
src/main/java/org/elasticsearch/script/ScriptService.java
src/main/java/org/elasticsearch/script/SearchScript.java
src/main/java/org/elasticsearch/search/SearchService.java
src/main/java/org/elasticsearch/search/aggregations/support/ValuesSourceParser.java
src/main/java/org/elasticsearch/search/facet/datehistogram/DateHistogramFacetParser.java
src/main/java/org/elasticsearch/search/facet/geodistance/GeoDistanceFacetParser.java
src/main/java/org/elasticsearch/search/facet/geodistance/ScriptGeoDistanceFacetExecutor.java
src/main/java/org/elasticsearch/search/facet/histogram/HistogramFacetParser.java
src/main/java/org/elasticsearch/search/facet/histogram/ScriptHistogramFacetExecutor.java
src/main/java/org/elasticsearch/search/facet/histogram/ValueScriptHistogramFacetExecutor.java
src/main/java/org/elasticsearch/search/facet/range/RangeFacetParser.java
src/main/java/org/elasticsearch/search/facet/range/ScriptRangeFacetExecutor.java
src/main/java/org/elasticsearch/search/facet/statistical/ScriptStatisticalFacetExecutor.java
src/main/java/org/elasticsearch/search/facet/statistical/StatisticalFacetParser.java
src/main/java/org/elasticsearch/search/facet/terms/TermsFacetParser.java
src/main/java/org/elasticsearch/search/facet/terms/strings/ScriptTermsStringFieldFacetExecutor.java
src/main/java/org/elasticsearch/search/facet/termsstats/TermsStatsFacetParser.java
src/main/java/org/elasticsearch/search/fetch/script/ScriptFieldsParseElement.java
src/main/java/org/elasticsearch/search/internal/ShardSearchRequest.java
src/main/java/org/elasticsearch/search/sort/ScriptSortParser.java
src/test/java/org/elasticsearch/action/index/IndexRequestTests.java
src/test/java/org/elasticsearch/cluster/NoMasterNodeTests.java
src/test/java/org/elasticsearch/document/BulkTests.java
src/test/java/org/elasticsearch/index/query/TemplateQueryParserTest.java
src/test/java/org/elasticsearch/index/query/TemplateQueryTest.java
src/test/java/org/elasticsearch/routing/AliasRoutingTests.java
src/test/java/org/elasticsearch/script/IndexedScriptTests.java
src/test/java/org/elasticsearch/script/NativeScriptTests.java
src/test/java/org/elasticsearch/script/OnDiskScriptTests.java
src/test/java/org/elasticsearch/update/UpdateByNativeScriptTests.java
src/test/java/org/elasticsearch/update/UpdateTests.java
comments:
Indexed Scripts/Templates: Add support for storing/deleting/getting scripts/template from an index.

This change allow elasticsearch users to store scripts and templates in an index for use at search time.
Scripts/Templates are stored in the .scripts index. The type of the events is set to the script language.
Templates use the mustache language so their type is be "mustache".
Adds the concept of a script type to calls to the ScriptService types are INDEXED,INLINE,FILE.
If a script type of INDEXED is supplied the script will be attempted to be loaded from the indexed, FILE will
look in the file cache and INLINE will treat the supplied script argument as the literal script.
REST endpoints are provided to do CRUD operations as is a java client library.
All query dsl points have been upgraded to allow passing in of explicit script ids and script file names.
Backwards compatible behavior has been preserved so this shouldn't break any existing querys that expect to
pass in a filename as the script/template name. The ScriptService will check the disk cache before parsing the
script.

Closes #5921 #5637 #5484
hey @GaelTadh is this constant used anywhere?

Hi @GaelTadh, I think this try catch is not needed, these errors are handled in the super class (`TransportAction`), right?


time:
2014-07-14T13:13:52Z
class:
src/test/java/org/elasticsearch/gateway/local/SimpleRecoveryLocalGatewayTests.java
comments:
[Test] testSingleNodeWithFlush should wait for yellow

O.w. it can restart a node before all primaries are started , leading to a red state down the road...

time:
2014-07-14T12:37:29Z
class:
src/main/java/org/elasticsearch/index/store/fs/FsDirectoryService.java
src/test/java/org/elasticsearch/indices/settings/UpdateSettingsTests.java
src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java
src/test/java/org/elasticsearch/test/store/MockFSDirectoryService.java
comments:
Test: add test case verifying updating merge IO throttle settings works

Closes #6842

time:
2014-07-14T10:52:45Z
class:
src/test/java/org/elasticsearch/test/transport/MockTransportService.java
comments:
[TEST] For connection rules make TransportAddress the identity instead of DiscoveryNode.

For unicast ping the DiscoveryNode identity is based on its id, which in that stage is a dummy value, this breaks any rule in the mock tran
However the TransportAddress is a valid value in unicast ping and all other places, so that is a better alternative.

Closes #6836

time:
2014-07-14T10:13:32Z
class:
src/main/java/org/elasticsearch/index/analysis/HunspellTokenFilterFactory.java
src/main/java/org/elasticsearch/indices/analysis/HunspellService.java
src/test/java/org/elasticsearch/indices/analyze/HunspellServiceTests.java
comments:
Analysis: Improve Hunspell error messages

The Hunspell service would throw a confusing error message if more than
one affix file was present.  This commit distinguishes between the two
error cases: where there are no affix files and when there are too many
affix files.

Also implements lazy dictionary loading, which was used in the tests
but not implemented.

Closes #6850

time:
2014-07-14T09:00:50Z
class:
src/main/java/org/elasticsearch/common/ParseField.java
src/main/java/org/elasticsearch/search/SearchModule.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/GlobalOrdinalsSignificantTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/InternalSignificantTerms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantLongTerms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantLongTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantStringTerms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantStringTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantTermsAggregatorFactory.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantTermsBuilder.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantTermsParametersParser.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantTermsParser.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/UnmappedSignificantTerms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/heuristics/JLHScore.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/heuristics/MutualInformation.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/heuristics/SignificanceHeuristic.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/heuristics/SignificanceHeuristicBuilder.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/heuristics/SignificanceHeuristicParser.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/heuristics/SignificanceHeuristicParserMapper.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/heuristics/SignificanceHeuristicStreams.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/heuristics/SignificantTermsHeuristicModule.java
src/test/java/org/elasticsearch/search/aggregations/bucket/SignificantTermsBackwardCompatibilityTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/SignificantTermsSignificanceScoreTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/SignificantTermsTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/significant/SignificanceHeuristicTests.java
comments:
significant terms: infrastructure for changing easily the significance heuristic

This commit adds the infrastructure to allow pluging in different
measures for computing the significance of a term.
Significance measures can be provided externally by overriding

- SignificanceHeuristic
- SignificanceHeuristicBuilder
- SignificanceHeuristicParser

closes #6561

time:
2014-07-14T08:52:29Z
class:
src/main/java/org/elasticsearch/transport/TransportService.java
comments:
[Transport] possible NPE during shutdown for requests using timeouts

Closes #6849

time:
2014-07-14T08:14:58Z
class:
src/main/java/org/elasticsearch/common/lucene/Lucene.java
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
comments:
[ENGINE] Mark store as corrupted before sending failed shard

We have to mark a shard as corrupted if necessary before the
shard failed event is fired ie. before we call the corresponding
listener in the engine. Otherwise the shard might be re-allocated
on the same node and just started up without being marked as corrupted.

Relates to #5924

time:
2014-07-14T07:18:25Z
class:
src/main/java/org/elasticsearch/index/store/Store.java
src/main/java/org/elasticsearch/indices/recovery/RecoveryTarget.java
comments:
[RECOVERY] Increment Store refcount on RecoveryTarget

We should make sure we have incremented the store refcount
before we start the recovery on the recovyer target.

Closes #6844

time:
2014-07-13T15:59:45Z
class:
src/test/java/org/elasticsearch/cluster/ClusterServiceTests.java
comments:
[Test] one more tweak to testLocalNodeMasterListenerCallbacks

time:
2014-07-13T15:51:01Z
class:
src/test/java/org/elasticsearch/cluster/ClusterServiceTests.java
comments:
[Test] renamed testListenerCallbacks to testLocalNodeMasterListenerCallbacks

Also clean up internal variable namings and fixed usage of wrong setting causing last node to not use the min_master_node settings.

time:
2014-07-13T13:53:05Z
class:
src/main/java/org/elasticsearch/cluster/action/shard/ShardStateAction.java
comments:
Core: Added missing return statements.

Closes #6841

time:
2014-07-13T08:52:41Z
class:
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/restore/RestoreSnapshotRequest.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/restore/RestoreSnapshotRequestBuilder.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/restore/TransportRestoreSnapshotAction.java
src/main/java/org/elasticsearch/cluster/metadata/IndexMetaData.java
src/main/java/org/elasticsearch/snapshots/RestoreService.java
src/test/java/org/elasticsearch/snapshots/SharedClusterSnapshotRestoreTests.java
src/test/java/org/elasticsearch/test/hamcrest/ElasticsearchAssertions.java
comments:
Snapshot/Restore: Add ability to restore indices without their aliases

Closes #6457

time:
2014-07-13T08:21:26Z
class:
src/test/java/org/elasticsearch/indices/IndicesOptionsIntegrationTests.java
comments:
[TEST] wait for green before deleting mapping

time:
2014-07-13T08:17:14Z
class:
src/test/java/org/elasticsearch/indices/IndicesOptionsIntegrationTests.java
comments:
[TEST] wait for green before deleting mapping

time:
2014-07-12T07:11:27Z
class:
src/test/java/org/elasticsearch/transport/AbstractSimpleTransportTests.java
comments:
[Test] testHostOnMessages - only decrease latch after setting transport addresses

time:
2014-07-11T16:35:36Z
class:
comments:
Docs: Fixed invalid word count in geodistance agg doc

Closes #6838

time:
2014-07-11T15:51:35Z
class:
src/test/java/org/elasticsearch/cluster/ClusterServiceTests.java
comments:
[TEST] Ensure that one node is part of the cluster.

time:
2014-07-11T15:42:11Z
class:
src/main/java/org/elasticsearch/discovery/zen/ZenDiscovery.java
comments:
Print trace log if not enough master nodes could be found.

time:
2014-07-11T14:41:01Z
class:
src/main/java/org/elasticsearch/common/transport/DummyTransportAddress.java
src/main/java/org/elasticsearch/common/transport/InetSocketTransportAddress.java
src/main/java/org/elasticsearch/common/transport/LocalTransportAddress.java
src/main/java/org/elasticsearch/common/transport/TransportAddress.java
src/main/java/org/elasticsearch/transport/TransportMessage.java
src/main/java/org/elasticsearch/transport/TransportRequest.java
src/main/java/org/elasticsearch/transport/TransportResponse.java
src/main/java/org/elasticsearch/transport/local/LocalTransport.java
src/main/java/org/elasticsearch/transport/netty/MessageChannelHandler.java
src/test/java/org/elasticsearch/transport/AbstractSimpleTransportTests.java
src/test/java/org/elasticsearch/transport/local/SimpleLocalTransportTests.java
comments:
Cleanup of the transport request/response messages

Now both TransportRequest and TransportResponse inherit from a base TransportMessage that holds the message headers and also now added the remote transport address (where this message came from).

time:
2014-07-11T14:37:52Z
class:
src/main/java/org/elasticsearch/transport/local/LocalTransport.java
src/test/java/org/elasticsearch/discovery/ZenUnicastDiscoveryTests.java
src/test/java/org/elasticsearch/discovery/ZenUnicastDiscoveryTestsMinimumMasterNodes.java
src/test/java/org/elasticsearch/discovery/ZenUnicastDiscoveryTestsSpecificNodes.java
comments:
[Tests] Enhance ZenUnicastDiscoveryTest

This started out as a simple correction to a missing setting problem, but go bigger into more general work on the ZenUnicastDiscoveryTets suite. It now works with both network and local mode. I also merge the different ZenUnicast test suites into a single place.

Closes #6835

time:
2014-07-11T12:26:08Z
class:
comments:
Docs: remove orphan comma

time:
2014-07-11T11:57:11Z
class:
src/main/java/org/elasticsearch/index/query/functionscore/FunctionScoreQueryBuilder.java
src/main/java/org/elasticsearch/index/query/functionscore/FunctionScoreQueryParser.java
src/test/java/org/elasticsearch/search/functionscore/DecayFunctionScoreTests.java
comments:
Throw exception if function in function score query is null

closes #6292 #6784

time:
2014-07-11T11:00:57Z
class:
comments:
Docs: fix merge docs to match the code (the max_thread_count default is 'aggressive' (favor SSDs))

time:
2014-07-11T09:38:36Z
class:
src/main/java/org/elasticsearch/action/admin/indices/recovery/TransportRecoveryAction.java
src/main/java/org/elasticsearch/indices/cluster/IndicesClusterStateService.java
src/main/java/org/elasticsearch/indices/recovery/RecoveryTarget.java
comments:
Only use IndexShard instance to lookup recovery status
make sure we use the instance itself to look it up, and not the shard id, as we might get another instance
leftover from #6825

time:
2014-07-11T09:28:45Z
class:
src/main/java/org/elasticsearch/gateway/GatewayService.java
src/test/java/org/elasticsearch/gateway/GatewayServiceTests.java
src/test/java/org/elasticsearch/test/cluster/NoopClusterService.java
comments:
[Gateway] set a default of 5m to `recover_after_time` when any to the `expected*Nodes` is set

The `recovery_after_time` tells the gateway to wait before starting recovery from disk. The goal here is to allow for more nodes to join the cluster and thus not start potentially unneeded replications. The `expectedNodes` setting (and friends) tells the gateway when it can start recovering even if the `recover_after_time` has not yet elapsed. However, `expectedNodes` is useless if one doesn't set `recovery_after_time`. This commit changes that by setting a sensible default of 5m for `recover_after_time` *if* a `expectedNodes` setting is present.

Closes #6742

time:
2014-07-11T09:14:31Z
class:
src/main/java/org/elasticsearch/common/lucene/search/MoreLikeThisQuery.java
src/main/java/org/elasticsearch/common/lucene/search/XMoreLikeThis.java
src/test/java/org/elasticsearch/mlt/XMoreLikeThisTests.java
comments:
More Like This: ensures selection of best terms is indeed O(n)

Previously the size of the priority queue was wrongly set to the total number
of terms. Instead, it should be set to 'maxQueryTerms'. This makes the
selection of best terms O(n), instead of O(n*log(n)).

Jira patch: https://issues.apache.org/jira/browse/LUCENE-5795

Closes #6657

time:
2014-07-11T08:51:59Z
class:
src/main/java/org/elasticsearch/cluster/routing/RoutingNodes.java
src/main/java/org/elasticsearch/cluster/routing/allocation/AllocationService.java
src/main/java/org/elasticsearch/indices/cluster/IndicesClusterStateService.java
src/main/java/org/elasticsearch/indices/recovery/RecoveryStatus.java
src/main/java/org/elasticsearch/indices/recovery/RecoveryTarget.java
src/test/java/org/elasticsearch/cluster/routing/allocation/FailedShardsRoutingTests.java
comments:
Improve handling of failed primary replica handling
Out of #6808, we improved the handling of a primary failing to make sure replicas that are initializing are properly failed as well. After double checking it, it has 2 problems, the first, if the same shard routing is failed again, there is no protection that we don't apply the failure (which we do in failed shard cases), and the other was that we already tried to handle it (wrongly) in the elect primary method.
This change fixes the handling to work correctly in the elect primary method, and adds unit tests to verify the behavior
The change also expose a problem in our handling of replica shards that stay initializing during primary failure and electing another replica shard as primary, where we need to cancel its ongoing recovery to make sure it re-starts from the new elected primary
closes #6825

time:
2014-07-11T08:22:11Z
class:
src/test/java/org/elasticsearch/index/store/CorruptedFileTest.java
comments:
[TEST] Fix CorruptedFileTest to always corrupt the latest delete generation if a .del file is picked

time:
2014-07-11T06:41:38Z
class:
src/test/java/org/elasticsearch/index/store/CorruptedFileTest.java
comments:
[TEST] Temporarily don't corrupt .del files since they are generational and we might pick the wrong one

time:
2014-07-11T06:30:46Z
class:
src/test/java/org/elasticsearch/index/store/CorruptedFileTest.java
comments:
[Test] testCorruptionOnNetworkLayer had a typo in test name.

time:
2014-07-10T19:30:15Z
class:
src/main/java/org/elasticsearch/cluster/routing/RoutingNodes.java
src/main/java/org/elasticsearch/cluster/routing/allocation/AllocationService.java
src/test/java/org/elasticsearch/cluster/routing/allocation/FailedShardsRoutingTests.java
comments:
Revert "Improve handling of failed primary replica handling"

This reverts commit 75ed24f6b6a96ac268f7b085550020252d94d908.

time:
2014-07-10T16:49:05Z
class:
src/main/java/org/elasticsearch/action/support/replication/TransportShardReplicationOperationAction.java
src/test/java/org/elasticsearch/index/TransportIndexFailuresTest.java
src/test/java/org/elasticsearch/test/transport/MockTransportService.java
comments:
Do not ignore ConnectTransportException for shard replication operations

A ConnectTransportException should fail the replica shard

Closes #6183

time:
2014-07-10T16:30:18Z
class:
src/main/java/org/elasticsearch/cluster/routing/RoutingNodes.java
src/main/java/org/elasticsearch/cluster/routing/allocation/AllocationService.java
src/test/java/org/elasticsearch/cluster/routing/allocation/FailedShardsRoutingTests.java
comments:
Improve handling of failed primary replica handling
Out of #6808, we improved the handling of a primary failing to make sure replicas that are initializing are properly failed as well. After double checking it, it has 2 problems, the first, if the same shard routing is failed again, there is no protection that we don't apply the failure (which we do in failed shard cases), and the other was that we already tried to handle it (wrongly) in the elect primary method.
This change fixes the handling to work correctly in the elect primary method, and adds unit tests to verify the behavior
closes #6816

time:
2014-07-10T16:02:10Z
class:
src/test/java/org/elasticsearch/action/suggest/SuggestActionTests.java
src/test/java/org/elasticsearch/search/suggest/SuggestSearchTests.java
comments:
[TEST] Fold SuggestActionTest into SuggestSearchTests

Instead of running the tests twice this commit just randomizes the API
that we use to return the suggestions.

time:
2014-07-10T15:38:09Z
class:
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/DateHistogramBuilder.java
src/test/java/org/elasticsearch/search/aggregations/bucket/DateHistogramTests.java
comments:
Aggregations: DateHistogramBuilder accepts String preOffset and postOffset

This is what DateHistogramParser expects so will enable the builder to build valid requests using these variables.
Also added tests for preOffset and postOffset since these tests did not exist

Closes #5586

time:
2014-07-10T15:25:47Z
class:
src/main/java/org/elasticsearch/index/store/Store.java
comments:
[STORE] Treat reading past EOF as an corrupted index when we fail to read segment infos

time:
2014-07-10T14:52:51Z
class:
src/test/java/org/elasticsearch/index/store/CorruptedFileTest.java
comments:
[TEST] Wait for longer on slow nodes until replicating has kicked in

time:
2014-07-10T14:45:16Z
class:
src/test/java/org/elasticsearch/test/CompositeTestCluster.java
src/test/java/org/elasticsearch/test/ElasticsearchBackwardsCompatIntegrationTest.java
src/test/java/org/elasticsearch/test/ExternalNode.java
comments:
[TEST] added ability to provide settings for external nodes in backwards compatibility tests

Closes #6809

time:
2014-07-10T14:24:01Z
class:
src/test/java/org/elasticsearch/test/CompositeTestCluster.java
comments:
[TEST] Do RollingUpgrade in BWC tests

time:
2014-07-10T14:06:38Z
class:
src/test/java/org/elasticsearch/action/bulk/BulkProcessorTests.java
src/test/java/org/elasticsearch/tribe/TribeTests.java
comments:
[TEST] Close TransportClient after it's used in BulkProcessorTests otherwise it will leave threads behind

time:
2014-07-10T13:28:38Z
class:
src/test/java/org/elasticsearch/common/logging/LoggingConfigurationTests.java
comments:
[TEST] Subclass ElasticsearchTestCase in LoggingConfigurationTests

time:
2014-07-10T13:04:00Z
class:
src/main/java/org/apache/lucene/store/BufferedChecksumIndexOutput.java
src/main/java/org/apache/lucene/store/BufferedIndexOutput.java
src/main/java/org/elasticsearch/ExceptionsHelper.java
src/main/java/org/elasticsearch/cluster/routing/RoutingNodes.java
src/main/java/org/elasticsearch/cluster/routing/allocation/AllocationService.java
src/main/java/org/elasticsearch/cluster/routing/allocation/decider/ThrottlingAllocationDecider.java
src/main/java/org/elasticsearch/common/lucene/Lucene.java
src/main/java/org/elasticsearch/gateway/local/LocalGatewayAllocator.java
src/main/java/org/elasticsearch/index/engine/Engine.java
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
src/main/java/org/elasticsearch/index/gateway/local/LocalIndexShardGateway.java
src/main/java/org/elasticsearch/index/merge/policy/LogDocMergePolicyProvider.java
src/main/java/org/elasticsearch/index/shard/service/InternalIndexShard.java
src/main/java/org/elasticsearch/index/snapshots/blobstore/BlobStoreIndexShardRepository.java
src/main/java/org/elasticsearch/index/snapshots/blobstore/BlobStoreIndexShardSnapshot.java
src/main/java/org/elasticsearch/index/store/DistributorDirectory.java
src/main/java/org/elasticsearch/index/store/Store.java
src/main/java/org/elasticsearch/index/store/StoreFileMetaData.java
src/main/java/org/elasticsearch/index/store/StoreModule.java
src/main/java/org/elasticsearch/index/store/ram/RamDirectoryService.java
src/main/java/org/elasticsearch/indices/cluster/IndicesClusterStateService.java
src/main/java/org/elasticsearch/indices/recovery/RecoveryFileChunkRequest.java
src/main/java/org/elasticsearch/indices/recovery/RecoverySource.java
src/main/java/org/elasticsearch/indices/recovery/RecoveryState.java
src/main/java/org/elasticsearch/indices/recovery/RecoveryStatus.java
src/main/java/org/elasticsearch/indices/recovery/RecoveryTarget.java
src/main/java/org/elasticsearch/indices/store/TransportNodesListShardStoreMetaData.java
src/main/java/org/elasticsearch/rest/action/cat/RestRecoveryAction.java
src/test/java/org/elasticsearch/bwcompat/BasicBackwardsCompatibilityTest.java
src/test/java/org/elasticsearch/gateway/local/RecoveryBackwardsCompatibilityTests.java
src/test/java/org/elasticsearch/gateway/local/SimpleRecoveryLocalGatewayTests.java
src/test/java/org/elasticsearch/index/engine/EngineSearcherTotalHitsMatcher.java
src/test/java/org/elasticsearch/index/engine/internal/InternalEngineTests.java
src/test/java/org/elasticsearch/index/store/CorruptedFileTest.java
src/test/java/org/elasticsearch/index/store/DistributorDirectoryTest.java
src/test/java/org/elasticsearch/index/store/StoreTest.java
src/test/java/org/elasticsearch/indices/recovery/RecoveryStateTest.java
src/test/java/org/elasticsearch/snapshots/SharedClusterSnapshotRestoreTests.java
src/test/java/org/elasticsearch/test/CompositeTestCluster.java
src/test/java/org/elasticsearch/test/ElasticsearchBackwardsCompatIntegrationTest.java
src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java
src/test/java/org/elasticsearch/test/ElasticsearchLuceneTestCase.java
src/test/java/org/elasticsearch/test/ExternalNode.java
src/test/java/org/elasticsearch/test/hamcrest/ElasticsearchAssertions.java
src/test/java/org/elasticsearch/test/store/MockDirectoryHelper.java
src/test/java/org/elasticsearch/test/store/MockFSDirectoryService.java
src/test/java/org/elasticsearch/test/transport/MockTransportService.java
comments:
[STORE]: Make use of Lucene build-in checksums

Since Lucene version 4.8 each file has a checksum written as it's
footer. We used to calculate the checksums for all files transparently
on the filesystem layer (Directory / Store) which is now not necessary
anymore. This commit makes use of the new checksums in a backwards
compatible way such that files written with the old checksum mechanism
are still compared against the corresponding Alder32 checksum while
newer files are compared against the Lucene build in CRC32 checksum.

Since now every written file is checksummed by default this commit
also verifies the checksum for files during recovery and restore if
applicable.

Closes #5924

This commit also has a fix for #6808 since the added tests in
`CorruptedFileTest.java` exposed the issue.

Closes #6808

time:
2014-07-10T12:49:52Z
class:
src/main/java/org/elasticsearch/cluster/service/InternalClusterService.java
src/main/java/org/elasticsearch/common/component/LifecycleListener.java
src/main/java/org/elasticsearch/discovery/DiscoveryService.java
src/main/java/org/elasticsearch/node/internal/InternalNode.java
src/main/java/org/elasticsearch/tribe/TribeService.java
src/test/java/org/elasticsearch/cluster/MinimumMasterNodesTests.java
comments:
Add local node to cluster state
Today, the tribe node needs the local node so it adds it when it starts, but other APIs would benefit from adding the local node, also, adding the local node should be done in a cleaner manner, where it belongs, which is right after the discovery service starts in the cluster service
closes #6811

time:
2014-07-10T12:04:26Z
class:
comments:
Docs: Update plugins.asciidoc to fix typo

Changed the name of the European Environment Agency (from European Environmental Agency)

Closes #6807

time:
2014-07-10T09:54:24Z
class:
src/test/java/org/elasticsearch/gateway/local/SimpleRecoveryLocalGatewayTests.java
comments:
[TEST] Wait for primary allocations before restart

This commit ensures that all primaries are allocated before we
restart the node. If one primary is in post recovery when we
restart it will not be allocated otherwise.

time:
2014-07-10T09:21:27Z
class:
comments:
[DOC] Added comprehensive documentation for the Ruby and Rails integrations

time:
2014-07-10T06:47:18Z
class:
comments:
[DOCS] Fix typo in reference

time:
2014-07-10T05:48:12Z
class:
src/test/java/org/elasticsearch/test/ElasticsearchTokenStreamTestCase.java
comments:
[TEST] SuppressSysoutChecks on ElasticsearchTokenStreamTestCase

time:
2014-07-09T22:50:11Z
class:
src/test/java/org/elasticsearch/plugin/PluginManagerTests.java
comments:
added a fix to the PluginManagerTests to create config & bin dirs if they don't exist

time:
2014-07-09T22:14:52Z
class:
src/main/java/org/elasticsearch/node/internal/InternalNode.java
comments:
[ENV] Release node env if initialization fails

If the node initialisation fails, make sure the
node environment is closed correctly and thus
all locks (on data directories) being properly released.

Closes #6715

time:
2014-07-09T22:01:43Z
class:
src/main/java/org/apache/lucene/store/RateLimitedFSDirectory.java
src/main/java/org/apache/lucene/store/StoreUtils.java
src/main/java/org/elasticsearch/index/store/DirectoryUtils.java
src/main/java/org/elasticsearch/index/store/IndexStoreModule.java
src/main/java/org/elasticsearch/index/store/fs/DefaultFsDirectoryService.java
src/main/java/org/elasticsearch/index/store/fs/DefaultFsIndexStore.java
src/main/java/org/elasticsearch/index/store/fs/DefaultFsIndexStoreModule.java
src/main/java/org/elasticsearch/index/store/fs/FsDirectoryService.java
src/main/java/org/elasticsearch/index/store/fs/MmapFsDirectoryService.java
src/main/java/org/elasticsearch/index/store/fs/NioFsDirectoryService.java
src/main/java/org/elasticsearch/index/store/fs/SimpleFsDirectoryService.java
src/test/java/org/elasticsearch/index/store/DirectoryUtilsTest.java
src/test/java/org/elasticsearch/indices/store/SimpleDistributorTests.java
src/test/java/org/elasticsearch/test/store/MockDirectoryHelper.java
src/test/java/org/elasticsearch/test/store/MockFSDirectoryService.java
comments:
[STORE] Make a hybrid directory default using `mmapfs` and `niofs`

`mmapfs` is really good for random access but can have sideeffects if
memory maps are large depending on the operating system etc. A hybrid
solution where only selected files are actually memory mapped but others
mostly consumed sequentially brings the best of both worlds and
minimizes the memory map impact.
This commit mmaps only the `dvd` and `tim` file for fast random access
on docvalues and term dictionaries.

Closes #6636

time:
2014-07-09T22:00:41Z
class:
src/test/java/org/elasticsearch/plugin/PluginManagerTests.java
comments:
[TEST] Mute PluginManagerTests#testLocalPluginInstallWithBinAndConfig

time:
2014-07-09T21:24:31Z
class:
src/test/java/org/elasticsearch/index/codec/postingformat/ElasticsearchPostingsFormatTest.java
comments:
[TEST] SuppressSysoutChecks on ElasticsearchPostingsFormatTest

time:
2014-07-09T21:05:12Z
class:
src/main/java/org/elasticsearch/plugins/PluginManager.java
comments:
Added a check on moving bin & config plugin dirs

Plugins can contain bin & config sub-dirs that are copied to es's bin & config directories. If moving these directories fails we now throw an error.

time:
2014-07-09T21:03:06Z
class:
src/test/java/org/elasticsearch/cluster/SimpleClusterStateTests.java
comments:
[TEST] relax size test, to not run into OOM

time:
2014-07-09T20:19:06Z
class:
src/test/java/org/elasticsearch/search/suggest/CompletionSuggestSearchTests.java
comments:
[TEST] make completion tests more resilient to delayed mapping
especially the tests that check for update of mapping, we need to make sure that the cluster is green so mappings won't get override, also, put mapping during index creation when possible

time:
2014-07-09T19:46:21Z
class:
src/main/java/org/elasticsearch/common/logging/log4j/Log4jESLogger.java
src/main/java/org/elasticsearch/common/logging/log4j/LogConfigurator.java
src/main/java/org/elasticsearch/plugins/PluginManager.java
src/test/java/org/elasticsearch/common/logging/LoggingConfigurationTests.java
src/test/java/org/elasticsearch/plugin/PluginManagerTests.java
comments:
Enables plugins to define default logging configuration for their needs.

- adds support for multiple logging configurations under the config dir (will pick up any logging.xxx in the config folder tree)
- plugins can now define a top level config directory that will be copied under es config dir and will be renamed after the plugin name (same as the support we have the plugin "bin" dirs)

 Closes #6802

time:
2014-07-09T19:40:15Z
class:
src/main/java/org/elasticsearch/cluster/metadata/MappingMetaData.java
src/main/java/org/elasticsearch/common/netty/NettyUtils.java
src/main/java/org/elasticsearch/http/netty/NettyHttpServerTransport.java
src/main/java/org/elasticsearch/transport/netty/NettyTransport.java
src/test/java/org/elasticsearch/cluster/SimpleClusterStateTests.java
src/test/java/org/elasticsearch/cluster/metadata/MappingMetaDataParserTests.java
comments:
Improve large bytes request handling by detecting content composite buffer
There is a special type of request that tries to not allocate another buffer when sending bytes request (used by the public cluster state action). With the new pages bytes reference support, the content can already be a composite channel buffer, take that into account when building the actual composite buffer that will be sent over the network
closes #6756

time:
2014-07-09T19:17:17Z
class:
src/main/java/org/elasticsearch/rest/RestController.java
src/test/java/org/elasticsearch/options/jsonp/JsonpOptionDisabledTest.java
src/test/java/org/elasticsearch/options/jsonp/JsonpOptionEnabledTest.java
comments:
Disable JSONP by default
By default, disable the option to use JSONP in our REST layer
closes #6795

time:
2014-07-09T19:16:23Z
class:
src/test/java/org/elasticsearch/action/bulk/BulkIntegrationTests.java
src/test/java/org/elasticsearch/cluster/NoMasterNodeTests.java
src/test/java/org/elasticsearch/common/util/concurrent/EsExecutorsTests.java
src/test/java/org/elasticsearch/index/fielddata/DisabledFieldDataFormatTests.java
src/test/java/org/elasticsearch/indices/mapping/SimpleDeleteMappingTests.java
comments:
[TEST] move more tests to assertBusy from awaitBusy

time:
2014-07-09T16:15:13Z
class:
comments:
Modify command window title (windows)

When launching multiple nodes in MS Windows env, batch command window does not come by default with any title.

This patch add `Elasticsearch VERSION` as a title, where VERSION is the current elasticsearch version.

Same for `plugin.bat` and `service.bat`.

Closes #6336
Closes #6752

time:
2014-07-09T15:49:51Z
class:
src/main/java/org/elasticsearch/common/xcontent/cbor/CborXContent.java
src/main/java/org/elasticsearch/common/xcontent/json/JsonXContent.java
src/main/java/org/elasticsearch/common/xcontent/smile/SmileXContent.java
comments:
Upgrade to jackson core 2.4.1.1
Note, we had to disable the symbol overflow, since the many mapping case was tripping it
closes #6789

time:
2014-07-09T15:18:51Z
class:
src/main/java/org/elasticsearch/index/analysis/PatternAnalyzerProvider.java
comments:
Merge pull request #6792 from areek/fix/6717

Remove Lucene's deprecated PatternAnalyzer

time:
2014-07-09T14:49:05Z
class:
src/test/java/org/elasticsearch/test/BackgroundIndexer.java
comments:
[Test] BackgroundIndexer uses the wrong logger

Closes #6781

time:
2014-07-09T14:36:23Z
class:
comments:
Docs: New entry/front-end

Adding, Calaca, a simple search client for Elasticsearch.

Closes #6754

time:
2014-07-09T14:15:59Z
class:
comments:
Docs: Update plugins.asciidoc

Closes #6683

time:
2014-07-09T13:56:07Z
class:
src/main/java/org/elasticsearch/indices/analysis/HunspellService.java
comments:
Fix typo in Hunspell logging

time:
2014-07-09T13:02:18Z
class:
src/main/java/org/elasticsearch/Version.java
comments:
Add v1.2.3 to Version.java

time:
2014-07-09T12:23:37Z
class:
src/main/java/org/elasticsearch/common/settings/ImmutableSettings.java
src/test/java/org/elasticsearch/common/settings/ImmutableSettingsTests.java
comments:
Improve Settings#get lookup for camel case support
Today, if we miss on a get on setting, we try its camel case version. The assumption is that in our code, we never use camel case to lookup a setting, but we want to support camel case if the user provided one.
This can be expensive (#toCamelCase) when the get on the setting is done in a tight call, which is evident when running the allocation deciders as part of the reroute logic.
Instead of doing the camel case check on get, prepare an additional map that includes all the settings that are provided as came case, and try and lookup from it if needed.
closes #6765

time:
2014-07-09T10:57:04Z
class:
src/main/java/org/elasticsearch/indices/store/IndicesStore.java
src/test/java/org/elasticsearch/indices/store/IndicesStoreIntegrationTests.java
src/test/java/org/elasticsearch/indices/store/IndicesStoreTests.java
comments:
Store: Before removing shard physically from disk verify that another node in the cluster actually holds an active shard copy.

Closes #6692

time:
2014-07-09T09:31:52Z
class:
src/main/java/org/elasticsearch/cluster/metadata/MetaDataCreateIndexService.java
src/main/java/org/elasticsearch/index/fielddata/plain/ParentChildIndexFieldData.java
src/main/java/org/elasticsearch/index/mapper/MapperService.java
src/main/java/org/elasticsearch/index/mapper/internal/ParentFieldMapper.java
src/main/java/org/elasticsearch/index/query/HasParentFilterParser.java
src/main/java/org/elasticsearch/index/query/HasParentQueryParser.java
src/main/java/org/elasticsearch/indices/cluster/IndicesClusterStateService.java
src/main/java/org/elasticsearch/indices/recovery/RecoverySource.java
src/main/java/org/elasticsearch/search/SearchService.java
src/test/java/org/elasticsearch/indices/leaks/IndicesLeaksTests.java
comments:
[Code] Control whether MapperService docMapper iterator should contain DEFAULT_MAPPING

At the moment one can iterate the MapperService to go through all document mappers. This includes the document mapper of DEFAULT_MAPPING, which may be surprising and lead to unintended results. This commit removes the Iterable implementation and add a docMappers method that asks the caller to make an explicit choice

Closes #6793

time:
2014-07-09T09:13:17Z
class:
comments:
Update preference.asciidoc

Clarify that `preference` is a query string parameter only
and provide an example.

time:
2014-07-09T08:43:28Z
class:
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
comments:
[Engine] checkVersionMapRefresh shouldn't use indexWriter.getConfig(). We run it out of lock, the indexWriter may be closed..

Relates to #6443, #6786

Closes #6794

time:
2014-07-09T01:39:39Z
class:
src/main/java/org/elasticsearch/index/analysis/PatternAnalyzerProvider.java
comments:
Remove Lucene's deprecated PatternTokenizer

Instead of using the PatternTokenizer, the functionality was replicated by using Lucene's StopFilter, PatterTokenizer and LowerCaseFilter

Closes #6717

time:
2014-07-08T22:22:31Z
class:
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
comments:
[ENGINE] Prevent NPE if engine is closed while version map is checked

We check if the version map needs to be refreshed after we released
the readlock which can cause the the engine being closed before we
read the value from the volatile `indexWriter` field which can cause an
NPE on the indexing thread. This commit also fixes a potential uncaught
exception if the refresh failed due to the engine being already closed.

Relates to #6443
Closes #6786

time:
2014-07-08T21:46:33Z
class:
src/test/java/org/elasticsearch/benchmark/mapping/ManyMappingsBenchmark.java
comments:
add more options to many mappings test

time:
2014-07-08T18:25:13Z
class:
comments:
[API SPEC] Update indicies.stats group param

time:
2014-07-08T18:17:48Z
class:
src/main/java/org/elasticsearch/index/mapper/FieldMapper.java
comments:
Remove intern calls on FieldMapper#Names
remove internal callas on FieldMappers#Names, we properly reuse FieldMapper, so there is no need to try and call intern in order to reuse the names. This can be heavy with many fields and continuous mapping parsing.
closes #6747

time:
2014-07-08T17:54:05Z
class:
src/main/java/org/elasticsearch/index/analysis/DelimitedPayloadTokenFilterFactory.java
src/main/java/org/elasticsearch/index/analysis/LimitTokenCountFilterFactory.java
src/main/java/org/elasticsearch/indices/analysis/PreBuiltTokenFilters.java
src/main/java/org/elasticsearch/indices/analysis/PreBuiltTokenizers.java
comments:
Add missing pre built analysis components
closes #6770

time:
2014-07-08T17:06:59Z
class:
src/test/java/org/elasticsearch/tribe/TribeTests.java
comments:
[TEST] move tribe tests to use assertBusy

time:
2014-07-08T16:58:10Z
class:
src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java
src/test/java/org/elasticsearch/test/ElasticsearchTestCase.java
comments:
Add assertBusy helper test method
We use awaitBusy in our tests, the problem is that we have to check if it awaited or not, and then try and keep around somehow more info around why the predicate failed and a timeout happened.
The idea of assertBusy is to allow to simply write "regular" test code, and if the test code trips, it will busy wait till a timeout. This allows us to keep around the assertion information and properly throw it for information that is inherently kept in the failure itself.

time:
2014-07-08T16:42:17Z
class:
src/main/java/org/elasticsearch/index/translog/TranslogService.java
comments:
Translog: change flush_threshold_ops to unlimited by default, so we only flush by byte size by default

If you are indexing tiny documents then the previous default (5000)
was too low, causing excessive fsyncs with high indexing rates.  With
this change we now only flush by byte size (200 MB) by default for
better indexing performance for tiny documents.

Closes #6783

time:
2014-07-08T16:07:48Z
class:
src/main/java/org/elasticsearch/index/engine/internal/DeleteVersionValue.java
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
src/main/java/org/elasticsearch/index/engine/internal/LiveVersionMap.java
src/main/java/org/elasticsearch/index/engine/internal/VersionValue.java
src/main/java/org/elasticsearch/index/translog/Translog.java
src/main/java/org/elasticsearch/index/translog/TranslogService.java
src/test/java/org/elasticsearch/index/engine/internal/InternalEngineTests.java
src/test/java/org/elasticsearch/versioning/SimpleVersioningTests.java
comments:
Core: trigger refresh when the live version map is using too much RAM

When refresh_interval is long or disabled, and indexing rate is high,
it's possible for live version map to use non-trivial amounts of RAM.
With this change we now trigger a refresh in such cases to clear the
version map so we don't use unbounded RAM.

Closes #6443

time:
2014-07-08T14:44:58Z
class:
comments:
Docs: Changed the path separator for Windows in the README

Closes #1854

time:
2014-07-08T14:05:46Z
class:
src/main/java/org/elasticsearch/search/aggregations/AggregatorParsers.java
src/main/java/org/elasticsearch/search/aggregations/support/OrderPath.java
src/test/java/org/elasticsearch/search/aggregations/ParsingTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/StringTermsTests.java
src/test/java/org/elasticsearch/search/aggregations/support/PathTests.java
comments:
Aggregations: Aggregation names can now include dot

Aggregation name are now able to use any character except '[', ']', and '>". Dot syntax may still be used to reference values (e.g. in the order field) but may only defence the value directly beneath the last aggregation in the list. more complex structures will need to be accessed using the aggname[value] syntax

Closes #6702

time:
2014-07-08T13:54:11Z
class:
comments:
Docs: Improved the docs for nested mapping

Closes #1643

time:
2014-07-08T12:41:53Z
class:
src/main/java/org/elasticsearch/discovery/zen/ZenDiscovery.java
comments:
[Discovery] verify connect when sending a rejoin cluster request

When a master receives a cluster state from another node, it compares the local cluster state with the one it got. If the local one has a higher version, it sends a JoinClusterRequest to the other master to tell it step down. Because our network layer is asymmetric, we need to make sure we're connected before sending.

Closes #6779

time:
2014-07-08T12:18:26Z
class:
src/main/java/org/elasticsearch/action/admin/indices/alias/exists/TransportAliasesExistAction.java
src/main/java/org/elasticsearch/action/admin/indices/alias/get/TransportGetAliasesAction.java
src/main/java/org/elasticsearch/action/admin/indices/close/TransportCloseIndexAction.java
src/main/java/org/elasticsearch/action/admin/indices/delete/TransportDeleteIndexAction.java
src/main/java/org/elasticsearch/action/admin/indices/exists/indices/TransportIndicesExistsAction.java
src/main/java/org/elasticsearch/action/admin/indices/exists/types/TransportTypesExistsAction.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/delete/TransportDeleteMappingAction.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/get/TransportGetFieldMappingsAction.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/get/TransportGetMappingsAction.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/put/TransportPutMappingAction.java
src/main/java/org/elasticsearch/action/admin/indices/open/TransportOpenIndexAction.java
src/main/java/org/elasticsearch/action/admin/indices/settings/get/TransportGetSettingsAction.java
src/main/java/org/elasticsearch/action/admin/indices/settings/put/TransportUpdateSettingsAction.java
src/main/java/org/elasticsearch/action/admin/indices/warmer/delete/TransportDeleteWarmerAction.java
src/main/java/org/elasticsearch/action/admin/indices/warmer/get/TransportGetWarmersAction.java
src/main/java/org/elasticsearch/action/support/master/info/TransportClusterInfoAction.java
src/main/java/org/elasticsearch/action/support/replication/TransportIndicesReplicationOperationAction.java
src/test/java/org/elasticsearch/action/bulk/BulkProcessorTests.java
src/test/java/org/elasticsearch/cluster/BlockClusterStatsTests.java
comments:
Core: don't replace indices within the ActionRequest with the concrete ones, and make sure check blocks is executed on concrete indices

Concrete indices is now called multiple times when needed instead of changing what's inside the incoming request with the concrete indices. Ideally we want to keep the original aliases or indices or wildcard expressions in the request.

Also made sure that the check blocks is done against the concrete indices, which wasn't the case for delete index, delete mapping, open index, close index, types exists and indices exists.

Closes #6694
Closes #6777

time:
2014-07-08T11:35:08Z
class:
src/main/java/org/elasticsearch/discovery/zen/fd/MasterFaultDetection.java
src/main/java/org/elasticsearch/discovery/zen/fd/NodesFaultDetection.java
comments:
Revert "[Discovery] immediately start Master|Node fault detection pinging"

In #6706 we change the master validation to start pining immediately after a new master as ellected or a node joined. The idea is to have a quicker response to failures. This does however create a problem if the new master has yet fully processed it's ellection and responds to the ping with a NoLongerMasterException. This causes the source node to remove the current master and ellect another, only to find out it's not a master either and so forth. We are moving this change to the feature/improve_zen branch, where the improvements we made will cause the situation to be handled properly.

This reverts commit ae16956e072bea317ea481f65f2e110dc48fde17.

time:
2014-07-08T11:17:53Z
class:
comments:
Docs: YAML mappings use colons, not equals sign

Closes #6750

time:
2014-07-08T11:16:06Z
class:
comments:
Docs: grammatical error

Closes #6716

time:
2014-07-08T11:09:16Z
class:
src/main/java/org/elasticsearch/action/admin/cluster/health/ClusterHealthResponse.java
src/test/java/org/elasticsearch/test/hamcrest/ElasticsearchAssertions.java
comments:
[TEST] more consistent toString on cluster state, print with assertTimeout

time:
2014-07-08T09:54:53Z
class:
comments:
Docs: Rewrote the scroll/scan docs

Closes #6774

time:
2014-07-07T20:27:25Z
class:
src/test/java/org/elasticsearch/index/mapper/geo/GeoMappingTests.java
comments:
[Test] Revert temporary fixes for update mapping on recovery issue

This reverts:
"Test: Temporarily change delete/put_mapping to wait for green": commit e408f8f638c2dd97a3ec86c8a9ac940f43ab37a0.
"[TEST] wait for green to update mapping": commit b3641a2ee6eb23318d49f5f04b39149e70c2b65b.

time:
2014-07-07T19:39:22Z
class:
src/main/java/org/elasticsearch/indices/recovery/RecoverySource.java
comments:
[Recovery] only send mapping updates to master if needed

The change added in #6762 helps making sure the pending mapping updates are processed on all nodes to prevent moving shards to nodes which are not yet fully aware of the new mapping. However it introduced a racing condition delete_mapping operations, potentially causing a type to be added after it's deletion. This commit solves this by only sending a mapping update if the mapping source has actually changed.

Closes #6772

time:
2014-07-07T17:02:36Z
class:
comments:
Test: Temporarily change delete/put_mapping to wait for green
Delete and update mapping execution order has changed with #6762

time:
2014-07-07T16:42:20Z
class:
src/test/java/org/elasticsearch/index/mapper/geo/GeoMappingTests.java
comments:
[TEST] wait for green to update mapping
before we update the mapping, make sure the index is green, so a delayed recovery update mapping will not override the mapping itself

time:
2014-07-07T16:40:05Z
class:
src/main/java/org/elasticsearch/cluster/action/index/MappingUpdatedAction.java
src/main/java/org/elasticsearch/indices/recovery/RecoverySource.java
src/test/java/org/elasticsearch/indices/mapping/UpdateMappingTests.java
comments:
Don't update default mapping on phase2 recovery
the default mapping is not merged, but updated in place, and only put mapping API can change it, no need to make sure it has been properly updated on the master. This can cause conflicts when a put mapping for it happens at the same time.
closes #6771

time:
2014-07-07T15:35:33Z
class:
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
comments:
Core: remove per-ID locking when ID was auto-generated

When we know the ID for the document we are about to index was
auto-generated, we don't need to acquire/release the per-ID lock,
which might provide small speedups during highly concurrent indexing.

Closes #6584

time:
2014-07-07T13:09:36Z
class:
comments:
Build: Add all netty classes during shading

In order to have access to all codecs and handlers by netty, they
need to be exposed during shading, otherwise only the classes, which
are used by the built are exposed.

time:
2014-07-07T12:42:31Z
class:
src/main/java/org/elasticsearch/common/lucene/search/MultiPhrasePrefixQuery.java
src/test/java/org/elasticsearch/validate/SimpleValidateQueryTests.java
comments:
Query DSL: Improved explanation for match_phrase_prefix

The match_phrase_prefix provided the same explanation as the match_phrase
query. There was no indication that the last term was run as a prefix
query.

This change marks the last term (or terms if there are multiple terms
in the same position) with a *

Closes #2449

time:
2014-07-07T11:21:16Z
class:
src/main/java/org/elasticsearch/cluster/action/index/MappingUpdatedAction.java
src/main/java/org/elasticsearch/indices/recovery/RecoverySource.java
src/test/java/org/elasticsearch/recovery/SimpleRecoveryTests.java
comments:
[Relocation] process pending mapping update in phase 2

During phase1 we copy over all lucene segments. These may refer to mapping updates that are still queued up to be sent to master. We must make sure those pending updates are processed before completing the relocation.

Relates to #6648

Closes #6762

time:
2014-07-07T09:48:11Z
class:
src/main/java/org/elasticsearch/cluster/routing/allocation/decider/DiskThresholdDecider.java
src/test/java/org/elasticsearch/cluster/routing/allocation/decider/DiskThresholdDeciderTests.java
comments:
Allow primaries that have never been allocated to be allocated if under the low watermark

Fixes #6196

time:
2014-07-07T08:44:11Z
class:
comments:
Docs: Update histogram-aggregation.asciidoc

filter in a filtered query should be under "filter" key

Closes #6738

time:
2014-07-07T08:41:36Z
class:
comments:
Docs: fixed a typo in the docs

Closes: #6718

time:
2014-07-07T08:06:18Z
class:
comments:
Docs: Language analyzers
Clarified the use of stem_exclusion and the keyword_marker
token filter

Closes #6613

time:
2014-07-07T07:49:53Z
class:
comments:
Upgrade Jackson to 2.4.1
closes #6757

time:
2014-07-07T07:42:05Z
class:
src/main/java/org/elasticsearch/cluster/metadata/MetaDataMappingService.java
comments:
Call callback on actual mapping processed
only callback the registered callback listeners when mapping have actually been processed...
closes #6748

time:
2014-07-06T14:08:09Z
class:
src/test/java/org/elasticsearch/common/collect/UpdateInPlaceMapTests.java
comments:
[TEST] wait for threads to finish writing before checking
we need to make sure we wait for all threads to finish executing, since there might still be a thread around even post await (i.e. just starting) performing updates

time:
2014-07-06T10:24:16Z
class:
src/test/java/org/elasticsearch/cluster/ClusterServiceTests.java
comments:
[TEST] remove repeat lefover...

time:
2014-07-06T10:23:50Z
class:
src/test/java/org/elasticsearch/cluster/ClusterServiceTests.java
comments:
[TEST] test didn't take into account other cluster service tasks
The pending tests on an actual node should take into account that other tasks might be executing on that node, thus failing when it happens

time:
2014-07-05T17:08:31Z
class:
src/test/java/org/elasticsearch/cluster/ClusterServiceTests.java
comments:
[TEST] only mark the event as processed when its out of its execution

time:
2014-07-05T16:10:18Z
class:
src/test/java/org/elasticsearch/benchmark/mapping/ManyMappingsBenchmark.java
comments:
Add license header to ManyMappingsBenchmark.java

time:
2014-07-05T15:40:52Z
class:
src/main/java/org/elasticsearch/action/admin/cluster/tasks/PendingClusterTasksResponse.java
src/main/java/org/elasticsearch/cluster/service/InternalClusterService.java
src/main/java/org/elasticsearch/cluster/service/PendingClusterTask.java
src/main/java/org/elasticsearch/common/util/concurrent/PrioritizedEsThreadPoolExecutor.java
src/test/java/org/elasticsearch/cluster/ClusterServiceTests.java
src/test/java/org/elasticsearch/common/util/concurrent/PrioritizedExecutorsTests.java
comments:
Improve pending api to include current executing class
the pending tasks api will now include the current executing tasks (with a proper marker boolean flag)
this will also help in tests that wait for no pending tasks, to also wait till the current executing task is done
closes #6744

time:
2014-07-05T15:39:39Z
class:
src/main/java/org/elasticsearch/action/admin/indices/mapping/get/TransportGetFieldMappingsIndexAction.java
src/main/java/org/elasticsearch/common/collect/UpdateInPlaceMap.java
src/main/java/org/elasticsearch/index/analysis/FieldNameAnalyzer.java
src/main/java/org/elasticsearch/index/mapper/DocumentFieldMappers.java
src/main/java/org/elasticsearch/index/mapper/DocumentMapper.java
src/main/java/org/elasticsearch/index/mapper/FieldMapperListener.java
src/main/java/org/elasticsearch/index/mapper/FieldMappersLookup.java
src/main/java/org/elasticsearch/index/mapper/MapperService.java
src/main/java/org/elasticsearch/index/mapper/internal/AnalyzerMapper.java
src/main/java/org/elasticsearch/index/mapper/object/ObjectMapper.java
src/main/java/org/elasticsearch/index/mapper/object/RootObjectMapper.java
src/test/java/org/elasticsearch/benchmark/mapping/ManyMappingsBenchmark.java
src/test/java/org/elasticsearch/common/collect/UpdateInPlaceMapTests.java
src/test/java/org/elasticsearch/test/InternalTestCluster.java
comments:
Improve performance for many new fields introduction in mapping
When we have many new fields keep being introduced, the immutable open map we used becomes more and more expensive because of its clone characteristics, and we use it in several places.

The usage semantics of it allows us to also use a CHM if we want to, but it would be nice to still maintain the concurrency aspects of volatile immutable map when the number of fields is sane.

Introduce a new map like data structure, that can switch internally to CHM when a certain threshold is met.

Also add a benchmark class to exploit the many new field mappings use case, which shows significant gains by using this change, to a level where mapping introduction is no longer a significant bottleneck.
closes #6707

time:
2014-07-05T13:20:46Z
class:
src/test/java/org/elasticsearch/index/search/child/ChildrenConstantScoreQueryTests.java
src/test/java/org/elasticsearch/index/search/child/ChildrenQueryTests.java
src/test/java/org/elasticsearch/index/search/child/ParentConstantScoreQueryTests.java
src/test/java/org/elasticsearch/index/search/child/ParentQueryTests.java
src/test/java/org/elasticsearch/index/search/child/TestSearchContext.java
src/test/java/org/elasticsearch/index/search/child/TopChildrenQueryTests.java
comments:
[TEST] Close threadpool once test searchcontext is released

time:
2014-07-05T11:44:24Z
class:
src/main/java/org/apache/lucene/queryparser/classic/MapperQueryParser.java
src/main/java/org/elasticsearch/common/lucene/search/Queries.java
src/main/java/org/elasticsearch/index/query/BoolQueryParser.java
src/main/java/org/elasticsearch/index/query/QueryStringQueryParser.java
src/main/java/org/elasticsearch/index/query/TermsQueryParser.java
comments:
[QUERY] Remove Queries#optimizeQuery(...)

This method tires to optimize boolean queries if there is only
one clause. Yet BooleanQuery already does that internally This
optimization is unneeded.

Closes #6743

time:
2014-07-05T09:24:16Z
class:
src/test/java/org/elasticsearch/index/fielddata/DisabledFieldDataFormatTests.java
comments:
[TEST] also assert that put mapping is ack'ed

time:
2014-07-05T09:23:10Z
class:
src/test/java/org/elasticsearch/index/fielddata/DisabledFieldDataFormatTests.java
src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java
comments:
[TEST] wait for no pending tasks so processed all mappings

time:
2014-07-04T19:10:52Z
class:
src/main/java/org/elasticsearch/action/get/GetRequest.java
src/main/java/org/elasticsearch/action/support/single/shard/TransportShardSingleOperationAction.java
src/test/java/org/elasticsearch/recovery/SimpleRecoveryTests.java
comments:
[Logging] added trace logging to TransportShardSingleOperationAction

And enabled them on SimpleRecoveryTests.testSimpleRecovery

time:
2014-07-04T15:50:43Z
class:
comments:
Update lang-analyzer.asciidoc

Clarified the use of the `stem_exclusion` token filter.

Closes #6613

time:
2014-07-04T15:44:02Z
class:
comments:
Update plugins.asciidoc

time:
2014-07-04T15:29:18Z
class:
src/main/java/org/elasticsearch/plugins/PluginManager.java
comments:
Removing plugin does not fail when plugin dir is read only

If you try to remove a plugin in read only dir, you get a successful result:

```
$ bin/plugin --remove marvel
-> Removing marvel
Removed marvel
```

But actually the plugin has not been removed.

When installing, if fails properly:

```
$ bin/plugin -i elasticsearch/marvel/latest
-> Installing elasticsearch/marvel/latest...

Failed to install elasticsearch/marvel/latest, reason: plugin directory /usr/local/elasticsearch/plugins is read only
```

This change throw an exception when we don't succeed removing the plugin.

Closes #6546.

time:
2014-07-04T15:18:38Z
class:
src/test/java/org/elasticsearch/search/query/SimpleQueryTests.java
comments:
[TEST] Ensure scores are consistent.

time:
2014-07-04T15:06:51Z
class:
comments:
Docs: Link to eskka discovery plugin from doc

Closes #6721

time:
2014-07-04T14:33:41Z
class:
src/test/java/org/elasticsearch/search/sort/SimpleSortTests.java
comments:
[TEST] mute test - working on a fix

time:
2014-07-04T14:18:52Z
class:
src/main/java/org/elasticsearch/plugins/PluginManager.java
src/test/java/org/elasticsearch/plugin/PluginManagerTests.java
comments:
PluginManager: tests for missing plugin name when passing --url

Adding code to test for unset plugin names to fail fast with descriptive error messages. Also simplified the series of `if` statements checking for the commands by using a `switch` (now that it's using Java 7), added tests, and updated random exceptions with the up-to-date flag names (e.g., "--verbose" instead of "-verbose").

Closes #5976.
Closes #6013.

time:
2014-07-04T14:06:47Z
class:
src/main/java/org/apache/lucene/analysis/SimpleAnalyzerWrapper.java
comments:
make sure we use the new analyzer wrapper on 4.10

time:
2014-07-04T13:23:12Z
class:
src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java
comments:
[TEST] Reset all cluster if a test hit a failure

Closes #6734

time:
2014-07-04T13:11:22Z
class:
src/test/java/org/elasticsearch/index/cache/query/parser/resident/ResidentQueryParserCacheTest.java
comments:
Added licence header

time:
2014-07-04T13:04:26Z
class:
src/main/java/org/elasticsearch/index/cache/query/parser/resident/ResidentQueryParserCache.java
src/test/java/org/elasticsearch/index/cache/query/parser/resident/ResidentQueryParserCacheTest.java
src/test/java/org/elasticsearch/search/query/SimpleQueryTests.java
comments:
The query string cache can't return the same instance, since Query is mutable changing the query else where in the execution path changes the instance in the cache too.

Instead the query parser cache should return a cloned instances.

Closes #2542
Closes #6733

time:
2014-07-04T12:29:49Z
class:
src/test/java/org/elasticsearch/search/query/MultiMatchQueryTests.java
comments:
[TEST] Order of the results is not important in this test

time:
2014-07-04T12:26:20Z
class:
comments:
Updated cache.asciidoc

The index level filter cache was removed a long time ago

Closes #6455

time:
2014-07-04T10:18:03Z
class:
src/test/java/org/elasticsearch/test/CompositeTestCluster.java
comments:
[TEST] use existing client that is already in the cluster to wait for joining node

time:
2014-07-04T09:42:21Z
class:
src/test/java/org/elasticsearch/search/sort/SimpleSortTests.java
comments:
[TEST] assert search results before comparing the results - shards / indices might be missing

time:
2014-07-04T08:52:06Z
class:
src/main/java/org/elasticsearch/index/query/support/XContentStructure.java
src/test/java/org/elasticsearch/search/child/SimpleChildQuerySearchTests.java
comments:
[Query] QueryParser can return null from a query

This causes a NPE since XContentStructure checks if the query is null
and takes this as the condition to parse from the byte source which is
actually null in that case.

Closes #6722

time:
2014-07-04T07:53:48Z
class:
src/test/java/org/elasticsearch/search/query/ExistsMissingTests.java
comments:
[TEST] Wait for yellow since some shards might not be started

In this test we only index a handful of docs so if we have more shards
than docs we might fail on the `assertSearchResult` since not all shards
are started but results are just fine.

time:
2014-07-03T19:03:08Z
class:
src/main/java/org/apache/lucene/analysis/CustomAnalyzerWrapper.java
src/main/java/org/apache/lucene/analysis/SimpleAnalyzerWrapper.java
src/main/java/org/elasticsearch/index/analysis/FieldNameAnalyzer.java
src/main/java/org/elasticsearch/index/analysis/NamedAnalyzer.java
src/main/java/org/elasticsearch/index/mapper/MapperService.java
comments:
More resource efficient analysis wrapping usage
Today, we take great care to try and share the same analyzer instances across shards and indices (global analyzer). The idea is to share the same analyzer so the thread local resource it has will not be allocated per analyzer instance per thread.
The problem is that AnalyzerWrapper keeps its resources on its own per thread storage, and with per field reuse strategy, it causes for per field per thread token stream components to be used. This is very evident with the StandardTokenizer that uses a buffer...
This came out of test with "many fields", where the majority of 1GB heap was consumed by StandardTokenizer instances...
closes #6714

time:
2014-07-03T13:40:16Z
class:
src/main/java/org/elasticsearch/plugins/PluginManager.java
comments:
Fix github download link when using specific version

time:
2014-07-03T13:38:06Z
class:
comments:
[DOCS] Add information regarding _type parameter requirement for _mget

Change ID to `[[mget-type]]`

Closes #6670.

time:
2014-07-03T13:23:35Z
class:
comments:
[DOCS] Add information regarding _type parameter requirement for _mget

Closes #6670.

time:
2014-07-03T13:21:51Z
class:
comments:
Docs: fixed ICU plugin documentation

add ICU Normalization CharFilter to docs

Closes #6711

time:
2014-07-03T12:54:20Z
class:
src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java
comments:
[TEST] Include mapping in failure

time:
2014-07-03T12:51:11Z
class:
src/main/java/org/elasticsearch/discovery/zen/fd/MasterFaultDetection.java
src/main/java/org/elasticsearch/discovery/zen/fd/NodesFaultDetection.java
comments:
[Discovery] immediately start Master|Node fault detection pinging

After a node joins the clusters, it starts pinging the master to verify it's health. Before, the cluster join request was processed async and we had to give some time to complete. With  #6480 we changed this to wait for the join process to complete on the master. We can therefore start pinging immediately for fast detection of failures. Similar change can be made to the Node fault detection from the master side.

Closes #6706