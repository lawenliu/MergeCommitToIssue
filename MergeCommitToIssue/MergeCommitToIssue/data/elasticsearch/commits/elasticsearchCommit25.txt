time:
2014-04-29T09:29:11Z
class:
comments:
Add Lucene version in plugin.properties file

Closes #33.
(cherry picked from commit fd508b8)

time:
2014-04-29T09:28:48Z
class:
src/main/java/org/elasticsearch/index/analysis/KuromojiPartOfSpeechFilterFactory.java
src/main/java/org/elasticsearch/indices/analysis/KuromojiIndicesAnalysis.java
comments:
Update to Lucene 4.8

Closes #30.
(cherry picked from commit bf7cc95)

time:
2014-04-29T09:23:04Z
class:
comments:
Create branch es-1.2

time:
2014-04-29T09:21:31Z
class:
comments:
Fix typo

time:
2014-04-29T09:20:17Z
class:
comments:
Add Lucene version in plugin.properties file

Closes #24.
(cherry picked from commit aca83a7)

time:
2014-04-29T09:20:01Z
class:
src/test/java/org/elasticsearch/index/analysis/SimplePolishIntegrationTests.java
comments:
Update to Lucene 4.8

Closes #23.
(cherry picked from commit 64a1d9c)

time:
2014-04-29T09:07:06Z
class:
src/main/java/org/elasticsearch/search/aggregations/AggregatorParsers.java
src/test/java/org/elasticsearch/search/aggregations/ParsingTests.java
comments:
Aggregations parsing is too lenient.

Close #5827

time:
2014-04-29T09:04:36Z
class:
comments:
Create es-1.2 branch

time:
2014-04-29T09:03:14Z
class:
comments:
Add Lucene version in plugin.properties file

Closes #19.
(cherry picked from commit 3fb429c)

time:
2014-04-29T09:02:53Z
class:
src/test/java/org/elasticsearch/index/analysis/SimpleSmartChineseIntegrationTests.java
comments:
Update to Lucene 4.8

Closes #18
(cherry picked from commit e2a98c9)

time:
2014-04-29T08:55:47Z
class:
comments:
Create es-1.2 branch

time:
2014-04-29T08:52:00Z
class:
comments:
Add lucene version in es-plugin.properties

Closes #25.
(cherry picked from commit 8836775)

time:
2014-04-29T08:34:19Z
class:
comments:
Create branch es-1.2

time:
2014-04-29T07:40:29Z
class:
comments:
Upgrade to Lucene 4.8.

time:
2014-04-29T07:37:17Z
class:
comments:
Update to Lucene 4.8.

time:
2014-04-29T06:58:39Z
class:
src/test/java/org/elasticsearch/search/suggest/SuggestSearchTests.java
comments:
Added AwaitsFix

time:
2014-04-29T05:41:04Z
class:
src/main/java/org/elasticsearch/index/fielddata/ordinals/GlobalOrdinalsIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/ordinals/InternalGlobalOrdinalsBuilder.java
src/main/java/org/elasticsearch/index/fielddata/ordinals/InternalGlobalOrdinalsIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/ParentChildAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/ParentChildIndexFieldData.java
src/main/java/org/elasticsearch/index/search/child/ChildrenConstantScoreQuery.java
src/main/java/org/elasticsearch/index/search/child/ChildrenQuery.java
src/main/java/org/elasticsearch/index/search/child/ParentConstantScoreQuery.java
src/main/java/org/elasticsearch/index/search/child/ParentIdsFilter.java
src/main/java/org/elasticsearch/index/search/child/ParentQuery.java
src/test/java/org/elasticsearch/index/search/child/ChildrenConstantScoreQueryTests.java
src/test/java/org/elasticsearch/search/child/SimpleChildQuerySearchTests.java
comments:
Cut p/c queries (has_child and has_parent queries) over to use global ordinals instead of being bytes values based.

Closes #5846

time:
2014-04-29T04:07:12Z
class:
src/main/java/org/elasticsearch/search/aggregations/bucket/geogrid/GeoHashGridAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/HistogramAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantStringTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/DoubleTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/LongTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/StringTermsAggregator.java
comments:
Cut other aggregations over to use collectExistingBucket() if a bucket ord has been hit, that already exists.

Closes #5955

time:
2014-04-29T04:04:03Z
class:
src/main/java/org/elasticsearch/index/fielddata/ordinals/InternalGlobalOrdinalsBuilder.java
src/main/java/org/elasticsearch/search/aggregations/bucket/BucketsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/GlobalOrdinalsStringTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/TermsAggregatorFactory.java
src/main/java/org/elasticsearch/search/aggregations/support/ValuesSource.java
src/test/java/org/elasticsearch/benchmark/search/aggregations/GlobalOrdinalsBenchmark.java
src/test/java/org/elasticsearch/search/aggregations/bucket/StringTermsTests.java
comments:
Added global ordinals terms aggregator impl that is optimized low cardinality fields.
Instead of resolving the global ordinal for each hit on the fly, resolve the global ordinals during post collect.
On fields with not so many unique values, that can reduce the number of global ordinals significantly.

Closes #5895
Closes #5854

time:
2014-04-28T16:49:55Z
class:
src/test/java/org/elasticsearch/index/query/TemplateQueryParserTest.java
src/test/java/org/elasticsearch/index/query/TemplateQueryTest.java
src/test/java/org/elasticsearch/test/rest/support/FileUtils.java
comments:
Use URI vs URL accessing File from classpath.

URL escapes special characters such as spaces which
causes the resource to not be found when used to create
a File object.  Use URI.

Closes #5915

time:
2014-04-28T16:31:47Z
class:
src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java
src/test/java/org/elasticsearch/test/NodeSettingsSource.java
comments:
[TEST] made sure nodeSettings method gets called for every node type, not only data nodes in case numDataNodes is specified.

This fixes a test ZenUnicastDiscoveryTests when running in network mode

time:
2014-04-28T16:23:15Z
class:
comments:
Update to Lucene 4.8

Closes #24.
(cherry picked from commit 1596bf6)

time:
2014-04-28T16:22:11Z
class:
comments:
Add Lucene version in plugin.properties file

Closes #25.
(cherry picked from commit 17d43f5)

time:
2014-04-28T16:21:49Z
class:
comments:
Added new branch for elasticsearch 1.2
(cherry picked from commit aac8f23)

time:
2014-04-28T14:31:36Z
class:
src/test/java/org/elasticsearch/action/admin/cluster/stats/ClusterStatsTests.java
src/test/java/org/elasticsearch/action/bulk/BulkIntegrationTests.java
src/test/java/org/elasticsearch/client/transport/TransportClientTests.java
src/test/java/org/elasticsearch/cluster/ClusterServiceTests.java
src/test/java/org/elasticsearch/cluster/MinimumMasterNodesTests.java
src/test/java/org/elasticsearch/cluster/NoMasterNodeTests.java
src/test/java/org/elasticsearch/cluster/SimpleDataNodesTests.java
src/test/java/org/elasticsearch/cluster/SpecificMasterNodesTests.java
src/test/java/org/elasticsearch/cluster/UpdateSettingsValidationTests.java
src/test/java/org/elasticsearch/cluster/ack/AckClusterUpdateSettingsTests.java
src/test/java/org/elasticsearch/cluster/ack/AckTests.java
src/test/java/org/elasticsearch/cluster/allocation/AwarenessAllocationTests.java
src/test/java/org/elasticsearch/cluster/allocation/ClusterRerouteTests.java
src/test/java/org/elasticsearch/cluster/allocation/FilteringAllocationTests.java
src/test/java/org/elasticsearch/cluster/allocation/ShardsAllocatorModuleTests.java
src/test/java/org/elasticsearch/cluster/shards/ClusterSearchShardsTests.java
src/test/java/org/elasticsearch/discovery/DiscoveryWithNetworkFailuresTests.java
src/test/java/org/elasticsearch/discovery/ZenUnicastDiscoveryTests.java
src/test/java/org/elasticsearch/discovery/ZenUnicastDiscoveryTestsMinimumMasterNodes.java
src/test/java/org/elasticsearch/discovery/ZenUnicastDiscoveryTestsSpecificNodes.java
src/test/java/org/elasticsearch/document/BulkTests.java
src/test/java/org/elasticsearch/gateway/local/LocalGatewayIndexStateTests.java
src/test/java/org/elasticsearch/gateway/local/QuorumLocalGatewayTests.java
src/test/java/org/elasticsearch/gateway/local/SimpleRecoveryLocalGatewayTests.java
src/test/java/org/elasticsearch/gateway/none/RecoverAfterNodesTests.java
src/test/java/org/elasticsearch/index/engine/internal/InternalEngineMergeTests.java
src/test/java/org/elasticsearch/index/suggest/stats/SuggestStatsTests.java
src/test/java/org/elasticsearch/indexlifecycle/IndexLifecycleActionTests.java
src/test/java/org/elasticsearch/indices/IndicesLifecycleListenerTests.java
src/test/java/org/elasticsearch/indices/analyze/HunspellServiceTests.java
src/test/java/org/elasticsearch/indices/cache/CacheTests.java
src/test/java/org/elasticsearch/indices/leaks/IndicesLeaksTests.java
src/test/java/org/elasticsearch/indices/mapping/DedicatedMasterGetFieldMappingTests.java
src/test/java/org/elasticsearch/indices/recovery/IndexRecoveryTests.java
src/test/java/org/elasticsearch/indices/settings/UpdateNumberOfReplicasTests.java
src/test/java/org/elasticsearch/indices/state/CloseIndexDisableCloseAllTests.java
src/test/java/org/elasticsearch/indices/stats/SimpleIndexStatsTests.java
src/test/java/org/elasticsearch/indices/store/IndicesStoreTests.java
src/test/java/org/elasticsearch/indices/template/IndexTemplateFileLoadingTests.java
src/test/java/org/elasticsearch/indices/warmer/LocalGatewayIndicesWarmerTests.java
src/test/java/org/elasticsearch/nodesinfo/SimpleNodesInfoTests.java
src/test/java/org/elasticsearch/percolator/RecoveryPercolatorTests.java
src/test/java/org/elasticsearch/plugin/PluginManagerTests.java
src/test/java/org/elasticsearch/plugin/ResponseHeaderPluginTests.java
src/test/java/org/elasticsearch/plugin/SitePluginTests.java
src/test/java/org/elasticsearch/recovery/FullRollingRestartTests.java
src/test/java/org/elasticsearch/recovery/RelocationTests.java
src/test/java/org/elasticsearch/script/ScriptFieldTests.java
src/test/java/org/elasticsearch/search/basic/SearchWhileCreatingIndexTests.java
src/test/java/org/elasticsearch/search/functionscore/FunctionScorePluginTests.java
src/test/java/org/elasticsearch/search/highlight/CustomHighlighterSearchTests.java
src/test/java/org/elasticsearch/search/preference/SearchPreferenceTests.java
src/test/java/org/elasticsearch/search/stats/SearchStatsTests.java
src/test/java/org/elasticsearch/search/suggest/CustomSuggesterSearchTests.java
src/test/java/org/elasticsearch/snapshots/AbstractSnapshotTests.java
src/test/java/org/elasticsearch/snapshots/DedicatedClusterSnapshotRestoreTests.java
src/test/java/org/elasticsearch/snapshots/SharedClusterSnapshotRestoreTests.java
src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java
src/test/java/org/elasticsearch/test/ExternalTestCluster.java
src/test/java/org/elasticsearch/test/ImmutableTestCluster.java
src/test/java/org/elasticsearch/test/TestCluster.java
src/test/java/org/elasticsearch/threadpool/SimpleThreadPoolTests.java
src/test/java/org/elasticsearch/tribe/TribeTests.java
src/test/java/org/elasticsearch/ttl/SimpleTTLTests.java
src/test/java/org/elasticsearch/update/UpdateByNativeScriptTests.java
comments:
[TEST] randomly introduced a client node within test cluster

The default number of clients nodes is randomized between 0 and 1, applied to all cluster scopes (global, suite and test). Can be changed through the newly added `@ClusterScope#numClientNodes`.

In our tests we currently refer to nodes in a generic way. All the tests that either stop or start nodes rely on the fact that those nodes hold data though. Made that clearer as that becomes more important when introducing other types of nodes within the test cluster. Reflected this by adapting and renaming the following methods in `TestCluster`:

- ensureAtLeastNumNodes to ensureAtLeastNumDataNodes
- ensureAtMostNumNodes to ensureAtMostNumDataNodes
- stopRandomNode to stopRandomDataNode

and the following ones in `ElasticsearchIntegrationTest`:

- allowNodes to allowDataNodes
- dataNodes to numDataNodes.
- @ClusterScope#numNodes to numDataNodes
- @ClusterScope#minNumNodes to minNumDataNodes
- @ClusterScope#maxNumNodes to maxNumDataNodes

Added facilities to be able to deal with data nodes specifically, like for instance retrieve a client to a data node, or retrieve an instance of a class through guice only from data nodes.

Adapted existing tests to successfully run although there's a node client around.

Fixed _cat/allocation REST tests to make disk.total, disk.avail and disk.percent optional as client nodes won't return that info.

Closes #5949

time:
2014-04-28T13:12:54Z
class:
src/main/java/org/elasticsearch/action/deletebyquery/TransportShardDeleteByQueryAction.java
src/main/java/org/elasticsearch/index/query/HasChildFilterParser.java
src/main/java/org/elasticsearch/index/query/HasChildQueryParser.java
src/main/java/org/elasticsearch/index/query/HasParentFilterParser.java
src/main/java/org/elasticsearch/index/query/HasParentQueryParser.java
src/main/java/org/elasticsearch/index/query/QueryParserUtils.java
src/main/java/org/elasticsearch/index/query/TopChildrenQueryParser.java
src/main/java/org/elasticsearch/index/search/child/DeleteByQueryWrappingFilter.java
src/test/java/org/elasticsearch/deleteByQuery/DeleteByQueryTests.java
src/test/java/org/elasticsearch/search/child/SimpleChildQuerySearchTests.java
comments:
Disabled parent/child queries in the delete by query api.
It wasn't properly implemented and could lead to a shard being failed and not able to recover.

Closes #5828 #5916

time:
2014-04-28T11:56:01Z
class:
src/test/java/org/elasticsearch/index/fielddata/ordinals/MultiOrdinalsTests.java
comments:
[TEST] Fix test bug in MultiOrdinalsTests.

time:
2014-04-28T11:00:08Z
class:
comments:
Removed spec and YAML tests for indices.status

Related #4854

time:
2014-04-28T10:45:50Z
class:
src/main/java/org/apache/lucene/analysis/miscellaneous/TruncateTokenFilter.java
src/main/java/org/apache/lucene/index/TrackingSerialMergeScheduler.java
src/main/java/org/apache/lucene/queries/ExtendedCommonTermsQuery.java
src/main/java/org/apache/lucene/search/suggest/analyzing/XAnalyzingSuggester.java
src/main/java/org/elasticsearch/Version.java
src/main/java/org/elasticsearch/common/io/FileSystemUtils.java
src/main/java/org/elasticsearch/common/lucene/Directories.java
src/main/java/org/elasticsearch/common/lucene/Lucene.java
src/main/java/org/elasticsearch/common/lucene/SegmentReaderUtils.java
src/main/java/org/elasticsearch/common/lucene/all/AllTermQuery.java
src/main/java/org/elasticsearch/common/lucene/search/MatchNoDocsQuery.java
src/main/java/org/elasticsearch/common/lucene/search/XFilteredQuery.java
src/main/java/org/elasticsearch/common/lucene/search/function/FiltersFunctionScoreQuery.java
src/main/java/org/elasticsearch/common/lucene/search/function/FunctionScoreQuery.java
src/main/java/org/elasticsearch/common/lucene/store/ChecksumIndexOutput.java
src/main/java/org/elasticsearch/common/util/CollectionUtils.java
src/main/java/org/elasticsearch/env/NodeEnvironment.java
src/main/java/org/elasticsearch/index/analysis/HunspellTokenFilterFactory.java
src/main/java/org/elasticsearch/index/analysis/WordDelimiterTokenFilterFactory.java
src/main/java/org/elasticsearch/index/codec/postingsformat/BloomFilterPostingsFormat.java
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
src/main/java/org/elasticsearch/index/fielddata/plain/BinaryDVAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/BinaryDVNumericAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/BytesBinaryDVAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/GeoPointBinaryDVAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/NumericDVAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/SortedSetDVAtomicFieldData.java
src/main/java/org/elasticsearch/index/merge/EnableMergeScheduler.java
src/main/java/org/elasticsearch/index/merge/Merges.java
src/main/java/org/elasticsearch/index/merge/scheduler/SerialMergeSchedulerProvider.java
src/main/java/org/elasticsearch/index/search/child/ChildrenConstantScoreQuery.java
src/main/java/org/elasticsearch/index/search/child/ChildrenQuery.java
src/main/java/org/elasticsearch/index/search/child/CustomQueryWrappingFilter.java
src/main/java/org/elasticsearch/index/search/child/DeleteByQueryWrappingFilter.java
src/main/java/org/elasticsearch/index/search/child/ParentConstantScoreQuery.java
src/main/java/org/elasticsearch/index/search/child/ParentQuery.java
src/main/java/org/elasticsearch/index/search/child/TopChildrenQuery.java
src/main/java/org/elasticsearch/index/search/nested/IncludeNestedDocsQuery.java
src/main/java/org/elasticsearch/index/store/Store.java
src/main/java/org/elasticsearch/indices/analysis/HunspellService.java
src/main/java/org/elasticsearch/indices/analysis/IndicesAnalysisModule.java
src/main/java/org/elasticsearch/indices/analysis/PreBuiltTokenFilters.java
src/main/java/org/elasticsearch/indices/recovery/RecoveryTarget.java
src/main/java/org/elasticsearch/monitor/dump/AbstractDump.java
src/main/java/org/elasticsearch/monitor/dump/SimpleDump.java
src/main/java/org/elasticsearch/monitor/dump/SimpleDumpGenerator.java
src/main/java/org/elasticsearch/repositories/blobstore/BlobStoreRepository.java
src/main/java/org/elasticsearch/search/aggregations/support/ValuesSource.java
src/main/java/org/elasticsearch/search/facet/terms/strings/HashedAggregator.java
src/main/java/org/elasticsearch/search/scan/ScanContext.java
src/main/java/org/elasticsearch/search/suggest/completion/AnalyzingCompletionLookupProvider.java
src/main/java/org/elasticsearch/search/suggest/completion/Completion090PostingsFormat.java
src/main/java/org/elasticsearch/search/suggest/completion/CompletionTokenStream.java
src/test/java/org/apache/lucene/TrackingSerialMergeSchedulerTests.java
src/test/java/org/apache/lucene/queries/BlendedTermQueryTest.java
src/test/java/org/elasticsearch/benchmark/fielddata/LongFieldDataBenchmark.java
src/test/java/org/elasticsearch/common/lucene/uid/VersionsTests.java
src/test/java/org/elasticsearch/common/util/BytesRefHashTests.java
src/test/java/org/elasticsearch/common/util/CollectionUtilsTests.java
src/test/java/org/elasticsearch/index/analysis/AnalysisFactoryTests.java
src/test/java/org/elasticsearch/index/analysis/HunspellTokenFilterFactoryTests.java
src/test/java/org/elasticsearch/index/analysis/WordDelimiterTokenFilterFactoryTests.java
src/test/java/org/elasticsearch/index/codec/postingformat/DefaultPostingsFormatTests.java
src/test/java/org/elasticsearch/index/codec/postingformat/ElasticsearchPostingsFormatTest.java
src/test/java/org/elasticsearch/index/engine/internal/InternalEngineTests.java
src/test/java/org/elasticsearch/index/fielddata/AbstractStringFieldDataTests.java
src/test/java/org/elasticsearch/index/fielddata/FilterFieldDataTest.java
src/test/java/org/elasticsearch/index/fielddata/LongFieldDataTests.java
src/test/java/org/elasticsearch/indices/analyze/HunspellServiceTests.java
src/test/java/org/elasticsearch/indices/leaks/IndicesLeaksTests.java
src/test/java/org/elasticsearch/search/aggregations/support/FieldDataSourceTests.java
src/test/java/org/elasticsearch/search/child/SimpleChildQuerySearchTests.java
src/test/java/org/elasticsearch/search/highlight/HighlighterSearchTests.java
src/test/java/org/elasticsearch/search/sort/SimpleSortTests.java
src/test/java/org/elasticsearch/search/suggest/completion/CompletionPostingsFormatTest.java
src/test/java/org/elasticsearch/test/TestCluster.java
comments:
Upgrade to Lucene 4.8

Closes #5932

time:
2014-04-28T10:00:27Z
class:
src/main/java/org/elasticsearch/rest/action/cat/RestThreadPoolAction.java
comments:
Added type, max, min, queueSize & keepAlive to _cat/thread_pool

Closes #5366

time:
2014-04-28T09:55:32Z
class:
src/main/java/org/elasticsearch/index/query/functionscore/DecayFunctionBuilder.java
src/main/java/org/elasticsearch/index/query/functionscore/DecayFunctionParser.java
src/main/java/org/elasticsearch/index/query/functionscore/exp/ExponentialDecayFunctionParser.java
src/main/java/org/elasticsearch/index/query/functionscore/lin/LinearDecayFunctionParser.java
src/test/java/org/elasticsearch/search/functionscore/DecayFunctionScoreTests.java
comments:
Multi value handling in decay functions

Decay functions currently only use the first value in a field that contains
multiple values to compute the distance to the origin. Instead, it should
consider all distances if more values are in the field and then use
one of min/max/sum/avg which is defined by the user.

Relates to #3960
closes #5940

time:
2014-04-28T09:55:32Z
class:
src/main/java/org/elasticsearch/index/fielddata/IndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/BytesRefFieldComparatorSource.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/BytesRefOrdValComparator.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/BytesRefValComparator.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/DoubleValuesComparator.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/DoubleValuesComparatorBase.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/DoubleValuesComparatorSource.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/FloatValuesComparator.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/FloatValuesComparatorSource.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/GeoDistanceComparator.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/GeoDistanceComparatorSource.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/LongValuesComparator.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/LongValuesComparatorBase.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/LongValuesComparatorSource.java
src/main/java/org/elasticsearch/index/fielddata/ordinals/GlobalOrdinalsIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/AbstractBytesIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/AbstractGeoPointIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/BinaryDVIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/BinaryDVNumericIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/BytesBinaryDVIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/DisabledIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/DoubleArrayIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/FloatArrayIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/GeoPointBinaryDVIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/NumericDVIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/PackedArrayIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/ParentChildIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/SortedSetDVBytesIndexFieldData.java
src/main/java/org/elasticsearch/index/query/functionscore/DecayFunctionParser.java
src/main/java/org/elasticsearch/index/search/nested/NestedFieldComparatorSource.java
src/main/java/org/elasticsearch/search/MultiValueMode.java
src/main/java/org/elasticsearch/search/sort/GeoDistanceSortParser.java
src/main/java/org/elasticsearch/search/sort/ScriptSortParser.java
src/main/java/org/elasticsearch/search/sort/SortParseElement.java
src/test/java/org/elasticsearch/index/fielddata/AbstractFieldDataImplTests.java
src/test/java/org/elasticsearch/index/fielddata/AbstractNumericFieldDataTests.java
src/test/java/org/elasticsearch/index/fielddata/AbstractStringFieldDataTests.java
src/test/java/org/elasticsearch/index/fielddata/NoOrdinalsStringFieldDataTests.java
src/test/java/org/elasticsearch/index/fielddata/ParentChildFieldDataTests.java
src/test/java/org/elasticsearch/index/search/nested/AbstractNumberNestedSortingTests.java
src/test/java/org/elasticsearch/index/search/nested/DoubleNestedSortingTests.java
src/test/java/org/elasticsearch/index/search/nested/FloatNestedSortingTests.java
src/test/java/org/elasticsearch/index/search/nested/LongNestedSortingTests.java
src/test/java/org/elasticsearch/index/search/nested/NestedSortingTests.java
comments:
Move SortMode to org.elasticsearch.search and rename to MultiValueMode

time:
2014-04-28T09:39:12Z
class:
comments:
[DOCS] Removed leftover indices status link

time:
2014-04-28T09:39:12Z
class:
comments:
[DOCS] Fixed get asciidoc missing section warning

time:
2014-04-28T09:39:12Z
class:
comments:
[DOCS] Fixed scripting example

time:
2014-04-28T09:07:54Z
class:
src/main/java/org/elasticsearch/transport/local/LocalTransport.java
src/test/java/org/elasticsearch/test/transport/AssertingLocalTransport.java
comments:
spelling

time:
2014-04-28T09:02:30Z
class:
comments:
Upgrade to Guava 17
closes #5953

time:
2014-04-28T08:56:43Z
class:
src/main/java/org/elasticsearch/transport/TransportService.java
src/test/java/org/elasticsearch/transport/AbstractSimpleTransportTests.java
comments:
Raise node disconnected even if the transport is stopped
during the stop process, we raise network disconnect, so it is valid to raise then while we are in stop mode, and actually, we should not miss any events in such a case.
Typically, this is not a problem, since its during the normal shutdown process on the JVM, but when running a reused cluster within the JVM (like in our test infra with the shared cluster), we should properly raise those node disconnects
closes #5918

time:
2014-04-28T08:40:45Z
class:
comments:
Removed indices-status docs.

Related #4854

time:
2014-04-28T08:21:50Z
class:
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/BytesRefOrdValComparator.java
src/main/java/org/elasticsearch/index/fielddata/ordinals/EmptyOrdinals.java
src/main/java/org/elasticsearch/index/fielddata/ordinals/InternalGlobalOrdinalsBuilder.java
src/main/java/org/elasticsearch/index/fielddata/ordinals/MultiOrdinals.java
src/main/java/org/elasticsearch/index/fielddata/ordinals/Ordinals.java
src/main/java/org/elasticsearch/index/fielddata/ordinals/OrdinalsBuilder.java
src/main/java/org/elasticsearch/index/fielddata/ordinals/SinglePackedOrdinals.java
src/main/java/org/elasticsearch/index/fielddata/plain/DoubleArrayIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/FSTBytesAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/FSTBytesIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/FloatArrayIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/GeoPointCompressedAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/GeoPointCompressedIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/GeoPointDoubleArrayAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/GeoPointDoubleArrayIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/PackedArrayAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/PackedArrayIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/PagedBytesAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/PagedBytesIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/ParentChildIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/SortedSetDVAtomicFieldData.java
src/main/java/org/elasticsearch/search/facet/terms/strings/TermsStringOrdinalsFacetExecutor.java
src/test/java/org/elasticsearch/index/fielddata/AbstractStringFieldDataTests.java
src/test/java/org/elasticsearch/index/fielddata/FilterFieldDataTest.java
src/test/java/org/elasticsearch/index/fielddata/ordinals/MultiOrdinalsTests.java
comments:
Make ordinals start at 0.

Our ordinals currently start at 1, like FieldCache did in older Lucene versions.
However, Lucene 4.2 changed it in order to make ordinals start at 0, using -1
as the ordinal for the missing value. We should switch to the same numbering as
Lucene for consistency. This also allows to remove some abstraction on top of
Lucene doc values.

Close #5871

time:
2014-04-26T14:46:34Z
class:
src/main/java/org/elasticsearch/rest/action/cat/RestAllocationAction.java
comments:
_cat/allocation to return no value for `disk.total` when not available (e.g. non data nodes) instead of `-1b`

Closes #5948

time:
2014-04-25T21:08:26Z
class:
src/main/java/org/elasticsearch/script/NativeScriptEngineService.java
src/main/java/org/elasticsearch/script/ScriptEngineService.java
src/main/java/org/elasticsearch/script/ScriptService.java
src/main/java/org/elasticsearch/script/mustache/MustacheScriptEngineService.java
src/main/java/org/elasticsearch/script/mvel/MvelScriptEngineService.java
src/test/java/org/elasticsearch/test/TestCluster.java
comments:
Disable dynamic scripting by default

Closes #5853

time:
2014-04-25T21:06:12Z
class:
src/main/java/org/elasticsearch/action/bulk/TransportShardBulkAction.java
src/main/java/org/elasticsearch/action/delete/DeleteRequest.java
src/main/java/org/elasticsearch/action/delete/TransportDeleteAction.java
src/main/java/org/elasticsearch/action/delete/index/TransportShardDeleteAction.java
src/main/java/org/elasticsearch/action/get/GetRequest.java
src/main/java/org/elasticsearch/action/index/IndexRequest.java
src/main/java/org/elasticsearch/action/index/TransportIndexAction.java
src/main/java/org/elasticsearch/action/update/UpdateHelper.java
src/main/java/org/elasticsearch/action/update/UpdateRequest.java
src/main/java/org/elasticsearch/index/VersionType.java
src/main/java/org/elasticsearch/index/engine/Engine.java
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
src/main/java/org/elasticsearch/index/translog/Translog.java
src/test/java/org/elasticsearch/document/BulkTests.java
src/test/java/org/elasticsearch/index/VersionTypeTests.java
src/test/java/org/elasticsearch/update/UpdateTests.java
comments:
Version types `EXTERNAL` & `EXTERNAL_GTE` test for version equality in read operation & disallow them in the Update API

Separate version check logic for reads and writes for all version types, which allows different behavior in these cases.
Change `VersionType.EXTERNAL` & `VersionType.EXTERNAL_GTE` to behave the same as `VersionType.INTERNAL` for read operations.
The previous behavior was fit for writes but is useless in reads.

This commit also makes the usage of `EXTERNAL` & `EXTERNAL_GTE` in the update api raise a validation error as it make cause data to
be lost.

Closes #5663 , Closes #5661, Closes #5929
@bleskes I validate enum type params client side (no need to make the request) so this test fails.

Perhaps `catch: request` (the request should fail) or `catch: param` (there should be a param validation error) would be a better idea.


time:
2014-04-25T20:59:10Z
class:
comments:
Fix typo

time:
2014-04-25T20:57:23Z
class:
comments:
Update setup repositories documentation

Update doc so
http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/setup-repositories.html
example is going to 1.1 instead of 0.90

time:
2014-04-25T17:01:52Z
class:
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/GlobalOrdinalsStringTermsAggregator.java
comments:
Don't create docCounts equal to maxOrd for the GlobalOrdinalsStringTermsAggregator.WithHash impl.

Relates #5873

time:
2014-04-25T16:05:07Z
class:
src/main/java/org/elasticsearch/index/fielddata/ordinals/GlobalOrdinalsIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/ordinals/InternalGlobalOrdinalsBuilder.java
src/main/java/org/elasticsearch/search/aggregations/bucket/BucketsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/GlobalOrdinalsStringTermsAggregator.java
src/test/java/org/elasticsearch/benchmark/search/aggregations/GlobalOrdinalsBenchmark.java
comments:
Use segment ordinals as global ordinals if a segment contains all values for a field on a shard level.

Relates to #5854
Closes #5873

time:
2014-04-25T12:31:20Z
class:
src/main/java/org/elasticsearch/action/bulk/TransportShardBulkAction.java
src/main/java/org/elasticsearch/action/index/IndexRequest.java
src/main/java/org/elasticsearch/action/index/TransportIndexAction.java
src/main/java/org/elasticsearch/action/support/replication/ShardReplicationOperationRequest.java
src/main/java/org/elasticsearch/action/support/replication/TransportShardReplicationOperationAction.java
src/main/java/org/elasticsearch/index/engine/Engine.java
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
src/main/java/org/elasticsearch/index/shard/service/IndexShard.java
src/main/java/org/elasticsearch/index/shard/service/InternalIndexShard.java
src/test/java/org/elasticsearch/benchmark/stress/SingleThreadBulkStress.java
comments:
Don't lookup version for auto generated id and create
When a create document is executed, and its an auto generated id (based on UUID), we know that the document will not exists in the index, so there is no need to try and lookup the version from the index.
For many cases, like logging, where ids are auto generated, this can improve the indexing performance, specifically for lightweight documents where analysis is not a big part of the execution.
closes #5917

time:
2014-04-25T10:36:32Z
class:
src/test/java/org/elasticsearch/index/engine/internal/InternalEngineTests.java
comments:
[TEST] Logger names differ based on the classpath, inside the IDE the package name is used as a prefix

time:
2014-04-25T09:42:05Z
class:
src/main/java/org/elasticsearch/action/bulk/TransportShardBulkAction.java
src/main/java/org/elasticsearch/action/delete/TransportDeleteAction.java
src/main/java/org/elasticsearch/action/delete/index/TransportShardDeleteAction.java
src/main/java/org/elasticsearch/action/deletebyquery/TransportShardDeleteByQueryAction.java
src/main/java/org/elasticsearch/action/index/TransportIndexAction.java
src/main/java/org/elasticsearch/index/engine/Engine.java
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
src/main/java/org/elasticsearch/index/shard/service/IndexShard.java
src/main/java/org/elasticsearch/index/shard/service/InternalIndexShard.java
src/test/java/org/elasticsearch/index/engine/internal/InternalEngineTests.java
comments:
Make Create/Update/Delete classes less mutable

Today we use a builder pattern / setters to set relevant information
to Engine#Delete|Create|Index. Yet almost all the values are required
but they are not passed via ctor arguments but via an error prone builder
pattern. If we add a required argument we should see compile errors on that
level to make sure we don't miss any place to set them.

Prerequisite for #5917

time:
2014-04-25T09:41:18Z
class:
src/test/java/org/elasticsearch/search/suggest/completion/CompletionPostingsFormatTest.java
comments:
temporarily mute this test on Java 8 until we fix getFiniteStrings

time:
2014-04-25T09:07:31Z
class:
src/test/java/org/elasticsearch/search/suggest/CompletionSuggestSearchTests.java
comments:
[TEST] Prevent deletion of the second document by using different ids

time:
2014-04-25T09:03:22Z
class:
src/test/java/org/elasticsearch/search/basic/SearchWithRandomExceptionsTests.java
comments:
[TEST] Expect all shards failed in SearchWithRandomExceptionsTests

time:
2014-04-25T06:57:06Z
class:
src/main/java/org/elasticsearch/search/SearchService.java
comments:
Throw exception if an additional field was placed inside the "query" body

Currently the parser accepts queries like

```
"query" : {
     "any_query": {
         ...
     },
     "any_field_name":...
}
```

The "any_field_name" is silently ignored. However, this also causes the parser
not to move to the next closing bracket which in turn can lead to additional query
paremters being ignored such as "fields", "highlight",...
This was the case in issue #4895

closes issue #4895

time:
2014-04-25T06:51:08Z
class:
src/main/java/org/elasticsearch/index/query/TemplateQueryParser.java
src/test/java/org/elasticsearch/index/query/TemplateQueryTest.java
comments:
Fix TemplateQueryParser swallows additional parameters

Request parameters such as "size" and "fields" were ignored when
placed after the template query in the reqest.

closes #5933

time:
2014-04-24T22:07:10Z
class:
src/test/java/org/elasticsearch/search/suggest/CompletionSuggestSearchTests.java
comments:
[TEST] Use assertAllSuccessful instead of assertNoFailures in CompletionSuggestSearchTests.

time:
2014-04-24T21:25:23Z
class:
src/test/java/org/elasticsearch/search/aggregations/bucket/DateHistogramTests.java
comments:
[TEST] Fix typo in DateHistogramTests that fails the test since it expects dates to be rounded by day.

time:
2014-04-24T20:41:12Z
class:
src/main/java/org/elasticsearch/index/fielddata/plain/FSTBytesAtomicFieldData.java
comments:
Remove java6ism in FSTBytesAtomicFieldData.

time:
2014-04-24T20:31:23Z
class:
src/main/java/org/elasticsearch/common/logging/Loggers.java
src/main/java/org/elasticsearch/common/lucene/LoggerInfoStream.java
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
src/test/java/org/elasticsearch/common/lucene/LuceneTest.java
src/test/java/org/elasticsearch/index/engine/internal/InternalEngineTests.java
comments:
Send Lucene's IndexWriter infoStream messages to Logger lucene.iw, level=TRACE

Lucene's IndexWriter logs many low-level details to its infoStream
which can be helpful for diagnosing; with this change, if you enable
TRACE logging for the "lucene.iw" logger name then IndexWriter's
infoStream output will be captured and can later be scrutinized
e.g. using https://code.google.com/a/apache-extras.org/p/luceneutil/source/browse/src/python/iwLogToGraphs.py
to generate graphs like http://people.apache.org/~mikemccand/lucenebench/iw.html

Closes #5891

time:
2014-04-24T20:18:31Z
class:
src/main/java/org/elasticsearch/Version.java
src/test/java/org/elasticsearch/VersionTests.java
src/test/java/org/elasticsearch/cluster/ack/AckClusterUpdateSettingsTests.java
src/test/java/org/elasticsearch/cluster/ack/AckTests.java
src/test/java/org/elasticsearch/indices/fielddata/breaker/RandomExceptionCircuitBreakerTests.java
src/test/java/org/elasticsearch/mget/SimpleMgetTests.java
src/test/java/org/elasticsearch/nested/SimpleNestedTests.java
src/test/java/org/elasticsearch/search/basic/SearchWithRandomExceptionsTests.java
src/test/java/org/elasticsearch/search/child/SimpleChildQuerySearchTests.java
src/test/java/org/elasticsearch/search/query/SimpleQueryTests.java
src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java
src/test/java/org/elasticsearch/test/ImmutableTestCluster.java
src/test/java/org/elasticsearch/test/engine/MockInternalEngine.java
src/test/java/org/elasticsearch/test/rest/ElasticsearchRestTests.java
src/test/java/org/elasticsearch/test/store/MockFSDirectoryService.java
src/test/java/org/elasticsearch/test/store/MockRamDirectoryService.java
src/test/java/org/elasticsearch/test/transport/AssertingLocalTransport.java
comments:
[TEST] Allow to disable randomization of shards and replicas via system property

Needed for REST backwards compatibility tests, since we need to run older tests with the latest runner, which randomizes shards and replicas, but the tests rely on defaults (5,1).

Done in a generic way based on compatibility versions e.g. `-Dtests.compatibility=1.0.0` allows to run tests in a special manner that is compatibile with 1.0.0 version.

Also moved back randomIndexTemplate to ElasticsearchIntegrationTest (from ImmutableCluster) where all the randomized aspects should be.

Closes #5897

time:
2014-04-24T20:11:17Z
class:
src/main/java/org/elasticsearch/index/query/TemplateQueryParser.java
comments:
Add some more documentation to TemplateQueryParser

Relates to #4879

time:
2014-04-24T19:42:08Z
class:
src/test/java/org/elasticsearch/search/suggest/CompletionSuggestSearchTests.java
comments:
test was missing tie-break for the two suggestions

time:
2014-04-24T14:44:02Z
class:
comments:
Update keyword-repeat-tokenfilter.asciidoc

time:
2014-04-24T13:46:48Z
class:
src/main/java/org/elasticsearch/index/query/functionscore/DecayFunctionParser.java
src/test/java/org/elasticsearch/search/functionscore/DecayFunctionScoreTests.java
comments:
Revert "Throw exception if decay is requested for a field with multiple values"

This reverts commit 95d781510f9ec66b6615df4e26ccc18da9c2b155.

see https://github.com/elasticsearch/elasticsearch/issues/3960#issuecomment-41279373

time:
2014-04-24T13:18:39Z
class:
src/main/java/org/elasticsearch/index/query/functionscore/DecayFunctionParser.java
src/test/java/org/elasticsearch/search/functionscore/DecayFunctionScoreTests.java
comments:
Throw exception if decay is requested for a field with multiple values

closes #3960

time:
2014-04-24T12:16:07Z
class:
src/test/java/org/elasticsearch/index/fielddata/DisabledFieldDataFormatTests.java
comments:
[TEST] DisabledFieldDataFormatTests assumes a single replica.

time:
2014-04-24T09:48:36Z
class:
src/main/java/org/elasticsearch/search/aggregations/Aggregator.java
src/main/java/org/elasticsearch/search/query/QueryPhase.java
comments:
Instantiate facets/aggregations during the QUERY phase.

In case of a DFS_QUERY_THEN_FETCH request, facets and aggregations are currently
instantiated during the DFS phase while they only become useful during the QUERY
phase. By instantiating during the QUERY phase instead, we can make better use
of recycling since objects will have a shorter life out of the recyclers.

Close #5821

time:
2014-04-24T09:48:24Z
class:
src/main/java/org/elasticsearch/action/search/type/TransportSearchDfsQueryThenFetchAction.java
comments:
Fail a DFS_QUERY_THEN_FETCH request if all shards failed the QUERY phase.

Today, if some shards pass the DFS phase but all of them fail the QUERY phase,
the response will only consist of failed shards. We should throw an exception
instead in order to be consistent with the QUERY_THEN_FETCH type.

time:
2014-04-24T07:44:36Z
class:
src/main/java/org/elasticsearch/search/aggregations/metrics/percentiles/InternalPercentiles.java
src/main/java/org/elasticsearch/search/aggregations/metrics/percentiles/Percentiles.java
src/main/java/org/elasticsearch/search/aggregations/metrics/percentiles/PercentilesAggregator.java
src/main/java/org/elasticsearch/search/aggregations/metrics/percentiles/PercentilesBuilder.java
src/main/java/org/elasticsearch/search/aggregations/metrics/percentiles/PercentilesEstimator.java
src/main/java/org/elasticsearch/search/aggregations/metrics/percentiles/PercentilesParser.java
src/main/java/org/elasticsearch/search/aggregations/metrics/percentiles/tdigest/TDigest.java
src/test/java/org/elasticsearch/search/aggregations/metrics/PercentilesTests.java
comments:
Remove abstraction in the percentiles aggregation.

We initially added abstraction in the percentiles aggregation in order to be
able to plug in different percentiles estimators. However, only one of the 3
options that we looked into proved useful and I don't see us adding new
estimators in the future.

Moreover, because of this, we let the parser put unknown parameters into a hash
table in case these parameters would have meaning for a specific percentiles
estimator impl. But this makes parsing error-prone: for example a user reported
that his percentiles aggregation reported extremely high (in the order of
several millions while the maximum field value was `5`), and the reason was that
he had a typo and had written `fields` instead of `field`. As a consequence,
the percentiles aggregation used the parent value source which was a timestamp,
hence the large values. Parsing would now barf in case of an unknown parameter.

Close #5859

time:
2014-04-24T07:14:09Z
class:
src/main/java/org/elasticsearch/index/fielddata/AtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/BytesRefOrdValComparator.java
src/main/java/org/elasticsearch/index/fielddata/ordinals/DocIdOrdinals.java
src/main/java/org/elasticsearch/index/fielddata/ordinals/EmptyOrdinals.java
src/main/java/org/elasticsearch/index/fielddata/ordinals/GlobalOrdinalsIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/ordinals/InternalGlobalOrdinalsBuilder.java
src/main/java/org/elasticsearch/index/fielddata/ordinals/MultiOrdinals.java
src/main/java/org/elasticsearch/index/fielddata/ordinals/Ordinals.java
src/main/java/org/elasticsearch/index/fielddata/ordinals/SinglePackedOrdinals.java
src/main/java/org/elasticsearch/index/fielddata/plain/AbstractGeoPointIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/BinaryDVAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/BinaryDVNumericAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/BytesBinaryDVAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/DoubleArrayAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/DoubleArrayIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/FSTBytesAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/FSTBytesIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/FloatArrayAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/FloatArrayIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/GeoPointBinaryDVAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/GeoPointBinaryDVIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/GeoPointCompressedAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/GeoPointCompressedIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/GeoPointDoubleArrayAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/GeoPointDoubleArrayIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/NumericDVAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/PackedArrayAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/PackedArrayIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/PagedBytesAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/PagedBytesIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/ParentChildAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/SortedSetDVAtomicFieldData.java
src/main/java/org/elasticsearch/search/facet/terms/strings/TermsStringOrdinalsFacetExecutor.java
src/test/java/org/elasticsearch/index/fielddata/AbstractFieldDataImplTests.java
src/test/java/org/elasticsearch/index/fielddata/AbstractNumericFieldDataTests.java
src/test/java/org/elasticsearch/index/fielddata/AbstractStringFieldDataTests.java
src/test/java/org/elasticsearch/index/fielddata/BinaryDVFieldDataTests.java
src/test/java/org/elasticsearch/index/fielddata/DuelFieldDataTests.java
src/test/java/org/elasticsearch/index/fielddata/FilterFieldDataTest.java
src/test/java/org/elasticsearch/index/fielddata/ParentChildFieldDataTests.java
src/test/java/org/elasticsearch/index/fielddata/ordinals/MultiOrdinalsTests.java
src/test/java/org/elasticsearch/index/fielddata/ordinals/SingleOrdinalsTests.java
comments:
Field data diet.

We have lots of unused, or almost unused methods in our field data impls,
especially when dealing with ordinals. Let's nuke them.

Close #5874

time:
2014-04-23T19:29:29Z
class:
comments:
Add REST API spec for /_search_shards endpoint

Also adds REST test for /_search_shards

Closes #5907

time:
2014-04-23T19:13:12Z
class:
src/test/java/org/elasticsearch/indexing/IndexActionTests.java
comments:
[TEST] add a test that explicitly verifies no duplicates are created
we do this test in other places in ES, but no dedicated test for it. This test was born out of the auto generate id work, but we should have this test regardless if it gets in or not

time:
2014-04-23T19:05:14Z
class:
comments:
[DOCS] rewrite -> fuzzy_rewrite in match query
Fixed typo

time:
2014-04-23T15:54:00Z
class:
src/main/java/org/elasticsearch/common/breaker/MemoryCircuitBreaker.java
src/main/java/org/elasticsearch/index/fielddata/RamAccountingTermsEnum.java
src/main/java/org/elasticsearch/index/fielddata/plain/PackedArrayIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/PagedBytesIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/ParentChildIndexFieldData.java
src/test/java/org/elasticsearch/common/breaker/MemoryCircuitBreakerTests.java
src/test/java/org/elasticsearch/indices/fielddata/breaker/CircuitBreakerServiceTests.java
comments:
Include name of the field that caused a circuit break in the log and exception message

Fixes #5718
Closes #5841

time:
2014-04-23T15:46:35Z
class:
src/test/java/org/elasticsearch/test/ImmutableTestCluster.java
comments:
[TEST] Randomized number of replicas between 0 and the number of data nodes - 1 (rather than just between 0 and 1)

Closes #5896

time:
2014-04-23T14:42:41Z
class:
src/main/java/org/elasticsearch/index/merge/EnableMergeScheduler.java
src/main/java/org/elasticsearch/index/merge/scheduler/ConcurrentMergeSchedulerProvider.java
comments:
Closes #5882

time:
2014-04-23T13:40:21Z
class:
src/main/java/org/elasticsearch/indices/recovery/RecoverySettings.java
src/test/java/org/elasticsearch/test/ImmutableTestCluster.java
comments:
Change default recovery throttling to 50MB / sec

The current setting of 20MB/sec seems to be too conservative given
the capabilities of modern hardware / network throughput.
A 50MB default should provide better out of the box performance.

time:
2014-04-23T13:01:25Z
class:
src/main/java/org/elasticsearch/index/analysis/NumericDateAnalyzer.java
src/main/java/org/elasticsearch/index/analysis/NumericDoubleAnalyzer.java
src/main/java/org/elasticsearch/index/analysis/NumericFloatAnalyzer.java
src/main/java/org/elasticsearch/index/analysis/NumericIntegerAnalyzer.java
src/main/java/org/elasticsearch/index/analysis/NumericLongAnalyzer.java
src/main/java/org/elasticsearch/index/mapper/core/ByteFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/core/DateFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/core/DoubleFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/core/FloatFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/core/IntegerFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/core/LongFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/core/Murmur3FieldMapper.java
src/main/java/org/elasticsearch/index/mapper/core/NumberFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/core/ShortFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/core/TokenCountFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/internal/BoostFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/internal/SizeFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/internal/TTLFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/internal/TimestampFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/ip/IpFieldMapper.java
src/main/java/org/elasticsearch/indices/ttl/IndicesTTLService.java
src/test/java/org/elasticsearch/index/mapper/numeric/SimpleNumericTests.java
src/test/java/org/elasticsearch/index/query/SimpleIndexQueryParserTests.java
comments:
Change default numeric precision_step

Change the default numeric precision_step to 16 for 64-bit types,
8 for 32-bit and 16-bit types. Disable precision_step for the 8-bit
byte type.

Closes #5905

time:
2014-04-23T10:13:44Z
class:
src/main/java/org/elasticsearch/indices/warmer/IndicesWarmer.java
src/main/java/org/elasticsearch/indices/warmer/InternalIndicesWarmer.java
src/test/java/org/elasticsearch/index/fielddata/FieldDataLoadingTests.java
comments:
Re-order log statements to be correct for segment and top level warming.

time:
2014-04-22T19:16:46Z
class:
comments:
Disable benchmark tests until nodes set to run with
-Des.node.bench=true

time:
2014-04-22T19:08:40Z
class:
src/main/java/org/elasticsearch/indices/store/IndicesStore.java
src/test/java/org/elasticsearch/indices/store/SimpleDistributorTests.java
src/test/java/org/elasticsearch/test/ImmutableTestCluster.java
comments:
Change default merge throttling to 50MB / sec

The current setting of 20MB/sec seems to be too conservative given
the capabilities of modern hardware. Even on cloud infrastructure this
seems to be too lowish. A 50MB default should provide better out of the box
performance

time:
2014-04-22T17:38:55Z
class:
comments:
[SPEC] Added path without scroll_id to clear_scroll

time:
2014-04-22T17:33:03Z
class:
comments:
[DOCS] getting started tutorial

time:
2014-04-22T17:30:51Z
class:
comments:
[SPEC] The scroll_id is no longer a required qs param
Can be passed in the body instead

time:
2014-04-22T17:27:37Z
class:
comments:
[SPEC] Added missing list_benchmarks test

time:
2014-04-22T17:14:26Z
class:
comments:
[SPEC] Renamed benchmark endpoints

benchmark.submit -> benchmark
benchmark.list   -> list_benchmarks
benchmark.abort  -> abort_benchmark

And fixed the related tests

time:
2014-04-22T15:29:48Z
class:
src/main/java/org/elasticsearch/index/query/HasChildFilterParser.java
src/main/java/org/elasticsearch/index/query/HasChildQueryParser.java
src/main/java/org/elasticsearch/index/query/HasParentFilterParser.java
src/main/java/org/elasticsearch/index/query/HasParentQueryParser.java
src/main/java/org/elasticsearch/index/query/IndicesQueryParser.java
src/main/java/org/elasticsearch/index/query/QueryParseContext.java
src/main/java/org/elasticsearch/index/query/TopChildrenQueryParser.java
src/main/java/org/elasticsearch/index/query/support/XContentStructure.java
src/test/java/org/elasticsearch/search/child/SimpleChildQuerySearchTests.java
comments:
Parse has_child query/filter after child type has been parsed

Fixes #5783
Fixes #5838

time:
2014-04-22T15:17:25Z
class:
src/main/java/org/elasticsearch/common/hash/MurmurHash3.java
src/main/java/org/elasticsearch/common/util/BloomFilter.java
comments:
Improved bloom filter hashing
Make improvements to how bloom filter hashing works based on guava 17 upcoming changes, see more here (https://code.google.com/p/guava-libraries/issues/detail?id=1119)
In order to do it, introduce a hashing enum, and use the (unused until now) hash type serialization to choose the correct hashing used based on serialized version.
Also, move to use our own optimized murmur hash for the new hashing logic.

time:
2014-04-22T14:54:32Z
class:
src/main/java/org/elasticsearch/rest/action/admin/cluster/shards/RestClusterSearchShardsAction.java
comments:
[DOCS] Add /_search_shards documentation
Hey @dakrone I was wondering where this page should go. The classes in the code base use the cluster prefix (e.g. `RestClusterSearchShards` etc.) and the api doesn't return actual data, maybe we should consider moving it under the cluster apis section of the docs? @clintongormley what do you think?

@javanna Yeah, that makes more sense to me.  

@javanna @clintongormley hmm... if we went with that, shouldn't I also move the `explain.asciidoc` docs to the cluster section? The reason I put in in the request section is because I view the /_search_shards API endpoint in the same light as the /_explain API.

I see! I think the difference is that the explain is more about documents and actual data, but it depends on the point of view... in fact I wasn't totally sure myself :)

I'm not violently opposed to it being in the search section, but it does feel more like cluster-level information.  Explain on the other hand actually involves search.

> Explain on the other hand actually involves search.

I still feel like `/_search_shards` involves search, as it's telling you exactly what shards your search will be executed on. Additionally it takes the `preference` and `routing` parameters, which are search-related.

Let's leave it under search then, /me was just wondering, no strong opinions really ;)


time:
2014-04-22T14:41:00Z
class:
src/main/java/org/elasticsearch/index/translog/TranslogService.java
src/test/java/org/elasticsearch/test/ImmutableTestCluster.java
comments:
[TEST] Randomize translog setting per index

time:
2014-04-22T14:37:07Z
class:
src/main/java/org/elasticsearch/index/translog/TranslogService.java
comments:
Use unlimited flush_threshold_ops for translog

Currently we use 5k operations as a flush threshold. Indexing 5k documents
per second is rather common which would cause the index to be committed on
the lucene level each time the flush logic runs which is 5 seconds by default.
We should rather use a size based threshold similar to the lucene index writer
that doesn't cause such agressive commits which can slow down indexing significantly
especially since they cause the underlying devices to fsync their data.

time:
2014-04-22T12:16:10Z
class:
comments:
Update benchmark.asciidoc

Fixed incorrect parameter spec for benchmark nodes

time:
2014-04-22T08:14:41Z
class:
src/main/java/org/elasticsearch/action/support/master/TransportMasterNodeOperationAction.java
src/main/java/org/elasticsearch/action/support/replication/TransportShardReplicationOperationAction.java
src/main/java/org/elasticsearch/action/support/single/instance/TransportInstanceSingleOperationAction.java
src/main/java/org/elasticsearch/cluster/ClusterState.java
src/main/java/org/elasticsearch/cluster/ClusterStateObserver.java
src/main/java/org/elasticsearch/cluster/service/InternalClusterService.java
src/main/java/org/elasticsearch/discovery/local/LocalDiscovery.java
src/main/java/org/elasticsearch/discovery/zen/publish/PublishClusterStateAction.java
src/test/java/org/elasticsearch/cluster/NoMasterNodeTests.java
src/test/java/org/elasticsearch/search/facet/SimpleFacetsTests.java
comments:
A new ClusterStateStatus to indicate cluster state life cycles

When the ClusterService applies a new cluster state, it is first assigned as the new active one and then all listeners are called. Some of ES's features sample the current state and try to take action on it (for example index a document). If that fails, they will wait for change in the cluster state and try again (for example, wait for a shard to start and try indexing again).

If you're unlucky you sample the state after it has been assigned as the "active" state but before all listeners has done the work. In this cases the action take (i.e., indexing a doc) will still fail (as the shard is not yet started) but waiting for a new state may take a long time or fail.

This commit adds a new ClusterStateStatus that allows to better track the stages a cluster state goes through (currently `RECEIVED`, `BEING_APPLIED` & `APPLIED`). This allows detecting that a cluster state is not yet fully applied and retry without waiting for a new state to arrive.

This commit also adds a utility class , ClusterStateObserver, to make this pattern slightly simpler and avoid common pit falls.

Closes #5741

time:
2014-04-22T08:06:58Z
class:
src/test/java/org/elasticsearch/test/rest/section/RestTestSuite.java
src/test/java/org/elasticsearch/test/rest/section/TestSection.java
comments:
[TEST] Ensure that iteration order of TestSection is consistent

time:
2014-04-22T08:00:02Z
class:
src/test/java/org/elasticsearch/search/suggest/phrase/NoisyChannelSpellCheckerTests.java
comments:
[TEST] Remove ambigious 4th suggestion - order differs slightly on Java 8

time:
2014-04-22T07:52:48Z
class:
src/test/java/org/elasticsearch/test/junit/listeners/ReproduceInfoPrinter.java
src/test/java/org/elasticsearch/test/rest/ElasticsearchRestTests.java
src/test/java/org/elasticsearch/test/rest/RestTestCandidate.java
src/test/java/org/elasticsearch/test/rest/parser/RestTestSuiteParser.java
src/test/java/org/elasticsearch/test/rest/section/RestTestSuite.java
comments:
[TEST] Added blacklist to be able to skip specific REST tests

The blacklist can be provided through -Dtests.rest.blacklist and supports a comma separated list of globs
e.g. -Dtests.rest.blacklist=get/10_basic/*,index/*/*

Also added some missing docs and made it clearer that the suite/test descriptions effectively contains their (relative) path (api/yaml_file/test section)

Closes #5881

time:
2014-04-21T23:52:25Z
class:
src/main/java/org/elasticsearch/action/admin/indices/recovery/RecoveryResponse.java
src/main/java/org/elasticsearch/rest/action/admin/indices/recovery/RestRecoveryAction.java
comments:
Return valid empty JSON response when no recovery information

This is a fix to send back to the client a valid empty JSON response in
the case when we have no recovery information.

Closes #5743

time:
2014-04-21T22:08:50Z
class:
src/main/java/org/elasticsearch/action/bench/BenchmarkNodeMissingException.java
src/main/java/org/elasticsearch/action/bench/BenchmarkResponse.java
src/main/java/org/elasticsearch/action/bench/BenchmarkService.java
src/main/java/org/elasticsearch/rest/action/bench/RestBenchAction.java
comments:
Bug fix for hung clients on cluster without benchmark nodes

This is a fix for a bug whereby a cluster that has no nodes started with
-Des.node.bench=true will cause clients to hang if they attempt to
submit a benchmark.

Also adds REST tests to validate fix

Closes #5754

time:
2014-04-21T22:00:08Z
class:
src/test/java/org/elasticsearch/search/stats/SearchStatsTests.java
comments:
[TEST] make fetch time in millis test more resilient
 beef up the fetch work, and increase teh number of iterations (since we count in nanos, but reports in rounded millis)

time:
2014-04-21T18:55:03Z
class:
src/main/java/org/elasticsearch/common/network/NetworkUtils.java
comments:
Use loopback when localhost is not resolved
we use the "local host" address in sevearl places in our networking layer, if local host is not resolved for some reason, still continue and operate but using the loopback interface

time:
2014-04-21T18:45:38Z
class:
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
comments:
Searcher might not be closed if store hande can't be obtained

Today we first get a reference to the IndexSearcher in #acquireSearcher
and then futher down we try to run Store#incRef() which might throw an
exception if the store is already closed. There is a small window
that allows this to happen during InternalEngine#close() when we try
to acquire the searcher at the same time and the engine is the last
resource that holds a reference to the store.

This commit only affects unreleased code since the Store's ref counting
has not yet been released.

time:
2014-04-21T18:39:33Z
class:
comments:
Update benchmark.asciidoc

time:
2014-04-21T09:44:16Z
class:
src/main/java/org/elasticsearch/index/shard/service/InternalIndexShard.java
src/test/java/org/elasticsearch/gateway/local/SimpleRecoveryLocalGatewayTests.java
comments:
[Tests] SimpleRecoveryLocalGatewayTests.testSingleNodeNoFlush could fail if shards were not started

The test starts a single node, indexes into, restarts the node and checks that no data was lost. It only indexed into 2 shards and didn't wait for green meaning that the node could be restarted with non-started primary. In that case the node will not re-assign the primary as it was not started. This commit makes sure that we either wait for primaries to start or index into all shards which has the same net effect.

Also extending some logging in InternalIndexShard.

time:
2014-04-20T11:39:32Z
class:
comments:
Update function-score-query.asciidoc

time:
2014-04-19T20:44:44Z
class:
comments:
[DOCS] fix typo

time:
2014-04-19T15:46:52Z
class:
src/test/java/org/elasticsearch/index/suggest/stats/SuggestStatsTests.java
comments:
[Test] Let SuggestStatsTests.testSimpleStats do more work

The test verifies that stats are measure by checking timeInMillis>0. On fast machines the suggestions are done in < 1 millis time. The tests now index documents (to power suggestions) and does multiple suggestions per iterations to slow things down.

time:
2014-04-19T06:53:45Z
class:
comments:
Update forbidden-apis to 1.5.1 and remove the relaxed missing classes error.

time:
2014-04-18T19:52:24Z
class:
comments:
Upgrade to mvel 2.2.0.Final
closes #5877

time:
2014-04-18T16:56:08Z
class:
src/main/java/org/elasticsearch/action/support/replication/TransportIndexReplicationOperationAction.java
src/main/java/org/elasticsearch/action/support/replication/TransportIndicesReplicationOperationAction.java
src/main/java/org/elasticsearch/action/support/replication/TransportShardReplicationOperationAction.java
src/main/java/org/elasticsearch/index/engine/Engine.java
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
src/main/java/org/elasticsearch/index/shard/service/IndexShard.java
src/main/java/org/elasticsearch/index/shard/service/InternalIndexShard.java
src/main/java/org/elasticsearch/indices/cluster/IndicesClusterStateService.java
comments:
Fail replica shards locally upon failures

When a replication operation (index/delete/update) fails to be executed properly, we fail the replica and allow master to allocate a new copy of it. At the moment, the node hosting the primary shard is responsible of notifying the master of a failed replica. However, if the replica shard is initializing (`POST_RECOVERY` state), we have a racing condition between the failed shard message and moving the shard into the `STARTED` state. If the latter happen first, master will fail to resolve the fail shard message.

This commit builds on #5800 and fails the engine of the replica shard if a replication operation fails. This protects us against the above as the shard will reject the `STARTED` command from master. It also makes us more resilient to other racing conditions in this area.

Closes #5847

time:
2014-04-18T16:20:44Z
class:
src/test/java/org/elasticsearch/index/engine/internal/InternalEngineMergeTests.java
comments:
[TEST] Make InternalEngineMergeTests more stable

time:
2014-04-18T15:54:52Z
class:
comments:
Removed leading spaces on commented config key lines in elasticsearch.yml
Author: Sean Gallagher
Date: 17 Apr 2014 16:18 EDT

Removed spaces on commented lines containing config key entries to prevent
users from inadvertently messing up the indents in elasticsearch.yml.
Closes #5842

time:
2014-04-18T13:09:00Z
class:
src/test/java/org/elasticsearch/search/query/MultiMatchQueryTests.java
comments:
[TEST] _id is not indexed by default, sort on score,_uid in MultiMatchQueryTests

time:
2014-04-18T12:27:13Z
class:
src/main/java/org/elasticsearch/action/bulk/TransportShardBulkAction.java
src/main/java/org/elasticsearch/action/index/TransportIndexAction.java
src/main/java/org/elasticsearch/cluster/action/index/MappingUpdatedAction.java
src/main/java/org/elasticsearch/percolator/PercolatorService.java
comments:
Moved the updateMappingOnMaster logic into a single place.

Closes #5798

time:
2014-04-18T10:15:44Z
class:
src/test/java/org/elasticsearch/search/query/MultiMatchQueryTests.java
comments:
[TEST] added sort by "_id" when score is the same to MultiMatchQueryTests#testEquivalence

A merge (and refresh) might rarely happen in the background between the two queries whose output is compared. It might then happen that two docs with same scores get returned by the two queries in a different order due to different lucene document id (which has changed in the meantime). To fix this we need to order by id when the score is the same, so that we can safely compare the output of the two queries (multimatch and dismax).

time:
2014-04-18T09:31:22Z
class:
src/test/java/org/elasticsearch/repositories/azure/AzureSnapshotRestoreITest.java
src/test/java/org/elasticsearch/repositories/azure/AzureSnapshotRestoreTest.java
comments:
Update to elasticsearch 1.1.1

(Impact only on tests as test framework moved a bit)

(cherry picked from commit e5a32c0)

time:
2014-04-18T09:15:54Z
class:
comments:
Remove S3 gateway

In elasticsearch core code, we removed Gateways (see https://github.com/elasticsearch/elasticsearch/issues/5422).

We need now to remove S3 gateway from aws plugin.

Closes #75.

time:
2014-04-18T09:14:46Z
class:
src/main/java/org/elasticsearch/gateway/s3/S3Gateway.java
src/main/java/org/elasticsearch/gateway/s3/S3GatewayModule.java
src/main/java/org/elasticsearch/index/gateway/s3/S3IndexGateway.java
src/main/java/org/elasticsearch/index/gateway/s3/S3IndexGatewayModule.java
src/main/java/org/elasticsearch/index/gateway/s3/S3IndexShardGateway.java
comments:
Remove S3 gateway

In elasticsearch core code, we removed Gateways (see https://github.com/elasticsearch/elasticsearch/issues/5422).

We need now to remove S3 gateway from aws plugin.

Closes #75.

time:
2014-04-18T09:14:46Z
class:
src/main/java/org/elasticsearch/discovery/ec2/Ec2Discovery.java
src/main/java/org/elasticsearch/gateway/s3/S3Gateway.java
src/test/java/org/elasticsearch/repositories/s3/S3SnapshotRestoreTest.java
comments:
cloud-aws 2.1.0 doesn't support elasticsearch 1.1.1

Closes #74.
(cherry picked from commit a9a76e2)

time:
2014-04-17T21:39:03Z
class:
comments:
Update forbidden-apis to 1.5.1 and remove the relaxed missing classes error.

time:
2014-04-17T17:28:37Z
class:
comments:
Add a site plugin into list

Howdy,

Not sure if this is kosher but I would like to add my site plugin to the list in the docs.

time:
2014-04-17T14:45:46Z
class:
comments:
[BUILD] Fail release if test have AwaitsFix annotations

Note this commit upgrades Forbidden APIs to version 1.5

Closes #5807

time:
2014-04-17T12:42:58Z
class:
comments:
Update allocation.asciidoc

time:
2014-04-17T04:51:11Z
class:
src/test/java/org/elasticsearch/discovery/ZenUnicastDiscoveryTestsMinimumMasterNodes.java
src/test/java/org/elasticsearch/discovery/ZenUnicastDiscoveryTestsSpecificNodes.java
comments:
[TEST] Use startNodesAsync in unicast discovery tests.

time:
2014-04-16T21:28:43Z
class:
comments:
[DOCS] Make snapshot repository examples consistent

time:
2014-04-16T20:59:31Z
class:
src/test/java/org/elasticsearch/transport/AbstractSimpleTransportTests.java
comments:
[TEST] make testTimeoutSendExceptionWithDelayedResponse more reliable on slow systems

time:
2014-04-16T15:21:19Z
class:
src/main/java/org/elasticsearch/Version.java
comments:
Added version constants for 1.1.2 and 1.0.4

time:
2014-04-16T13:59:56Z
class:
src/test/java/org/elasticsearch/index/engine/internal/InternalEngineTests.java
comments:
[Test] InternalEngineTests: increased gc deletes interval & turn it off randomly

time:
2014-04-16T13:41:38Z
class:
comments:
Update multi-match-query.asciidoc

Typo

time:
2014-04-16T13:19:17Z
class:
src/test/java/org/apache/lucene/util/AbstractRandomizedTest.java
comments:
[TEST] Ignore bogus system properties.

LuceneTestCase might reset some solr properties that cause
our tests to fail if the run before in the same JVM We just ignore
solr properties.

time:
2014-04-16T13:10:28Z
class:
src/test/java/org/elasticsearch/percolator/TTLPercolatorTests.java
comments:
[TEST] catch exceptions if TTL already expired when indexing

TTLPercolatorTests indexes docs with small TTLs which can trigger
AlreadyExpiredException exception. This is expected while rare and
we should just catch them.

time:
2014-04-16T12:50:40Z
class:
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
comments:
Ensure close is called under lock in the case of an engine failure

Until today we did close the engine without aqcuireing the write lock
since most calls were still holding a read lock. This commit removes
the code that holds on to the readlock when failing the engine which
means we can simply call #close()

time:
2014-04-16T12:45:54Z
class:
src/main/java/org/elasticsearch/cluster/routing/allocation/AllocationService.java
comments:
add debug logs if failed shards can not be resolved.

time:
2014-04-16T08:49:24Z
class:
src/test/java/org/elasticsearch/index/search/child/ChildrenConstantScoreQueryTests.java
src/test/java/org/elasticsearch/index/search/child/ChildrenQueryTests.java
src/test/java/org/elasticsearch/index/search/child/ParentConstantScoreQueryTests.java
src/test/java/org/elasticsearch/index/search/child/ParentQueryTests.java
comments:
[TEST] Reduce the amount of docs being indexed.

time:
2014-04-16T07:13:29Z
class:
src/main/java/org/elasticsearch/action/search/type/TransportSearchHelper.java
src/test/java/org/elasticsearch/search/scroll/SearchScrollTests.java
comments:
Better deal with invalid scroll ids.

Closes #5738

time:
2014-04-16T06:01:35Z
class:
comments:
Fix tests when running mvn tests
(cherry picked from commit 1edd72e)

time:
2014-04-15T23:30:30Z
class:
comments:
[DOCS] Change bucket names to use "-" instead of "_" in examples

While it's possible to create a bucket with "_" in US Standard region, AWS Java SDK cannot work with such buckets. Changing all examples to use "-" instead of "_" in bucket names.

Closes #72

time:
2014-04-15T21:01:35Z
class:
src/main/java/org/elasticsearch/percolator/PercolatorService.java
src/test/java/org/elasticsearch/percolator/PercolatorTests.java
comments:
[TEST] Fix PercolatorTests#testSimple2

This test requires a mapping since otherwise if there is no mapping
added the percolator query might not be parsed as a query on a numeric
field since the query might arrive on a node before the dynamic mapping
reached that node.

This commit also moves the `indexService.readAllowed()` call up before
the number of percolation queries is check to make sure we fail if reads
are not allowed - there might be a query in-flight which means we need
to check another node rather than return an empty result.

time:
2014-04-15T17:19:41Z
class:
src/test/java/org/elasticsearch/percolator/PercolatorTests.java
comments:
[TEST] Wait for green, and refresh after indexing in percolator test

time:
2014-04-15T15:57:25Z
class:
comments:
Remove garbage

time:
2014-04-15T15:03:31Z
class:
src/main/java/org/elasticsearch/common/io/FileSystemUtils.java
src/test/java/org/elasticsearch/test/TestCluster.java
comments:
[TEST] Don't delete data dirs after test - only delete their content.

Closes #5815

time:
2014-04-15T14:42:23Z
class:
comments:
[DOCS] Update merge docs to reflect the max_merge_at_once property

time:
2014-04-15T14:42:23Z
class:
src/main/java/org/elasticsearch/index/merge/scheduler/MergeSchedulerModule.java
comments:
Switch back to ConcurrentMergeScheduler

Load tests showed that SerialMS has problems to keep up with
the merges under high load. We should switch back to CMS
until we have a better story to balance merge
threads / efforts across shards on a single node.

Closes #5817

time:
2014-04-15T14:20:16Z
class:
src/test/java/org/elasticsearch/percolator/PercolatorTests.java
comments:
[TEST] Wait for shards to be allocated before running testUpdateMappingDynamicallyWhilePercolating.

If the percolate request is executed soon enough, all shards fail and the
mapping is not actually updated.

time:
2014-04-15T14:01:44Z
class:
comments:
Update percolate.asciidoc

fix typo

time:
2014-04-15T13:57:04Z
class:
comments:
Update core-types.asciidoc

Missing bracket

time:
2014-04-15T13:44:08Z
class:
comments:
Updated date_formats to new dynamic_date_formats

time:
2014-04-15T11:41:01Z
class:
src/main/java/org/elasticsearch/percolator/PercolatorService.java
src/test/java/org/elasticsearch/percolator/PercolatorTests.java
comments:
Update clusterstate if mapping service has local changes

If the during percolating a new field was introduced
in the local mapping service, then those changes should
be updated in cluster state of the master as well.

Closes #5776

time:
2014-04-15T11:22:51Z
class:
src/main/java/org/elasticsearch/common/io/FileSystemUtils.java
src/main/java/org/elasticsearch/threadpool/ThreadPool.java
comments:
Cleanup FileSystemUtils#mkdirs(File)

This methods had some workarounds for bugs that seem to be fixed
in Java 7 [1]. There seem to be other problems on shared file-systems
which are not really supported by lucene anyway or rather not
recommeded. Yet the current solution that interrupts a static thread
reference is too dangrous given all the usage of NIO across
elasticsearch.

[1] http://bugs.java.com/bugdatabase/view_bug.do?bug_id=4742723

time:
2014-04-15T11:22:51Z
class:
src/main/java/org/elasticsearch/bootstrap/Bootstrap.java
src/main/java/org/elasticsearch/common/io/FileSystemUtils.java
comments:
Remove FileSystemUtils#maxOpenFiles

This method basically forcefully creates as many files as possible
to find out the process limit in a brute-force manner. The number of
possible probles with this approach would exceed the number of lines
left on this commit message.

This commit uses a JMX based alternative to print the process limit.

time:
2014-04-15T11:17:28Z
class:
src/main/java/jsr166e/CompletableFuture.java
src/main/java/jsr166e/CompletionException.java
src/main/java/jsr166e/ConcurrentHashMapV8.java
src/main/java/jsr166e/CountedCompleter.java
src/main/java/jsr166e/ForkJoinPool.java
src/main/java/jsr166e/ForkJoinTask.java
src/main/java/jsr166e/ForkJoinWorkerThread.java
src/main/java/jsr166e/LongAdderTable.java
src/main/java/jsr166e/RecursiveAction.java
src/main/java/jsr166e/RecursiveTask.java
src/main/java/jsr166e/StampedLock.java
src/main/java/jsr166e/extra/AtomicDouble.java
src/main/java/jsr166e/extra/AtomicDoubleArray.java
src/main/java/jsr166e/extra/ReadMostlyVector.java
src/main/java/jsr166e/extra/SequenceLock.java
src/main/java/jsr166y/ConcurrentLinkedDeque.java
src/main/java/jsr166y/CountedCompleter.java
src/main/java/jsr166y/ForkJoinPool.java
src/main/java/jsr166y/ForkJoinTask.java
src/main/java/jsr166y/ForkJoinWorkerThread.java
src/main/java/jsr166y/LinkedTransferQueue.java
src/main/java/jsr166y/Phaser.java
src/main/java/jsr166y/RecursiveAction.java
src/main/java/jsr166y/RecursiveTask.java
src/main/java/jsr166y/ThreadLocalRandom.java
src/main/java/jsr166y/TransferQueue.java
src/main/java/jsr166y/package-info.java
src/main/java/org/elasticsearch/action/admin/indices/validate/query/TransportValidateQueryAction.java
src/main/java/org/elasticsearch/cluster/routing/IndexRoutingTable.java
src/main/java/org/elasticsearch/cluster/routing/IndexShardRoutingTable.java
src/main/java/org/elasticsearch/common/Names.java
src/main/java/org/elasticsearch/common/math/UnboxedMathUtils.java
src/main/java/org/elasticsearch/common/util/concurrent/ConcurrentCollections.java
src/main/java/org/elasticsearch/common/util/concurrent/EsExecutors.java
src/main/java/org/elasticsearch/index/store/distributor/LeastUsedDistributor.java
src/main/java/org/elasticsearch/index/store/distributor/RandomWeightedDistributor.java
src/main/java/org/elasticsearch/index/translog/TranslogService.java
src/main/java/org/elasticsearch/index/translog/fs/FsTranslog.java
src/test/java/org/elasticsearch/benchmark/common/lucene/uidscan/LuceneUidScanBenchmark.java
src/test/java/org/elasticsearch/benchmark/hppc/StringMapAdjustOrPutBenchmark.java
src/test/java/org/elasticsearch/benchmark/search/aggregations/QueryFilterAggregationSearchBenchmark.java
src/test/java/org/elasticsearch/benchmark/search/aggregations/TermsAggregationSearchAndIndexingBenchmark.java
src/test/java/org/elasticsearch/benchmark/search/aggregations/TermsAggregationSearchBenchmark.java
src/test/java/org/elasticsearch/benchmark/search/aggregations/TimeDataHistogramAggregationBenchmark.java
src/test/java/org/elasticsearch/stresstest/fullrestart/FullRestartStressTest.java
src/test/java/org/elasticsearch/stresstest/get/GetStressTest.java
src/test/java/org/elasticsearch/stresstest/get/MGetStress1.java
src/test/java/org/elasticsearch/stresstest/indexing/BulkIndexingStressTest.java
src/test/java/org/elasticsearch/stresstest/indexing/ConcurrentIndexingVersioningStressTest.java
src/test/java/org/elasticsearch/stresstest/rollingrestart/QuickRollingRestartStressTest.java
src/test/java/org/elasticsearch/stresstest/rollingrestart/RollingRestartStressTest.java
src/test/java/org/elasticsearch/stresstest/search1/ConcurrentSearchSerializationTests.java
src/test/java/org/elasticsearch/stresstest/search1/Search1StressTest.java
comments:
Remove jsr166y now that we on Java 7, cleanup jsr166e to classes we use

time:
2014-04-15T10:40:25Z
class:
src/main/java/org/elasticsearch/action/bulk/TransportBulkAction.java
src/main/java/org/elasticsearch/indices/ttl/IndicesTTLService.java
src/test/java/org/elasticsearch/percolator/TTLPercolatorTests.java
comments:
Use TransportBulkAction for internal request from IndicesTTLService

This prevents executing bulks internal autocreate indices logic
and ensures that this internal request never creates an index
automaticall.

This fixes a bug where the TTL purger thread ran after the actual
index it was purging was already closed / deleted and that re-created
that index.

Closes #5766

time:
2014-04-15T00:36:43Z
class:
comments:
Separate benchmark API endpoints

Separates benchmark API endpoints into separate files according to API
funtionality. This makes it easier for our tests and clients.

Closes #5787

time:
2014-04-14T23:02:41Z
class:
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/status/SnapshotsStatusRequest.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/status/TransportSnapshotsStatusAction.java
src/main/java/org/elasticsearch/client/ClusterAdminClient.java
src/main/java/org/elasticsearch/client/support/AbstractClusterAdminClient.java
src/main/java/org/elasticsearch/rest/action/admin/cluster/snapshots/status/RestSnapshotsStatusAction.java
src/main/java/org/elasticsearch/snapshots/SnapshotsService.java
src/test/java/org/elasticsearch/snapshots/SharedClusterSnapshotRestoreTests.java
comments:
Fix snapshot status with empty repository

The snapshot status command with empty repository should return current status of currently running snapshots in all repositories.

Fixes #5790

time:
2014-04-14T21:45:17Z
class:
src/main/java/org/elasticsearch/discovery/gce/GceUnicastHostsProvider.java
comments:
Fix log

Related to #19.

time:
2014-04-14T21:36:24Z
class:
src/main/java/org/elasticsearch/discovery/gce/GceUnicastHostsProvider.java
src/test/java/org/elasticsearch/discovery/gce/GceComputeServiceAbstractMock.java
comments:
Upgrade to GCE v1-rev15-1.18.0-rc API

Closes #19.

time:
2014-04-14T21:08:41Z
class:
comments:
Benchmark documentation

Moving benchmark documentation under the search section.

Closes #5786

time:
2014-04-14T20:25:33Z
class:
src/main/java/org/elasticsearch/cluster/metadata/MetaData.java
src/main/java/org/elasticsearch/gateway/local/state/meta/LocalGatewayMetaState.java
src/main/java/org/elasticsearch/repositories/blobstore/BlobStoreRepository.java
comments:
Separate persistent and global metadata serialization settings

time:
2014-04-14T20:23:10Z
class:
comments:
[BUILD] remove leftover print statement

time:
2014-04-14T19:48:27Z
class:
src/main/java/org/elasticsearch/common/io/FileSystemUtils.java
comments:
Remove unused FileSystemUtils#copyFile

time:
2014-04-14T19:48:23Z
class:
src/main/java/org/elasticsearch/common/blobstore/fs/FsImmutableBlobContainer.java
src/main/java/org/elasticsearch/common/io/FileSystemUtils.java
comments:
Prevent fsync from creating 0-byte files

This is related to LUCENE-5570 where fsync creates a 0-byte file
if the file does not exists. This commit adds the patched lucene
version using Java 7 APIs as well as a note to replace this method
with the upcomeing IOUtils#fsync in Lucene 4.8

This commit cleans up FsImmutableBlobContainer#writeBlob to make
use of Java7 Auto-Closing features and ensures that the directory
the blob was written to is fsynced as well if possible.

time:
2014-04-14T16:54:04Z
class:
comments:
Check for no open issues before build release

time:
2014-04-14T16:30:03Z
class:
comments:
Upgrade to Lucene 4.7.2

time:
2014-04-14T15:42:41Z
class:
src/main/java/org/elasticsearch/action/deletebyquery/TransportShardDeleteByQueryAction.java
src/main/java/org/elasticsearch/index/search/child/ChildrenConstantScoreQuery.java
src/main/java/org/elasticsearch/index/search/child/ChildrenQuery.java
src/main/java/org/elasticsearch/index/search/child/CustomQueryWrappingFilter.java
src/main/java/org/elasticsearch/index/search/child/ParentConstantScoreQuery.java
src/main/java/org/elasticsearch/index/search/child/ParentQuery.java
src/main/java/org/elasticsearch/index/search/child/TopChildrenQuery.java
src/main/java/org/elasticsearch/percolator/PercolateContext.java
src/main/java/org/elasticsearch/search/SearchService.java
src/main/java/org/elasticsearch/search/aggregations/AggregationPhase.java
src/main/java/org/elasticsearch/search/aggregations/Aggregator.java
src/main/java/org/elasticsearch/search/aggregations/AggregatorFactories.java
src/main/java/org/elasticsearch/search/fetch/matchedqueries/MatchedQueriesFetchSubPhase.java
src/main/java/org/elasticsearch/search/internal/ContextIndexSearcher.java
src/main/java/org/elasticsearch/search/internal/DefaultSearchContext.java
src/main/java/org/elasticsearch/search/internal/DocIdSetCollector.java
src/main/java/org/elasticsearch/search/internal/SearchContext.java
src/test/java/org/elasticsearch/index/search/child/TestSearchContext.java
src/test/java/org/elasticsearch/search/aggregations/bucket/DoubleTermsTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/LongTermsTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/NestedTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/StringTermsTests.java
src/test/java/org/elasticsearch/test/cache/recycler/MockBigArrays.java
src/test/java/org/elasticsearch/test/cache/recycler/MockPageCacheRecycler.java
comments:
Improved SearchContext.addReleasable.

For resources that have their life time effectively defined by the search
context they are attached to, it is convenient to use the search context to
schedule the release of such resources.

This commit changes aggregations to use this mechanism and also introduces
a `Lifetime` object that can be used to define how long the object should
live:
 - COLLECTION: if the object only needs to live during collection time and is
   what SearchContext.addReleasable would have chosen before this change
   (used for p/c queries),
 - SEARCH_PHASE for resources that only need to live during the current search
   phase (DFS, QUERY or FETCH),
 - SEARCH_CONTEXT for resources that need to live until the context is
   destroyed.

Aggregators are currently registed with SEARCH_CONTEXT. The reason is that when
using the DFS_QUERY_THEN_FETCH search type, they are allocated during the DFS
phase but only used during the QUERY phase. However we should fix it in order
to only allocate them during the QUERY phase and use SEARCH_PHASE as a life
time.

Close #5703

time:
2014-04-14T15:21:42Z
class:
src/main/java/org/elasticsearch/action/admin/indices/status/TransportIndicesStatusAction.java
src/main/java/org/elasticsearch/action/admin/indices/validate/query/TransportValidateQueryAction.java
src/main/java/org/elasticsearch/action/count/TransportCountAction.java
src/main/java/org/elasticsearch/action/explain/TransportExplainAction.java
src/main/java/org/elasticsearch/action/suggest/TransportSuggestAction.java
src/main/java/org/elasticsearch/common/bytes/ReleasablePagedBytesReference.java
src/main/java/org/elasticsearch/common/lease/Releasable.java
src/main/java/org/elasticsearch/common/lease/Releasables.java
src/main/java/org/elasticsearch/common/lucene/index/FreqTermsEnum.java
src/main/java/org/elasticsearch/common/netty/ReleaseChannelFutureListener.java
src/main/java/org/elasticsearch/common/recycler/DequeRecycler.java
src/main/java/org/elasticsearch/common/recycler/NoneRecycler.java
src/main/java/org/elasticsearch/common/recycler/Recyclers.java
src/main/java/org/elasticsearch/common/util/AbstractArray.java
src/main/java/org/elasticsearch/common/util/AbstractBigArray.java
src/main/java/org/elasticsearch/common/util/AbstractHash.java
src/main/java/org/elasticsearch/common/util/BigArrays.java
src/main/java/org/elasticsearch/common/util/BytesRefHash.java
src/main/java/org/elasticsearch/common/util/DoubleObjectPagedHashMap.java
src/main/java/org/elasticsearch/common/util/LongHash.java
src/main/java/org/elasticsearch/common/util/LongObjectPagedHashMap.java
src/main/java/org/elasticsearch/http/netty/NettyHttpChannel.java
src/main/java/org/elasticsearch/index/deletionpolicy/SnapshotDeletionPolicy.java
src/main/java/org/elasticsearch/index/deletionpolicy/SnapshotIndexCommit.java
src/main/java/org/elasticsearch/index/deletionpolicy/SnapshotIndexCommits.java
src/main/java/org/elasticsearch/index/engine/Engine.java
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
src/main/java/org/elasticsearch/index/percolator/PercolatorQueriesRegistry.java
src/main/java/org/elasticsearch/index/search/child/ChildrenConstantScoreQuery.java
src/main/java/org/elasticsearch/index/search/child/ChildrenQuery.java
src/main/java/org/elasticsearch/index/search/child/CustomQueryWrappingFilter.java
src/main/java/org/elasticsearch/index/search/child/ParentConstantScoreQuery.java
src/main/java/org/elasticsearch/index/search/child/ParentQuery.java
src/main/java/org/elasticsearch/index/search/child/TopChildrenQuery.java
src/main/java/org/elasticsearch/index/shard/service/InternalIndexShard.java
src/main/java/org/elasticsearch/index/snapshots/IndexShardSnapshotAndRestoreService.java
src/main/java/org/elasticsearch/index/termvectors/ShardTermVectorService.java
src/main/java/org/elasticsearch/index/translog/fs/FsChannelSnapshot.java
src/main/java/org/elasticsearch/index/translog/fs/FsTranslog.java
src/main/java/org/elasticsearch/indices/cache/filter/IndicesFilterCache.java
src/main/java/org/elasticsearch/indices/ttl/IndicesTTLService.java
src/main/java/org/elasticsearch/percolator/MultiDocumentPercolatorIndex.java
src/main/java/org/elasticsearch/percolator/PercolateContext.java
src/main/java/org/elasticsearch/percolator/PercolatorService.java
src/main/java/org/elasticsearch/percolator/SingleDocumentPercolatorIndex.java
src/main/java/org/elasticsearch/search/SearchService.java
src/main/java/org/elasticsearch/search/aggregations/AggregationPhase.java
src/main/java/org/elasticsearch/search/aggregations/Aggregator.java
src/main/java/org/elasticsearch/search/aggregations/AggregatorFactories.java
src/main/java/org/elasticsearch/search/aggregations/bucket/BucketsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/geogrid/GeoHashGridAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/geogrid/InternalGeoHashGrid.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/HistogramAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/InternalHistogram.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantLongTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantStringTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantTermsAggregatorFactory.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/DoubleTerms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/DoubleTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/GlobalOrdinalsStringTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/LongTerms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/LongTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/StringTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/metrics/avg/AvgAggregator.java
src/main/java/org/elasticsearch/search/aggregations/metrics/cardinality/CardinalityAggregator.java
src/main/java/org/elasticsearch/search/aggregations/metrics/cardinality/HyperLogLogPlusPlus.java
src/main/java/org/elasticsearch/search/aggregations/metrics/max/MaxAggregator.java
src/main/java/org/elasticsearch/search/aggregations/metrics/min/MinAggregator.java
src/main/java/org/elasticsearch/search/aggregations/metrics/percentiles/PercentilesAggregator.java
src/main/java/org/elasticsearch/search/aggregations/metrics/percentiles/tdigest/TDigest.java
src/main/java/org/elasticsearch/search/aggregations/metrics/stats/StatsAggegator.java
src/main/java/org/elasticsearch/search/aggregations/metrics/stats/extended/ExtendedStatsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/metrics/sum/SumAggregator.java
src/main/java/org/elasticsearch/search/aggregations/metrics/valuecount/ValueCountAggregator.java
src/main/java/org/elasticsearch/search/facet/datehistogram/CountDateHistogramFacetExecutor.java
src/main/java/org/elasticsearch/search/facet/datehistogram/InternalCountDateHistogramFacet.java
src/main/java/org/elasticsearch/search/facet/datehistogram/InternalFullDateHistogramFacet.java
src/main/java/org/elasticsearch/search/facet/datehistogram/ValueDateHistogramFacetExecutor.java
src/main/java/org/elasticsearch/search/facet/datehistogram/ValueScriptDateHistogramFacetExecutor.java
src/main/java/org/elasticsearch/search/facet/histogram/CountHistogramFacetExecutor.java
src/main/java/org/elasticsearch/search/facet/histogram/FullHistogramFacetExecutor.java
src/main/java/org/elasticsearch/search/facet/histogram/InternalCountHistogramFacet.java
src/main/java/org/elasticsearch/search/facet/histogram/InternalFullHistogramFacet.java
src/main/java/org/elasticsearch/search/facet/histogram/ScriptHistogramFacetExecutor.java
src/main/java/org/elasticsearch/search/facet/histogram/ValueHistogramFacetExecutor.java
src/main/java/org/elasticsearch/search/facet/histogram/ValueScriptHistogramFacetExecutor.java
src/main/java/org/elasticsearch/search/facet/terms/doubles/InternalDoubleTermsFacet.java
src/main/java/org/elasticsearch/search/facet/terms/doubles/TermsDoubleFacetExecutor.java
src/main/java/org/elasticsearch/search/facet/terms/longs/InternalLongTermsFacet.java
src/main/java/org/elasticsearch/search/facet/terms/longs/TermsLongFacetExecutor.java
src/main/java/org/elasticsearch/search/facet/terms/strings/InternalStringTermsFacet.java
src/main/java/org/elasticsearch/search/facet/terms/strings/ScriptTermsStringFieldFacetExecutor.java
src/main/java/org/elasticsearch/search/facet/terms/strings/TermsStringOrdinalsFacetExecutor.java
src/main/java/org/elasticsearch/search/facet/termsstats/doubles/InternalTermsStatsDoubleFacet.java
src/main/java/org/elasticsearch/search/facet/termsstats/doubles/TermsStatsDoubleFacetExecutor.java
src/main/java/org/elasticsearch/search/facet/termsstats/longs/InternalTermsStatsLongFacet.java
src/main/java/org/elasticsearch/search/facet/termsstats/longs/TermsStatsLongFacetExecutor.java
src/main/java/org/elasticsearch/search/facet/termsstats/strings/InternalTermsStatsStringFacet.java
src/main/java/org/elasticsearch/search/facet/termsstats/strings/TermsStatsStringFacetExecutor.java
src/main/java/org/elasticsearch/search/internal/DefaultSearchContext.java
src/main/java/org/elasticsearch/search/internal/SearchContext.java
src/main/java/org/elasticsearch/transport/netty/NettyTransport.java
src/main/java/org/elasticsearch/transport/netty/NettyTransportChannel.java
src/test/java/org/elasticsearch/benchmark/common/recycler/RecyclerBenchmark.java
src/test/java/org/elasticsearch/common/recycler/AbstractRecyclerTests.java
src/test/java/org/elasticsearch/common/util/BigArraysTests.java
src/test/java/org/elasticsearch/common/util/BytesRefHashTests.java
src/test/java/org/elasticsearch/common/util/DoubleObjectHashMapTests.java
src/test/java/org/elasticsearch/common/util/LongHashTests.java
src/test/java/org/elasticsearch/common/util/LongObjectHashMapTests.java
src/test/java/org/elasticsearch/index/deletionpolicy/SnapshotDeletionPolicyTests.java
src/test/java/org/elasticsearch/index/engine/internal/InternalEngineTests.java
src/test/java/org/elasticsearch/index/search/child/TestSearchContext.java
src/test/java/org/elasticsearch/index/translog/AbstractSimpleTranslogTests.java
src/test/java/org/elasticsearch/test/cache/recycler/MockBigArrays.java
src/test/java/org/elasticsearch/test/cache/recycler/MockPageCacheRecycler.java
src/test/java/org/elasticsearch/test/engine/MockInternalEngine.java
comments:
Make Releasable extend AutoCloseable.

Java7's AutoCloseable allows to manage resources more nicely using
try-with-resources statements. Since the semantics of our Releasable interface
are very close to a Closeable, let's switch to it.

Close #5689

time:
2014-04-14T10:31:34Z
class:
src/test/java/org/elasticsearch/search/aggregations/bucket/ShardSizeTests.java
comments:
[TEST] Use indexRandom in ShardSizeTests.

time:
2014-04-14T10:15:02Z
class:
src/main/java/org/elasticsearch/action/bulk/TransportShardBulkAction.java
src/main/java/org/elasticsearch/action/index/IndexRequest.java
src/main/java/org/elasticsearch/action/index/TransportIndexAction.java
src/main/java/org/elasticsearch/index/engine/Engine.java
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
src/test/java/org/elasticsearch/benchmark/stress/SingleThreadBulkStress.java
comments:
Revert "Don't lookup version for auto generated id and create"

This reverts commit dc734984541537dc93ddae4633ad69898bdb6959.

time:
2014-04-14T08:06:53Z
class:
src/main/java/org/elasticsearch/action/bulk/TransportShardBulkAction.java
src/main/java/org/elasticsearch/action/index/IndexRequest.java
src/main/java/org/elasticsearch/action/index/TransportIndexAction.java
src/main/java/org/elasticsearch/index/engine/Engine.java
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
src/test/java/org/elasticsearch/benchmark/stress/SingleThreadBulkStress.java
comments:
Don't lookup version for auto generated id and create
When a create document is executed, and its an auto generated id (based on UUID), we know that the document will not exists in the index, so there is no need to try and lookup the version from the index.
For many cases, like logging, where ids are auto generated, this can improve the indexing performance, specifically for lightweight documents where analysis is not a big part of the execution.

time:
2014-04-14T00:18:19Z
class:
comments:
[DOCS] update old status of plugins

time:
2014-04-12T21:02:31Z
class:
src/test/java/org/elasticsearch/action/admin/cluster/stats/ClusterStatsTests.java
comments:
[TEST] Fix ClusterStatsTests#testValuesSmokeScreen to wait for yellow to get reliable FS stats.

time:
2014-04-12T19:54:46Z
class:
src/test/java/org/elasticsearch/index/suggest/stats/SuggestStatsTests.java
comments:
[TEST] use a real upperbound for the check on the time spend during suggestions

time:
2014-04-12T14:14:58Z
class:
src/test/java/org/elasticsearch/test/ElasticsearchAllocationTestCase.java
comments:
[Test] should be abstract

time:
2014-04-11T21:02:59Z
class:
src/test/java/org/elasticsearch/test/cache/recycler/MockBigArrays.java
src/test/java/org/elasticsearch/test/cache/recycler/MockPageCacheRecycler.java
comments:
[TEST] Improve performance of MockBigArray MockPageRecycler

time:
2014-04-11T21:02:59Z
class:
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
src/main/java/org/elasticsearch/index/merge/policy/LogByteSizeMergePolicyProvider.java
src/main/java/org/elasticsearch/index/merge/policy/LogDocMergePolicyProvider.java
src/main/java/org/elasticsearch/index/merge/policy/TieredMergePolicyProvider.java
src/test/java/org/elasticsearch/index/engine/internal/InternalEngineIntegrationTest.java
src/test/java/org/elasticsearch/index/engine/internal/InternalEngineMergeTests.java
src/test/java/org/elasticsearch/test/hamcrest/ElasticsearchAssertions.java
comments:
Ensure pending merges are updated on segment flushes

Due to the default of `async_merge` to `true` we never run
the merge policy on a segment flush which prevented the
pending merges from being updated and that caused actual
pending merges not to contribute to the merge decision.

This commit also removes the `index.async.merge` setting is actually
misleading since we take care of merges not being excecuted on the
indexing threads  on a different level (the merge scheduler) since 1.1.

This commit also adds an additional check when to run a refresh
since soely relying on the dirty flag might leave merges un-refreshed
which can cause search slowdowns and higher memory consumption.

Closes #5779

time:
2014-04-11T19:34:36Z
class:
src/main/java/org/elasticsearch/index/fielddata/plain/PackedArrayIndexFieldData.java
src/test/java/org/elasticsearch/nested/SimpleNestedTests.java
comments:
PR #5706 introduced a bug in the sparse array-backed field data

When we load sparse single valued data, we automatically assign a missing value to represent a document who has none. We try to find a value that will increase the number of bits needed to represent the data. If that missing value happen to be 0, we do no properly intialize the value array.

This commit solved this problem but also cleans up the code even more to make spotting such issues easier in the future.

time:
2014-04-11T16:12:35Z
class:
src/test/java/org/elasticsearch/nested/SimpleNestedTests.java
comments:
Added awaitFix for SimpleNestedTests.testSortNestedWithNestedFilter

While investigating failures

time:
2014-04-11T16:09:16Z
class:
comments:
Fix typos in percolate.asciidoc

Close #5762 #5763 #5764

time:
2014-04-11T14:40:47Z
class:
src/main/java/org/elasticsearch/index/fielddata/plain/PackedArrayIndexFieldData.java
src/test/java/org/elasticsearch/index/fielddata/LongFieldDataTests.java
comments:
Fixed- PackedArrayIndexFieldData.chooseStorageFormat compared to Long.MAX_VALUE instead of Long.MIN_VALUE

Also made the LongFieldDataTests.SINGLE_VALUED_SPARSE_RANDOM & LongFieldDataTests.MULTI_VALUED_SPARSE_RANDOM more sparse

time:
2014-04-11T13:50:34Z
class:
src/main/java/org/elasticsearch/index/fielddata/IndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/DoubleArrayIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/FloatArrayIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/GeoPointCompressedIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/GeoPointDoubleArrayIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/PackedArrayAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/PackedArrayIndexFieldData.java
src/test/java/org/elasticsearch/benchmark/search/aggregations/TimeDataHistogramAggregationBenchmark.java
src/test/java/org/elasticsearch/index/fielddata/AbstractNumericFieldDataTests.java
src/test/java/org/elasticsearch/index/fielddata/DoubleFieldDataTests.java
src/test/java/org/elasticsearch/index/fielddata/FloatFieldDataTests.java
src/test/java/org/elasticsearch/index/fielddata/LongFieldDataTests.java
comments:
Added a AppendingDeltaPackedLongBuffer-based storage format to single value field data

The AppendingDeltaPackedLongBuffer uses delta compression in paged fashion. For data which is roughly monotonic this results in reduced memory signature.

By default we use the storage format expected to use the least memory. You can force a choice using a new field data setting `memory_storage_hint` which can be set to `ORDINALS`, `PACKED` or `PAGED`

Closes #5706

time:
2014-04-11T12:01:40Z
class:
src/main/java/org/elasticsearch/common/lucene/search/function/RandomScoreFunction.java
src/test/java/org/elasticsearch/common/lucene/search/function/RandomScoreFunctionTests.java
comments:
Strengthening pseudo random number generator and adding tests to verify its behavior.

Closes #5454 and #5578

time:
2014-04-11T10:44:21Z
class:
src/main/java/org/elasticsearch/action/search/type/TransportSearchTypeAction.java
src/main/java/org/elasticsearch/search/controller/SearchPhaseController.java
src/main/java/org/elasticsearch/search/internal/InternalSearchResponse.java
comments:
Each search request should use a new InternalSearchResponse instance even in case when all shards return no hits.
The InternalSearchResponse may get modified afterwards, so a new instance required at all times.

time:
2014-04-11T07:03:28Z
class:
src/test/java/org/elasticsearch/percolator/TTLPercolatorTests.java
comments:
[TEST] Prevent TTLPurger from recreating deleted index

Related to #5766

time:
2014-04-11T06:47:41Z
class:
comments:
Ignored clear scroll rest test

time:
2014-04-11T03:39:59Z
class:
src/main/java/org/elasticsearch/rest/action/search/RestClearScrollAction.java
comments:
The clear scroll apis now optionally accepts a scroll_id in it body.

Closes #5726

time:
2014-04-11T03:16:17Z
class:
src/main/java/org/elasticsearch/search/aggregations/bucket/nested/NestedAggregator.java
src/test/java/org/elasticsearch/search/aggregations/bucket/NestedTests.java
comments:
Fixed an where a nested `nested` aggregation falls outside of its parent `nested` aggregation bounds.

The nested `nested` aggs now gets the proper parent docs that define its bounds correctly.

Closes #5728

time:
2014-04-10T19:23:07Z
class:
comments:
[DOCS] Added tables and fixes to upgrade.asciidoc, fixed version in README.textile
Author: Sean Gallagher
Date: 10 Apr 2014 15:23 EDT

time:
2014-04-10T17:32:34Z
class:
comments:
[Docs]  Add experimental highlighter plugin

time:
2014-04-10T13:13:59Z
class:
src/test/java/org/elasticsearch/discovery/DiscoveryWithNetworkFailuresTests.java
comments:
Added test with AwaitsFix annotation that simulates a split brain.

time:
2014-04-10T12:59:11Z
class:
src/test/java/org/elasticsearch/cluster/UpdateSettingsValidationTests.java
src/test/java/org/elasticsearch/cluster/allocation/AwarenessAllocationTests.java
src/test/java/org/elasticsearch/cluster/allocation/ClusterRerouteTests.java
src/test/java/org/elasticsearch/cluster/allocation/FilteringAllocationTests.java
src/test/java/org/elasticsearch/gateway/local/LocalGatewayIndexStateTests.java
src/test/java/org/elasticsearch/gateway/local/SimpleRecoveryLocalGatewayTests.java
src/test/java/org/elasticsearch/indices/mapping/DedicatedMasterGetFieldMappingTests.java
src/test/java/org/elasticsearch/nodesinfo/SimpleNodesInfoTests.java
src/test/java/org/elasticsearch/recovery/FullRollingRestartTests.java
src/test/java/org/elasticsearch/test/TestCluster.java
comments:
Use startNodesAsync in more tests

time:
2014-04-10T09:34:41Z
class:
src/test/java/org/elasticsearch/search/aggregations/RandomTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/GeoHashGridTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/NaNSortingTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/SignificantTermsTests.java
comments:
[TESTS] Add more assertSearchResponse to aggregations tests.

time:
2014-04-10T08:49:32Z
class:
src/test/java/org/elasticsearch/search/basic/SearchWhileRelocatingTests.java
src/test/java/org/elasticsearch/test/hamcrest/ElasticsearchAssertions.java
comments:
[TEST] Allow higher ClusterHealthTimeout on tests if configuration is slow

time:
2014-04-09T21:16:52Z
class:
comments:
Fix _bench endpoint specs to have the body on the right level in the json object

time:
2014-04-09T21:16:17Z
class:
src/test/java/org/elasticsearch/test/rest/spec/RestApiParser.java
src/test/java/org/elasticsearch/test/rest/spec/RestSpec.java
comments:
Add better error reporting to RestApiParser if assertions are tripped

time:
2014-04-09T20:06:55Z
class:
src/main/java/org/elasticsearch/action/ActionModule.java
src/main/java/org/elasticsearch/action/bench/AbortBenchmarkAction.java
src/main/java/org/elasticsearch/action/bench/AbortBenchmarkNodeResponse.java
src/main/java/org/elasticsearch/action/bench/AbortBenchmarkRequest.java
src/main/java/org/elasticsearch/action/bench/AbortBenchmarkRequestBuilder.java
src/main/java/org/elasticsearch/action/bench/AbortBenchmarkResponse.java
src/main/java/org/elasticsearch/action/bench/BenchmarkAction.java
src/main/java/org/elasticsearch/action/bench/BenchmarkCompetitor.java
src/main/java/org/elasticsearch/action/bench/BenchmarkCompetitorBuilder.java
src/main/java/org/elasticsearch/action/bench/BenchmarkExecutor.java
src/main/java/org/elasticsearch/action/bench/BenchmarkModule.java
src/main/java/org/elasticsearch/action/bench/BenchmarkRequest.java
src/main/java/org/elasticsearch/action/bench/BenchmarkRequestBuilder.java
src/main/java/org/elasticsearch/action/bench/BenchmarkResponse.java
src/main/java/org/elasticsearch/action/bench/BenchmarkService.java
src/main/java/org/elasticsearch/action/bench/BenchmarkSettings.java
src/main/java/org/elasticsearch/action/bench/BenchmarkStatusAction.java
src/main/java/org/elasticsearch/action/bench/BenchmarkStatusNodeResponse.java
src/main/java/org/elasticsearch/action/bench/BenchmarkStatusRequest.java
src/main/java/org/elasticsearch/action/bench/BenchmarkStatusRequestBuilder.java
src/main/java/org/elasticsearch/action/bench/BenchmarkStatusResponse.java
src/main/java/org/elasticsearch/action/bench/CompetitionDetails.java
src/main/java/org/elasticsearch/action/bench/CompetitionIteration.java
src/main/java/org/elasticsearch/action/bench/CompetitionIterationData.java
src/main/java/org/elasticsearch/action/bench/CompetitionNodeResult.java
src/main/java/org/elasticsearch/action/bench/CompetitionResult.java
src/main/java/org/elasticsearch/action/bench/CompetitionSummary.java
src/main/java/org/elasticsearch/action/bench/SinglePassStatistics.java
src/main/java/org/elasticsearch/action/bench/TransportAbortBenchmarkAction.java
src/main/java/org/elasticsearch/action/bench/TransportBenchmarkAction.java
src/main/java/org/elasticsearch/action/bench/TransportBenchmarkStatusAction.java
src/main/java/org/elasticsearch/client/Client.java
src/main/java/org/elasticsearch/client/support/AbstractClient.java
src/main/java/org/elasticsearch/client/transport/TransportClient.java
src/main/java/org/elasticsearch/cluster/metadata/BenchmarkMetaData.java
src/main/java/org/elasticsearch/cluster/metadata/MetaData.java
src/main/java/org/elasticsearch/node/internal/InternalNode.java
src/main/java/org/elasticsearch/rest/action/RestActionModule.java
src/main/java/org/elasticsearch/rest/action/admin/indices/cache/clear/RestClearIndicesCacheAction.java
src/main/java/org/elasticsearch/rest/action/bench/RestBenchAction.java
src/main/java/org/elasticsearch/threadpool/ThreadPool.java
src/test/java/org/elasticsearch/test/client/RandomizingClient.java
comments:
Benchmark API

Add an API endpoint at /_bench for submitting, listing, and aborting
search benchmarks. This API can be used for timing search requests,
subject to various user-defined settings.

Benchmark results provide summary and detailed statistics on such
values as min, max, and mean time. Values are reported per-node so that
it is easy to spot outliers. Slow requests are also reported.

Long running benchmarks can be viewed with a GET request, or aborted
with a POST request.

Benchmark results are optionally stored in an index for subsequent
analysis.

Closes #5407

time:
2014-04-09T18:11:36Z
class:
comments:
[Docs] Allocation setting explanation

Closes #5748

time:
2014-04-09T14:49:49Z
class:
src/main/java/org/elasticsearch/cluster/routing/allocation/decider/DiskThresholdDecider.java
comments:
Fix format string for DiskThresholdDecider reroute explanation

time:
2014-04-09T14:28:11Z
class:
src/main/java/org/elasticsearch/action/admin/cluster/node/info/PluginInfo.java
src/main/java/org/elasticsearch/plugins/PluginClassLoader.java
src/main/java/org/elasticsearch/plugins/PluginUtils.java
src/main/java/org/elasticsearch/plugins/PluginsService.java
src/main/java/org/elasticsearch/rest/action/cat/RestPluginsAction.java
src/test/java/org/elasticsearch/nodesinfo/SimpleNodesInfoTests.java
src/test/java/org/elasticsearch/plugins/IsolatedPluginTests.java
src/test/java/org/elasticsearch/plugins/PluginClassLoaderTest.java
src/test/java/org/elasticsearch/plugins/isolation/DummyClass.java
src/test/java/org/elasticsearch/plugins/isolation/IsolatedPlugin.java
comments:
Remove plugin isolation feature for a future version

relates #5261

time:
2014-04-09T09:45:55Z
class:
comments:
[TEST] MLT Rest test needs a mapping since we randomized number of nodes/shards

time:
2014-04-09T09:37:02Z
class:
src/test/java/org/elasticsearch/recovery/RecoveryWhileUnderLoadTests.java
src/test/java/org/elasticsearch/test/hamcrest/ElasticsearchAssertions.java
comments:
[TEST] RecoveryWhileunderLoadTests sometimes need higher timeouts

In some cases when we have a lot of docs with lots of shards
recovery takes longer than 1m causing the tests to fail before all
shards are recovered. This commit raises the timeout in this test to
5m max while it's rarely needed.

This commit also adds an assertion to ElasticsearchAssertions that
ensures that the cluster health requests are not hitting a timeout.

time:
2014-04-08T18:53:31Z
class:
src/test/java/org/elasticsearch/recovery/RecoveryWhileUnderLoadTests.java
comments:
[Test] recoverWhileRelocating: Increase timeout while waiting for shards to replicate.

time:
2014-04-08T15:47:31Z
class:
src/main/java/org/elasticsearch/index/search/child/ChildrenConstantScoreQuery.java
src/main/java/org/elasticsearch/index/search/child/ChildrenQuery.java
src/main/java/org/elasticsearch/index/search/child/ParentConstantScoreQuery.java
src/main/java/org/elasticsearch/index/search/child/ParentQuery.java
comments:
Fix P/C assertions for rewrite reader

Inner queries must be rewritten as soon as a weight is pulled ie. must
be non-null.

Closes #5731

time:
2014-04-08T15:46:56Z
class:
src/test/java/org/elasticsearch/search/basic/SearchWithRandomExceptionsTests.java
comments:
[TEST] Fix testRandomDirectoryIOExceptions to wait for green on reopen & add more assertions

time:
2014-04-08T14:18:15Z
class:
src/test/java/org/elasticsearch/test/store/MockDirectoryHelper.java
comments:
Revert "[TEST] Log where locks are created from if they are still open on close()"

This reverts commit 7eb8b0d0c0b2ef3adcfd7b1e10ea0ca9a50c1adc.

time:
2014-04-08T13:14:08Z
class:
src/test/java/org/elasticsearch/test/store/MockDirectoryHelper.java
comments:
[TEST] Log where locks are created from if they are still open on close()

time:
2014-04-08T10:41:13Z
class:
src/test/java/org/elasticsearch/action/admin/cluster/stats/ClusterStatsTests.java
comments:
[TEST] Wait for LANGUID events to be processed before pulling stats

time:
2014-04-08T10:10:45Z
class:
src/main/java/org/elasticsearch/cluster/routing/allocation/RoutingAllocation.java
src/main/java/org/elasticsearch/indices/cluster/IndicesClusterStateService.java
src/test/java/org/elasticsearch/cluster/routing/allocation/FailedShardsRoutingTests.java
comments:
Failed shards could be re-assigned to the same nodes if multiple replicas failed at once

After a shard fails on a node we assign a new replica on another node. This is important in order to avoid failing again due to node specific problems. In the rare case where two different replicas of the same shard failed in a short time span, we may fail to do so and assign one of them back to the node it's currently on. This happens if both shard failed events are processed within the same batch on the master.

Closes #5725

time:
2014-04-08T09:38:08Z
class:
src/test/java/org/elasticsearch/document/BulkTests.java
comments:
[TEST] Add more randomization to bulk tests

time:
2014-04-08T09:11:56Z
class:
src/test/java/org/elasticsearch/document/BulkTests.java
comments:
[TEST] make BulkTest more robust if test infra is slow

time:
2014-04-08T08:55:26Z
class:
comments:
Text Query has been replaced by Match Query

Closes #5727.

time:
2014-04-08T08:07:53Z
class:
comments:
[TEST] use no replicas in MLT tests - doc mappers need to be present on all nodes

time:
2014-04-07T23:01:02Z
class:
comments:
[BUILD] Remove site dependencies generation

Removed dependencies library generation.  It stalls Jenkins static analysis job

time:
2014-04-07T22:01:37Z
class:
comments:
Fixes typo in "Scan" search type documention

time:
2014-04-07T20:34:56Z
class:
src/test/java/org/elasticsearch/test/transport/MockTransportService.java
comments:
[TEST] return the correct transport instance in mock transport

time:
2014-04-07T20:15:09Z
class:
src/main/java/org/elasticsearch/action/search/type/TransportSearchCountAction.java
src/main/java/org/elasticsearch/action/search/type/TransportSearchDfsQueryAndFetchAction.java
src/main/java/org/elasticsearch/action/search/type/TransportSearchDfsQueryThenFetchAction.java
src/main/java/org/elasticsearch/action/search/type/TransportSearchQueryAndFetchAction.java
src/main/java/org/elasticsearch/action/search/type/TransportSearchQueryThenFetchAction.java
src/main/java/org/elasticsearch/action/search/type/TransportSearchScanAction.java
src/main/java/org/elasticsearch/action/search/type/TransportSearchTypeAction.java
comments:
Rename successulOps to successfulOps in TransportSearchTypeAction

time:
2014-04-07T20:15:09Z
class:
src/main/java/org/elasticsearch/action/search/type/TransportSearchTypeAction.java
comments:
Make sure successful operations are correct if second phase is fast

In TransportSearchTypeAction we  need to increment successful ops
first before we increment and compare the exit condition otherwise if we
are fast we could concurrently update totalOps but then preempt one
of the threads which can cause the successor to read a wrong value from
successfulOps if second phase is very fast ie. searchType == count etc.
This can cause wrong success stats in the search response.

time:
2014-04-07T20:14:10Z
class:
src/test/java/org/elasticsearch/action/admin/cluster/stats/ClusterStatsTests.java
comments:
[TEST] Be more verbose if ClusterStatsTests fails

time:
2014-04-07T18:43:35Z
class:
comments:
Author: Sean Gallagher
Date: Tue Apr 1 12:28:00 2014

Added upgrade.asciidoc and links to it from setup.asciidoc

Author: Sean Gallagher
Date: Apr 1 2014

Added upgrade.asciidoc

Add upgrade instructions
Author: Sean Gallagher
Date: 4/4/14
Closes issue #5651

Fixed upgrade.asciidoc typo and incorrect usage.
Author: Sean Gallagher
Date: 4 Apr 2014
Closes 5651

time:
2014-04-07T18:15:21Z
class:
src/main/java/org/elasticsearch/common/io/stream/StreamInput.java
src/main/java/org/elasticsearch/common/io/stream/StreamOutput.java
comments:
Rename readPrimitive*Array()/writePrimitive*Array() methods

Make method names shorter and easier to read.

Closes #5711

time:
2014-04-07T17:59:08Z
class:
src/main/java/org/elasticsearch/common/util/LongHash.java
src/main/java/org/elasticsearch/search/aggregations/bucket/geogrid/GeoHashGridAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/HistogramAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantLongTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/DoubleTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/LongTermsAggregator.java
src/test/java/org/elasticsearch/common/util/LongHashTests.java
comments:
Update LongHash to work like BytesRefHash.

- rename "key" to "get"
- update and add more tests

Closes #5693

time:
2014-04-07T17:38:57Z
class:
src/main/java/org/elasticsearch/common/io/stream/StreamInput.java
src/main/java/org/elasticsearch/common/io/stream/StreamOutput.java
comments:
Make writePrimitive*() and readPrimitive*() methods public.

These utility methods are useful for client code to read/write arrays of
primitive types.

time:
2014-04-07T17:01:19Z
class:
comments:
[TEST] specified number_of_shards 5 to make sure the two docs end up in different shards that can be refreshed separately

time:
2014-04-07T16:17:25Z
class:
src/test/java/org/elasticsearch/test/rest/ElasticsearchRestTests.java
comments:
[TEST] null out static resources in base test classes

time:
2014-04-07T15:08:05Z
class:
src/test/java/com/carrotsearch/randomizedtesting/StandaloneRandomizedContext.java
src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java
src/test/java/org/elasticsearch/test/junit/listeners/ReproduceInfoPrinter.java
src/test/java/org/elasticsearch/test/rest/ElasticsearchRestTests.java
src/test/java/org/elasticsearch/test/rest/RestTestCandidate.java
src/test/java/org/elasticsearch/test/rest/RestTestExecutionContext.java
src/test/java/org/elasticsearch/test/rest/client/RestClient.java
src/test/java/org/elasticsearch/test/rest/junit/DescriptionHelper.java
src/test/java/org/elasticsearch/test/rest/junit/RestReproduceInfoPrinter.java
src/test/java/org/elasticsearch/test/rest/junit/RestTestSuiteRunner.java
src/test/java/org/elasticsearch/test/rest/junit/RunAfter.java
src/test/java/org/elasticsearch/test/rest/parser/RestTestSectionParser.java
src/test/java/org/elasticsearch/test/rest/parser/RestTestSuiteParseContext.java
src/test/java/org/elasticsearch/test/rest/parser/RestTestSuiteParser.java
src/test/java/org/elasticsearch/test/rest/parser/SetupSectionParser.java
src/test/java/org/elasticsearch/test/rest/section/RestTestSuite.java
src/test/java/org/elasticsearch/test/rest/test/AssertionParsersTests.java
src/test/java/org/elasticsearch/test/rest/test/DoSectionParserTests.java
src/test/java/org/elasticsearch/test/rest/test/RestTestParserTests.java
src/test/java/org/elasticsearch/test/rest/test/SetSectionParserTests.java
src/test/java/org/elasticsearch/test/rest/test/SetupSectionParserTests.java
src/test/java/org/elasticsearch/test/rest/test/SkipSectionParserTests.java
src/test/java/org/elasticsearch/test/rest/test/TestSectionParserTests.java
comments:
[TEST] Replaced RestTestSuiteRunner with parametrized test that uses RandomizedRunner directly

ElasticsearchRestTests extends now ElasticsearchIntegrationTest and makes use of our ordinary test infrastructure, in particular all randomized aspects now come for free instead of having to maintain a separate (custom) tests runner

We previously parsed only the tests that needed to be run given the version of the cluster the tests are running against. This doesn't happen anymore as it didn't buy much and it would be harder to support as the tests get now parsed before the test cluster gets started. Thus all the tests are now parsed regardless of their skip sections, afterwards the ones that don't need to be run will be skipped through assume directives.

Fixed REST tests that rely on a specific number of shards as this change introduces also random number of shards and replicas (through randomIndexTemplate)

Closes #5654

time:
2014-04-07T13:29:04Z
class:
src/main/java/org/elasticsearch/action/get/MultiGetResponse.java
src/main/java/org/elasticsearch/action/percolate/MultiPercolateResponse.java
src/main/java/org/elasticsearch/action/percolate/PercolateResponse.java
src/main/java/org/elasticsearch/action/termvector/MultiTermVectorsResponse.java
src/main/java/org/elasticsearch/action/termvector/TermVectorResponse.java
src/main/java/org/elasticsearch/http/HttpChannel.java
src/main/java/org/elasticsearch/http/netty/NettyHttpChannel.java
src/main/java/org/elasticsearch/http/netty/NettyHttpServerTransport.java
src/main/java/org/elasticsearch/index/get/GetResult.java
src/main/java/org/elasticsearch/rest/BytesRestResponse.java
src/main/java/org/elasticsearch/rest/RestChannel.java
src/main/java/org/elasticsearch/rest/RestController.java
src/main/java/org/elasticsearch/rest/RestFilter.java
src/main/java/org/elasticsearch/rest/RestHandler.java
src/main/java/org/elasticsearch/rest/action/admin/cluster/health/RestClusterHealthAction.java
src/main/java/org/elasticsearch/rest/action/admin/cluster/node/hotthreads/RestNodesHotThreadsAction.java
src/main/java/org/elasticsearch/rest/action/admin/cluster/node/info/RestNodesInfoAction.java
src/main/java/org/elasticsearch/rest/action/admin/cluster/node/restart/RestNodesRestartAction.java
src/main/java/org/elasticsearch/rest/action/admin/cluster/node/shutdown/RestNodesShutdownAction.java
src/main/java/org/elasticsearch/rest/action/admin/cluster/node/stats/RestNodesStatsAction.java
src/main/java/org/elasticsearch/rest/action/admin/cluster/repositories/delete/RestDeleteRepositoryAction.java
src/main/java/org/elasticsearch/rest/action/admin/cluster/repositories/get/RestGetRepositoriesAction.java
src/main/java/org/elasticsearch/rest/action/admin/cluster/repositories/put/RestPutRepositoryAction.java
src/main/java/org/elasticsearch/rest/action/admin/cluster/reroute/RestClusterRerouteAction.java
src/main/java/org/elasticsearch/rest/action/admin/cluster/settings/RestClusterGetSettingsAction.java
src/main/java/org/elasticsearch/rest/action/admin/cluster/settings/RestClusterUpdateSettingsAction.java
src/main/java/org/elasticsearch/rest/action/admin/cluster/shards/RestClusterSearchShardsAction.java
src/main/java/org/elasticsearch/rest/action/admin/cluster/snapshots/create/RestCreateSnapshotAction.java
src/main/java/org/elasticsearch/rest/action/admin/cluster/snapshots/delete/RestDeleteSnapshotAction.java
src/main/java/org/elasticsearch/rest/action/admin/cluster/snapshots/get/RestGetSnapshotsAction.java
src/main/java/org/elasticsearch/rest/action/admin/cluster/snapshots/restore/RestRestoreSnapshotAction.java
src/main/java/org/elasticsearch/rest/action/admin/cluster/snapshots/status/RestSnapshotsStatusAction.java
src/main/java/org/elasticsearch/rest/action/admin/cluster/state/RestClusterStateAction.java
src/main/java/org/elasticsearch/rest/action/admin/cluster/stats/RestClusterStatsAction.java
src/main/java/org/elasticsearch/rest/action/admin/cluster/tasks/RestPendingClusterTasksAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/alias/RestIndicesAliasesAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/alias/delete/RestIndexDeleteAliasesAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/alias/get/RestGetAliasesAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/alias/get/RestGetIndicesAliasesAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/alias/put/RestIndexPutAliasAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/analyze/RestAnalyzeAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/cache/clear/RestClearIndicesCacheAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/close/RestCloseIndexAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/create/RestCreateIndexAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/delete/RestDeleteIndexAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/exists/indices/RestIndicesExistsAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/exists/types/RestTypesExistsAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/flush/RestFlushAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/mapping/delete/RestDeleteMappingAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/mapping/get/RestGetFieldMappingAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/mapping/get/RestGetMappingAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/mapping/put/RestPutMappingAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/open/RestOpenIndexAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/optimize/RestOptimizeAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/recovery/RestRecoveryAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/refresh/RestRefreshAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/segments/RestIndicesSegmentsAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/settings/RestGetSettingsAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/settings/RestUpdateSettingsAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/stats/RestIndicesStatsAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/status/RestIndicesStatusAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/template/delete/RestDeleteIndexTemplateAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/template/get/RestGetIndexTemplateAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/template/head/RestHeadIndexTemplateAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/template/put/RestPutIndexTemplateAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/validate/query/RestValidateQueryAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/warmer/delete/RestDeleteWarmerAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/warmer/get/RestGetWarmerAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/warmer/put/RestPutWarmerAction.java
src/main/java/org/elasticsearch/rest/action/bulk/RestBulkAction.java
src/main/java/org/elasticsearch/rest/action/cat/AbstractCatAction.java
src/main/java/org/elasticsearch/rest/action/cat/RestAliasAction.java
src/main/java/org/elasticsearch/rest/action/cat/RestAllocationAction.java
src/main/java/org/elasticsearch/rest/action/cat/RestCatAction.java
src/main/java/org/elasticsearch/rest/action/cat/RestCountAction.java
src/main/java/org/elasticsearch/rest/action/cat/RestHealthAction.java
src/main/java/org/elasticsearch/rest/action/cat/RestIndicesAction.java
src/main/java/org/elasticsearch/rest/action/cat/RestMasterAction.java
src/main/java/org/elasticsearch/rest/action/cat/RestNodesAction.java
src/main/java/org/elasticsearch/rest/action/cat/RestPendingClusterTasksAction.java
src/main/java/org/elasticsearch/rest/action/cat/RestPluginsAction.java
src/main/java/org/elasticsearch/rest/action/cat/RestRecoveryAction.java
src/main/java/org/elasticsearch/rest/action/cat/RestSegmentsAction.java
src/main/java/org/elasticsearch/rest/action/cat/RestShardsAction.java
src/main/java/org/elasticsearch/rest/action/cat/RestThreadPoolAction.java
src/main/java/org/elasticsearch/rest/action/count/RestCountAction.java
src/main/java/org/elasticsearch/rest/action/delete/RestDeleteAction.java
src/main/java/org/elasticsearch/rest/action/deletebyquery/RestDeleteByQueryAction.java
src/main/java/org/elasticsearch/rest/action/explain/RestExplainAction.java
src/main/java/org/elasticsearch/rest/action/get/RestGetAction.java
src/main/java/org/elasticsearch/rest/action/get/RestGetSourceAction.java
src/main/java/org/elasticsearch/rest/action/get/RestHeadAction.java
src/main/java/org/elasticsearch/rest/action/get/RestMultiGetAction.java
src/main/java/org/elasticsearch/rest/action/index/RestIndexAction.java
src/main/java/org/elasticsearch/rest/action/main/RestMainAction.java
src/main/java/org/elasticsearch/rest/action/mlt/RestMoreLikeThisAction.java
src/main/java/org/elasticsearch/rest/action/percolate/RestMultiPercolateAction.java
src/main/java/org/elasticsearch/rest/action/percolate/RestPercolateAction.java
src/main/java/org/elasticsearch/rest/action/search/RestClearScrollAction.java
src/main/java/org/elasticsearch/rest/action/search/RestMultiSearchAction.java
src/main/java/org/elasticsearch/rest/action/search/RestSearchAction.java
src/main/java/org/elasticsearch/rest/action/search/RestSearchScrollAction.java
src/main/java/org/elasticsearch/rest/action/suggest/RestSuggestAction.java
src/main/java/org/elasticsearch/rest/action/support/AcknowledgedRestListener.java
src/main/java/org/elasticsearch/rest/action/support/RestActionListener.java
src/main/java/org/elasticsearch/rest/action/support/RestBuilderListener.java
src/main/java/org/elasticsearch/rest/action/support/RestResponseListener.java
src/main/java/org/elasticsearch/rest/action/support/RestTable.java
src/main/java/org/elasticsearch/rest/action/support/RestToXContentListener.java
src/main/java/org/elasticsearch/rest/action/support/RestXContentBuilder.java
src/main/java/org/elasticsearch/rest/action/termvector/RestMultiTermVectorsAction.java
src/main/java/org/elasticsearch/rest/action/termvector/RestTermVectorAction.java
src/main/java/org/elasticsearch/rest/action/update/RestUpdateAction.java
src/main/java/org/elasticsearch/search/internal/InternalSearchHit.java
src/test/java/org/elasticsearch/action/termvector/GetTermVectorCheckDocFreqTests.java
comments:
Recycled bytes in http + rest layer refactoring phase 2
Refactor the rest layer handlers to simplify common code paths (like handling) failures, and introduce optional (enabled for netty) rest channel bytes recycling

time:
2014-04-07T13:20:13Z
class:
comments:
Update advanced-scripting.asciidoc

time:
2014-04-07T12:34:17Z
class:
src/main/java/org/elasticsearch/common/geo/GeoHashUtils.java
src/main/java/org/elasticsearch/search/aggregations/AggregatorFactories.java
src/main/java/org/elasticsearch/search/aggregations/InternalAggregation.java
src/main/java/org/elasticsearch/search/aggregations/bucket/geogrid/GeoHashGridParser.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/DateHistogramParser.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/ExtendedBounds.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/HistogramAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/HistogramParser.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/InternalDateHistogram.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/InternalHistogram.java
src/main/java/org/elasticsearch/search/aggregations/bucket/missing/MissingParser.java
src/main/java/org/elasticsearch/search/aggregations/bucket/range/InternalRange.java
src/main/java/org/elasticsearch/search/aggregations/bucket/range/RangeAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/range/RangeParser.java
src/main/java/org/elasticsearch/search/aggregations/bucket/range/date/DateRangeParser.java
src/main/java/org/elasticsearch/search/aggregations/bucket/range/date/InternalDateRange.java
src/main/java/org/elasticsearch/search/aggregations/bucket/range/geodistance/GeoDistanceParser.java
src/main/java/org/elasticsearch/search/aggregations/bucket/range/geodistance/InternalGeoDistance.java
src/main/java/org/elasticsearch/search/aggregations/bucket/range/ipv4/InternalIPv4Range.java
src/main/java/org/elasticsearch/search/aggregations/bucket/range/ipv4/IpRangeParser.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantLongTerms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantLongTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantTermsAggregatorFactory.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantTermsParser.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/DoubleTerms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/DoubleTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/LongTerms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/LongTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/Terms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/TermsAggregatorFactory.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/TermsParser.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/support/IncludeExclude.java
src/main/java/org/elasticsearch/search/aggregations/metrics/NumericValuesSourceMetricsAggregatorParser.java
src/main/java/org/elasticsearch/search/aggregations/metrics/ValuesSourceMetricsAggregatorParser.java
src/main/java/org/elasticsearch/search/aggregations/metrics/avg/AvgParser.java
src/main/java/org/elasticsearch/search/aggregations/metrics/cardinality/CardinalityParser.java
src/main/java/org/elasticsearch/search/aggregations/metrics/max/MaxParser.java
src/main/java/org/elasticsearch/search/aggregations/metrics/min/MinParser.java
src/main/java/org/elasticsearch/search/aggregations/metrics/percentiles/PercentilesParser.java
src/main/java/org/elasticsearch/search/aggregations/metrics/stats/StatsParser.java
src/main/java/org/elasticsearch/search/aggregations/metrics/stats/extended/ExtendedStatsParser.java
src/main/java/org/elasticsearch/search/aggregations/metrics/sum/SumParser.java
src/main/java/org/elasticsearch/search/aggregations/metrics/valuecount/ValueCountAggregator.java
src/main/java/org/elasticsearch/search/aggregations/metrics/valuecount/ValueCountParser.java
src/main/java/org/elasticsearch/search/aggregations/support/FieldContext.java
src/main/java/org/elasticsearch/search/aggregations/support/GeoPointParser.java
src/main/java/org/elasticsearch/search/aggregations/support/ScriptValueType.java
src/main/java/org/elasticsearch/search/aggregations/support/ValueType.java
src/main/java/org/elasticsearch/search/aggregations/support/ValuesSource.java
src/main/java/org/elasticsearch/search/aggregations/support/ValuesSourceAggregatorFactory.java
src/main/java/org/elasticsearch/search/aggregations/support/ValuesSourceConfig.java
src/main/java/org/elasticsearch/search/aggregations/support/ValuesSourceParser.java
src/main/java/org/elasticsearch/search/aggregations/support/format/ValueFormat.java
src/main/java/org/elasticsearch/search/aggregations/support/format/ValueFormatter.java
src/main/java/org/elasticsearch/search/aggregations/support/format/ValueParser.java
src/test/java/org/elasticsearch/search/aggregations/bucket/DateHistogramTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/SignificantTermsTests.java
comments:
Aggregation cleanup

- consolidated value source parsing under a single parser that is reused in all the value source aggs parsers
- consolidated include/exclude parsing under a single parser
- cleaned up value format handling, to have consistent behaviour across all values source aggs

time:
2014-04-07T12:24:10Z
class:
comments:
Update link to puppet module and remove link to other RPM repo as we have our own.

time:
2014-04-07T11:52:06Z
class:
comments:
Fix typo and add more clients

time:
2014-04-07T11:51:44Z
class:
comments:
Removing EOL client rubberband and adding official php client

time:
2014-04-07T10:26:06Z
class:
src/main/java/org/elasticsearch/cluster/ClusterState.java
comments:
Renamed ClusterBlocks variable named "block" to "blocks".

"blocks" has been used 9 times for variable names of type
ClusterBlocks but block has been used only this case. It
seems to be a typo.

time:
2014-04-07T10:26:06Z
class:
src/main/java/org/elasticsearch/action/update/UpdateRequest.java
src/main/java/org/elasticsearch/cluster/metadata/MappingMetaData.java
src/main/java/org/elasticsearch/common/xcontent/XContentHelper.java
src/main/java/org/elasticsearch/common/xcontent/support/AbstractXContentParser.java
comments:
Renamed XContentParser.Token named "t" to "token".

The name "token" was declared 191 times for XContentParser.Token
objects, while "t" was used only 6 times.

time:
2014-04-07T09:25:18Z
class:
src/test/java/org/elasticsearch/search/aggregations/bucket/DoubleTermsTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/LongTermsTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/NestedTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/StringTermsTests.java
comments:
disable args tests that cause page/array leak
related to #5703

time:
2014-04-07T09:25:18Z
class:
src/test/java/org/elasticsearch/common/bytes/PagedBytesReferenceTest.java
src/test/java/org/elasticsearch/index/search/child/ChildrenConstantScoreQueryTests.java
src/test/java/org/elasticsearch/test/ElasticsearchTestCase.java
src/test/java/org/elasticsearch/test/cache/recycler/MockBigArrays.java
src/test/java/org/elasticsearch/test/cache/recycler/MockPageCacheRecycler.java
comments:
Remove clear on mock page/array
since we use a shared cluster, calling clear on the mock array / page recycler can cause removing a valid on going reference, and then when its released, the release will fail because it can't be found.
There is no real reason to call clear, checking if pages/arrays have been released takes the snapshot behavior here into account.
This change also makes sure we don't use the mock classes in places where we don't really release.

Note, with this change DoubleTermsTests fails, since it causes failures when creating aggs in the pre process phase, causing obtained arrays not to be released. This needs to be fixed before pulling this change in.

time:
2014-04-07T08:48:03Z
class:
src/main/java/org/elasticsearch/index/similarity/LMDirichletSimilarityProvider.java
src/main/java/org/elasticsearch/index/similarity/LMJelinekMercerSimilarityProvider.java
src/test/java/org/elasticsearch/index/similarity/SimilarityTests.java
comments:
add lucene language model similarities (Dirichlet & JelinekMercer)

time:
2014-04-07T08:30:10Z
class:
src/main/java/org/elasticsearch/index/fielddata/AbstractAtomicNumericFieldData.java
src/main/java/org/elasticsearch/index/fielddata/AtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/ordinals/GlobalOrdinalsIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/AbstractGeoPointIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/BinaryDVAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/BytesBinaryDVAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/DoubleArrayAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/FSTBytesAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/FloatArrayAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/GeoPointBinaryDVAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/GeoPointCompressedAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/GeoPointDoubleArrayAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/NumericDVAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/PackedArrayAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/PagedBytesAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/ParentChildAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/SortedSetDVBytesAtomicFieldData.java
comments:
Remove AtomicFieldData.isValuesOrdered.

This method is not used anymore.

Close #5688

time:
2014-04-07T08:18:55Z
class:
src/main/java/org/elasticsearch/common/util/CollectionUtils.java
src/main/java/org/elasticsearch/index/fielddata/IndexFieldDataService.java
src/main/java/org/elasticsearch/index/fielddata/plain/BytesBinaryDVAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/BytesBinaryDVIndexFieldData.java
src/main/java/org/elasticsearch/index/mapper/core/BinaryFieldMapper.java
src/test/java/org/elasticsearch/index/fielddata/AbstractFieldDataTests.java
src/test/java/org/elasticsearch/index/fielddata/BinaryDVFieldDataTests.java
comments:
Add doc value for binary field.

Close #5669

time:
2014-04-07T07:23:46Z
class:
comments:
fix typo

time:
2014-04-07T04:06:41Z
class:
src/main/java/org/elasticsearch/common/lucene/TopReaderContextAware.java
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
src/main/java/org/elasticsearch/index/fielddata/AbstractIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/AtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/FieldDataType.java
src/main/java/org/elasticsearch/index/fielddata/IndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/IndexFieldDataCache.java
src/main/java/org/elasticsearch/index/fielddata/IndexFieldDataService.java
src/main/java/org/elasticsearch/index/fielddata/RamUsage.java
src/main/java/org/elasticsearch/index/fielddata/ShardFieldData.java
src/main/java/org/elasticsearch/index/fielddata/ordinals/GlobalOrdinalsBuilder.java
src/main/java/org/elasticsearch/index/fielddata/ordinals/GlobalOrdinalsIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/ordinals/InternalGlobalOrdinalsBuilder.java
src/main/java/org/elasticsearch/index/fielddata/plain/AbstractBytesIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/AtomicFieldDataWithOrdinalsTermsEnum.java
src/main/java/org/elasticsearch/index/fielddata/plain/BinaryDVIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/BinaryDVNumericIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/DisabledIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/DocValuesIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/DoubleArrayIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/FSTBytesAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/FSTBytesIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/FloatArrayIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/GeoPointBinaryDVIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/GeoPointCompressedIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/GeoPointDoubleArrayIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/NumericDVIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/PackedArrayIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/PagedBytesAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/PagedBytesIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/ParentChildIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/SortedSetDVAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/SortedSetDVBytesAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/SortedSetDVBytesIndexFieldData.java
src/main/java/org/elasticsearch/index/mapper/FieldMapper.java
src/main/java/org/elasticsearch/index/shard/ShardUtils.java
src/main/java/org/elasticsearch/indices/fielddata/cache/IndicesFieldDataCache.java
src/main/java/org/elasticsearch/indices/fielddata/cache/IndicesFieldDataCacheListener.java
src/main/java/org/elasticsearch/indices/warmer/IndicesWarmer.java
src/main/java/org/elasticsearch/indices/warmer/InternalIndicesWarmer.java
src/main/java/org/elasticsearch/percolator/QueryCollector.java
src/main/java/org/elasticsearch/search/SearchService.java
src/main/java/org/elasticsearch/search/aggregations/AggregationPhase.java
src/main/java/org/elasticsearch/search/aggregations/bucket/BucketsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/AbstractStringTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/GlobalOrdinalsStringTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/StringTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/TermsAggregatorFactory.java
src/main/java/org/elasticsearch/search/aggregations/support/AggregationContext.java
src/main/java/org/elasticsearch/search/aggregations/support/ValuesSource.java
src/test/java/org/elasticsearch/benchmark/search/aggregations/GlobalOrdinalsBenchmark.java
src/test/java/org/elasticsearch/benchmark/search/aggregations/TermsAggregationSearchAndIndexingBenchmark.java
src/test/java/org/elasticsearch/benchmark/search/aggregations/TermsAggregationSearchBenchmark.java
src/test/java/org/elasticsearch/index/fielddata/AbstractFieldDataTests.java
src/test/java/org/elasticsearch/index/fielddata/AbstractStringFieldDataTests.java
src/test/java/org/elasticsearch/index/fielddata/DuelFieldDataTests.java
src/test/java/org/elasticsearch/index/fielddata/NoOrdinalsStringFieldDataTests.java
src/test/java/org/elasticsearch/search/aggregations/RandomTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/StringTermsTests.java
src/test/java/org/elasticsearch/test/TestCluster.java
comments:
Added global ordinals (unique incremental numbering for terms) to fielddata.
Added a terms aggregation implementations that work on global ordinals, which is also the default.

Closes #5672

time:
2014-04-06T18:49:27Z
class:
src/test/java/org/elasticsearch/recovery/RecoveryWhileUnderLoadTests.java
src/test/java/org/elasticsearch/recovery/RelocationTests.java
src/test/java/org/elasticsearch/test/BackgroundIndexer.java
src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java
comments:
[Test] Added better control over the number of documents indexed by BackgroundIndexer

Used the new controls to reduce indexing activity in RelocationTests and RecoveryWhileUnderLoadTests

Closes #5696

time:
2014-04-06T18:23:21Z
class:
src/main/java/org/elasticsearch/common/bytes/PagedBytesReference.java
src/main/java/org/elasticsearch/common/bytes/ReleasableBytesReference.java
src/main/java/org/elasticsearch/common/bytes/ReleasablePagedBytesReference.java
src/main/java/org/elasticsearch/common/io/ReleasableBytesStream.java
src/main/java/org/elasticsearch/common/io/stream/BytesStreamOutput.java
src/main/java/org/elasticsearch/common/io/stream/ReleasableBytesStreamOutput.java
src/main/java/org/elasticsearch/index/translog/fs/FsTranslog.java
src/main/java/org/elasticsearch/transport/netty/NettyTransport.java
src/main/java/org/elasticsearch/transport/netty/NettyTransportChannel.java
src/test/java/org/elasticsearch/benchmark/transport/BenchmarkNettyLargeMessages.java
src/test/java/org/elasticsearch/benchmark/transport/TransportBenchmark.java
src/test/java/org/elasticsearch/common/util/BigArraysTests.java
src/test/java/org/elasticsearch/discovery/zen/ping/unicast/UnicastZenPingTests.java
src/test/java/org/elasticsearch/test/ElasticsearchTestCase.java
src/test/java/org/elasticsearch/test/cache/recycler/MockBigArrays.java
src/test/java/org/elasticsearch/test/cache/recycler/MockPageCacheRecycler.java
src/test/java/org/elasticsearch/test/cache/recycler/MockPageCacheRecyclerModule.java
src/test/java/org/elasticsearch/transport/netty/SimpleNettyTransportTests.java
comments:
releasable bytes output + use in transport / translog
create a new releasable bytes output, that can be recycled, and use it in netty and the translog, 2 areas where the recycling will help nicely.
Note, opted for statically typed enforced releasble bytes output, to make sure people take the extra care to control when the bytes reference are released.
 Also, the mock page/array classes were fixed to not take into account potential recycling going during teardown, for example, on a shared cluster ping requests still happen, so recycling happen actively during teardown.
closes #5691

time:
2014-04-05T20:36:16Z
class:
src/test/java/org/elasticsearch/recovery/RelocationTests.java
src/test/java/org/elasticsearch/test/BackgroundIndexer.java
comments:
[TEST] Prevent RelocationTests from going crazy when relocations take time

time:
2014-04-05T20:18:38Z
class:
src/test/java/org/elasticsearch/tribe/TribeTests.java
comments:
[TEST] cleanup secondary cluster properly in Tribe tests.

time:
2014-04-04T19:19:35Z
class:
src/main/java/org/elasticsearch/cluster/routing/allocation/decider/DiskThresholdDecider.java
src/main/java/org/elasticsearch/common/settings/ImmutableSettings.java
src/main/java/org/elasticsearch/common/settings/Settings.java
src/main/java/org/elasticsearch/common/unit/RatioValue.java
src/test/java/org/elasticsearch/cluster/routing/allocation/decider/DiskThresholdDeciderTests.java
src/test/java/org/elasticsearch/common/unit/RatioValueTests.java
comments:
Add `getAsRatio` to Settings class, allow DiskThresholdDecider to take percentages

Adds new RatioValue class that parses ratios between 0-100% expressed in
either floating-point (0.13) or percentage (51.12%) notation.

Closes #5690

time:
2014-04-04T19:06:01Z
class:
src/main/java/org/elasticsearch/cluster/InternalClusterInfoService.java
comments:
log full exception in InternalClusterInfoService unless it's a ClusterBlockException

time:
2014-04-04T17:26:38Z
class:
comments:
[DOCS] A few grammar and word use corrections

time:
2014-04-04T15:56:08Z
class:
src/main/java/org/elasticsearch/action/update/UpdateRequestBuilder.java
comments:
Adding javadoc to UpdateRequestBuilder for a couple of details it took me a while to find.

time:
2014-04-04T15:37:56Z
class:
comments:
[DOCS] Fixed typo

time:
2014-04-04T15:15:41Z
class:
src/main/java/org/elasticsearch/ExceptionsHelper.java
src/main/java/org/elasticsearch/bootstrap/Bootstrap.java
comments:
Show stacktrace of startup exception

Whether or not the stacktrace is displayed is controlled by bootstrap
log level setting, so that bootstrap: DEBUG displays the stack trace on
output, like it does on log

Closes #5102

time:
2014-04-04T12:06:09Z
class:
src/test/java/org/elasticsearch/action/admin/cluster/stats/ClusterStatsTests.java
comments:
[TEST] Wait for nodes to join before asserting on cluster stats

time:
2014-04-04T11:17:28Z
class:
src/main/java/org/elasticsearch/action/admin/indices/refresh/TransportRefreshAction.java
src/test/java/org/elasticsearch/search/aggregations/bucket/MinDocCountTests.java
src/test/java/org/elasticsearch/search/basic/SearchWithRandomExceptionsTests.java
comments:
[Test] added trace logging to refresh action to note which cluster version was used

Increase logging level for SearchWithRandomExceptionsTests.testRandomExceptions & MinDocCountTests to use the above and log cluster states on changes.

time:
2014-04-04T08:53:10Z
class:
src/main/java/org/elasticsearch/index/mapper/geo/GeoPointFieldMapper.java
src/test/java/org/elasticsearch/index/mapper/geo/GeohashMappingGeoPointTests.java
comments:
`geo_point` doesn't allow null values

After upgrading to 1.1.0, sending null values to geo points produces the following error:

```
MapperParsingException[failed to parse]; nested: ElasticsearchParseException[geo_point expected];
```

Closes #5680.
Closes #5681.

time:
2014-04-04T07:41:07Z
class:
src/test/java/org/elasticsearch/search/geo/GeoShapeIntegrationTests.java
comments:
[TEST] Harden GeoShapeIntegrationTests.

time:
2014-04-03T17:31:22Z
class:
src/test/java/org/elasticsearch/search/aggregations/bucket/HistogramTests.java
comments:
[TEST] build index up-front to prevent relocations

time:
2014-04-03T15:44:41Z
class:
src/main/java/org/elasticsearch/common/bytes/PagedBytesReference.java
src/test/java/org/elasticsearch/common/bytes/PagedBytesReferenceTest.java
src/test/java/org/elasticsearch/common/xcontent/builder/XContentBuilderTests.java
comments:
Take stream position into account when calculating remaining length

Currently `PagedBytesReferenceStreamInput#read(byte[],int,int)` ignores
the current pos and that causes to read past EOF

Closes #5667

time:
2014-04-03T14:58:44Z
class:
src/test/java/org/elasticsearch/search/aggregations/RandomTests.java
comments:
[TEST] Reduce number of documents/terms in aggregations' RandomTests.

This test initially had three purposes:
 - duels between equivalent aggregations on significant amounts of data,
 - make sure that array growth works (when the number of buckets grows larger
   than the initial number o buckets),
 - make sure that page recycling works correctly.

Because of the last point, it needed large numbers of docs/terms since page
recycling only kicks in on arrays of more than 16KB. However, since then, we
added a MockPageCacheRecycler to track allocation/release of BigArrays and make
sure that all arrays get released, so we can now lower these numbers of docs/
terms to just make sure that array growth is triggered.

time:
2014-04-03T14:25:15Z
class:
src/test/java/org/elasticsearch/index/search/child/ChildrenConstantScoreQueryTests.java
src/test/java/org/elasticsearch/index/search/child/ParentConstantScoreQueryTests.java
comments:
[TEST] Fix [Children|Parent]ConstantScoreQueryTests with nightly=true

Those tests use RandomIW which can flush after each document taking forever
to index the 20k docs it was indexing. This commit makes sure the IW is
sane and the number of docs is not too crazy.

time:
2014-04-03T13:57:54Z
class:
src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java
comments:
[TEST] Make sure refresh is called by `indexRandom`, even if the list of documents to index is empty.

time:
2014-04-03T13:48:50Z
class:
src/main/java/org/elasticsearch/indices/fielddata/cache/IndicesFieldDataCacheListener.java
comments:
sizeInBytes can be 0

time:
2014-04-03T11:32:41Z
class:
src/test/java/org/elasticsearch/document/BulkTests.java
comments:
[TEST] Make BulkTests#testBulkProcessorFlush more robust

time:
2014-04-03T11:01:01Z
class:
comments:
[BUILD] Set -Dtests.jvms=auto by default to make use of multiple JVMs

time:
2014-04-03T10:50:51Z
class:
src/main/java/org/elasticsearch/index/fielddata/IndexFieldDataCache.java
src/main/java/org/elasticsearch/indices/fielddata/cache/IndicesFieldDataCache.java
comments:
Cleanup IndicesFieldDataCache and IndexFieldDataCache

This commit adds several asserts and removes possible `null` values
from the `FieldDataCache` implementation.

Closes #5664

time:
2014-04-03T07:45:07Z
class:
src/main/java/org/elasticsearch/index/mapper/internal/ParentFieldMapper.java
src/main/java/org/elasticsearch/search/SearchService.java
comments:
Moved the decision to load p/c fielddata eagerly to a better place.

Closes #5569

time:
2014-04-02T22:07:00Z
class:
comments:
[DOCS] remove extraneous ` from cache page

time:
2014-04-02T22:01:30Z
class:
src/main/java/org/elasticsearch/rest/action/search/RestSearchAction.java
comments:
Made template endpoint compatible with search endpoint

Before this the from/size parameters did not work.
Also updated the rest api spec definition file with all the query_string
parameters.

Fixes #5550

time:
2014-04-02T21:51:14Z
class:
src/main/java/org/elasticsearch/search/suggest/completion/CompletionSuggestionBuilder.java
src/main/java/org/elasticsearch/search/suggest/context/GeolocationContextMapping.java
src/test/java/org/elasticsearch/search/suggest/ContextSuggestSearchTests.java
src/test/java/org/elasticsearch/search/suggest/context/GeoLocationContextMappingTest.java
comments:
Geo context suggester: Require precision in mapping

The default precision was way too exact and could lead people to
think that geo context suggestions are not working. This patch now
requires you to set the precision in the mapping, as elasticsearch itself
can never tell exactly, what the required precision for the users
suggestions are.

Closes #5621

time:
2014-04-02T17:16:29Z
class:
src/main/java/org/elasticsearch/action/bulk/BulkProcessor.java
src/test/java/org/elasticsearch/document/BulkTests.java
comments:
Add `flush` method for BulkProcessor class

There is no explicit method `flush/execute` in `BulkProcessor` class. This can be useful in certain scenarios.
Currently it requires to close and create a new BulkProcessor if one wants an immediate flush.

Closes #5575.
Closes #5570.

time:
2014-04-02T16:32:03Z
class:
src/main/java/org/elasticsearch/cluster/node/DiscoveryNode.java
comments:
Document es.node.mode and add possible options to error message

time:
2014-04-02T12:58:45Z
class:
src/test/java/org/elasticsearch/common/lucene/index/FreqTermsEnumTests.java
comments:
[TEST] Use NoMergePolicy rather than NoMergeScheduler in FreqTermsEnumTests

time:
2014-04-02T12:28:42Z
class:
src/main/java/org/elasticsearch/index/fielddata/ScriptDocValues.java
src/main/java/org/elasticsearch/index/fielddata/plain/AbstractGeoPointIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/DoubleArrayAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/FloatArrayAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/PackedArrayAtomicFieldData.java
comments:
Remove ScriptDocValues.EMPTY.

Instead the default implementation is used, but on top of empty
(Bytes|Long|Double|GeoPoint)Values. This makes sure there is no
inconsistency between documents depending on whether other documents in the
segment have values or not.

Close #5646

time:
2014-04-02T11:53:44Z
class:
src/main/java/org/elasticsearch/action/bulk/TransportShardBulkAction.java
src/test/java/org/elasticsearch/action/bulk/BulkIntegrationTests.java
comments:
Fix mapping creation on bulk request

When a bulk request triggers an index creation a mapping might not be
created. The reason is that when indexing documents in a bulk,
an indexing operation might fail due to a shard not yet being
started. The mapping service, however, might already
have the mapping but the mapping update is never issued to the master,
even on subsequent indexing of documents.

Instead, the mapping must be propagated to master even if the
indexing fails due to a shard not being started.

closes #5623

time:
2014-04-02T10:16:00Z
class:
src/main/java/org/elasticsearch/common/lucene/index/FilterableTermsEnum.java
src/main/java/org/elasticsearch/common/lucene/index/FreqTermsEnum.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantLongTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantStringTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantTermsAggregatorFactory.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantTermsParser.java
src/main/java/org/elasticsearch/search/suggest/phrase/WordScorer.java
src/test/java/org/elasticsearch/common/lucene/index/FreqTermsEnumTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/SignificantTermsTests.java
comments:
Freq Terms Enum
A frequency caching terms enum, that also allows to be configured with an optional filter. To be used by both significant terms and phrase suggester.
This change extracts the frequency caching into the same code, and allow in the future to add a filter to control/customize the background frequencies
Closes #5597

time:
2014-04-02T10:02:12Z
class:
comments:
Typo in the description for include_in_all

I know this is uber-minor, but I was confused by the phrase "the raw field value to be copied". I assume "is" was supposed to be instead of "to"

time:
2014-04-02T09:02:38Z
class:
src/test/java/org/elasticsearch/test/BackgroundIndexer.java
comments:
[Tests] Reduce the number of threads used by the BackgroundIndexer by default

It sometimes overloads the nodes.

time:
2014-04-02T05:14:35Z
class:
src/main/java/org/elasticsearch/index/fielddata/IndexFieldDataCache.java
src/main/java/org/elasticsearch/indices/fielddata/cache/IndicesFieldDataCache.java
comments:
Removed incorrect comment

time:
2014-04-02T04:55:45Z
class:
src/main/java/org/elasticsearch/index/fielddata/IndexFieldDataCache.java
src/main/java/org/elasticsearch/index/fielddata/IndexFieldDataService.java
src/main/java/org/elasticsearch/index/fielddata/ShardFieldData.java
src/main/java/org/elasticsearch/indices/IndicesModule.java
src/main/java/org/elasticsearch/indices/fielddata/cache/IndicesFieldDataCache.java
src/main/java/org/elasticsearch/indices/fielddata/cache/IndicesFieldDataCacheListener.java
src/main/java/org/elasticsearch/percolator/PercolatorService.java
src/test/java/org/elasticsearch/percolator/PercolatorTests.java
comments:
Added an indices level field data cache listener that always gets invoked and updates indices statistics and services about field data loading and unloading.

Moved the circuit breaker memory reducing logic to the IndicesFieldDataCacheListener, so it always reduces the memory used when field data gets unloaded,
this fixes a issue where the circuit breaker didn't get reduced when segments where no shardId could be resolved get cleared up.

Also made sure that exceptions in the percolator service are bubbled up properly.

Closes #5588

time:
2014-04-01T21:50:55Z
class:
src/main/java/org/apache/lucene/queries/XTermsFilter.java
src/main/java/org/elasticsearch/index/mapper/MapperService.java
src/main/java/org/elasticsearch/index/mapper/core/AbstractFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/internal/IdFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/internal/ParentFieldMapper.java
src/main/java/org/elasticsearch/index/query/IdsFilterParser.java
src/main/java/org/elasticsearch/index/query/IdsQueryParser.java
src/main/java/org/elasticsearch/index/query/TermsFilterParser.java
src/test/java/org/elasticsearch/common/lucene/search/TermsFilterTests.java
src/test/java/org/elasticsearch/common/lucene/search/XBooleanFilterLuceneTests.java
src/test/java/org/elasticsearch/index/query/SimpleIndexQueryParserTests.java
src/test/java/org/elasticsearch/search/child/SimpleChildQuerySearchTests.java
src/test/java/org/elasticsearch/search/highlight/HighlighterSearchTests.java
comments:
Upgrade to Lucene 4.7.1

 * Removed XTermsFilter fixed in LUCENE-5502
 * Switched back to automaton queries that caused failures due to LUCENE-5532
 * Fixed Highlight test that has different results due to LUCENE-5538

time:
2014-04-01T18:43:38Z
class:
comments:
[DOC] Fixed flags example incorrect syntax

time:
2014-04-01T18:36:43Z
class:
src/test/java/org/apache/lucene/queries/BlendedTermQueryTest.java
comments:
[TEST] use length-norm as the tie-breaker in BlendedTermQueryTest

time:
2014-04-01T17:09:33Z
class:
src/main/java/org/elasticsearch/common/geo/GeoUtils.java
src/main/java/org/elasticsearch/search/suggest/context/GeolocationContextMapping.java
src/test/java/org/elasticsearch/index/search/geo/GeoUtilsTests.java
src/test/java/org/elasticsearch/search/suggest/context/GeoLocationContextMappingTest.java
comments:
Geo: Allow to parse lat/lon as strings and coerce them

In order to be more failsafe parsing GeoPoints can support
lat/lon as strings and coerce them. Added support and test for this.

time:
2014-04-01T16:43:14Z
class:
src/test/java/org/elasticsearch/test/junit/listeners/ReproduceInfoPrinter.java
comments:
[TEST] fixed typo in ReproduceInfoPrinter (s/nighly/nightly)

time:
2014-04-01T16:40:43Z
class:
src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java
src/test/java/org/elasticsearch/test/ExternalTestCluster.java
src/test/java/org/elasticsearch/test/junit/listeners/ReproduceInfoPrinter.java
comments:
[TEST] Print out the `tests.cluster` sys prop if available to be able to reproduce failures when using the external cluster

Relates to #5630

time:
2014-04-01T16:01:47Z
class:
src/test/java/org/elasticsearch/gateway/local/QuorumLocalGatewayTests.java
src/test/java/org/elasticsearch/test/TestCluster.java
comments:
[TEST] Add ability to start nodes in async mode in TestCluster
this will help speed up when starting multiple nodes in a test
closes #5644

time:
2014-04-01T15:57:57Z
class:
src/test/java/org/elasticsearch/test/rest/junit/RestTestSuiteRunner.java
comments:
[TEST] Removed last occurences of cluster_seed, no longer used

Relates to #5233

time:
2014-04-01T15:27:58Z
class:
src/test/java/org/elasticsearch/index/codec/postingformat/ElasticsearchPostingsFormatTest.java
comments:
[TEST] Add ThreadLeaks protection to ElasticsearchPostingsFormatTest since we keep running clusters around in the JVM

time:
2014-04-01T15:13:23Z
class:
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
comments:
Enrich exception message if searcher can not be aquired

This commit also moves the log message after the ensureOpen() call
to only log an error if it's really an erro condition.

time:
2014-04-01T15:00:42Z
class:
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
comments:
Throw EngineClosedException if engine is closed

Currently we throw misleading exception in acquireSearcher
if we try to acquire while we are failing the engine. We should
throw an EngineClosedException instead.

Relates to #5633

time:
2014-04-01T15:00:35Z
class:
src/test/java/org/elasticsearch/search/basic/SearchWithRandomExceptionsTests.java
comments:
[TEST] Expect all shards to fail if full refresh failed

time:
2014-04-01T14:02:43Z
class:
src/main/java/org/elasticsearch/tribe/TribeService.java
comments:
ignore index if it's not in the cluster state and it's in the drop indices set

Closes #5643

time:
2014-04-01T14:02:30Z
class:
src/test/java/org/elasticsearch/tribe/TribeTests.java
comments:
[TEST] use assertAcked when creating indices

time:
2014-04-01T12:50:22Z
class:
src/test/java/org/elasticsearch/index/codec/postingformat/ElasticsearchPostingsFormatTest.java
comments:
add test for ElasticSearchPostingsFormat

time:
2014-04-01T12:38:35Z
class:
src/test/java/org/elasticsearch/document/BulkTests.java
comments:
[TEST] Fix BulkTests#testThatInvalidIndexNamesShouldNotBreakCompleteBulkRequest - randomBoolean() doesn't always return true

time:
2014-04-01T12:32:20Z
class:
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
comments:
Fail the engine/shard when refresh failed
When refresh failed, it would fail due to a serious issue in the shard (mainly corrupted index). Fail the engine in that cause, which will cause the shard to fail. The reason why its not only on CorruptedIndex failed is that any type of failure seems to be relevant here to fail the shard
closes #5633

time:
2014-04-01T12:16:43Z
class:
comments:
[DOCS] "F" is not valid false value for boolean type

time:
2014-04-01T12:12:52Z
class:
src/test/java/org/elasticsearch/test/junit/listeners/ReproduceInfoPrinter.java
comments:
[BUILD] Allow to set tests memory via the commandline

time:
2014-04-01T12:12:52Z
class:
src/test/java/org/elasticsearch/recovery/RecoveryWhileUnderLoadTests.java
src/test/java/org/elasticsearch/recovery/RelocationTests.java
src/test/java/org/elasticsearch/test/BackgroundIndexer.java
comments:
Moved BackgroundIndexer to a top level class. Moved waitNumDocs to ElasticsearchIntegrationTestBase.

Update RelocationTests to use the above and unified testPrimaryRelocationWhileIndexing & testReplicaRelocationWhileIndexingRandom into a single randomized test.

time:
2014-04-01T12:12:45Z
class:
src/test/java/org/elasticsearch/cluster/BlockClusterStatsTests.java
src/test/java/org/elasticsearch/cluster/ClusterServiceTests.java
src/test/java/org/elasticsearch/cluster/MinimumMasterNodesTests.java
src/test/java/org/elasticsearch/cluster/NoMasterNodeTests.java
src/test/java/org/elasticsearch/cluster/SimpleDataNodesTests.java
src/test/java/org/elasticsearch/cluster/SpecificMasterNodesTests.java
src/test/java/org/elasticsearch/cluster/UpdateSettingsValidationTests.java
src/test/java/org/elasticsearch/cluster/allocation/AwarenessAllocationTests.java
src/test/java/org/elasticsearch/cluster/allocation/ClusterRerouteTests.java
src/test/java/org/elasticsearch/cluster/allocation/FilteringAllocationTests.java
src/test/java/org/elasticsearch/cluster/allocation/ShardsAllocatorModuleTests.java
src/test/java/org/elasticsearch/cluster/settings/ClusterSettingsTests.java
src/test/java/org/elasticsearch/cluster/shards/ClusterSearchShardsTests.java
src/test/java/org/elasticsearch/discovery/ZenUnicastDiscoveryTests.java
src/test/java/org/elasticsearch/gateway/local/LocalGatewayIndexStateTests.java
src/test/java/org/elasticsearch/gateway/local/QuorumLocalGatewayTests.java
src/test/java/org/elasticsearch/gateway/local/SimpleRecoveryLocalGatewayTests.java
src/test/java/org/elasticsearch/gateway/none/RecoverAfterNodesTests.java
src/test/java/org/elasticsearch/index/query/TemplateQueryTest.java
src/test/java/org/elasticsearch/indexlifecycle/IndexLifecycleActionTests.java
src/test/java/org/elasticsearch/indices/analyze/HunspellServiceTests.java
src/test/java/org/elasticsearch/indices/cache/CacheTests.java
src/test/java/org/elasticsearch/indices/fielddata/breaker/CircuitBreakerServiceTests.java
src/test/java/org/elasticsearch/indices/fielddata/breaker/RandomExceptionCircuitBreakerTests.java
src/test/java/org/elasticsearch/indices/leaks/IndicesLeaksTests.java
src/test/java/org/elasticsearch/indices/mapping/DedicatedMasterGetFieldMappingTests.java
src/test/java/org/elasticsearch/indices/mapping/SimpleGetMappingsTests.java
src/test/java/org/elasticsearch/indices/recovery/IndexRecoveryTests.java
src/test/java/org/elasticsearch/indices/state/CloseIndexDisableCloseAllTests.java
src/test/java/org/elasticsearch/indices/stats/SimpleIndexStatsTests.java
src/test/java/org/elasticsearch/indices/store/IndicesStoreTests.java
src/test/java/org/elasticsearch/indices/template/IndexTemplateFileLoadingTests.java
src/test/java/org/elasticsearch/indices/template/SimpleIndexTemplateTests.java
src/test/java/org/elasticsearch/indices/warmer/LocalGatewayIndicesWarmerTests.java
src/test/java/org/elasticsearch/nodesinfo/SimpleNodesInfoTests.java
src/test/java/org/elasticsearch/percolator/TTLPercolatorTests.java
src/test/java/org/elasticsearch/plugin/PluginManagerTests.java
src/test/java/org/elasticsearch/plugin/ResponseHeaderPluginTests.java
src/test/java/org/elasticsearch/plugin/SitePluginTests.java
src/test/java/org/elasticsearch/plugins/IsolatedPluginTests.java
src/test/java/org/elasticsearch/recovery/FullRollingRestartTests.java
src/test/java/org/elasticsearch/recovery/RelocationTests.java
src/test/java/org/elasticsearch/script/ScriptFieldTests.java
src/test/java/org/elasticsearch/search/aggregations/ParsingTests.java
src/test/java/org/elasticsearch/search/aggregations/RandomTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/DateHistogramTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/DateRangeTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/DoubleTermsTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/FilterTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/GeoDistanceTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/GeoHashGridTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/GlobalTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/HistogramTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/IPv4RangeTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/LongTermsTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/MinDocCountTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/MissingTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/NaNSortingTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/NestedTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/RangeTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/ShardReduceTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/SignificantTermsTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/StringTermsTests.java
src/test/java/org/elasticsearch/search/aggregations/metrics/AbstractNumericTests.java
src/test/java/org/elasticsearch/search/aggregations/metrics/CardinalityTests.java
src/test/java/org/elasticsearch/search/aggregations/metrics/ValueCountTests.java
src/test/java/org/elasticsearch/search/aggregations/metrics/cardinality/HyperLogLogPlusPlusTests.java
src/test/java/org/elasticsearch/search/basic/SearchWhileRelocatingTests.java
src/test/java/org/elasticsearch/search/functionscore/FunctionScoreFieldValueTests.java
src/test/java/org/elasticsearch/search/geo/GeoShapeIntegrationTests.java
src/test/java/org/elasticsearch/search/indicesboost/SimpleIndicesBoostSearchTests.java
src/test/java/org/elasticsearch/search/scroll/SlowDuelScrollTests.java
src/test/java/org/elasticsearch/search/scroll/SlowSearchScrollTests.java
src/test/java/org/elasticsearch/search/stats/SearchStatsTests.java
src/test/java/org/elasticsearch/search/suggest/ContextSuggestSearchTests.java
src/test/java/org/elasticsearch/search/suggest/CustomSuggesterSearchTests.java
src/test/java/org/elasticsearch/snapshots/DedicatedClusterSnapshotRestoreTests.java
src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java
src/test/java/org/elasticsearch/threadpool/SimpleThreadPoolTests.java
src/test/java/org/elasticsearch/tribe/TribeTests.java
src/test/java/org/elasticsearch/ttl/SimpleTTLTests.java
src/test/java/org/elasticsearch/update/UpdateByNativeScriptTests.java
comments:
[Test] allow tests to reuse a singel index across tests

This commit speeds up aggregations tests dramatically since they all
rely on the same index structure. Here we can safe a large amout of time
to not recreate the index for each small test.

time:
2014-04-01T10:03:57Z
class:
src/test/java/org/elasticsearch/recovery/RecoveryWhileUnderLoadTests.java
comments:
Add a BackgroundIndexer class to RecoveryWhileUnderLoadTests and use it.

Also change the document distribution a bit between the tests

time:
2014-04-01T10:03:57Z
class:
src/test/java/org/elasticsearch/update/UpdateTests.java
comments:
[Test] Speedup UpdateTests#testConcurrentUpdateWithRetryOnConflict

time:
2014-04-01T10:03:57Z
class:
src/test/java/org/elasticsearch/index/fielddata/AbstractStringFieldDataTests.java
comments:
[Test] Speeup FieldData tests and remove unnecessary @Repeat annotations

time:
2014-04-01T10:03:57Z
class:
src/test/java/org/elasticsearch/search/suggest/SuggestSearchTests.java
comments:
[Test] Run intensive suggest tests only if nightly=true

time:
2014-04-01T10:03:57Z
class:
src/test/java/org/elasticsearch/recovery/RecoveryWhileUnderLoadTests.java
comments:
[Test] Speedup RecoveryWhileUnderLoadTests to run with less documents unless tests.nightly=true

time:
2014-04-01T10:03:57Z
class:
src/test/java/org/elasticsearch/cluster/routing/allocation/RandomAllocationDeciderTests.java
comments:
[Test] Speed up RandomAllocationDeciderTests

time:
2014-04-01T09:52:18Z
class:
src/test/java/org/elasticsearch/test/transport/MockTransportService.java
comments:
[TEST] delegate to the original transport

time:
2014-04-01T09:45:35Z
class:
src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java
src/test/java/org/elasticsearch/test/ExternalTestCluster.java
src/test/java/org/elasticsearch/test/ImmutableTestCluster.java
src/test/java/org/elasticsearch/test/TestCluster.java
comments:
[TEST] added ExternalTestCluster that allows to run tests against an external cluster

All the ordinary test operations happen based on the ImmutableTestCluster base class and are executed via transport client. Will be used especially for the REST tests once migrated to the standard randomized runner.

Added new httpAddresses method to ImmutableTestCluster to be able to retrieve the http addresses to connect to for the REST tests. Both versions will look inside the cluster to figure out which nodes are available for http calls and their addresses.

The external cluster is used as global cluster if the tests.cluster system property is available. The property needs to contain a comma separated list of available elasticsearch nodes that will be used to connect to the cluster (e.g. localhost:9300,localhost:9301).

Only a subset of the integration tests can currently be run successfully against the external cluster, for more precision the ones that don't modify the cluster layout (don't require cluster() functionalities but rely only on immutableCluster()). Also at least two data nodes are required otherwise the ensureGreen calls cannot succeed.

Closes #5630

time:
2014-04-01T08:40:07Z
class:
src/main/java/org/elasticsearch/action/admin/cluster/node/info/PluginInfo.java
src/test/java/org/elasticsearch/stresstest/fullrestart/FullRestartStressTest.java
comments:
Replaces usage of `StringBuffer` with `StringBuilder` and fixes stray
single quote in the same `PluginInfo#toString()` method.

Closes #5605

time:
2014-04-01T08:02:29Z
class:
src/main/java/org/elasticsearch/search/action/SearchServiceTransportAction.java
comments:
Do not propagate errors from onResult to onFailure.

The way that SearchServiceTransportAction executes actions on a local node
today would propagate exceptions thrown in onResult to onFailure.

Close #5629

time:
2014-04-01T02:28:27Z
class:
comments:
[BUILD] Switch 1x to JDK7 download

Changed download URL for 1x build to point to JDK7 latest

time:
2014-03-31T21:23:46Z
class:
src/main/java/org/elasticsearch/action/search/type/TransportSearchTypeAction.java
src/test/java/org/elasticsearch/search/aggregations/bucket/MinDocCountTests.java
comments:
Added trace logging in TransportSearchTypeAction and a delayed verification of test failures in MinDocCountTests.testMinDocCountOnTerms

time:
2014-03-31T20:49:10Z
class:
src/main/java/org/elasticsearch/transport/TransportModule.java
src/main/java/org/elasticsearch/transport/TransportService.java
src/test/java/org/elasticsearch/test/TestCluster.java
src/test/java/org/elasticsearch/test/transport/MockTransportService.java
src/test/java/org/elasticsearch/transport/AbstractSimpleTransportTests.java
src/test/java/org/elasticsearch/transport/local/SimpleLocalTransportTests.java
src/test/java/org/elasticsearch/transport/netty/SimpleNettyTransportTests.java
comments:
Mock Transport: Allow to simulate network failures
An infrastructure that allows to simulate different network topologies failures, including 2 basic ones in failure to send requests, and unresponsive nodes
closes #5631

time:
2014-03-31T18:57:58Z
class:
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
comments:
InternalEngine - back to set dirty=false just *before* a refresh is done

reverting: 5553c383bca1f8b5437aa0eb34e291824e9057fb

time:
2014-03-31T18:23:49Z
class:
src/main/java/org/elasticsearch/discovery/zen/ZenDiscovery.java
comments:
Discard new cluster state if the clustername doesn't match

Closes #5622

time:
2014-03-31T18:23:49Z
class:
src/main/java/org/elasticsearch/action/admin/cluster/state/TransportClusterStateAction.java
src/main/java/org/elasticsearch/cluster/ClusterState.java
src/main/java/org/elasticsearch/cluster/service/InternalClusterService.java
src/main/java/org/elasticsearch/discovery/zen/publish/PublishClusterStateAction.java
src/main/java/org/elasticsearch/gateway/local/LocalGateway.java
src/main/java/org/elasticsearch/gateway/none/NoneGateway.java
src/test/java/org/elasticsearch/benchmark/cluster/ClusterAllocationRerouteBenchmark.java
src/test/java/org/elasticsearch/cluster/ClusterHealthResponsesTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/AddIncrementallyTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/AllocatePostApiFlagTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/AllocationCommandsTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/AwarenessAllocationTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/BalanceConfigurationTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/ClusterRebalanceRoutingTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/ConcurrentRebalanceRoutingTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/DeadNodesAllocationTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/DisableAllocationTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/ElectReplicaAsPrimaryDuringRelocationTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/FailedNodeRoutingTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/FailedShardsRoutingTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/FilterRoutingTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/IndexBalanceTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/NodeVersionAllocationDeciderTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/PreferLocalPrimariesToRelocatingPrimariesTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/PreferPrimaryAllocationTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/PrimaryElectionRoutingTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/PrimaryNotRelocatedWhileBeingRecoveredTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/RandomAllocationDeciderTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/RebalanceAfterActiveTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/ReplicaAllocatedAfterPrimaryTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/RoutingNodesIntegrityTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/SameShardRoutingTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/ShardVersioningTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/ShardsLimitAllocationTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/SingleShardNoReplicasRoutingTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/SingleShardOneReplicaRoutingTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/TenShardsOneReplicaRoutingTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/ThrottlingAllocationTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/UpdateNumberOfReplicasTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/decider/DiskThresholdDeciderTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/decider/EnableAllocationTests.java
src/test/java/org/elasticsearch/cluster/serialization/ClusterSerializationTests.java
src/test/java/org/elasticsearch/cluster/serialization/ClusterStateToStringTests.java
src/test/java/org/elasticsearch/cluster/structure/RoutingIteratorTests.java
comments:
Add cluster_name to cluster_state

Today the clusterstate is not asssociated with the cluster_name which is odd
since it's pretty much it's only valid identifier. Any node can send a cluster
state to another node today even if it's not the same cluster. These situations
can happen rarely during tests or even in the wild by accident.

time:
2014-03-31T17:54:48Z
class:
comments:
[docs] Indices stats groups in nodes api

Closes #5349

time:
2014-03-31T17:09:53Z
class:
src/test/java/org/elasticsearch/cluster/ack/AckClusterUpdateSettingsTests.java
src/test/java/org/elasticsearch/cluster/ack/AckTests.java
src/test/java/org/elasticsearch/index/suggest/stats/SuggestStatsTests.java
src/test/java/org/elasticsearch/search/preference/SearchPreferenceTests.java
src/test/java/org/elasticsearch/search/stats/SearchStatsTests.java
src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java
src/test/java/org/elasticsearch/test/ImmutableTestCluster.java
src/test/java/org/elasticsearch/test/TestCluster.java
comments:
[TEST] moved dataNodes method to ImmutableTestCluster base class, replaced cluster().dataNodes() calls with immutableCluster().dataNodes()

time:
2014-03-31T17:07:30Z
class:
src/test/java/org/elasticsearch/action/admin/HotThreadsTest.java
src/test/java/org/elasticsearch/cluster/SimpleClusterStateTests.java
src/test/java/org/elasticsearch/cluster/ack/AckClusterUpdateSettingsTests.java
src/test/java/org/elasticsearch/cluster/allocation/ClusterRerouteTests.java
src/test/java/org/elasticsearch/cluster/allocation/FilteringAllocationTests.java
src/test/java/org/elasticsearch/cluster/allocation/ShardsAllocatorModuleTests.java
src/test/java/org/elasticsearch/versioning/ConcurrentDocumentOperationTests.java
comments:
[TEST] replaced cluster().size() calls with immutableCluster().size

time:
2014-03-31T16:35:57Z
class:
comments:
[DOCS] fixed transport client link in java api docs

time:
2014-03-31T16:34:26Z
class:
src/test/java/org/elasticsearch/test/ImmutableTestCluster.java
src/test/java/org/elasticsearch/test/TestCluster.java
comments:
[TEST] fixed TestCluster size() javadocs

time:
2014-03-31T16:34:25Z
class:
src/test/java/org/elasticsearch/search/suggest/SuggestSearchTests.java
comments:
[TEST] move SuggestSearchTests to make use of default number of replicas randomization (based on number of data nodes)

time:
2014-03-31T16:34:25Z
class:
src/test/java/org/elasticsearch/document/DocumentActionsTests.java
src/test/java/org/elasticsearch/indices/mapping/ConcurrentDynamicTemplateTests.java
src/test/java/org/elasticsearch/indices/store/SimpleDistributorTests.java
src/test/java/org/elasticsearch/percolator/PercolatorTests.java
src/test/java/org/elasticsearch/search/aggregations/RandomTests.java
src/test/java/org/elasticsearch/search/basic/SearchWhileCreatingIndexTests.java
src/test/java/org/elasticsearch/search/query/SimpleQueryTests.java
src/test/java/org/elasticsearch/snapshots/DedicatedClusterSnapshotRestoreTests.java
src/test/java/org/elasticsearch/snapshots/SharedClusterSnapshotRestoreTests.java
comments:
[TEST] replaced cluster().wipeIndices|wipeTemplates calls with immutableCluster().wipeIndices|wipeTemplates

time:
2014-03-31T16:06:48Z
class:
src/main/java/org/elasticsearch/search/aggregations/bucket/geogrid/GeoHashGridAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/geogrid/GeoHashGridParser.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/DateHistogramParser.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/ExtendedBounds.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/HistogramAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/HistogramParser.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/InternalDateHistogram.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/InternalHistogram.java
src/main/java/org/elasticsearch/search/aggregations/bucket/missing/MissingAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/missing/MissingParser.java
src/main/java/org/elasticsearch/search/aggregations/bucket/range/InternalRange.java
src/main/java/org/elasticsearch/search/aggregations/bucket/range/RangeAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/range/RangeBuilder.java
src/main/java/org/elasticsearch/search/aggregations/bucket/range/RangeParser.java
src/main/java/org/elasticsearch/search/aggregations/bucket/range/date/DateRangeParser.java
src/main/java/org/elasticsearch/search/aggregations/bucket/range/date/InternalDateRange.java
src/main/java/org/elasticsearch/search/aggregations/bucket/range/geodistance/GeoDistanceParser.java
src/main/java/org/elasticsearch/search/aggregations/bucket/range/geodistance/InternalGeoDistance.java
src/main/java/org/elasticsearch/search/aggregations/bucket/range/ipv4/InternalIPv4Range.java
src/main/java/org/elasticsearch/search/aggregations/bucket/range/ipv4/IpRangeParser.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantLongTerms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantLongTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantStringTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantTermsAggregatorFactory.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantTermsParser.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/DoubleTerms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/DoubleTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/LongTerms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/LongTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/StringTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/TermsAggregatorFactory.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/TermsParser.java
src/main/java/org/elasticsearch/search/aggregations/metrics/MetricsAggregation.java
src/main/java/org/elasticsearch/search/aggregations/metrics/ValuesSourceMetricsAggregatorParser.java
src/main/java/org/elasticsearch/search/aggregations/metrics/avg/AvgAggregator.java
src/main/java/org/elasticsearch/search/aggregations/metrics/avg/AvgParser.java
src/main/java/org/elasticsearch/search/aggregations/metrics/avg/InternalAvg.java
src/main/java/org/elasticsearch/search/aggregations/metrics/cardinality/CardinalityAggregator.java
src/main/java/org/elasticsearch/search/aggregations/metrics/cardinality/CardinalityAggregatorFactory.java
src/main/java/org/elasticsearch/search/aggregations/metrics/cardinality/CardinalityParser.java
src/main/java/org/elasticsearch/search/aggregations/metrics/cardinality/InternalCardinality.java
src/main/java/org/elasticsearch/search/aggregations/metrics/max/InternalMax.java
src/main/java/org/elasticsearch/search/aggregations/metrics/max/MaxAggregator.java
src/main/java/org/elasticsearch/search/aggregations/metrics/max/MaxParser.java
src/main/java/org/elasticsearch/search/aggregations/metrics/min/InternalMin.java
src/main/java/org/elasticsearch/search/aggregations/metrics/min/MinAggregator.java
src/main/java/org/elasticsearch/search/aggregations/metrics/min/MinParser.java
src/main/java/org/elasticsearch/search/aggregations/metrics/percentiles/InternalPercentiles.java
src/main/java/org/elasticsearch/search/aggregations/metrics/percentiles/PercentilesAggregator.java
src/main/java/org/elasticsearch/search/aggregations/metrics/percentiles/PercentilesParser.java
src/main/java/org/elasticsearch/search/aggregations/metrics/stats/InternalStats.java
src/main/java/org/elasticsearch/search/aggregations/metrics/stats/StatsAggegator.java
src/main/java/org/elasticsearch/search/aggregations/metrics/stats/StatsParser.java
src/main/java/org/elasticsearch/search/aggregations/metrics/stats/extended/ExtendedStatsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/metrics/stats/extended/ExtendedStatsParser.java
src/main/java/org/elasticsearch/search/aggregations/metrics/sum/InternalSum.java
src/main/java/org/elasticsearch/search/aggregations/metrics/sum/SumAggregator.java
src/main/java/org/elasticsearch/search/aggregations/metrics/sum/SumParser.java
src/main/java/org/elasticsearch/search/aggregations/metrics/valuecount/ValueCountAggregator.java
src/main/java/org/elasticsearch/search/aggregations/metrics/valuecount/ValueCountParser.java
src/main/java/org/elasticsearch/search/aggregations/support/AggregationContext.java
src/main/java/org/elasticsearch/search/aggregations/support/FieldDataSource.java
src/main/java/org/elasticsearch/search/aggregations/support/ScriptValueType.java
src/main/java/org/elasticsearch/search/aggregations/support/ValuesSource.java
src/main/java/org/elasticsearch/search/aggregations/support/ValuesSourceAggregatorFactory.java
src/main/java/org/elasticsearch/search/aggregations/support/ValuesSourceBased.java
src/main/java/org/elasticsearch/search/aggregations/support/ValuesSourceConfig.java
src/main/java/org/elasticsearch/search/aggregations/support/bytes/BytesValuesSource.java
src/main/java/org/elasticsearch/search/aggregations/support/format/ValueFormatter.java
src/main/java/org/elasticsearch/search/aggregations/support/format/ValueFormatterStreams.java
src/main/java/org/elasticsearch/search/aggregations/support/format/ValueParser.java
src/main/java/org/elasticsearch/search/aggregations/support/geopoints/GeoPointValuesSource.java
src/main/java/org/elasticsearch/search/aggregations/support/numeric/NumericValuesSource.java
src/main/java/org/elasticsearch/search/aggregations/support/values/ScriptBytesValues.java
src/main/java/org/elasticsearch/search/aggregations/support/values/ScriptDoubleValues.java
src/main/java/org/elasticsearch/search/aggregations/support/values/ScriptLongValues.java
src/test/java/org/elasticsearch/search/aggregations/bucket/RangeTests.java
src/test/java/org/elasticsearch/search/aggregations/support/FieldDataSourceTests.java
src/test/java/org/elasticsearch/search/aggregations/support/ScriptValuesTests.java
comments:
Aggregations cleanup

- removed an abstraction layer that handles the values source (consolidated values source with field data source)
- better handling of value parser/formatter in range & histogram aggs
- the buckets key will now be shown by default in range agg

time:
2014-03-31T16:01:03Z
class:
src/test/java/org/elasticsearch/cluster/MinimumMasterNodesTests.java
comments:
[TEST] Set minimum_master_nodes for new node as well to make sure all ndoes have the same settings

time:
2014-03-31T15:39:57Z
class:
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
comments:
InternalEngine - only set dirty=false after a refresh happened

time:
2014-03-31T15:28:38Z
class:
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
comments:
InternalEngine - added an assert to verify refresh was performed by lucene

time:
2014-03-31T15:24:02Z
class:
src/main/java/org/elasticsearch/common/netty/ReleaseChannelFutureListener.java
src/main/java/org/elasticsearch/http/HttpResponse.java
src/main/java/org/elasticsearch/http/HttpServer.java
src/main/java/org/elasticsearch/http/netty/HttpRequestHandler.java
src/main/java/org/elasticsearch/http/netty/NettyHttpChannel.java
src/main/java/org/elasticsearch/http/netty/NettyHttpRequest.java
src/main/java/org/elasticsearch/rest/AbstractRestResponse.java
src/main/java/org/elasticsearch/rest/AbstractRestResponseActionListener.java
src/main/java/org/elasticsearch/rest/AcknowledgedRestResponseActionListener.java
src/main/java/org/elasticsearch/rest/BytesRestResponse.java
src/main/java/org/elasticsearch/rest/HttpRedirectRestResponse.java
src/main/java/org/elasticsearch/rest/RestController.java
src/main/java/org/elasticsearch/rest/RestResponse.java
src/main/java/org/elasticsearch/rest/Utf8RestResponse.java
src/main/java/org/elasticsearch/rest/XContentRestResponse.java
src/main/java/org/elasticsearch/rest/XContentThrowableRestResponse.java
src/main/java/org/elasticsearch/rest/action/admin/cluster/health/RestClusterHealthAction.java
src/main/java/org/elasticsearch/rest/action/admin/cluster/node/hotthreads/RestNodesHotThreadsAction.java
src/main/java/org/elasticsearch/rest/action/admin/cluster/node/info/RestNodesInfoAction.java
src/main/java/org/elasticsearch/rest/action/admin/cluster/node/restart/RestNodesRestartAction.java
src/main/java/org/elasticsearch/rest/action/admin/cluster/node/shutdown/RestNodesShutdownAction.java
src/main/java/org/elasticsearch/rest/action/admin/cluster/node/stats/RestNodesStatsAction.java
src/main/java/org/elasticsearch/rest/action/admin/cluster/repositories/get/RestGetRepositoriesAction.java
src/main/java/org/elasticsearch/rest/action/admin/cluster/reroute/RestClusterRerouteAction.java
src/main/java/org/elasticsearch/rest/action/admin/cluster/settings/RestClusterGetSettingsAction.java
src/main/java/org/elasticsearch/rest/action/admin/cluster/settings/RestClusterUpdateSettingsAction.java
src/main/java/org/elasticsearch/rest/action/admin/cluster/shards/RestClusterSearchShardsAction.java
src/main/java/org/elasticsearch/rest/action/admin/cluster/snapshots/create/RestCreateSnapshotAction.java
src/main/java/org/elasticsearch/rest/action/admin/cluster/snapshots/get/RestGetSnapshotsAction.java
src/main/java/org/elasticsearch/rest/action/admin/cluster/snapshots/restore/RestRestoreSnapshotAction.java
src/main/java/org/elasticsearch/rest/action/admin/cluster/snapshots/status/RestSnapshotsStatusAction.java
src/main/java/org/elasticsearch/rest/action/admin/cluster/state/RestClusterStateAction.java
src/main/java/org/elasticsearch/rest/action/admin/cluster/stats/RestClusterStatsAction.java
src/main/java/org/elasticsearch/rest/action/admin/cluster/tasks/RestPendingClusterTasksAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/alias/RestIndicesAliasesAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/alias/get/RestGetAliasesAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/alias/get/RestGetIndicesAliasesAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/alias/head/RestAliasesExistAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/alias/put/RestIndexPutAliasAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/analyze/RestAnalyzeAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/cache/clear/RestClearIndicesCacheAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/create/RestCreateIndexAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/exists/indices/RestIndicesExistsAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/exists/types/RestTypesExistsAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/flush/RestFlushAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/mapping/get/RestGetFieldMappingAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/mapping/get/RestGetMappingAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/optimize/RestOptimizeAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/recovery/RestRecoveryAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/refresh/RestRefreshAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/segments/RestIndicesSegmentsAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/settings/RestGetSettingsAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/settings/RestUpdateSettingsAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/stats/RestIndicesStatsAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/status/RestIndicesStatusAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/template/get/RestGetIndexTemplateAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/template/head/RestHeadIndexTemplateAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/template/put/RestPutIndexTemplateAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/validate/query/RestValidateQueryAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/warmer/get/RestGetWarmerAction.java
src/main/java/org/elasticsearch/rest/action/bulk/RestBulkAction.java
src/main/java/org/elasticsearch/rest/action/cat/AbstractCatAction.java
src/main/java/org/elasticsearch/rest/action/cat/RestAliasAction.java
src/main/java/org/elasticsearch/rest/action/cat/RestAllocationAction.java
src/main/java/org/elasticsearch/rest/action/cat/RestCatAction.java
src/main/java/org/elasticsearch/rest/action/cat/RestCountAction.java
src/main/java/org/elasticsearch/rest/action/cat/RestHealthAction.java
src/main/java/org/elasticsearch/rest/action/cat/RestIndicesAction.java
src/main/java/org/elasticsearch/rest/action/cat/RestMasterAction.java
src/main/java/org/elasticsearch/rest/action/cat/RestNodesAction.java
src/main/java/org/elasticsearch/rest/action/cat/RestPendingClusterTasksAction.java
src/main/java/org/elasticsearch/rest/action/cat/RestRecoveryAction.java
src/main/java/org/elasticsearch/rest/action/cat/RestSegmentsAction.java
src/main/java/org/elasticsearch/rest/action/count/RestCountAction.java
src/main/java/org/elasticsearch/rest/action/delete/RestDeleteAction.java
src/main/java/org/elasticsearch/rest/action/deletebyquery/RestDeleteByQueryAction.java
src/main/java/org/elasticsearch/rest/action/explain/RestExplainAction.java
src/main/java/org/elasticsearch/rest/action/get/RestGetAction.java
src/main/java/org/elasticsearch/rest/action/get/RestGetSourceAction.java
src/main/java/org/elasticsearch/rest/action/get/RestHeadAction.java
src/main/java/org/elasticsearch/rest/action/get/RestMultiGetAction.java
src/main/java/org/elasticsearch/rest/action/index/RestIndexAction.java
src/main/java/org/elasticsearch/rest/action/main/RestMainAction.java
src/main/java/org/elasticsearch/rest/action/mlt/RestMoreLikeThisAction.java
src/main/java/org/elasticsearch/rest/action/percolate/RestMultiPercolateAction.java
src/main/java/org/elasticsearch/rest/action/percolate/RestPercolateAction.java
src/main/java/org/elasticsearch/rest/action/search/RestClearScrollAction.java
src/main/java/org/elasticsearch/rest/action/search/RestMultiSearchAction.java
src/main/java/org/elasticsearch/rest/action/search/RestSearchAction.java
src/main/java/org/elasticsearch/rest/action/search/RestSearchScrollAction.java
src/main/java/org/elasticsearch/rest/action/suggest/RestSuggestAction.java
src/main/java/org/elasticsearch/rest/action/support/RestTable.java
src/main/java/org/elasticsearch/rest/action/termvector/RestMultiTermVectorsAction.java
src/main/java/org/elasticsearch/rest/action/termvector/RestTermVectorAction.java
src/main/java/org/elasticsearch/rest/action/update/RestUpdateAction.java
src/test/java/org/elasticsearch/plugin/responseheader/TestResponseHeaderRestAction.java
comments:
Cleanup Rest Response
simplify rest response class hierarchy, by using BytesReference for content, and handling JSONP internally in the respective channel that sends the response.
Also, handle the future case where bytes might be releasable, when we start to potentially recycle bytes output stream.

time:
2014-03-31T14:16:21Z
class:
src/main/java/org/apache/lucene/analysis/PrefixAnalyzer.java
src/main/java/org/elasticsearch/search/suggest/SuggestBuilder.java
src/main/java/org/elasticsearch/search/suggest/context/CategoryContextMapping.java
src/main/java/org/elasticsearch/search/suggest/context/GeolocationContextMapping.java
src/test/java/org/elasticsearch/search/suggest/ContextSuggestSearchTests.java
comments:
ContextSuggester: Adding couple of tests to catch more bugs

A bunch of minor fixes have been included here, especially due
to wrongly parsed mappings. Also using assertions resulted in an
NPE because they were disabled in the distribution.

Closes #5525

time:
2014-03-31T13:23:23Z
class:
src/main/java/org/elasticsearch/index/translog/Translog.java
src/main/java/org/elasticsearch/index/translog/fs/BufferingFsTranslogFile.java
src/main/java/org/elasticsearch/index/translog/fs/FsTranslog.java
src/main/java/org/elasticsearch/index/translog/fs/FsTranslogFile.java
src/main/java/org/elasticsearch/index/translog/fs/SimpleFsTranslogFile.java
comments:
Fix visibility in buffered translog
- fix visiblity of last written position in translog
- while there, make sure to properly propagate the exception from sync()

time:
2014-03-31T13:13:14Z
class:
comments:
[TEST] Fixed TTL tests for create, index, update
Were failing on faster boxes

time:
2014-03-31T12:41:05Z
class:
src/test/java/org/elasticsearch/indices/fielddata/breaker/RandomExceptionCircuitBreakerTests.java
src/test/java/org/elasticsearch/search/basic/SearchWithRandomExceptionsTests.java
src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java
src/test/java/org/elasticsearch/test/ImmutableTestCluster.java
src/test/java/org/elasticsearch/test/TestCluster.java
src/test/java/org/elasticsearch/test/engine/MockInternalEngine.java
src/test/java/org/elasticsearch/test/hamcrest/ElasticsearchAssertions.java
src/test/java/org/elasticsearch/test/store/MockFSDirectoryService.java
src/test/java/org/elasticsearch/test/store/MockRamDirectoryService.java
src/test/java/org/elasticsearch/test/transport/AssertingLocalTransport.java
comments:
[TEST] introduced ImmutableTestCluster abstract base class for TestCluster

The new base class contains all the immutable methods for a cluster, which will be extended by the future ExternalCluster impl that relies on an external cluster and won't be adding nodes etc. but only sending requests to an existing cluster whose layout never changes

Closes #5620

time:
2014-03-31T12:11:28Z
class:
src/main/java/org/elasticsearch/action/bulk/TransportBulkAction.java
src/test/java/org/elasticsearch/document/BulkTests.java
comments:
Bulk API: Ensure that specific failures do not affect whole request

Before a bulk request is executed, missing indices are being created by default.
If this fails, the whole request is failed.

This patch changes the behaviour to not fail the whole request, but rather all
requests using the index where the creation has failed.

Closes #4987

time:
2014-03-31T11:57:47Z
class:
src/main/java/org/elasticsearch/action/support/master/TransportMasterNodeOperationAction.java
comments:
TransportMasterNodeOperationAction: tighter postAdded change check

If a node fails to forward a master node operation to the current master, it will schedule a retry using a listener for cluster state changes. Once the listener is in place (and future changes are guaranteed to be observed) it will double check nothing has change during the addition of the listener. This check has previously been change to use cluster state versions (see: #5499). This is however not reliable solution as master elections (which change the master) do not increment the cluster state version and thus could be missed. This commit changes the check to use reference equality making it stricter.

Closes #5548

time:
2014-03-31T11:53:38Z
class:
src/test/java/org/elasticsearch/indices/warmer/SimpleIndicesWarmerTests.java
comments:
[Test] remove timeout from deleteWarmer call with many shards that might just take a while

time:
2014-03-31T11:48:17Z
class:
comments:
Fix some typos in documentation.

time:
2014-03-31T10:44:00Z
class:
src/main/java/org/elasticsearch/index/mapper/FieldMapper.java
src/main/java/org/elasticsearch/index/mapper/core/AbstractFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/core/BinaryFieldMapper.java
comments:
check "store" for binary mapper and check "index_name" for all mappers

closes #5474

time:
2014-03-31T10:37:04Z
class:
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/create/CreateSnapshotRequest.java
src/main/java/org/elasticsearch/action/get/TransportGetAction.java
src/main/java/org/elasticsearch/action/support/master/MasterNodeOperationRequest.java
src/main/java/org/elasticsearch/cluster/metadata/MetaData.java
src/main/java/org/elasticsearch/common/Names.java
src/main/java/org/elasticsearch/common/geo/GeoDistance.java
src/main/java/org/elasticsearch/common/lucene/Lucene.java
src/main/java/org/elasticsearch/common/unit/DistanceUnit.java
src/main/java/org/elasticsearch/discovery/zen/ping/ZenPing.java
src/main/java/org/elasticsearch/index/mapper/core/CompletionFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/geo/GeoPointFieldMapper.java
src/main/java/org/elasticsearch/monitor/jvm/GcNames.java
src/main/java/org/elasticsearch/rest/action/cat/RestAllocationAction.java
src/main/java/org/elasticsearch/rest/support/RestUtils.java
src/main/java/org/elasticsearch/search/aggregations/bucket/geogrid/InternalGeoHashGrid.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantLongTerms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantStringTerms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/UnmappedSignificantTerms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/DoubleTerms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/LongTerms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/StringTerms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/UnmappedTerms.java
src/main/java/org/elasticsearch/search/controller/SearchPhaseController.java
src/main/java/org/elasticsearch/search/suggest/SuggestUtils.java
src/main/java/org/elasticsearch/search/suggest/context/CategoryContextMapping.java
src/main/java/org/elasticsearch/search/suggest/context/GeolocationContextMapping.java
src/main/java/org/elasticsearch/search/suggest/term/TermSuggestion.java
src/main/java/org/elasticsearch/transport/ConnectTransportException.java
comments:
Fix some warnings reported by Findbugs.

Although high-severity bugs were mostly static variables that were not final,
it also found potential NPEs and bugs like `x ^= x;` or equality checks on
objects that don't share a common interface.

Close #5571

time:
2014-03-31T10:36:03Z
class:
src/test/java/org/elasticsearch/test/rest/client/RestClient.java
comments:
[TEST] Test sending the request body as source parameter with GET method through REST tests

For around 10% of the calls that support the GET method, the request body gets now sent as `source` parameter with GET method (no randomized method in this case).

This way we can find bugs like #5556 (missing support for source param).

time:
2014-03-31T09:46:13Z
class:
src/main/java/org/elasticsearch/search/aggregations/NonCollectingAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/geogrid/GeoHashGridAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/geogrid/GeoHashGridParser.java
src/main/java/org/elasticsearch/search/aggregations/bucket/range/RangeAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantTermsAggregatorFactory.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/UnmappedSignificantTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/TermsAggregatorFactory.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/UnmappedTermsAggregator.java
comments:
Refactor common code for unmapped aggregators into `NonCollectingAggregator`.

Our aggregators that are dedicated to unmapped fields all look more or less
the same so this hopefully helps remove some spaghetti code.

Close #5528

time:
2014-03-31T09:40:44Z
class:
src/main/java/org/elasticsearch/action/search/SearchRequest.java
comments:
Search template: Fix support for source parameter

If a search template was created using the source parameter, the
content of the parameter was put as source instead of sourceTemplate

Fixes #5556

time:
2014-03-31T09:34:46Z
class:
comments:
Document http.cors-settings

time:
2014-03-31T09:28:34Z
class:
comments:
[TEST] decreased number of replicas to 0 in refresh tests

Some tests disable refresh and verify that documents cannot be found without an explicit refresh. With at least one replica and waiting for yellow though, it can happen that we start indexing docs when the replicas are not ready yet, and as soon as they become ready they get refreshed, causing the newly added docs to be unexpectedly found. Solution is to disable replicas for these specific tests.

time:
2014-03-31T03:51:25Z
class:
src/main/java/org/elasticsearch/discovery/zen/ping/unicast/UnicastZenPing.java
src/test/java/org/elasticsearch/discovery/ZenUnicastDiscoveryTests.java
src/test/java/org/elasticsearch/discovery/ZenUnicastDiscoveryTestsMinimumMasterNodes.java
src/test/java/org/elasticsearch/discovery/ZenUnicastDiscoveryTestsSpecificNodes.java
comments:
An improvement to unicast discovery to also ping nodes the node itself received a ping from.
Also moved the unicast tests all in a single package.

Closes #5508

time:
2014-03-30T22:06:35Z
class:
comments:
Update has-parent-filter.asciidoc

"This filter return child..." => This filter returns child...

time:
2014-03-29T20:06:29Z
class:
src/test/java/org/elasticsearch/indices/fielddata/breaker/RandomExceptionCircuitBreakerTests.java
comments:
[TEST] Wait for shards to allocate before cleaning caches

time:
2014-03-28T17:35:25Z
class:
src/test/java/org/elasticsearch/script/python/PythonScriptSearchTests.java
comments:
Create branches according to elasticsearch versions

We create branches:

* es-0.90 for elasticsearch 0.90
* es-1.0 for elasticsearch 1.0
* es-1.1 for elasticsearch 1.1
* master for elasticsearch master

We also check that before releasing we don't have a dependency to an elasticsearch SNAPSHOT version.

Add links to each version in documentation

time:
2014-03-28T17:35:10Z
class:
src/test/java/org/elasticsearch/script/javascript/JavaScriptScriptSearchTests.java
comments:
Create branches according to elasticsearch versions

We create branches:

* es-0.90 for elasticsearch 0.90
* es-1.0 for elasticsearch 1.0
* es-1.1 for elasticsearch 1.1
* master for elasticsearch master

We also check that before releasing we don't have a dependency to an elasticsearch SNAPSHOT version.

Add links to each version in documentation

time:
2014-03-28T17:01:03Z
class:
src/main/java/org/elasticsearch/action/search/SearchRequestBuilder.java
src/main/java/org/elasticsearch/search/highlight/HighlightBuilder.java
src/test/java/org/elasticsearch/search/highlight/HighlighterSearchTests.java
comments:
Fixed highlighting inconsistencies between REST and Java api

Exposed HighlightBuilder missing global options in Java API: fragmentSize, numOfFragments, highlightFilter, boundaryMaxScan and boundaryChars
Exposed SearchRequestBuilder missing global options shortcuts: setHighlighterFragmentSize, setHighlighterNumOfFragments, setHighlighterFilter, setHighlighterBoundaryMaxScan, setHighlighterBoundaryChars, setHighlighterFragmenter, setHighlighterPhraseLimit & setHighlighterForceSource

Closes #5281

time:
2014-03-28T16:47:38Z
class:
src/test/java/org/elasticsearch/plugin/mapper/attachments/test/MultipleAttachmentIntegrationTests.java
src/test/java/org/elasticsearch/plugin/mapper/attachments/test/SimpleAttachmentIntegrationTests.java
comments:
Create branches according to elasticsearch versions

We create branches:

* es-0.90 for elasticsearch 0.90
* es-1.0 for elasticsearch 1.0
* es-1.1 for elasticsearch 1.1
* master for elasticsearch master

We also check that before releasing we don't have a dependency to an elasticsearch SNAPSHOT version.

Add links to each version in documentation

time:
2014-03-28T16:25:03Z
class:
comments:
Support documentation link update

time:
2014-03-28T16:23:17Z
class:
comments:
[TEST] Update TTL test can fail on faster boxes - improve range of valid vals

time:
2014-03-28T13:54:55Z
class:
src/main/java/org/elasticsearch/index/mapper/object/DynamicTemplate.java
comments:
fix dynamic_type in dynamic_template

closes #5256

time:
2014-03-28T11:19:46Z
class:
src/test/java/org/elasticsearch/test/rest/support/Features.java
comments:
[TEST] Removed skip regex sections as all the runners implemented the feature

time:
2014-03-28T11:05:08Z
class:
src/main/java/org/elasticsearch/common/xcontent/XContentBuilder.java
src/main/java/org/elasticsearch/monitor/jvm/JvmInfo.java
src/main/java/org/elasticsearch/monitor/network/NetworkInfo.java
src/main/java/org/elasticsearch/monitor/os/OsInfo.java
src/main/java/org/elasticsearch/monitor/process/ProcessInfo.java
comments:
add human readable start_time and refresh_interval

closes #5280

time:
2014-03-28T10:13:54Z
class:
src/main/java/org/elasticsearch/action/admin/indices/stats/CommonStats.java
src/main/java/org/elasticsearch/action/admin/indices/stats/CommonStatsFlags.java
src/main/java/org/elasticsearch/action/admin/indices/stats/IndicesStatsRequest.java
src/main/java/org/elasticsearch/action/admin/indices/stats/IndicesStatsRequestBuilder.java
src/main/java/org/elasticsearch/action/admin/indices/stats/TransportIndicesStatsAction.java
src/main/java/org/elasticsearch/action/suggest/TransportSuggestAction.java
src/main/java/org/elasticsearch/index/service/InternalIndexService.java
src/main/java/org/elasticsearch/index/shard/service/IndexShard.java
src/main/java/org/elasticsearch/index/shard/service/InternalIndexShard.java
src/main/java/org/elasticsearch/index/suggest/SuggestShardModule.java
src/main/java/org/elasticsearch/index/suggest/stats/ShardSuggestService.java
src/main/java/org/elasticsearch/index/suggest/stats/SuggestStats.java
src/main/java/org/elasticsearch/indices/NodeIndicesStats.java
src/main/java/org/elasticsearch/rest/action/admin/indices/stats/RestIndicesStatsAction.java
src/main/java/org/elasticsearch/rest/action/cat/RestIndicesAction.java
src/main/java/org/elasticsearch/rest/action/cat/RestNodesAction.java
src/test/java/org/elasticsearch/index/suggest/stats/SuggestStatsTests.java
src/test/java/org/elasticsearch/indices/stats/SimpleIndexStatsTests.java
comments:
Add suggest stats

closes #4032

time:
2014-03-28T10:02:53Z
class:
src/main/java/org/elasticsearch/common/bytes/PagedBytesReference.java
src/test/java/org/elasticsearch/common/bytes/PagedBytesReferenceTest.java
comments:
Restore streamInput() performance over PagedBytesReference.

Closes #5589

time:
2014-03-28T09:30:39Z
class:
src/main/java/org/elasticsearch/common/xcontent/XContentFactory.java
src/main/java/org/elasticsearch/common/xcontent/XContentType.java
src/main/java/org/elasticsearch/common/xcontent/cbor/CborXContent.java
src/main/java/org/elasticsearch/common/xcontent/cbor/CborXContentGenerator.java
src/main/java/org/elasticsearch/common/xcontent/cbor/CborXContentParser.java
src/test/java/org/elasticsearch/common/xcontent/XContentFactoryTests.java
src/test/java/org/elasticsearch/common/xcontent/builder/BuilderRawFieldTests.java
src/test/java/org/elasticsearch/common/xcontent/cbor/JsonVsCborTests.java
comments:
add CBOR data format support

time:
2014-03-28T09:01:08Z
class:
comments:
Update .gitignore to ignore the execution hints files

time:
2014-03-28T08:54:21Z
class:
src/main/java/org/elasticsearch/search/suggest/Suggest.java
src/test/java/org/elasticsearch/search/suggest/SuggestSearchTests.java
src/test/java/org/elasticsearch/test/hamcrest/ElasticsearchAssertions.java
comments:
Use only one shard in SuggestSearchTests#testPhraseBoundaryCases to get reliable statistics

time:
2014-03-27T20:29:37Z
class:
src/main/java/org/elasticsearch/common/lucene/search/function/FieldValueFactorFunction.java
src/main/java/org/elasticsearch/index/query/functionscore/FunctionScoreModule.java
src/main/java/org/elasticsearch/index/query/functionscore/ScoreFunctionBuilders.java
src/main/java/org/elasticsearch/index/query/functionscore/fieldvaluefactor/FieldValueFactorFunctionBuilder.java
src/main/java/org/elasticsearch/index/query/functionscore/fieldvaluefactor/FieldValueFactorFunctionParser.java
src/test/java/org/elasticsearch/search/functionscore/FunctionScoreFieldValueTests.java
comments:
Add the `field_value_factor` function to the function_score query

The `field_value_factor` function uses the value of a field in the
document to influence the score.

A query that looks like:
{
  "query": {
    "function_score": {
      "query": {"match": { "body": "foo" }},
      "functions": [
        {
          "field_value_factor": {
            "field": "popularity",
            "factor": 1.1,
            "modifier": "square"
          }
        }
      ],
      "score_mode": "max",
      "boost_mode": "sum"
    }
  }
}

Would have the score modified by:

square(1.1 * doc['popularity'].value)

Closes #5519

time:
2014-03-27T19:31:01Z
class:
src/main/java/org/elasticsearch/cluster/InternalClusterInfoService.java
comments:
Be less verbose logging ClusterInfoUpdateJob failures

Closes #5222

time:
2014-03-27T18:10:08Z
class:
src/test/java/org/elasticsearch/tribe/TribeTests.java
comments:
cleanup second static cluster in test
hopefully this will remove the testing infra from failing on hanging to memory

time:
2014-03-27T16:45:20Z
class:
src/main/java/org/elasticsearch/tribe/TribeService.java
src/test/java/org/elasticsearch/tribe/TribeTests.java
comments:
Tribe: Index level blocks, index conflict settings
allow to configure on the index level which blocks can optionally be applied using tribe.blocks.indices prefix settings.
allow to control what will be done when a conflict is detected on index names coming from several clusters using the tribe.on_conflict setting. Defaults remains "any", but now support also "drop" and "prefer_[tribeName]".
closes #5501

time:
2014-03-27T16:07:49Z
class:
comments:
Adding Kopf to community list of monitoring tools.

Adding versatile monitoring and administration tool Kopf to the community section of the documentation.

time:
2014-03-27T15:28:22Z
class:
comments:
[Build] use the same execution hint file across the pom file

time:
2014-03-27T15:22:22Z
class:
src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java
comments:
[TEST] Reset global cluster if tearDown failes to prevent subsequent failures

time:
2014-03-27T15:00:25Z
class:
src/main/java/org/elasticsearch/action/admin/cluster/reroute/ClusterRerouteRequest.java
src/main/java/org/elasticsearch/action/bulk/BulkRequest.java
src/main/java/org/elasticsearch/action/get/MultiGetRequest.java
src/main/java/org/elasticsearch/action/percolate/MultiPercolateRequest.java
src/main/java/org/elasticsearch/action/percolate/PercolateSourceBuilder.java
src/main/java/org/elasticsearch/action/search/MultiSearchRequest.java
src/main/java/org/elasticsearch/action/termvector/MultiTermVectorsRequest.java
src/main/java/org/elasticsearch/action/update/UpdateRequest.java
src/main/java/org/elasticsearch/cluster/metadata/AliasMetaData.java
src/main/java/org/elasticsearch/cluster/metadata/IndexMetaData.java
src/main/java/org/elasticsearch/common/Strings.java
src/main/java/org/elasticsearch/common/inject/internal/Errors.java
src/main/java/org/elasticsearch/common/settings/loader/XContentSettingsLoader.java
src/main/java/org/elasticsearch/common/xcontent/XContentHelper.java
src/main/java/org/elasticsearch/common/xcontent/smile/SmileXContentGenerator.java
src/main/java/org/elasticsearch/common/xcontent/yaml/YamlXContentGenerator.java
src/main/java/org/elasticsearch/gateway/local/state/meta/LocalGatewayMetaState.java
src/main/java/org/elasticsearch/index/aliases/IndexAliasesService.java
src/main/java/org/elasticsearch/index/fielddata/plain/DoubleArrayIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/FSTBytesIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/FloatArrayIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/GeoPointCompressedIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/GeoPointDoubleArrayIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/PackedArrayIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/PagedBytesIndexFieldData.java
src/main/java/org/elasticsearch/index/gateway/CommitPoints.java
src/main/java/org/elasticsearch/index/query/CommonTermsQueryParser.java
src/main/java/org/elasticsearch/index/query/TemplateQueryParser.java
src/main/java/org/elasticsearch/index/query/WrapperFilterParser.java
src/main/java/org/elasticsearch/index/query/WrapperQueryParser.java
src/main/java/org/elasticsearch/index/search/child/DeleteByQueryWrappingFilter.java
src/main/java/org/elasticsearch/index/snapshots/blobstore/BlobStoreIndexShardRepository.java
src/main/java/org/elasticsearch/index/store/Store.java
src/main/java/org/elasticsearch/rest/action/admin/indices/alias/RestIndicesAliasesAction.java
src/main/java/org/elasticsearch/search/aggregations/AggregationBinaryParseElement.java
src/main/java/org/elasticsearch/search/facet/FacetBinaryParseElement.java
src/main/java/org/elasticsearch/search/query/FilterBinaryParseElement.java
src/main/java/org/elasticsearch/search/query/QueryBinaryParseElement.java
src/main/java/org/elasticsearch/search/warmer/IndexWarmersMetaData.java
src/test/java/org/elasticsearch/test/rest/parser/RestTestSuiteParser.java
comments:
[JAVA7 Upgrade] Replace try/finally with

time:
2014-03-27T14:54:45Z
class:
src/main/java/jsr166e/CompletableFuture.java
src/main/java/jsr166e/ConcurrentHashMapV8.java
src/main/java/jsr166e/ForkJoinPool.java
src/main/java/jsr166e/ForkJoinTask.java
src/main/java/jsr166e/LongAdderTable.java
src/main/java/jsr166e/extra/ReadMostlyVector.java
src/main/java/jsr166y/ConcurrentLinkedDeque.java
src/main/java/jsr166y/ForkJoinPool.java
src/main/java/jsr166y/ForkJoinTask.java
src/main/java/jsr166y/Phaser.java
src/main/java/org/apache/lucene/queries/XTermsFilter.java
src/main/java/org/apache/lucene/queryparser/classic/MapperQueryParser.java
src/main/java/org/apache/lucene/search/postingshighlight/XPostingsHighlighter.java
src/main/java/org/apache/lucene/search/suggest/analyzing/XAnalyzingSuggester.java
src/main/java/org/apache/lucene/search/vectorhighlight/CustomFieldQuery.java
src/main/java/org/elasticsearch/action/ActionModule.java
src/main/java/org/elasticsearch/action/ActionRequestBuilder.java
src/main/java/org/elasticsearch/action/ActionRequestValidationException.java
src/main/java/org/elasticsearch/action/admin/cluster/node/info/PluginsInfo.java
src/main/java/org/elasticsearch/action/admin/cluster/node/info/TransportNodesInfoAction.java
src/main/java/org/elasticsearch/action/admin/cluster/node/shutdown/TransportNodesShutdownAction.java
src/main/java/org/elasticsearch/action/admin/cluster/stats/ClusterStatsIndices.java
src/main/java/org/elasticsearch/action/admin/cluster/stats/ClusterStatsNodes.java
src/main/java/org/elasticsearch/action/admin/cluster/stats/TransportClusterStatsAction.java
src/main/java/org/elasticsearch/action/admin/cluster/tasks/PendingClusterTasksResponse.java
src/main/java/org/elasticsearch/action/admin/indices/alias/IndicesAliasesRequest.java
src/main/java/org/elasticsearch/action/admin/indices/alias/TransportIndicesAliasesAction.java
src/main/java/org/elasticsearch/action/admin/indices/alias/get/GetAliasesResponse.java
src/main/java/org/elasticsearch/action/admin/indices/analyze/AnalyzeResponse.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/delete/TransportDeleteMappingAction.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/get/TransportGetFieldMappingsAction.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/get/TransportGetFieldMappingsIndexAction.java
src/main/java/org/elasticsearch/action/admin/indices/recovery/RecoveryResponse.java
src/main/java/org/elasticsearch/action/admin/indices/recovery/TransportRecoveryAction.java
src/main/java/org/elasticsearch/action/admin/indices/segments/ShardSegments.java
src/main/java/org/elasticsearch/action/admin/indices/validate/query/ValidateQueryResponse.java
src/main/java/org/elasticsearch/action/admin/indices/warmer/put/TransportPutWarmerAction.java
src/main/java/org/elasticsearch/action/bulk/BulkRequest.java
src/main/java/org/elasticsearch/action/bulk/TransportBulkAction.java
src/main/java/org/elasticsearch/action/bulk/TransportShardBulkAction.java
src/main/java/org/elasticsearch/action/delete/TransportDeleteAction.java
src/main/java/org/elasticsearch/action/delete/index/TransportShardDeleteAction.java
src/main/java/org/elasticsearch/action/deletebyquery/IndexDeleteByQueryRequest.java
src/main/java/org/elasticsearch/action/deletebyquery/ShardDeleteByQueryRequest.java
src/main/java/org/elasticsearch/action/deletebyquery/TransportShardDeleteByQueryAction.java
src/main/java/org/elasticsearch/action/get/MultiGetRequest.java
src/main/java/org/elasticsearch/action/get/MultiGetShardRequest.java
src/main/java/org/elasticsearch/action/get/MultiGetShardResponse.java
src/main/java/org/elasticsearch/action/get/TransportMultiGetAction.java
src/main/java/org/elasticsearch/action/index/TransportIndexAction.java
src/main/java/org/elasticsearch/action/percolate/MultiPercolateRequest.java
src/main/java/org/elasticsearch/action/percolate/PercolateResponse.java
src/main/java/org/elasticsearch/action/percolate/PercolateShardResponse.java
src/main/java/org/elasticsearch/action/percolate/PercolateSourceBuilder.java
src/main/java/org/elasticsearch/action/percolate/TransportMultiPercolateAction.java
src/main/java/org/elasticsearch/action/percolate/TransportShardMultiPercolateAction.java
src/main/java/org/elasticsearch/action/search/MultiSearchRequest.java
src/main/java/org/elasticsearch/action/search/TransportClearScrollAction.java
src/main/java/org/elasticsearch/action/search/TransportMultiSearchAction.java
src/main/java/org/elasticsearch/action/search/type/TransportSearchDfsQueryAndFetchAction.java
src/main/java/org/elasticsearch/action/search/type/TransportSearchDfsQueryThenFetchAction.java
src/main/java/org/elasticsearch/action/search/type/TransportSearchHelper.java
src/main/java/org/elasticsearch/action/search/type/TransportSearchQueryThenFetchAction.java
src/main/java/org/elasticsearch/action/search/type/TransportSearchScrollQueryAndFetchAction.java
src/main/java/org/elasticsearch/action/search/type/TransportSearchScrollQueryThenFetchAction.java
src/main/java/org/elasticsearch/action/search/type/TransportSearchScrollScanAction.java
src/main/java/org/elasticsearch/action/search/type/TransportSearchTypeAction.java
src/main/java/org/elasticsearch/action/suggest/TransportSuggestAction.java
src/main/java/org/elasticsearch/action/support/PlainActionFuture.java
src/main/java/org/elasticsearch/action/support/TransportAction.java
src/main/java/org/elasticsearch/action/support/nodes/TransportNodesOperationAction.java
src/main/java/org/elasticsearch/action/support/replication/TransportIndexReplicationOperationAction.java
src/main/java/org/elasticsearch/action/support/replication/TransportIndicesReplicationOperationAction.java
src/main/java/org/elasticsearch/action/termvector/MultiTermVectorsRequest.java
src/main/java/org/elasticsearch/action/termvector/MultiTermVectorsShardRequest.java
src/main/java/org/elasticsearch/action/termvector/MultiTermVectorsShardResponse.java
src/main/java/org/elasticsearch/action/termvector/TermVectorFields.java
src/main/java/org/elasticsearch/action/termvector/TermVectorRequest.java
src/main/java/org/elasticsearch/action/termvector/TermVectorWriter.java
src/main/java/org/elasticsearch/action/termvector/TransportMultiTermVectorsAction.java
src/main/java/org/elasticsearch/action/update/UpdateHelper.java
src/main/java/org/elasticsearch/bulk/udp/BulkUdpService.java
src/main/java/org/elasticsearch/client/node/NodeClient.java
src/main/java/org/elasticsearch/client/node/NodeClusterAdminClient.java
src/main/java/org/elasticsearch/client/node/NodeIndicesAdminClient.java
src/main/java/org/elasticsearch/client/transport/TransportClientNodesService.java
src/main/java/org/elasticsearch/client/transport/support/InternalTransportClient.java
src/main/java/org/elasticsearch/client/transport/support/InternalTransportClusterAdminClient.java
src/main/java/org/elasticsearch/client/transport/support/InternalTransportIndicesAdminClient.java
src/main/java/org/elasticsearch/cluster/ClusterState.java
src/main/java/org/elasticsearch/cluster/InternalClusterInfoService.java
src/main/java/org/elasticsearch/cluster/action/index/NodeIndexDeletedAction.java
src/main/java/org/elasticsearch/cluster/action/shard/ShardStateAction.java
src/main/java/org/elasticsearch/cluster/metadata/IndexMetaData.java
src/main/java/org/elasticsearch/cluster/metadata/MetaData.java
src/main/java/org/elasticsearch/cluster/metadata/MetaDataIndexStateService.java
src/main/java/org/elasticsearch/cluster/metadata/MetaDataMappingService.java
src/main/java/org/elasticsearch/cluster/metadata/MetaDataUpdateSettingsService.java
src/main/java/org/elasticsearch/cluster/metadata/RepositoriesMetaData.java
src/main/java/org/elasticsearch/cluster/node/DiscoveryNodeFilters.java
src/main/java/org/elasticsearch/cluster/node/DiscoveryNodeService.java
src/main/java/org/elasticsearch/cluster/node/DiscoveryNodes.java
src/main/java/org/elasticsearch/cluster/routing/IndexRoutingTable.java
src/main/java/org/elasticsearch/cluster/routing/IndexShardRoutingTable.java
src/main/java/org/elasticsearch/cluster/routing/RoutingNode.java
src/main/java/org/elasticsearch/cluster/routing/RoutingNodes.java
src/main/java/org/elasticsearch/cluster/routing/RoutingTable.java
src/main/java/org/elasticsearch/cluster/routing/allocation/AllocationService.java
src/main/java/org/elasticsearch/cluster/routing/allocation/RoutingAllocation.java
src/main/java/org/elasticsearch/cluster/routing/allocation/allocator/BalancedShardsAllocator.java
src/main/java/org/elasticsearch/cluster/routing/allocation/allocator/EvenShardsCountAllocator.java
src/main/java/org/elasticsearch/cluster/routing/allocation/command/AllocationCommands.java
src/main/java/org/elasticsearch/cluster/routing/allocation/decider/AwarenessAllocationDecider.java
src/main/java/org/elasticsearch/cluster/routing/operation/plain/PlainOperationRouting.java
src/main/java/org/elasticsearch/cluster/service/InternalClusterService.java
src/main/java/org/elasticsearch/common/ParseField.java
src/main/java/org/elasticsearch/common/StopWatch.java
src/main/java/org/elasticsearch/common/Strings.java
src/main/java/org/elasticsearch/common/Table.java
src/main/java/org/elasticsearch/common/blobstore/support/AbstractBlobContainer.java
src/main/java/org/elasticsearch/common/blobstore/support/BlobStores.java
src/main/java/org/elasticsearch/common/collect/HppcMaps.java
src/main/java/org/elasticsearch/common/collect/IdentityHashSet.java
src/main/java/org/elasticsearch/common/collect/ImmutableOpenIntMap.java
src/main/java/org/elasticsearch/common/collect/ImmutableOpenLongMap.java
src/main/java/org/elasticsearch/common/collect/ImmutableOpenMap.java
src/main/java/org/elasticsearch/common/collect/MapBuilder.java
src/main/java/org/elasticsearch/common/collect/Tuple.java
src/main/java/org/elasticsearch/common/component/AbstractLifecycleComponent.java
src/main/java/org/elasticsearch/common/geo/builders/BaseLineStringBuilder.java
src/main/java/org/elasticsearch/common/geo/builders/BasePolygonBuilder.java
src/main/java/org/elasticsearch/common/geo/builders/MultiLineStringBuilder.java
src/main/java/org/elasticsearch/common/geo/builders/MultiPointBuilder.java
src/main/java/org/elasticsearch/common/geo/builders/MultiPolygonBuilder.java
src/main/java/org/elasticsearch/common/geo/builders/PolygonBuilder.java
src/main/java/org/elasticsearch/common/geo/builders/ShapeBuilder.java
src/main/java/org/elasticsearch/common/inject/BindingProcessor.java
src/main/java/org/elasticsearch/common/inject/ConstructorBindingImpl.java
src/main/java/org/elasticsearch/common/inject/ConstructorInjectorStore.java
src/main/java/org/elasticsearch/common/inject/DeferredLookups.java
src/main/java/org/elasticsearch/common/inject/InheritingState.java
src/main/java/org/elasticsearch/common/inject/Initializer.java
src/main/java/org/elasticsearch/common/inject/InjectorImpl.java
src/main/java/org/elasticsearch/common/inject/InjectorShell.java
src/main/java/org/elasticsearch/common/inject/Key.java
src/main/java/org/elasticsearch/common/inject/MembersInjectorStore.java
src/main/java/org/elasticsearch/common/inject/Scopes.java
src/main/java/org/elasticsearch/common/inject/TypeLiteral.java
src/main/java/org/elasticsearch/common/inject/assistedinject/AssistedConstructor.java
src/main/java/org/elasticsearch/common/inject/assistedinject/FactoryProvider.java
src/main/java/org/elasticsearch/common/inject/assistedinject/ParameterListKey.java
src/main/java/org/elasticsearch/common/inject/internal/AbstractBindingBuilder.java
src/main/java/org/elasticsearch/common/inject/internal/BindingBuilder.java
src/main/java/org/elasticsearch/common/inject/internal/ConstantBindingBuilderImpl.java
src/main/java/org/elasticsearch/common/inject/internal/ConstructionContext.java
src/main/java/org/elasticsearch/common/inject/internal/ExposedBindingImpl.java
src/main/java/org/elasticsearch/common/inject/internal/InstanceBindingImpl.java
src/main/java/org/elasticsearch/common/inject/internal/InternalContext.java
src/main/java/org/elasticsearch/common/inject/internal/LinkedBindingImpl.java
src/main/java/org/elasticsearch/common/inject/internal/LinkedProviderBindingImpl.java
src/main/java/org/elasticsearch/common/inject/internal/ProviderInstanceBindingImpl.java
src/main/java/org/elasticsearch/common/inject/internal/ProviderMethodsModule.java
src/main/java/org/elasticsearch/common/inject/internal/ToStringBuilder.java
src/main/java/org/elasticsearch/common/inject/internal/UntargettedBindingImpl.java
src/main/java/org/elasticsearch/common/inject/matcher/AbstractMatcher.java
src/main/java/org/elasticsearch/common/inject/matcher/Matchers.java
src/main/java/org/elasticsearch/common/inject/multibindings/MapBinder.java
src/main/java/org/elasticsearch/common/inject/multibindings/Multibinder.java
src/main/java/org/elasticsearch/common/inject/spi/Dependency.java
src/main/java/org/elasticsearch/common/inject/spi/Elements.java
src/main/java/org/elasticsearch/common/inject/spi/InjectionPoint.java
src/main/java/org/elasticsearch/common/io/FileSystemUtils.java
src/main/java/org/elasticsearch/common/io/stream/CachedStreamInput.java
src/main/java/org/elasticsearch/common/io/stream/HandlesStreamInput.java
src/main/java/org/elasticsearch/common/io/stream/HandlesStreamOutput.java
src/main/java/org/elasticsearch/common/io/stream/StreamInput.java
src/main/java/org/elasticsearch/common/io/stream/StreamOutput.java
src/main/java/org/elasticsearch/common/lucene/docset/AndDocIdSet.java
src/main/java/org/elasticsearch/common/lucene/search/MultiPhrasePrefixQuery.java
src/main/java/org/elasticsearch/common/lucene/search/OrFilter.java
src/main/java/org/elasticsearch/common/lucene/search/XBooleanFilter.java
src/main/java/org/elasticsearch/common/lucene/search/function/FiltersFunctionScoreQuery.java
src/main/java/org/elasticsearch/common/network/MulticastChannel.java
src/main/java/org/elasticsearch/common/network/NetworkService.java
src/main/java/org/elasticsearch/common/network/NetworkUtils.java
src/main/java/org/elasticsearch/common/path/PathTrie.java
src/main/java/org/elasticsearch/common/recycler/NoneRecycler.java
src/main/java/org/elasticsearch/common/recycler/Recyclers.java
src/main/java/org/elasticsearch/common/settings/ImmutableSettings.java
src/main/java/org/elasticsearch/common/settings/SettingsFilter.java
src/main/java/org/elasticsearch/common/util/BigArrays.java
src/main/java/org/elasticsearch/common/util/DoubleObjectPagedHashMap.java
src/main/java/org/elasticsearch/common/util/LongObjectPagedHashMap.java
src/main/java/org/elasticsearch/common/util/concurrent/AtomicArray.java
src/main/java/org/elasticsearch/common/util/concurrent/BaseFuture.java
src/main/java/org/elasticsearch/common/util/concurrent/ConcurrentCollections.java
src/main/java/org/elasticsearch/common/util/concurrent/EsExecutors.java
src/main/java/org/elasticsearch/common/util/concurrent/KeyedLock.java
src/main/java/org/elasticsearch/common/util/concurrent/PrioritizedCallable.java
src/main/java/org/elasticsearch/common/util/concurrent/PrioritizedEsThreadPoolExecutor.java
src/main/java/org/elasticsearch/common/xcontent/support/AbstractXContentParser.java
src/main/java/org/elasticsearch/common/xcontent/support/XContentMapValues.java
src/main/java/org/elasticsearch/discovery/local/LocalDiscovery.java
src/main/java/org/elasticsearch/discovery/zen/ZenDiscovery.java
src/main/java/org/elasticsearch/discovery/zen/fd/MasterFaultDetection.java
src/main/java/org/elasticsearch/discovery/zen/fd/NodesFaultDetection.java
src/main/java/org/elasticsearch/discovery/zen/ping/ZenPingService.java
src/main/java/org/elasticsearch/discovery/zen/ping/multicast/MulticastZenPing.java
src/main/java/org/elasticsearch/discovery/zen/ping/unicast/UnicastZenPing.java
src/main/java/org/elasticsearch/gateway/local/LocalGateway.java
src/main/java/org/elasticsearch/gateway/local/LocalGatewayAllocator.java
src/main/java/org/elasticsearch/http/HttpServer.java
src/main/java/org/elasticsearch/http/netty/NettyHttpRequest.java
src/main/java/org/elasticsearch/http/netty/NettyHttpServerTransport.java
src/main/java/org/elasticsearch/index/analysis/Analysis.java
src/main/java/org/elasticsearch/index/analysis/CJKBigramFilterFactory.java
src/main/java/org/elasticsearch/index/analysis/CharMatcher.java
src/main/java/org/elasticsearch/index/analysis/NumericDoubleAnalyzer.java
src/main/java/org/elasticsearch/index/analysis/NumericFloatAnalyzer.java
src/main/java/org/elasticsearch/index/analysis/NumericIntegerAnalyzer.java
src/main/java/org/elasticsearch/index/analysis/NumericLongAnalyzer.java
src/main/java/org/elasticsearch/index/analysis/WordDelimiterTokenFilterFactory.java
src/main/java/org/elasticsearch/index/codec/postingsformat/BloomFilterPostingsFormat.java
src/main/java/org/elasticsearch/index/deletionpolicy/SnapshotDeletionPolicy.java
src/main/java/org/elasticsearch/index/deletionpolicy/SnapshotIndexCommit.java
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
src/main/java/org/elasticsearch/index/fielddata/FieldDataStats.java
src/main/java/org/elasticsearch/index/fielddata/ShardFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/FSTBytesAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/FSTBytesIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/ParentChildIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/ParentChildIntersectTermsEnum.java
src/main/java/org/elasticsearch/index/fieldvisitor/FieldsVisitor.java
src/main/java/org/elasticsearch/index/get/GetField.java
src/main/java/org/elasticsearch/index/get/ShardGetService.java
src/main/java/org/elasticsearch/index/indexing/IndexingStats.java
src/main/java/org/elasticsearch/index/indexing/ShardIndexingService.java
src/main/java/org/elasticsearch/index/mapper/DocumentMapper.java
src/main/java/org/elasticsearch/index/mapper/DocumentMapperParser.java
src/main/java/org/elasticsearch/index/mapper/FieldMapperListener.java
src/main/java/org/elasticsearch/index/mapper/FieldMappers.java
src/main/java/org/elasticsearch/index/mapper/FieldMappersLookup.java
src/main/java/org/elasticsearch/index/mapper/MapperService.java
src/main/java/org/elasticsearch/index/mapper/ObjectMapperListener.java
src/main/java/org/elasticsearch/index/mapper/ObjectMappers.java
src/main/java/org/elasticsearch/index/mapper/ParseContext.java
src/main/java/org/elasticsearch/index/mapper/core/AbstractFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/core/NumberFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/core/TypeParsers.java
src/main/java/org/elasticsearch/index/mapper/geo/GeoPointFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/internal/ParentFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/object/DynamicTemplate.java
src/main/java/org/elasticsearch/index/mapper/object/ObjectMapper.java
src/main/java/org/elasticsearch/index/merge/policy/ElasticsearchMergePolicy.java
src/main/java/org/elasticsearch/index/merge/policy/LogByteSizeMergePolicyProvider.java
src/main/java/org/elasticsearch/index/merge/policy/LogDocMergePolicyProvider.java
src/main/java/org/elasticsearch/index/merge/policy/TieredMergePolicyProvider.java
src/main/java/org/elasticsearch/index/merge/scheduler/ConcurrentMergeSchedulerProvider.java
src/main/java/org/elasticsearch/index/merge/scheduler/MergeSchedulerProvider.java
src/main/java/org/elasticsearch/index/merge/scheduler/SerialMergeSchedulerProvider.java
src/main/java/org/elasticsearch/index/query/BoolFilterBuilder.java
src/main/java/org/elasticsearch/index/query/BoolQueryBuilder.java
src/main/java/org/elasticsearch/index/query/HasParentFilterParser.java
src/main/java/org/elasticsearch/index/query/HasParentQueryParser.java
src/main/java/org/elasticsearch/index/query/IdsFilterBuilder.java
src/main/java/org/elasticsearch/index/query/IdsFilterParser.java
src/main/java/org/elasticsearch/index/query/IdsQueryBuilder.java
src/main/java/org/elasticsearch/index/query/IdsQueryParser.java
src/main/java/org/elasticsearch/index/query/IndicesFilterParser.java
src/main/java/org/elasticsearch/index/query/IndicesQueryParser.java
src/main/java/org/elasticsearch/index/query/MultiMatchQueryBuilder.java
src/main/java/org/elasticsearch/index/query/NestedQueryParser.java
src/main/java/org/elasticsearch/index/query/QueryParseContext.java
src/main/java/org/elasticsearch/index/query/QueryStringQueryBuilder.java
src/main/java/org/elasticsearch/index/query/SimpleQueryStringBuilder.java
src/main/java/org/elasticsearch/index/query/SimpleQueryStringParser.java
src/main/java/org/elasticsearch/index/query/SpanMultiTermQueryParser.java
src/main/java/org/elasticsearch/index/query/SpanNearQueryBuilder.java
src/main/java/org/elasticsearch/index/query/SpanOrQueryBuilder.java
src/main/java/org/elasticsearch/index/query/functionscore/FunctionScoreQueryBuilder.java
src/main/java/org/elasticsearch/index/query/functionscore/FunctionScoreQueryParser.java
src/main/java/org/elasticsearch/index/search/MultiMatchQuery.java
src/main/java/org/elasticsearch/index/search/child/CustomQueryWrappingFilter.java
src/main/java/org/elasticsearch/index/search/stats/SearchStats.java
src/main/java/org/elasticsearch/index/search/stats/ShardSearchService.java
src/main/java/org/elasticsearch/index/search/stats/StatsGroupsParseElement.java
src/main/java/org/elasticsearch/index/settings/IndexSettingsService.java
src/main/java/org/elasticsearch/index/snapshots/blobstore/BlobStoreIndexShardRepository.java
src/main/java/org/elasticsearch/index/store/Store.java
src/main/java/org/elasticsearch/indices/InternalIndicesLifecycle.java
src/main/java/org/elasticsearch/indices/InternalIndicesService.java
src/main/java/org/elasticsearch/indices/analysis/HunspellService.java
src/main/java/org/elasticsearch/indices/analysis/PreBuiltCacheFactory.java
src/main/java/org/elasticsearch/indices/cluster/IndicesClusterStateService.java
src/main/java/org/elasticsearch/indices/recovery/RecoveryFilesInfoRequest.java
src/main/java/org/elasticsearch/indices/recovery/RecoverySource.java
src/main/java/org/elasticsearch/indices/recovery/RecoveryState.java
src/main/java/org/elasticsearch/indices/ttl/IndicesTTLService.java
src/main/java/org/elasticsearch/indices/warmer/InternalIndicesWarmer.java
src/main/java/org/elasticsearch/monitor/dump/AbstractDump.java
comments:
[JAVA7 Upgrade] Replace explicit type with <>

time:
2014-03-27T14:48:12Z
class:
src/main/java/org/elasticsearch/common/util/CollectionUtils.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/BytesRefOrdValComparator.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/LongValuesComparator.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/LongValuesComparatorBase.java
src/main/java/org/elasticsearch/repositories/blobstore/BlobStoreSnapshot.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/Histogram.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantLongTerms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/InternalOrder.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/LongTerms.java
src/main/java/org/elasticsearch/search/aggregations/metrics/percentiles/tdigest/GroupRedBlackTree.java
src/main/java/org/elasticsearch/search/aggregations/support/FieldDataSource.java
comments:
[JAVA7 Upgrade] Move to Long.compare

time:
2014-03-27T14:32:53Z
class:
comments:
[Build] use branch version in execution hit file name

time:
2014-03-27T13:50:43Z
class:
src/main/java/org/elasticsearch/cluster/metadata/MetaDataService.java
src/main/java/org/elasticsearch/cluster/routing/operation/plain/PlainOperationRouting.java
src/main/java/org/elasticsearch/common/math/MathUtils.java
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
src/main/java/org/elasticsearch/transport/netty/NettyTransport.java
src/test/java/org/elasticsearch/common/math/MathUtilsTests.java
comments:
Forbid Math.abs(int/long).

We have had a couple of bugs because of the use of these methods without paying
attention that it might return a negative value when provided with MIN_VALUE.
There is one common and legitimate usage of this method in order to perform
a modulo operation which would always return a positive number. This use-case
has been extracted to MathUtils.mod.

Close #5562

time:
2014-03-27T13:33:37Z
class:
src/main/java/org/elasticsearch/cluster/routing/IndexRoutingTable.java
src/main/java/org/elasticsearch/cluster/routing/IndexShardRoutingTable.java
src/main/java/org/elasticsearch/cluster/routing/PlainShardIterator.java
src/main/java/org/elasticsearch/cluster/routing/PlainShardsIterator.java
src/main/java/org/elasticsearch/cluster/routing/RotationShardShuffler.java
src/main/java/org/elasticsearch/cluster/routing/ShardShuffler.java
src/main/java/org/elasticsearch/common/util/CollectionUtils.java
src/test/java/org/elasticsearch/cluster/structure/RoutingIteratorTests.java
src/test/java/org/elasticsearch/common/util/CollectionUtilsTests.java
comments:
Fix IndexShardRoutingTable's shard randomization to not throw out-of-bounds
exceptions.

Close #5559

time:
2014-03-27T10:12:05Z
class:
src/test/java/org/elasticsearch/ttl/SimpleTTLTests.java
comments:
[TEST] Made ttl test more predictable
* Only run the test with one node, to make sure only a single purger thread is running.
* Instead of generating the _timestamp upon indexing in ES, define the _timestamp in the documents.
* Verify the responses from the index requests.

time:
2014-03-27T07:35:15Z
class:
comments:
[DOCS] `_type` instead of Type Field

time:
2014-03-27T06:52:57Z
class:
src/main/java/org/elasticsearch/search/SearchService.java
comments:
Now really fix eager fielddata loading.

Relates to #5557

time:
2014-03-27T05:17:24Z
class:
src/test/java/org/elasticsearch/index/fielddata/FieldDataLoadingTests.java
comments:
Fixed space in licence header.

time:
2014-03-27T05:10:05Z
class:
src/main/java/org/elasticsearch/search/SearchService.java
src/test/java/org/elasticsearch/index/fielddata/FieldDataLoadingTests.java
comments:
Fixes a bug when the field has been configured with eager fielddata loading, the fielddata is not being loaded.

Closes #5557

time:
2014-03-26T22:10:51Z
class:
src/main/java/org/elasticsearch/action/ActionModule.java
src/main/java/org/elasticsearch/action/admin/indices/gateway/package-info.java
src/main/java/org/elasticsearch/action/admin/indices/gateway/snapshot/GatewaySnapshotAction.java
src/main/java/org/elasticsearch/action/admin/indices/gateway/snapshot/GatewaySnapshotRequest.java
src/main/java/org/elasticsearch/action/admin/indices/gateway/snapshot/GatewaySnapshotRequestBuilder.java
src/main/java/org/elasticsearch/action/admin/indices/gateway/snapshot/GatewaySnapshotResponse.java
src/main/java/org/elasticsearch/action/admin/indices/gateway/snapshot/ShardGatewaySnapshotRequest.java
src/main/java/org/elasticsearch/action/admin/indices/gateway/snapshot/ShardGatewaySnapshotResponse.java
src/main/java/org/elasticsearch/action/admin/indices/gateway/snapshot/TransportGatewaySnapshotAction.java
src/main/java/org/elasticsearch/action/admin/indices/gateway/snapshot/package-info.java
src/main/java/org/elasticsearch/action/admin/indices/status/TransportIndicesStatusAction.java
src/main/java/org/elasticsearch/client/IndicesAdminClient.java
src/main/java/org/elasticsearch/client/Requests.java
src/main/java/org/elasticsearch/client/support/AbstractIndicesAdminClient.java
src/main/java/org/elasticsearch/gateway/blobstore/BlobReuseExistingGatewayAllocator.java
src/main/java/org/elasticsearch/gateway/blobstore/BlobStoreGateway.java
src/main/java/org/elasticsearch/gateway/blobstore/BlobStoreGatewayModule.java
src/main/java/org/elasticsearch/gateway/fs/FsGateway.java
src/main/java/org/elasticsearch/gateway/fs/FsGatewayModule.java
src/main/java/org/elasticsearch/gateway/shared/SharedStorageGateway.java
src/main/java/org/elasticsearch/index/engine/Engine.java
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
src/main/java/org/elasticsearch/index/gateway/IndexShardGateway.java
src/main/java/org/elasticsearch/index/gateway/IndexShardGatewayService.java
src/main/java/org/elasticsearch/index/gateway/blobstore/BlobStoreIndexGateway.java
src/main/java/org/elasticsearch/index/gateway/blobstore/BlobStoreIndexShardGateway.java
src/main/java/org/elasticsearch/index/gateway/fs/FsIndexGateway.java
src/main/java/org/elasticsearch/index/gateway/fs/FsIndexGatewayModule.java
src/main/java/org/elasticsearch/index/gateway/fs/FsIndexShardGateway.java
src/main/java/org/elasticsearch/index/gateway/local/LocalIndexShardGateway.java
src/main/java/org/elasticsearch/index/gateway/none/NoneIndexShardGateway.java
src/main/java/org/elasticsearch/index/service/InternalIndexService.java
src/main/java/org/elasticsearch/index/settings/IndexDynamicSettingsModule.java
src/main/java/org/elasticsearch/index/shard/service/IndexShard.java
src/main/java/org/elasticsearch/index/shard/service/InternalIndexShard.java
src/main/java/org/elasticsearch/rest/action/RestActionModule.java
src/main/java/org/elasticsearch/rest/action/admin/indices/gateway/snapshot/RestGatewaySnapshotAction.java
src/test/java/org/elasticsearch/gateway/fs/IndexGatewayTests.java
src/test/java/org/elasticsearch/index/engine/internal/InternalEngineTests.java
src/test/java/org/elasticsearch/indices/IndicesOptionsTests.java
src/test/java/org/elasticsearch/stresstest/fullrestart/FullRestartStressTest.java
src/test/java/org/elasticsearch/stresstest/manyindices/ManyIndicesRemoteStressTest.java
src/test/java/org/elasticsearch/stresstest/manyindices/ManyIndicesStressTest.java
comments:
Remove deprecated gateways

Closes #5422

time:
2014-03-26T21:59:06Z
class:
src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java
comments:
[TEST] removed leftover ElasticsearchIntegrationTest#randomIndexTemplate

used cluster().randomIndexTemplate instead

time:
2014-03-26T19:38:37Z
class:
comments:
Fix typo

time:
2014-03-26T19:25:28Z
class:
src/main/java/org/elasticsearch/discovery/gce/GceDiscovery.java
comments:
Update to elasticsearch master

time:
2014-03-26T19:09:59Z
class:
comments:
Run tests with only one JVM

(cherry picked from commit d003f39)

time:
2014-03-26T18:58:45Z
class:
comments:
Create branches according to elasticsearch versions
We create branches:

* es-0.90 for elasticsearch 0.90
* es-1.0 for elasticsearch 1.0
* es-1.1 for elasticsearch 1.1
* master for elasticsearch master

We also check that before releasing we don't have a dependency to an elasticsearch SNAPSHOT version.

Add links to each version in documentation
(cherry picked from commit a51926c)

time:
2014-03-26T18:42:00Z
class:
comments:
Create branches according to elasticsearch versions
We create branches:

* es-0.90 for elasticsearch 0.90
* es-1.0 for elasticsearch 1.0
* es-1.1 for elasticsearch 1.1
* master for elasticsearch master

We also check that before releasing we don't have a dependency to an elasticsearch SNAPSHOT version.

Add links to each version in documentation
(cherry picked from commit 65d4862)

time:
2014-03-26T18:37:35Z
class:
src/main/java/org/elasticsearch/discovery/azure/AzureDiscovery.java
comments:
Update to elasticsearch 1.1.0

Closes #11.

time:
2014-03-26T17:52:48Z
class:
src/main/java/org/elasticsearch/cloud/aws/AwsS3Service.java
src/main/java/org/elasticsearch/repositories/s3/S3Repository.java
src/test/java/org/elasticsearch/repositories/s3/S3SnapshotRestoreTest.java
comments:
Add per repository credentials

Changed AwsS3Service to use one client per region and credentials combination.
Made S3Repository specify credentials if such exists in the repository settings.

Updated readme with repository specific credentials settings.

Closes #54.
Closes #55.
Closes #56.
(cherry picked from commit d4ea2dd)

time:
2014-03-26T17:35:21Z
class:
comments:
Create branches according to elasticsearch versions
We create branches:

* es-0.90 for elasticsearch 0.90
* es-1.0 for elasticsearch 1.0
* es-1.1 for elasticsearch 1.1
* master for elasticsearch master

We also check that before releasing we don't have a dependency to an elasticsearch SNAPSHOT version.

Add links to each version in documentation
(cherry picked from commit e0f06c6)

time:
2014-03-26T16:27:35Z
class:
src/test/java/org/elasticsearch/cluster/ack/AckClusterUpdateSettingsTests.java
src/test/java/org/elasticsearch/cluster/ack/AckTests.java
src/test/java/org/elasticsearch/document/DocumentActionsTests.java
src/test/java/org/elasticsearch/indices/fielddata/breaker/RandomExceptionCircuitBreakerTests.java
src/test/java/org/elasticsearch/indices/mapping/ConcurrentDynamicTemplateTests.java
src/test/java/org/elasticsearch/indices/store/SimpleDistributorTests.java
src/test/java/org/elasticsearch/mget/SimpleMgetTests.java
src/test/java/org/elasticsearch/nested/SimpleNestedTests.java
src/test/java/org/elasticsearch/percolator/PercolatorTests.java
src/test/java/org/elasticsearch/search/aggregations/RandomTests.java
src/test/java/org/elasticsearch/search/basic/SearchWhileCreatingIndexTests.java
src/test/java/org/elasticsearch/search/basic/SearchWithRandomExceptionsTests.java
src/test/java/org/elasticsearch/search/child/SimpleChildQuerySearchTests.java
src/test/java/org/elasticsearch/search/query/SimpleQueryTests.java
src/test/java/org/elasticsearch/snapshots/DedicatedClusterSnapshotRestoreTests.java
src/test/java/org/elasticsearch/snapshots/SharedClusterSnapshotRestoreTests.java
src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java
src/test/java/org/elasticsearch/test/ElasticsearchTestCase.java
src/test/java/org/elasticsearch/test/TestCluster.java
src/test/java/org/elasticsearch/test/engine/MockInternalEngine.java
src/test/java/org/elasticsearch/test/hamcrest/ElasticsearchAssertions.java
src/test/java/org/elasticsearch/test/store/MockDirectoryHelper.java
src/test/java/org/elasticsearch/test/store/MockFSDirectoryService.java
src/test/java/org/elasticsearch/test/store/MockRamDirectoryService.java
src/test/java/org/elasticsearch/test/transport/AssertingLocalTransport.java
comments:
[TEST] Moved wipe* methods, randomIndexTemplate & ensureEstimatedStats from ElasticsearchIntegrationTest to TestCluster

This is the first to make it possible to have a different impl of TestCluster (e.g. based on an external cluster) that has the same methods but a different impl for them (e.g. it might use the REST API to do the same instead of the Java API)

Closes #5542

time:
2014-03-26T15:57:41Z
class:
comments:
[DOCS] Clarify nested type documentation

time:
2014-03-26T15:44:33Z
class:
comments:
Create branches according to elasticsearch versions
We create branches:

* es-0.90 for elasticsearch 0.90
* es-1.0 for elasticsearch 1.0
* es-1.1 for elasticsearch 1.1
* master for elasticsearch master

We also check that before releasing we don't have a dependency to an elasticsearch SNAPSHOT version.

Add links to each version in documentation

(cherry picked from commit 35f5901)

time:
2014-03-26T15:22:04Z
class:
src/main/java/org/elasticsearch/index/search/MatchQuery.java
src/test/java/org/elasticsearch/search/query/SimpleQueryTests.java
comments:
Convert TermQuery to PrefixQuery if PHRASE_PREFIX is set

We miss to add a single term to a prefix query if the query in only a
single term.

Closes #5551

time:
2014-03-26T14:14:48Z
class:
src/test/java/org/elasticsearch/search/aggregations/bucket/MinDocCountTests.java
comments:
[TEST] Increase logging on MinDocCountTests.

time:
2014-03-26T13:58:53Z
class:
src/main/java/org/elasticsearch/indices/analysis/smartcn/SmartChineseIndicesAnalysis.java
src/main/java/org/elasticsearch/indices/analysis/smartcn/SmartChineseIndicesAnalysisModule.java
src/main/java/org/elasticsearch/plugin/analysis/smartcn/AnalysisSmartChinesePlugin.java
src/test/java/org/elasticsearch/index/analysis/SimpleSmartChineseIntegrationTests.java
comments:
Register smartcn analyzer, tokenizer and tokenfilter

When the plugin starts, it should register `smartcn` analyzer, `smartcn_sentence` tokenizer and `smartcn_word` token filter.

Closes #12.
(cherry picked from commit b8cd4c4)

time:
2014-03-26T13:51:02Z
class:
comments:
[DOCS] fixed typo

Closes #5272

time:
2014-03-26T13:48:30Z
class:
comments:
Update to elasticsearch 1.1.0 / Lucene 4.7.0

Create branches according to elasticsearch versions
We create branches:

* es-0.90 for elasticsearch 0.90
* es-1.0 for elasticsearch 1.0
* es-1.1 for elasticsearch 1.1
* master for elasticsearch master

We also check that before releasing we don't have a dependency to an elasticsearch SNAPSHOT version.

Add links to each version in documentation
(cherry picked from commit 397e943)

time:
2014-03-26T13:27:16Z
class:
src/main/java/org/elasticsearch/common/bytes/PagedBytesReference.java
src/test/java/org/elasticsearch/common/bytes/PagedBytesReferenceTest.java
comments:
Assorted fixes for bugs in the PagedBytesReference tests, plus a typo
where the wrong variable was used for a calculation.

Closes #5549

time:
2014-03-26T13:08:54Z
class:
comments:
Create branches according to elasticsearch versions

We create branches:

* es-0.90 for elasticsearch 0.90
* es-1.0 for elasticsearch 1.0
* es-1.1 for elasticsearch 1.1
* master for elasticsearch master

We also check that before releasing we don't have a dependency to an elasticsearch SNAPSHOT version.

Add links to each version in documentation
(cherry picked from commit 68bf829)

time:
2014-03-26T12:28:45Z
class:
src/main/java/org/elasticsearch/action/deletebyquery/IndexDeleteByQueryRequest.java
src/main/java/org/elasticsearch/action/deletebyquery/ShardDeleteByQueryRequest.java
src/main/java/org/elasticsearch/action/deletebyquery/TransportDeleteByQueryAction.java
src/main/java/org/elasticsearch/action/deletebyquery/TransportShardDeleteByQueryAction.java
src/main/java/org/elasticsearch/action/support/replication/TransportIndicesReplicationOperationAction.java
src/test/java/org/elasticsearch/deleteByQuery/DeleteByQueryTests.java
comments:
Capture and set start time in Delete By Query operations

This is important for queries/filters that use `now` in date based queries/filters

Closes #5540

time:
2014-03-26T11:51:14Z
class:
comments:
Create branches according to elasticsearch versions

We create branches:

* es-0.90 for elasticsearch 0.90
* es-1.0 for elasticsearch 1.0
* es-1.1 for elasticsearch 1.1
* master for elasticsearch master

We also check that before releasing we don't have a dependency to an elasticsearch SNAPSHOT version.

Add links to each version in documentation

(cherry picked from commit d5855a5)

time:
2014-03-26T11:22:04Z
class:
comments:
Manage per version documentation links

time:
2014-03-26T09:43:47Z
class:
src/main/java/org/elasticsearch/common/bytes/PagedBytesReference.java
src/main/java/org/elasticsearch/common/io/stream/BytesStreamOutput.java
src/test/java/org/elasticsearch/common/bytes/PagedBytesReferenceTest.java
comments:
Fix for zero-sized content throwing off toChannelBuffer(). Also
short-circuit writeTo(..) accordingly to avoid unnecessary work.

Fixes #5543

time:
2014-03-26T09:41:36Z
class:
comments:
Check elasticsearch version SNAPSHOT dependency

time:
2014-03-26T08:07:43Z
class:
src/main/java/org/elasticsearch/index/analysis/AnalysisModule.java
src/main/java/org/elasticsearch/index/analysis/UpperCaseTokenFilterFactory.java
src/main/java/org/elasticsearch/indices/analysis/PreBuiltTokenFilters.java
comments:
add uppercase token filter

closes #5539

time:
2014-03-26T07:34:44Z
class:
src/test/java/org/elasticsearch/index/mapper/all/SimpleAllMapperTests.java
comments:
[TEST] Added extra test for multi fields with default `include_in_all` settings, in which only the main field should end up in the `_all` field.

time:
2014-03-25T20:22:29Z
class:
src/test/java/org/elasticsearch/indices/IndicesOptionsTests.java
comments:
[TEST] Make sure that there are no relocating shards before taking snapshot

Temporary workaround for #5531

time:
2014-03-25T18:16:54Z
class:
comments:
Update master to elasticsearch master SNAPSHOT

time:
2014-03-25T18:02:16Z
class:
comments:
prepare for next development iteration

time:
2014-03-25T17:47:56Z
class:
comments:
prepare release elasticsearch-mapper-attachments-2.0.0

time:
2014-03-25T17:26:09Z
class:
src/main/java/org/elasticsearch/index/mapper/attachment/AttachmentMapper.java
src/test/java/org/elasticsearch/index/mapper/xcontent/LanguageDetectionAttachmentMapperTests.java
comments:
Add language detection option

Based on PR #45, we add a new language detection option using Language detection feature available in Tika:
https://tika.apache.org/1.4/detection.html#Language_Detection

By default, language detection is disabled (`false`) as it could come with a cost.
This default value can be changed by setting the `index.mapping.attachment.detect_language` setting.
It can also be provided on a per document indexed using the `_detect_language` parameter.

Closes #45.
Closes #44.

time:
2014-03-25T17:03:37Z
class:
src/main/java/org/elasticsearch/common/util/UnsafeUtils.java
comments:
Fix PMD warning: don't reassign method parameters.

time:
2014-03-25T16:57:49Z
class:
src/main/java/org/elasticsearch/common/io/stream/BytesStreamOutput.java
comments:
Fix compilation error from last commit.

time:
2014-03-25T16:51:48Z
class:
src/main/java/org/elasticsearch/Version.java
comments:
Added versions 1.1.1, 1.0.3 & 0.90.14

time:
2014-03-25T16:51:30Z
class:
comments:
Update Documentation Feature Flags [1.1.0]

time:
2014-03-25T16:45:32Z
class:
src/main/java/org/elasticsearch/common/io/stream/BytesStreamOutput.java
comments:
Temp. disable use of new PagedBytesReference since it breaks HTTP replies with 0-sized Content-Length

time:
2014-03-25T15:49:53Z
class:
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/TermsAggregatorFactory.java
src/test/java/org/elasticsearch/search/aggregations/RandomTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/StringTermsTests.java
comments:
Internally manipulate the terms execution hint as an enum instead of a String.

Close #5530

time:
2014-03-25T15:05:23Z
class:
comments:
[DOC] Clarify settings and documentation about norms.

time:
2014-03-25T14:25:02Z
class:
comments:
[Docs] updated the search template and query template docs

time:
2014-03-25T14:18:39Z
class:
src/main/java/org/elasticsearch/common/bytes/PagedBytesReference.java
src/main/java/org/elasticsearch/common/io/stream/BytesStreamOutput.java
src/test/java/org/elasticsearch/common/bytes/PagedBytesReferenceTest.java
comments:
PagedBytesReference with a boatload of tests. Passes all new and
existing tests. Non-allocating hashCode/Equals, zero-copy writeTo() and
ChannelBuffer support.

Fix for #5427

time:
2014-03-25T13:13:06Z
class:
src/main/java/org/elasticsearch/index/mapper/core/AbstractFieldMapper.java
src/test/java/org/elasticsearch/index/mapper/string/SimpleStringMappingTests.java
comments:
Allow to disable norms on an existing field.

Close #4813

time:
2014-03-25T10:50:30Z
class:
src/main/java/org/elasticsearch/index/fielddata/plain/ParentChildIndexFieldData.java
comments:
Set the actual bytes used in circuit breaker back to how it was before loading if the loading wasn't successful.

Closes #5526

time:
2014-03-25T10:05:55Z
class:
src/main/java/org/elasticsearch/index/mapper/ParseContext.java
src/main/java/org/elasticsearch/index/mapper/core/AbstractFieldMapper.java
src/test/java/org/elasticsearch/index/mapper/all/SimpleAllMapperTests.java
comments:
Fix include_in_all for multi field, to not include multi fields into _all field.

Closes #5522

time:
2014-03-25T09:44:50Z
class:
src/main/java/org/elasticsearch/common/util/BigArrays.java
src/main/java/org/elasticsearch/common/util/BigByteArray.java
src/main/java/org/elasticsearch/common/util/ByteArray.java
src/test/java/org/elasticsearch/test/cache/recycler/MockBigArrays.java
comments:
Let ByteArray/BigByteArray.get() indicate whether a byte[] was
materialized.

time:
2014-03-25T09:01:41Z
class:
comments:
[DOCS] Moved the template query documentation into search section

time:
2014-03-25T08:50:33Z
class:
src/main/java/org/elasticsearch/common/bytes/BytesReference.java
src/main/java/org/elasticsearch/common/util/UnsafeUtils.java
src/test/java/org/elasticsearch/common/bytes/BytesReferenceTests.java
comments:
BytesReference.Helper should never materialize a byte[] array.

The current implementations of BytesReference.Helper.bytesEquals and
bytesHashCode materialize a byte[] when passed an instance that returns `false`
in `hasArray()`. They should instead do a byte-by-byte comparison/hashcode
computation without materializing the array.

Close #5517

time:
2014-03-25T08:46:49Z
class:
comments:
[Docs] Add coming tag for context suggester docs

time:
2014-03-25T08:16:34Z
class:
comments:
[Build] splitted release commits into version and feature flag commits

Elasticsearch is release from release-branches but the modifications
to the documentation must be cherry-picked into the current development
branch. To make this easier this commit splits the commits of the
Version and the documenation into seperate commits.

time:
2014-03-25T01:55:19Z
class:
comments:
[DOCS] Mark snapshot status API as coming in 1.1.0

time:
2014-03-24T20:25:02Z
class:
src/test/java/org/elasticsearch/search/facet/SimpleFacetsTests.java
comments:
[TEST] Don't pass possibly oversized array with 0 padding to SearchRequestBuilder#setFacet(byte[])

time:
2014-03-24T18:46:01Z
class:
src/main/java/org/elasticsearch/common/xcontent/json/JsonXContentGenerator.java
src/test/java/org/elasticsearch/common/xcontent/builder/XContentBuilderTests.java
src/test/java/org/elasticsearch/search/facet/SimpleFacetsTests.java
comments:
Fix JsonXContentGenerator to write comma after rawWrite if needed

time:
2014-03-24T17:21:54Z
class:
src/test/java/org/elasticsearch/test/ElasticsearchTestCase.java
comments:
fix potential NPE, throw failure only if exists
Maybe designing for the future with this `if` statement, but `w.close()` throws the value stored in `ElasticsearchMockDirectoryWrapper.closeException` (`w.closeException()`) immediately after storing it for later, thus implying this `if` entire statement (now that it is fixed).


time:
2014-03-24T17:16:41Z
class:
comments:
Add 1.1 branch url

Added S3 access URL for elasticsearch 1.1 snapshot

time:
2014-03-24T17:07:24Z
class:
src/main/java/org/elasticsearch/action/admin/indices/validate/query/ValidateQueryRequest.java
src/main/java/org/elasticsearch/action/count/CountRequest.java
src/main/java/org/elasticsearch/action/deletebyquery/DeleteByQueryRequest.java
src/main/java/org/elasticsearch/action/explain/ExplainRequest.java
src/main/java/org/elasticsearch/action/mlt/MoreLikeThisRequest.java
src/main/java/org/elasticsearch/action/percolate/PercolateRequest.java
src/main/java/org/elasticsearch/action/percolate/PercolateSourceBuilder.java
src/main/java/org/elasticsearch/action/search/SearchRequest.java
src/main/java/org/elasticsearch/action/suggest/SuggestRequest.java
src/main/java/org/elasticsearch/action/suggest/SuggestRequestBuilder.java
src/test/java/org/elasticsearch/test/ElasticsearchTestCase.java
comments:
Randomize XContentType for requests

The used XContentType is static and should be randomized per test.

Closes #5515

time:
2014-03-24T13:32:32Z
class:
src/main/java/org/elasticsearch/common/xcontent/json/JsonXContentGenerator.java
src/test/java/org/elasticsearch/common/xcontent/builder/XContentBuilderTests.java
comments:
Use build-in function to write field name in JsonXContentGenerator#writeRawField

The #writeRawField method forcefully writes a `,` spearator expecting a raw field
to never start as the first value in an object.

Closes #5514

time:
2014-03-24T11:22:05Z
class:
src/main/java/org/elasticsearch/common/xcontent/smile/SmileXContent.java
comments:
Fix incorrect return impl in SmileXContent.createParser.

Close #5510

time:
2014-03-24T10:00:57Z
class:
src/main/java/org/elasticsearch/index/mapper/core/BooleanFieldMapper.java
comments:
Merge null_value for boolean field and remove include_in_all for boolean field in doc

Close #5502

time:
2014-03-24T09:59:12Z
class:
src/test/java/org/elasticsearch/common/unit/FuzzinessTests.java
comments:
[TEST] Fix rounding error problems in FuzzinessTests

time:
2014-03-24T08:30:55Z
class:
src/main/java/org/elasticsearch/index/mapper/geo/GeoPointFieldMapper.java
comments:
Merge GeoPoint specific mapping properties

Close #5505

time:
2014-03-24T08:03:32Z
class:
src/main/java/org/elasticsearch/action/support/master/TransportMasterNodeOperationAction.java
comments:
TransportMasterNodeOperationAction: retry operation if cluster state version changed while adding a ClusterStateListener

TransportMasterNodeOperationAction forwards incoming requests to the currently known master node. If that fails due to a connection error, a cluster state listener will be added in order to try again when a new master is elected. After the listener is in place, a check was made to see if the master has change *while* the listener was being added so that change will not be missed. The check was not enough as it may be that the same master was re-elected (for example, a network hick up) and thus test will fail even though the re-ellection event was missed. In these cases, the request would timeout unjustly. This commit changes this test to be  more strict and retry if the cluster state version changed during the addition of the listener.

Closes #5499

time:
2014-03-23T20:42:07Z
class:
src/test/java/org/elasticsearch/search/basic/SearchWhileRelocatingTests.java
comments:
[TEST] ensure that we don't fail if all shards fail due to no replicas and low number of shards

time:
2014-03-23T20:29:10Z
class:
src/test/java/org/elasticsearch/search/query/SimpleQueryTests.java
comments:
[TEST] Add mapping to ensure all nodes / shards parse a numeric field

time:
2014-03-23T14:58:48Z
class:
src/test/java/org/elasticsearch/search/child/SimpleChildQuerySearchTests.java
comments:
[TEST] Disable wildcard query in testFixAOBEIfTopChildrenIsWrappedInMusNotClause for now

time:
2014-03-22T20:33:52Z
class:
src/main/java/org/elasticsearch/discovery/zen/ZenDiscovery.java
src/test/java/org/elasticsearch/cluster/MinimumMasterNodesTests.java
comments:
Nodes who are not currently master do not update the ElectMasterService when dynamically setting min_master_nodes

When updating the min_master_nodes setting via the Cluster Settings API, the change is propagated to all nodes. The current master node also updates the ElectMasterService and validates that is still sees enough master eligible nodes and that it's election is still valid. Other master eligible nodes do not go through this validation (good) but also didn't update the ElectMasterService with the new settings. The result is that if the current master goes away, the next election will not be done with the latest setting.

Note - min_master_node set in the elasticsearch.yml file are processed correctly

Closes #5494

time:
2014-03-22T19:00:19Z
class:
src/test/java/org/elasticsearch/benchmark/search/aggregations/TermsAggregationSearchBenchmark.java
src/test/java/org/elasticsearch/benchmark/search/scroll/ScrollSearchBenchmark.java
src/test/java/org/elasticsearch/search/aggregations/metrics/GroupTree.java
comments:
Update to forbidden-apis 1.4.1

Closes #5492

time:
2014-03-22T18:31:19Z
class:
src/test/java/org/elasticsearch/search/aggregations/bucket/MinDocCountTests.java
comments:
[TEST] Assert search response in MinDocCountTests#testMinDocCountOnTerms

time:
2014-03-22T18:13:24Z
class:
src/test/java/org/elasticsearch/search/basic/SearchWhileRelocatingTests.java
comments:
[TEST] Make SearchWhileRelocatingTests to handle known limitations gracefully

time:
2014-03-22T17:36:34Z
class:
comments:
[TEST] Don't use replicas if only primaries are expected or the first shard in the list shoudl be a primary

time:
2014-03-21T15:13:00Z
class:
src/test/java/org/elasticsearch/cluster/BlockClusterStatsTests.java
src/test/java/org/elasticsearch/cluster/NoMasterNodeTests.java
src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java
comments:
[Test] Run after checks even if cluster scope is == TEST

time:
2014-03-21T14:02:38Z
class:
src/main/java/org/elasticsearch/common/blobstore/fs/FsImmutableBlobContainer.java
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
src/main/java/org/elasticsearch/index/snapshots/blobstore/BlobStoreIndexShardRepository.java
src/main/java/org/elasticsearch/index/store/Store.java
src/main/java/org/elasticsearch/indices/recovery/RecoverySource.java
src/main/java/org/elasticsearch/indices/recovery/RecoveryTarget.java
src/test/java/org/elasticsearch/gateway/local/SimpleRecoveryLocalGatewayTests.java
src/test/java/org/elasticsearch/indices/settings/UpdateNumberOfReplicasTests.java
src/test/java/org/elasticsearch/search/basic/SearchWithRandomExceptionsTests.java
src/test/java/org/elasticsearch/snapshots/mockstore/MockRepository.java
src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java
src/test/java/org/elasticsearch/test/ElasticsearchTestCase.java
src/test/java/org/elasticsearch/test/TestCluster.java
src/test/java/org/elasticsearch/test/engine/MockInternalEngine.java
src/test/java/org/elasticsearch/test/store/MockDirectoryHelper.java
src/test/java/org/elasticsearch/test/store/MockFSDirectoryService.java
src/test/java/org/elasticsearch/test/store/MockRamDirectoryService.java
comments:
Close Directory / Store once all resources have been released

Currently we close the store and therefor the underlying directory
when the engine / shard is closed ie. during relocation etc. We also
just close it while there are still searches going on and/or we are
recovering from it. The recoveries might fail which is ok but searches
etc. will be working like pending fetch phases.

The contract of the Directory doesn't prevent to read from a stream
that was already opened before the Directory was closed but from a
system boundary perspective and from lifecycles that we test it seems
to be the right thing to do to wait until all resources are released.

Additionally it will also help to make sure everything is closed
properly before directories are closed itself.

Note: this commit adds Object#wait & Object@#notify/All to forbidden APIs

Closes #5432

time:
2014-03-21T12:42:52Z
class:
comments:
Renamed spec search.template.json to search_template.json
to match the name of the method.

time:
2014-03-21T09:24:07Z
class:
comments:
[TEST] added missing wait for yellow to indices recovery REST test

time:
2014-03-21T09:02:53Z
class:
comments:
fix typo joda-time link

time:
2014-03-21T06:50:50Z
class:
src/main/java/org/elasticsearch/action/search/type/ParsedScrollId.java
src/main/java/org/elasticsearch/action/search/type/TransportSearchDfsQueryAndFetchAction.java
src/main/java/org/elasticsearch/action/search/type/TransportSearchDfsQueryThenFetchAction.java
src/main/java/org/elasticsearch/action/search/type/TransportSearchHelper.java
src/main/java/org/elasticsearch/action/search/type/TransportSearchQueryAndFetchAction.java
src/main/java/org/elasticsearch/action/search/type/TransportSearchQueryThenFetchAction.java
src/main/java/org/elasticsearch/action/search/type/TransportSearchScrollQueryAndFetchAction.java
src/main/java/org/elasticsearch/action/search/type/TransportSearchScrollQueryThenFetchAction.java
src/main/java/org/elasticsearch/action/search/type/TransportSearchTypeAction.java
src/main/java/org/elasticsearch/common/lucene/Lucene.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/BytesRefOrdValComparator.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/BytesRefValComparator.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/DoubleScriptDataComparator.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/DoubleValuesComparatorBase.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/GeoDistanceComparator.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/LongValuesComparatorBase.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/NestedWrappableComparator.java
src/main/java/org/elasticsearch/index/search/nested/NestedFieldComparatorSource.java
src/main/java/org/elasticsearch/percolator/PercolateContext.java
src/main/java/org/elasticsearch/search/SearchService.java
src/main/java/org/elasticsearch/search/controller/SearchPhaseController.java
src/main/java/org/elasticsearch/search/fetch/FetchSearchRequest.java
src/main/java/org/elasticsearch/search/internal/DefaultSearchContext.java
src/main/java/org/elasticsearch/search/internal/InternalSearchHit.java
src/main/java/org/elasticsearch/search/internal/SearchContext.java
src/main/java/org/elasticsearch/search/internal/ShardSearchRequest.java
src/main/java/org/elasticsearch/search/query/QueryPhase.java
src/main/java/org/elasticsearch/search/sort/SortBuilder.java
src/test/java/org/elasticsearch/index/search/child/TestSearchContext.java
src/test/java/org/elasticsearch/nested/SimpleNestedTests.java
src/test/java/org/elasticsearch/search/scroll/DuelScrollTests.java
src/test/java/org/elasticsearch/search/scroll/SlowDuelScrollTests.java
src/test/java/org/elasticsearch/search/scroll/SlowSearchScrollTests.java
comments:
Improved regular scroll api by using IndexSearch#searchAfter instead of regular search methods which rely on `from` for pagination.

This prevents the creation of priority queues of `from + size`, instead the size of the priority queue will always be equal to `size`.

Closes #4940

time:
2014-03-20T20:58:08Z
class:
comments:
[API] renaming search-template to search_template.

Name of the API should be a valid identifier.

time:
2014-03-20T20:09:58Z
class:
src/test/java/org/elasticsearch/VersionTests.java
comments:
[TEST] Add a test that ensures Version#CURRENT is actually the latest version

time:
2014-03-20T19:58:58Z
class:
comments:
[TEST] Fix cat.recovery/10_basic.yaml to allow '-' in the hostname

time:
2014-03-20T19:43:17Z
class:
comments:
[TEST] disable cat.recovery/10_basic.yaml

time:
2014-03-20T19:41:20Z
class:
comments:
[TEST] Added skip clause for regexp feature

time:
2014-03-20T17:48:14Z
class:
src/main/java/org/elasticsearch/script/mustache/JsonEscapingMustacheFactory.java
src/main/java/org/elasticsearch/script/mustache/MustacheScriptEngineService.java
src/test/java/org/elasticsearch/script/mustache/MustacheScriptEngineTest.java
comments:
Add simple escape method for special characters to template query

The default mustache engine was using HTML escaping which breaks queries
if used with JSON etc. This commit adds escaping for:

```
\b  Backspace (ascii code 08)
\f  Form feed (ascii code 0C)
\n  New line
\r  Carriage return
\t  Tab
\v  Vertical tab
\"  Double quote
\\  Backslash
```

Closes #5473

time:
2014-03-20T17:44:15Z
class:
src/main/java/org/elasticsearch/Version.java
comments:
Add new / missing version constants

time:
2014-03-20T17:13:30Z
class:
src/main/java/org/elasticsearch/action/ActionModule.java
src/main/java/org/elasticsearch/action/admin/indices/recovery/RecoveryAction.java
src/main/java/org/elasticsearch/action/admin/indices/recovery/RecoveryRequest.java
src/main/java/org/elasticsearch/action/admin/indices/recovery/RecoveryRequestBuilder.java
src/main/java/org/elasticsearch/action/admin/indices/recovery/RecoveryResponse.java
src/main/java/org/elasticsearch/action/admin/indices/recovery/ShardRecoveryResponse.java
src/main/java/org/elasticsearch/action/admin/indices/recovery/TransportRecoveryAction.java
src/main/java/org/elasticsearch/action/admin/indices/status/TransportIndicesStatusAction.java
src/main/java/org/elasticsearch/client/IndicesAdminClient.java
src/main/java/org/elasticsearch/client/support/AbstractIndicesAdminClient.java
src/main/java/org/elasticsearch/index/gateway/IndexShardGateway.java
src/main/java/org/elasticsearch/index/gateway/IndexShardGatewayService.java
src/main/java/org/elasticsearch/index/gateway/RecoveryStatus.java
src/main/java/org/elasticsearch/index/gateway/blobstore/BlobStoreIndexShardGateway.java
src/main/java/org/elasticsearch/index/gateway/local/LocalIndexShardGateway.java
src/main/java/org/elasticsearch/index/gateway/none/NoneIndexShardGateway.java
src/main/java/org/elasticsearch/index/shard/service/InternalIndexShard.java
src/main/java/org/elasticsearch/index/snapshots/IndexShardRepository.java
src/main/java/org/elasticsearch/index/snapshots/IndexShardSnapshotAndRestoreService.java
src/main/java/org/elasticsearch/index/snapshots/blobstore/BlobStoreIndexShardRepository.java
src/main/java/org/elasticsearch/indices/cluster/IndicesClusterStateService.java
src/main/java/org/elasticsearch/indices/recovery/RecoveryState.java
src/main/java/org/elasticsearch/indices/recovery/RecoveryStatus.java
src/main/java/org/elasticsearch/indices/recovery/RecoveryTarget.java
src/main/java/org/elasticsearch/indices/recovery/StartRecoveryRequest.java
src/main/java/org/elasticsearch/rest/action/RestActionModule.java
src/main/java/org/elasticsearch/rest/action/admin/indices/recovery/RestRecoveryAction.java
src/main/java/org/elasticsearch/rest/action/cat/RestRecoveryAction.java
src/test/java/org/elasticsearch/indices/recovery/IndexRecoveryTests.java
comments:
Recovery API

Adds a new API endpoint at /_recovery as well as to the Java API. The
recovery API allows one to see the recovery status of all shards in the
cluster. It will report on percent complete, recovery type, and which
files are copied.

Closes #4637

time:
2014-03-20T16:43:40Z
class:
src/main/java/org/elasticsearch/action/search/SearchRequest.java
src/main/java/org/elasticsearch/action/search/SearchRequestBuilder.java
src/main/java/org/elasticsearch/index/query/TemplateQueryParser.java
src/main/java/org/elasticsearch/rest/action/search/RestSearchAction.java
src/main/java/org/elasticsearch/search/SearchService.java
src/main/java/org/elasticsearch/search/internal/ShardSearchRequest.java
src/test/java/org/elasticsearch/index/query/TemplateQueryParserTest.java
src/test/java/org/elasticsearch/index/query/TemplateQueryTest.java
comments:
Query Templates: Adding dedicated /_search/template endpoint

In order to simplify query template execution an own endpoint has been added

Closes #5353

time:
2014-03-20T13:48:27Z
class:
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/DateHistogramBuilder.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/DateHistogramParser.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/ExtendedBounds.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/HistogramAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/HistogramBuilder.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/HistogramParser.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/InternalDateHistogram.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/InternalHistogram.java
src/test/java/org/elasticsearch/search/aggregations/bucket/DateHistogramTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/HistogramTests.java
comments:
Added extended_bounds support for date_/histogram aggs

By default the date_/histogram returns all the buckets within the range of the data itself, that is, the documents with the smallest values (on which with histogram) will determine the min bucket (the bucket with the smallest key) and the documents with the highest values will determine the max bucket (the bucket with the highest key). Often, when when requesting empty buckets (min_doc_count : 0), this causes a confusion, specifically, when the data is also filtered.

To understand why, let's look at an example:

Lets say the you're filtering your request to get all docs from the last month, and in the date_histogram aggs you'd like to slice the data per day. You also specify min_doc_count:0 so that you'd still get empty buckets for those days to which no document belongs. By default, if the first document that fall in this last month also happen to fall on the first day of the **second week** of the month, the date_histogram will **not** return empty buckets for all those days prior to that second week. The reason for that is that by default the histogram aggregations only start building buckets when they encounter documents (hence, missing on all the days of the first week in our example).

With extended_bounds, you now can "force" the histogram aggregations to start building buckets on a specific min values and also keep on building buckets up to a max value (even if there are no documents anymore). Using extended_bounds only makes sense when min_doc_count is 0 (the empty buckets will never be returned if the min_doc_count is greater than 0).

Note that (as the name suggest) extended_bounds is **not** filtering buckets. Meaning, if the min bounds is higher than the values extracted from the documents, the documents will still dictate what the min bucket will be (and the same goes to the extended_bounds.max and the max bucket). For filtering buckets, one should nest the histogram agg under a range filter agg with the appropriate min/max.

Closes #5224

time:
2014-03-20T12:30:08Z
class:
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/DateHistogram.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/InternalDateHistogram.java
comments:
Changed the DateHistogram.Bucket to return the date key in UTC timezone

Closes #5477

time:
2014-03-20T12:11:15Z
class:
src/main/java/org/elasticsearch/index/query/IndexQueryParserService.java
comments:
clean the query parse context after usage
that will make sure we don't have any parsers lying around that are no longer used

time:
2014-03-20T12:05:04Z
class:
src/main/java/org/elasticsearch/index/query/BoolFilterBuilder.java
src/main/java/org/elasticsearch/index/query/BoolQueryBuilder.java
comments:
Add BoolFilterBuilder#hasClauses to be consitent with BoolQueryBuilder

Closes #5472

time:
2014-03-20T11:58:28Z
class:
src/test/java/org/elasticsearch/gateway/fs/IndexGatewayTests.java
src/test/java/org/elasticsearch/gateway/local/LocalGatewayIndexStateTests.java
src/test/java/org/elasticsearch/gateway/local/SimpleRecoveryLocalGatewayTests.java
src/test/java/org/elasticsearch/snapshots/SharedClusterSnapshotRestoreTests.java
comments:
[TEST] add @Slow annotations to bad apples

time:
2014-03-20T11:45:35Z
class:
comments:
[Build] Skip topN hints if tests are skipped

time:
2014-03-20T11:43:43Z
class:
comments:
[DOCS] Documented the fact that binary fields are not stored by default

time:
2014-03-20T11:29:48Z
class:
comments:
[BUILD] Add top execution hints to test phase

Added a ant task that prints the Top N most expensive tests after
each test run.

time:
2014-03-20T11:25:45Z
class:
src/main/java/org/elasticsearch/search/suggest/context/CategoryContextMapping.java
src/test/java/org/elasticsearch/search/suggest/ContextSuggestSearchTests.java
comments:
category type should be called "category" instead of "field" in context suggester

Change according to documentation.

time:
2014-03-20T11:18:25Z
class:
src/main/java/org/elasticsearch/index/fielddata/ScriptDocValues.java
comments:
[Doc] Updated docs for distance scripting
Updated docs for distance scripting and
added missing geohash distance functions
Closes #5397

time:
2014-03-20T11:02:06Z
class:
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantTermsAggregatorFactory.java
comments:
Fix for Jenkins advice on SignificantTermsAggregatorFactory, changing a small switch statement to an if-else

time:
2014-03-20T10:17:51Z
class:
src/main/java/org/elasticsearch/common/geo/builders/BaseLineStringBuilder.java
src/main/java/org/elasticsearch/common/geo/builders/BasePolygonBuilder.java
src/main/java/org/elasticsearch/common/geo/builders/MultiLineStringBuilder.java
src/main/java/org/elasticsearch/common/geo/builders/MultiPointBuilder.java
src/main/java/org/elasticsearch/common/geo/builders/MultiPolygonBuilder.java
src/main/java/org/elasticsearch/common/geo/builders/ShapeBuilder.java
src/test/java/org/elasticsearch/common/geo/GeoJSONShapeParserTests.java
src/test/java/org/elasticsearch/test/hamcrest/ElasticsearchGeoAssertions.java
comments:
Upgrade to Spatial4j 0.4.1 and JTS 1.13

Fixes #5279

time:
2014-03-20T10:12:35Z
class:
src/test/java/org/elasticsearch/search/suggest/SuggestSearchTests.java
comments:
[TEST] remove time upperbound from test - only for testing

time:
2014-03-20T09:38:32Z
class:
src/main/java/org/elasticsearch/rest/action/admin/indices/alias/RestIndicesAliasesAction.java
comments:
PUT /_aliases should accept a numeric routing value

Also added REST tests for setting index/search/routing
via the PUT /_aliases endpoint

Fixes #5465

time:
2014-03-20T09:34:44Z
class:
src/test/java/org/elasticsearch/indices/IndicesLifecycleListenerTests.java
comments:
[Test] IndicesLifecycleListenerTests - added busy waiting for expected results (and improved error message)

The test currently uses ensureGreen to guaranty all shard allocations has happened. This only guaranties it from the cluster perspective and in some cases the nodes are not fast enough to implement the changes (which is what the test is about).

time:
2014-03-20T09:24:12Z
class:
src/main/java/org/elasticsearch/action/get/MultiGetRequest.java
comments:
Allow iteration over MultiGetRequest#Item instances

Closes #3061

time:
2014-03-20T09:02:40Z
class:
src/main/java/org/elasticsearch/search/aggregations/metrics/cardinality/CardinalityAggregator.java
src/main/java/org/elasticsearch/search/aggregations/metrics/cardinality/CardinalityAggregatorFactory.java
src/main/java/org/elasticsearch/search/aggregations/metrics/cardinality/HyperLogLogPlusPlus.java
comments:
Fix cardinality memory-usage considerations.

Default precision was computed based on the number of MULTI_BUCKET parents
instead of PER_BUCKET.

The ordinals-based execution mode was almost always used although ordinals
might have non-negligible memory usage compared to the counters.

Close #5452

time:
2014-03-20T07:56:25Z
class:
src/test/java/org/elasticsearch/search/child/SimpleChildQuerySearchTests.java
comments:
[TEST] Disable wildcard query in testDfsSearchType for now

time:
2014-03-20T03:56:06Z
class:
src/main/java/org/elasticsearch/rest/action/cat/RestSegmentsAction.java
comments:
Remove shard-level info from _cat/segments and add pri/rep and ip address to segments

Also fix typo

Closes #4711

time:
2014-03-20T03:56:06Z
class:
src/main/java/org/elasticsearch/rest/action/RestActionModule.java
src/main/java/org/elasticsearch/rest/action/cat/RestSegmentsAction.java
comments:
Added segments action to _cat API
Currently displays the same information as the _segments API

time:
2014-03-19T22:20:29Z
class:
comments:
Upgrade to Tika 1.5

Closes #56.

time:
2014-03-19T22:14:39Z
class:
src/test/java/org/elasticsearch/index/mapper/xcontent/DateAttachmentMapperTests.java
src/test/java/org/elasticsearch/index/mapper/xcontent/EncryptedDocMapperTest.java
src/test/java/org/elasticsearch/index/mapper/xcontent/MultifieldAttachmentMapperTests.java
src/test/java/org/elasticsearch/index/mapper/xcontent/SimpleAttachmentMapperTests.java
comments:
Update to elasticsearch 1.0.0

Closes #60.

time:
2014-03-19T22:09:37Z
class:
comments:
Add plugin version in es-plugin.properties

Closes #59.

time:
2014-03-19T22:04:09Z
class:
comments:
Add plugin release semi-automatic script

Closes #58.

time:
2014-03-19T21:45:17Z
class:
comments:
Disable java and maven version checking

And fix typo in email html

time:
2014-03-19T21:42:50Z
class:
comments:
Disable java and maven version checking

And fix typo in email html

time:
2014-03-19T21:38:17Z
class:
comments:
Disable java and maven version checking

And fix typo in email html

time:
2014-03-19T21:37:07Z
class:
comments:
Disable java and maven version checking

And fix typo in email html

time:
2014-03-19T21:35:56Z
class:
comments:
Disable java and maven version checking

And fix typo in email html

time:
2014-03-19T21:33:54Z
class:
comments:
Disable java and maven version checking

And fix typo in email html

time:
2014-03-19T21:29:26Z
class:
comments:
Disable java and maven version checking

And fix typo in email html

time:
2014-03-19T21:25:15Z
class:
comments:
Disable java and maven version checking

And fix typo in email html

time:
2014-03-19T21:19:09Z
class:
comments:
Disable java and maven version checking

And fix typo in email html

time:
2014-03-19T21:16:33Z
class:
comments:
Disable java and maven version checking

And fix typo in email html

time:
2014-03-19T19:58:45Z
class:
comments:
Replace gateway by S3 repository

time:
2014-03-19T16:30:49Z
class:
src/main/java/org/elasticsearch/common/geo/GeoPoint.java
src/main/java/org/elasticsearch/common/geo/GeoUtils.java
src/main/java/org/elasticsearch/index/mapper/geo/GeoPointFieldMapper.java
src/main/java/org/elasticsearch/index/query/GeoBoundingBoxFilterParser.java
src/main/java/org/elasticsearch/index/query/GeoDistanceFilterParser.java
src/main/java/org/elasticsearch/index/query/GeoDistanceRangeFilterParser.java
src/main/java/org/elasticsearch/index/query/GeoPolygonFilterParser.java
src/main/java/org/elasticsearch/index/query/GeohashCellFilter.java
src/main/java/org/elasticsearch/index/query/functionscore/DecayFunctionParser.java
src/main/java/org/elasticsearch/search/facet/geodistance/GeoDistanceFacetParser.java
src/main/java/org/elasticsearch/search/sort/GeoDistanceSortParser.java
src/main/java/org/elasticsearch/search/suggest/context/GeolocationContextMapping.java
src/test/java/org/elasticsearch/index/search/geo/GeoPointParsingTests.java
src/test/java/org/elasticsearch/search/sort/SimpleSortTests.java
comments:
Add exceptions to `GeoPointFieldMapper` when parsing `geo_point` object

* moved `geo_point` parsing to GeoUtils
* cleaned up `gzipped.json` for bulktest
* merged `GeoPointFieldMapper` and `GeoPoint` parsing methods

Closes #5390

time:
2014-03-19T15:49:23Z
class:
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantLongTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantStringTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantTermsAggregatorFactory.java
comments:
Significant_terms agg only creates term frequency cache when necessary and uses new TermsEnum wrapper to cache frequencies. Long and String-based aggs no longer need to pass an IndexReader as parameter when looking up frequencies of terms.
Closes #5459

time:
2014-03-19T13:12:42Z
class:
src/main/java/org/elasticsearch/common/bytes/ByteBufferBytesReference.java
src/main/java/org/elasticsearch/common/bytes/BytesArray.java
src/main/java/org/elasticsearch/common/bytes/BytesReference.java
src/main/java/org/elasticsearch/common/bytes/ChannelBufferBytesReference.java
src/main/java/org/elasticsearch/common/bytes/HashedBytesArray.java
src/main/java/org/elasticsearch/index/translog/fs/BufferingFsTranslogFile.java
src/main/java/org/elasticsearch/index/translog/fs/FsTranslog.java
src/main/java/org/elasticsearch/index/translog/fs/FsTranslogFile.java
src/main/java/org/elasticsearch/index/translog/fs/SimpleFsTranslogFile.java
comments:
Use BytesReference to write to translog files
Instead of using byte arrays, pass the BytesReference to the actual translog file, and use the new copyTo(channel) method to write. This will improve by not potentially having to convert the data to a byte array
closes #5463

time:
2014-03-19T11:46:06Z
class:
comments:
[DOCS] Fixed some bad UTF8

time:
2014-03-19T10:49:39Z
class:
comments:
[DOCS] Updated Drupal integration

time:
2014-03-19T04:12:14Z
class:
src/main/java/org/elasticsearch/index/search/child/ChildrenConstantScoreQuery.java
src/main/java/org/elasticsearch/index/search/child/ChildrenQuery.java
src/main/java/org/elasticsearch/index/search/child/ParentConstantScoreQuery.java
src/main/java/org/elasticsearch/index/search/child/ParentQuery.java
src/main/java/org/elasticsearch/index/search/child/TopChildrenQuery.java
comments:
Invoke super.clone() instead of creating a new instance in the clone methods.

time:
2014-03-18T23:12:03Z
class:
src/test/java/org/elasticsearch/recovery/RecoveryWhileUnderLoadTests.java
comments:
[Test] RecoveryWhileUnderLoadTests: smarter waiting for background indexers as it sometimes times out.

time:
2014-03-18T22:23:07Z
class:
src/main/java/org/elasticsearch/common/Table.java
src/test/java/org/elasticsearch/common/TableTests.java
comments:
Minor improvements to Table class and add tests

time:
2014-03-18T20:06:04Z
class:
src/main/java/org/elasticsearch/index/mapper/internal/SourceFieldMapper.java
src/main/java/org/elasticsearch/index/translog/fs/FsTranslog.java
comments:
BytesReference usage to properly work when hasArray is not available
fix spelling in comment, + remove overcautious assert

time:
2014-03-18T20:02:31Z
class:
src/main/java/org/elasticsearch/action/admin/indices/mapping/get/GetFieldMappingsResponse.java
src/main/java/org/elasticsearch/gateway/local/state/meta/LocalGatewayMetaState.java
src/main/java/org/elasticsearch/gateway/local/state/shards/LocalGatewayShardsState.java
src/main/java/org/elasticsearch/index/mapper/internal/SourceFieldMapper.java
src/main/java/org/elasticsearch/index/translog/fs/FsTranslog.java
src/test/java/org/elasticsearch/index/mapper/all/SimpleAllMapperTests.java
comments:
BytesReference usage to properly work when hasArray is not available
when a BytesReference doesn't have a backing array, properly handle the case in places where its applicable
closes #5455

time:
2014-03-18T14:36:46Z
class:
src/main/java/org/elasticsearch/node/internal/InternalNode.java
src/test/java/org/elasticsearch/test/TestCluster.java
comments:
[TEST] Added the option to specify on what ES version a node should run with. Useful for testing.

time:
2014-03-18T13:09:57Z
class:
src/main/java/org/elasticsearch/index/mapper/geo/GeoPointFieldMapper.java
src/test/java/org/elasticsearch/index/mapper/geo/GeohashMappingGeoPointTests.java
comments:
Geo Point Fieldmapper: Allow distance for geohash precision

Even though mentioned differently in the docs, the geohash precision needed to
be an integer instead of a DistanceUnit.

Closes #5448

time:
2014-03-18T12:17:00Z
class:
src/main/java/org/apache/lucene/index/TrackingSerialMergeScheduler.java
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
src/main/java/org/elasticsearch/index/merge/scheduler/MergeSchedulerModule.java
src/main/java/org/elasticsearch/index/merge/scheduler/SerialMergeSchedulerProvider.java
src/test/java/org/apache/lucene/TrackingSerialMergeSchedulerTests.java
comments:
Move to use serial merge schedule by default
Today, we use ConcurrentMergeScheduler, and this can be painful since it is concurrent on a shard level, with a max of 3 threads doing concurrent merges. If there are several shards being indexed, then there will be a minor explosion of threads trying to do merges, all being throttled by our merge throttling.
Moving to serial merge scheduler will still maintain concurrency of merges across shards, as we have the merge thread pool that schedules those merges. It will just be a serial one on a specific shard.
Also, on serial merge scheduler, we now have a limit of how many merges it will do at one go, so it will let other shards get their fair chance of merging. We use the pending merges on IW to check if merges are needed or not for it.
Note, that if a merge is happening, it will not block due to a sync on the maybeMerge call at indexing (flush) time, since we wrap our merge scheduler with the EnabledMergeScheduler, where maybeMerge is not activated during indexing, only with explicit calls to IW#maybeMerge (see Merges).
closes #5447

time:
2014-03-18T11:16:32Z
class:
src/main/java/org/elasticsearch/search/suggest/phrase/StupidBackoffScorer.java
src/main/java/org/elasticsearch/search/suggest/phrase/WordScorer.java
src/test/java/org/elasticsearch/search/suggest/SuggestSearchTests.java
comments:
Speed up phrase suggestion scoring

Two changes:
1.  In the StupidBackoffScorer only look for the trigram if there is a bigram.
2.  Cache the frequencies in WordScorer so we don't look them up again and
again and again.  This is implemented by wrapping the TermsEnum in a special
purpose wrapper that really only works in context of the WordScorer.

This provides a pretty substantial speedup when there are many candidates.

Closes #5395

time:
2014-03-18T11:16:32Z
class:
src/test/java/org/elasticsearch/search/suggest/SuggestSearchTests.java
src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java
comments:
Make indexRandom handle many documents better

* Index one at a time only rarely if doing more then 300.
* When launching async actions, take some care to make sure you don't already
have more then 150 other async actions in flight.
* When indexing in bulk split into chunks of 1000 documents.

time:
2014-03-18T10:30:45Z
class:
src/main/java/org/elasticsearch/index/search/child/ChildrenConstantScoreQuery.java
src/main/java/org/elasticsearch/index/search/child/ChildrenQuery.java
src/main/java/org/elasticsearch/index/search/child/ParentConstantScoreQuery.java
src/main/java/org/elasticsearch/index/search/child/ParentQuery.java
src/main/java/org/elasticsearch/index/search/child/TopChildrenQuery.java
src/test/java/org/elasticsearch/index/search/child/ChildrenConstantScoreQueryTests.java
src/test/java/org/elasticsearch/index/search/child/ChildrenQueryTests.java
src/test/java/org/elasticsearch/index/search/child/ParentConstantScoreQueryTests.java
src/test/java/org/elasticsearch/index/search/child/ParentQueryTests.java
src/test/java/org/elasticsearch/index/search/child/TopChildrenQueryTests.java
comments:
Made p/c override the clone() method. This is necessary since by default clone will make a shallow copy of the original object, while for p/c queries we need to make sure that the wrapped queries are also cloned.

time:
2014-03-18T00:13:49Z
class:
src/main/java/org/elasticsearch/action/ActionModule.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/status/SnapshotIndexShardStage.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/status/SnapshotIndexShardStatus.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/status/SnapshotIndexStatus.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/status/SnapshotShardsStats.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/status/SnapshotStats.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/status/SnapshotStatus.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/status/SnapshotsStatusAction.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/status/SnapshotsStatusRequest.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/status/SnapshotsStatusRequestBuilder.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/status/SnapshotsStatusResponse.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/status/TransportNodesSnapshotsStatus.java
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/status/TransportSnapshotsStatusAction.java
src/main/java/org/elasticsearch/client/ClusterAdminClient.java
src/main/java/org/elasticsearch/client/Requests.java
src/main/java/org/elasticsearch/client/support/AbstractClusterAdminClient.java
src/main/java/org/elasticsearch/gateway/local/state/meta/TransportNodesListGatewayMetaState.java
src/main/java/org/elasticsearch/gateway/local/state/shards/TransportNodesListGatewayStartedShards.java
src/main/java/org/elasticsearch/index/snapshots/IndexShardRepository.java
src/main/java/org/elasticsearch/index/snapshots/IndexShardSnapshotStatus.java
src/main/java/org/elasticsearch/index/snapshots/blobstore/BlobStoreIndexShardRepository.java
src/main/java/org/elasticsearch/index/snapshots/blobstore/BlobStoreIndexShardSnapshot.java
src/main/java/org/elasticsearch/indices/store/TransportNodesListShardStoreMetaData.java
src/main/java/org/elasticsearch/repositories/RepositoriesModule.java
src/main/java/org/elasticsearch/rest/action/RestActionModule.java
src/main/java/org/elasticsearch/rest/action/admin/cluster/snapshots/status/RestSnapshotsStatusAction.java
src/main/java/org/elasticsearch/snapshots/SnapshotsService.java
src/test/java/org/elasticsearch/snapshots/SharedClusterSnapshotRestoreTests.java
comments:
Add ability to get snapshot status for running snapshots

Closes #4946

time:
2014-03-17T20:55:39Z
class:
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/create/CreateSnapshotRequest.java
comments:
Revert "Findbug warning supression"

This reverts commit 744eabad030f8f8c5705beeea7ab7eeb47f84969.

time:
2014-03-17T20:35:37Z
class:
src/main/java/org/elasticsearch/action/admin/cluster/snapshots/create/CreateSnapshotRequest.java
comments:
Findbug warning supression

Added logic to enable findbug warnings supression via annotations

time:
2014-03-17T20:31:17Z
class:
src/test/java/org/elasticsearch/plugin/PluginManagerTests.java
comments:
[TEST] pre check download service working

Seen during CI tests, it could appears that the download service is not available for any reason.

This fix in test will check before each test which requires an internet access (annotated with @Network) that the download service we are testing is still working.

It won't fail the test but will mark the test as `Ignored` in case of failure.

time:
2014-03-17T18:42:05Z
class:
comments:
prepare for next development iteration

time:
2014-03-17T18:40:28Z
class:
comments:
[DOCS] Add Azure storage repositories

time:
2014-03-17T18:36:52Z
class:
comments:
prepare release elasticsearch-cloud-azure-2.1.0

time:
2014-03-17T18:36:18Z
class:
comments:
Fix azure plugin description

It now also add `azure` repositories

time:
2014-03-17T18:25:39Z
class:
comments:
Fix typo in tests

time:
2014-03-17T18:18:20Z
class:
comments:
Update to AWS SDK 1.7.3

Closes #62.

time:
2014-03-17T16:14:13Z
class:
src/test/java/org/elasticsearch/test/junit/listeners/ReproduceInfoPrinter.java
comments:
[TEST] Print tests.jvms and tests.client.ratio if set

We need to print options that can modify stream of events we need
to print it otherwise a seed might not reproduce the failure in
the tests.

time:
2014-03-17T13:43:10Z
class:
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/BucketSignificancePriorityQueue.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/InternalSignificantTerms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantLongTerms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantLongTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantStringTerms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantStringTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantTerms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantTermsAggregatorFactory.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantTermsBuilder.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantTermsParser.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/UnmappedSignificantTerms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/UnmappedSignificantTermsAggregator.java
comments:
cleanup formatting in significant aggs package

time:
2014-03-17T13:06:34Z
class:
comments:
Move systemd files from /etc to /usr/lib

As documented in systemd's manual pages tmpfiles.d(5) and systemd.unit(5),
a package should install its default configuration in /usr/lib, which can
be overriden by system administrators in /etc.

New locations in the rpm:
/usr/lib/systemd/system/elasticsearch.service
/usr/lib/tmpfiles.d/elasticsearch.conf

time:
2014-03-17T12:55:37Z
class:
src/main/java/org/elasticsearch/index/search/stats/SearchStats.java
src/test/java/org/elasticsearch/search/stats/SearchStatsTests.java
comments:
[TEST] Use client node such that we always have to do a round-trip to do a fetch.

time:
2014-03-17T12:30:43Z
class:
comments:
Elasticsearch dependency should be provided and not compile

Please change the Elasticsearch dependency to provided (and maybe testCompile) instead of compile and runtime.

Why? If you include the plugin in embedded Elasticsearch, and you exclude anything from the Elasticsearch dependency, it is undone by this dependency also including Elasticsearch. Therefore you have to tune both, when really this plugin only needs it as provided (since it runs with Elasticsearch or in Elasticsearch but never on its own).

Related to #48.

time:
2014-03-17T12:17:54Z
class:
comments:
Documentation fix for significant_terms heading levels

time:
2014-03-17T11:59:18Z
class:
comments:
Add plugin release semi-automatic script

Closes #58.

time:
2014-03-17T11:20:48Z
class:
comments:
[DOCS] Fixing contributing.md indentation

Add a whitespace to make these separate paragraphs inside of a list.

time:
2014-03-17T11:08:49Z
class:
comments:
[DOCS] Reword clear-scroll sentence

time:
2014-03-17T11:03:25Z
class:
comments:
[DOCS] Fix typo in the reference doc. SuSe -> SUSE

SUSE, as a Linux distribution, is never lower cased

fixes #5354

time:
2014-03-17T10:59:02Z
class:
comments:
[DOCS] Updating scripting docs for geo functions

Added a few functions are corrected the default unit where necessary

time:
2014-03-17T10:50:28Z
class:
src/main/java/org/elasticsearch/gateway/s3/S3Gateway.java
src/main/java/org/elasticsearch/repositories/s3/S3Repository.java
comments:
Support ap-northeast region for EC2 and S3

Closes #52.

time:
2014-03-17T10:45:55Z
class:
comments:
[Docs] added a missing reference to significantterms-aggergations

Also fix header level mismatch issue reported by the build

time:
2014-03-17T10:01:43Z
class:
src/test/java/org/elasticsearch/cluster/ClusterServiceTests.java
src/test/java/org/elasticsearch/gateway/local/QuorumLocalGatewayTests.java
comments:
[Tests] QuorumLocalGatewayTests - Set mini_master_nodes earlier to make sure it has effect.  ClusterServiceTests - remove a thread.sleep in favor of awaitBusy

time:
2014-03-17T09:37:56Z
class:
src/test/java/org/elasticsearch/indexlifecycle/IndexLifecycleActionTests.java
src/test/java/org/elasticsearch/recovery/FullRollingRestartTests.java
src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java
comments:
[Test] FullRollingRestartTests - correctly setting minimum_master_nodes

Also added a ElasticsearchIntegrationTest.setMinimumMasterNodes() helper function.

time:
2014-03-17T09:36:42Z
class:
comments:
Elasticsearch dependency should be provided and not compile

Please change the Elasticsearch dependency to provided (and maybe testCompile) instead of compile and runtime.

Why? If you include the plugin in embedded Elasticsearch, and you exclude anything from the Elasticsearch dependency, it is undone by this dependency also including Elasticsearch. Therefore you have to tune both, when really this plugin only needs it as provided (since it runs with Elasticsearch or in Elasticsearch but never on its own).

Closes #48.

time:
2014-03-17T08:53:56Z
class:
src/main/java/org/elasticsearch/discovery/ec2/AwsEc2UnicastHostsProvider.java
comments:
Support group id in addition to group names

Based on issue #43, we want to support both notations:

* group name first
* group id if it does not work with group name

Closes #49.

time:
2014-03-17T08:53:24Z
class:
src/main/java/org/elasticsearch/discovery/zen/ZenDiscovery.java
src/test/java/org/elasticsearch/indexlifecycle/IndexLifecycleActionTests.java
comments:
[Test] IndexLifecycleActionTests - set minimum master node earlier to make sure it's in effect when needed.

time:
2014-03-17T08:44:41Z
class:
comments:
Update to elasticsearch 1.0.0

Closes #57.

time:
2014-03-17T08:41:47Z
class:
comments:
Add plugin version in es-plugin.properties

With https://github.com/elasticsearch/elasticsearch/issues/2784, we can now add plugin version in `es-plugin.properties` file.

It will only be used with elasticsearch 1.0.0 and upper. No need to push it in 1.x branch.

Closes #59.

time:
2014-03-17T08:23:29Z
class:
src/main/java/org/elasticsearch/cloud/azure/AzureComputeServiceImpl.java
src/main/java/org/elasticsearch/cloud/azure/AzureModule.java
src/main/java/org/elasticsearch/cloud/azure/AzureSettingsFilter.java
src/main/java/org/elasticsearch/cloud/azure/AzureStorageService.java
src/main/java/org/elasticsearch/cloud/azure/AzureStorageServiceImpl.java
src/main/java/org/elasticsearch/cloud/azure/blobstore/AbstractAzureBlobContainer.java
src/main/java/org/elasticsearch/cloud/azure/blobstore/AzureBlobStore.java
src/main/java/org/elasticsearch/cloud/azure/blobstore/AzureImmutableBlobContainer.java
src/main/java/org/elasticsearch/discovery/azure/AzureDiscoveryModule.java
src/main/java/org/elasticsearch/plugin/cloud/azure/CloudAzurePlugin.java
src/main/java/org/elasticsearch/repositories/azure/AzureRepository.java
src/main/java/org/elasticsearch/repositories/azure/AzureRepositoryModule.java
src/test/java/org/elasticsearch/cloud/azure/AbstractAzureTest.java
src/test/java/org/elasticsearch/repositories/azure/AbstractAzureRepositoryServiceTest.java
src/test/java/org/elasticsearch/repositories/azure/AzureSnapshotRestoreITest.java
src/test/java/org/elasticsearch/repositories/azure/AzureSnapshotRestoreTest.java
src/test/java/org/elasticsearch/repositories/azure/AzureStorageServiceMock.java
comments:
Add Azure Storage repository

elasticsearch 1.0 will provide a new feature named `Snapshot & Restore`.

We want to add support for [Azure Storage](http://www.windowsazure.com/en-us/documentation/services/storage/).

To enable Azure repositories, you have first to set your azure storage settings:

```yaml
    cloud:
        azure:
            storage_account: your_azure_storage_account
            storage_key: your_azure_storage_key
```

The Azure repository supports following settings:

* `container`: Container name. Defaults to `elasticsearch-snapshots`
* `base_path`: Specifies the path within container to repository data. Defaults to empty (root directory).
* `concurrent_streams`: Throttles the number of streams (per node) preforming snapshot operation. Defaults to `5`.
* `chunk_size`: Big files can be broken down into chunks during snapshotting if needed. The chunk size can be specified
in bytes or by using size value notation, i.e. `1g`, `10m`, `5k`. Defaults to `64m` (64m max)
* `compress`: When set to `true` metadata files are stored in compressed format. This setting doesn't affect index
files that are already compressed by default. Defaults to `false`.

Some examples, using scripts:

```sh
$ curl -XPUT 'http://localhost:9200/_snapshot/my_backup1' -d '{
    "type": "azure"
}'

$ curl -XPUT 'http://localhost:9200/_snapshot/my_backup2' -d '{
    "type": "azure",
    "settings": {
        "container": "backup_container",
        "base_path": "backups",
        "concurrent_streams": 2,
        "chunk_size": "32m",
        "compress": true
    }
}'
```

Example using Java:

```java
client.admin().cluster().preparePutRepository("my_backup3")
        .setType("azure").setSettings(ImmutableSettings.settingsBuilder()
                .put(AzureStorageService.Fields.CONTAINER, "backup_container")
                .put(AzureStorageService.Fields.CHUNK_SIZE, new ByteSizeValue(32, ByteSizeUnit.MB))
        ).get();
```

Closes #2.

time:
2014-03-17T07:43:33Z
class:
comments:
Enforce java version 1.7

When building elasticsearch, we now require to use java 1.7.

Maven will check that before compiling any class. If Java version is incorrect, you will get the following message:

```
[WARNING] Rule 0: org.apache.maven.plugins.enforcer.RequireJavaVersion failed with message:
Detected JDK Version: 1.6.0-65 is not in the allowed range [1.7,).
```

Closes #5428.

time:
2014-03-17T03:50:57Z
class:
src/test/java/org/elasticsearch/percolator/PercolatorTests.java
comments:
[TEST] In PercolatorTests#testPercolateSorting_unsupportedField we need to be sure that the .percolator type exists

time:
2014-03-17T03:21:44Z
class:
src/test/java/org/elasticsearch/nested/SimpleNestedTests.java
comments:
[TEST] Make sure that the facet fields exist.

time:
2014-03-16T17:19:21Z
class:
src/main/java/org/elasticsearch/common/network/MulticastChannel.java
comments:
MulticastChannel returned wrong channel in shared mode

If the shared channel is used a wrong refrence was returned and
close calls couldn't find the listener since it go never registered
in that instance.

time:
2014-03-16T15:08:36Z
class:
src/main/java/org/elasticsearch/discovery/zen/ping/unicast/UnicastZenPing.java
comments:
Count latch down if sendsPing throws exception

if the async sendPingsHandler throws an unexpected exception the
corresponding latch is never counted down. This might only happen
during node shutdown but can still cause starvation or test failures.

time:
2014-03-16T11:16:09Z
class:
src/main/java/org/elasticsearch/rest/action/RestActionModule.java
src/main/java/org/elasticsearch/rest/action/cat/RestPluginsAction.java
comments:
Add _cat/plugins endpoint

If we want to have a full picture of versions running in a cluster, we need to add a `_cat/plugins` endpoint.

Response could look like:

```sh
% curl es2:9200/_cat/plugins?v
node component                        version   type url                                   desc
es1  mapper-attachments               1.7.0       j                                        Adds the attachment type allowing to parse difference attachment formats
es1  lang-javascript                  1.4.0       j                                        JavaScript plugin allowing to add javascript scripting support
es1  analysis-smartcn                 1.9.0       j                                        Smart Chinese analysis support
es1  marvel                           1.1.0      j/s http://localhost:9200/_plugins/marvel Elasticsearch Management & Monitoring
es1  kopf                             0.5.3       s  http://localhost:9200/_plugins/kopf   kopf - simple web administration tool for ElasticSearch
es2  mapper-attachments               2.0.0.RC1   j                                        Adds the attachment type allowing to parse difference attachment formats
es2  lang-javascript                  2.0.0.RC1   j                                        JavaScript plugin allowing to add javascript scripting support
es2  analysis-smartcn                 2.0.0.RC1   j                                        Smart Chinese analysis support
```

Closes #4824.

time:
2014-03-16T06:29:24Z
class:
src/test/java/org/elasticsearch/mlt/MoreLikeThisActionTests.java
comments:
[TEST] add mapping to MoreLikeThisActionTests to make sure doc mapper exists on all shards / nodes

time:
2014-03-15T22:06:36Z
class:
src/test/java/org/elasticsearch/recovery/RecoveryWhileUnderLoadTests.java
src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java
comments:
[Tests] RecoveryWhileUnderLoadTests - made sure background indexing threads are closed on errors.

Fixed minor logging discrepancies introduced with randomized shard count.
Added logging to recoverWhileUnderLoadWithNodeShutdown
Added logging ElasticsearchIntegrationTest.allowNodes to indicate what nodes were excluded.
recoverWhileRelocating's shard setting were potentially ignored (depending on key order in hashmaps)

time:
2014-03-15T11:32:09Z
class:
src/main/java/org/elasticsearch/action/bulk/BulkProcessor.java
src/test/java/org/elasticsearch/document/BulkTests.java
comments:
BulkProcessor process every n+1 docs instead of n

When you set a BulkProcessor with a bulk actions size of 100, it executes the bulk after 101 documents.

```java
BulkProcessor.builder(client(), listener).setBulkActions(100).setConcurrentRequests(1).setName("foo").build();
```

Same for size. If you set the bulk size to 1024 bytes, it will actually execute the bulk after 1025 bytes.

This patch fix it.

Closes #4265.

time:
2014-03-15T11:07:17Z
class:
comments:
[DOCS] Documented gateway.local.auto_import_dangled

Relates to #4996

time:
2014-03-14T22:19:23Z
class:
src/test/java/org/elasticsearch/indices/fielddata/breaker/CircuitBreakerServiceTests.java
comments:
[TEST] Fix CircuitBreakerServiceTests from failing due to rounding errors

time:
2014-03-14T20:40:57Z
class:
src/main/java/org/elasticsearch/index/merge/policy/ElasticsearchMergePolicy.java
comments:
Remove PMD clone warning

Removed PMD clone warning on class ElasticsearchMergePolicy

time:
2014-03-14T20:11:40Z
class:
src/main/java/org/elasticsearch/common/http/client/HttpDownloadHelper.java
comments:
Improve exception handling in HttpDownloadHelper

time:
2014-03-14T19:39:07Z
class:
src/test/java/org/elasticsearch/cluster/routing/allocation/RandomAllocationDeciderTests.java
comments:
[TEST] Reduce iterations in RandomAllocationDeciderTests

time:
2014-03-14T19:26:03Z
class:
src/main/java/org/elasticsearch/index/search/MatchQuery.java
src/test/java/org/elasticsearch/search/query/SimpleQueryTests.java
comments:
Add slop to prefix phrase query after parsing query string

This fixes a regression introduced by #5005 where the query slop
was simply ignored when a `match_phrase_prefix` type was set.

Closes #5437

time:
2014-03-14T19:18:09Z
class:
src/main/java/org/elasticsearch/index/search/child/ChildrenQuery.java
src/main/java/org/elasticsearch/index/search/child/ParentQuery.java
comments:
Improve resource handling in Parent/ChildQuery

time:
2014-03-14T19:18:01Z
class:
src/main/java/org/elasticsearch/common/lucene/search/Queries.java
src/main/java/org/elasticsearch/index/query/FQueryFilterParser.java
src/main/java/org/elasticsearch/index/query/NestedFilterParser.java
src/main/java/org/elasticsearch/index/query/QueryFilterParser.java
src/main/java/org/elasticsearch/index/query/QueryParseContext.java
src/main/java/org/elasticsearch/search/facet/query/QueryFacetExecutor.java
src/test/java/org/elasticsearch/search/child/SimpleChildQuerySearchTests.java
comments:
Enforce query instance checking before it wrapper as a filter

We have the default QueryWrapperFilter as well as our custom one while
our wrapper is explicitly marked as no_cache such that it will never
be included in a cache. This was not consistenly used and caused several
problems during tests where p/c related queries were used as filters
and ended up in the cache. This commit adds the QueryWrapperFilter
ctor to the forbidden APIs to enforce the query instance checks.

time:
2014-03-14T17:55:32Z
class:
comments:
[Doc] doc updates for date histogram interval

Close #5308

time:
2014-03-14T17:21:56Z
class:
src/main/java/org/elasticsearch/action/admin/indices/optimize/OptimizeRequest.java
src/main/java/org/elasticsearch/action/admin/indices/optimize/OptimizeRequestBuilder.java
src/main/java/org/elasticsearch/action/admin/indices/optimize/ShardOptimizeRequest.java
src/main/java/org/elasticsearch/action/admin/indices/optimize/TransportOptimizeAction.java
src/main/java/org/elasticsearch/index/engine/Engine.java
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
src/main/java/org/elasticsearch/index/merge/policy/ElasticsearchMergePolicy.java
src/main/java/org/elasticsearch/rest/action/admin/indices/optimize/RestOptimizeAction.java
src/test/java/org/elasticsearch/common/lucene/uid/VersionsTests.java
src/test/java/org/elasticsearch/index/engine/internal/InternalEngineTests.java
src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java
comments:
Add an option to force _optimize operations.

When forced, the index will be merged even if it contains a single segment with
no deletions.

Close #5243

time:
2014-03-14T17:03:14Z
class:
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/InternalSignificantTerms.java
comments:
Tidy significant terms warnings from Jenkins

time:
2014-03-14T15:54:58Z
class:
src/main/java/org/elasticsearch/index/query/FQueryFilterParser.java
comments:
Also wrap p/c queries in CustomQueryWrappingFilter in the fquery qparser, because they otherwise p/c queries may work incorrectly.

time:
2014-03-14T15:32:03Z
class:
src/main/java/org/elasticsearch/common/util/BigArrays.java
src/test/java/org/elasticsearch/common/util/BigArraysTests.java
comments:
equals()/hashCode() & tests for ByteArrays to avoid materializing a
full byte[].

Fixes #5435

time:
2014-03-14T15:26:39Z
class:
src/main/java/org/elasticsearch/index/mapper/ParseContext.java
src/main/java/org/elasticsearch/index/mapper/core/BinaryFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/core/BooleanFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/geo/GeoPointFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/geo/GeoShapeFieldMapper.java
src/test/java/org/elasticsearch/index/mapper/externalvalues/ExternalIndexModule.java
src/test/java/org/elasticsearch/index/mapper/externalvalues/ExternalMapper.java
src/test/java/org/elasticsearch/index/mapper/externalvalues/ExternalMapperPlugin.java
src/test/java/org/elasticsearch/index/mapper/externalvalues/ExternalValuesMapperIntegrationTests.java
src/test/java/org/elasticsearch/index/mapper/externalvalues/RegisterExternalTypes.java
comments:
Support externalValue() in mappers

Some mappers do not support externalValue() to be set. So plugin developers can't use it while building their own mappers.

Support added in this PR for:

* `BinaryFieldMapper`
* `BooleanFieldMapper`
* `GeoPointFieldMapper`
* `GeoShapeFieldMapper`

Closes #4986.
Relative to #4154.

time:
2014-03-14T15:19:26Z
class:
src/test/java/org/elasticsearch/search/child/SimpleChildQuerySearchTests.java
comments:
[TEST] Made sure that the parent exists (`foo` is the parent type and not `parent`)

time:
2014-03-14T15:13:18Z
class:
src/test/java/org/elasticsearch/search/child/SimpleChildQuerySearchTests.java
comments:
[TEST] Make sure that "assertNoFailures(searchResponse);" is used instead of "assertThat(searchResponse.getFailedShards(), equalTo(0));" to see what is failing.
Removed redundant "assertThat(searchResponse.getFailedShards(), equalTo(0));" checks

time:
2014-03-14T13:58:05Z
class:
src/main/java/org/elasticsearch/common/network/MulticastChannel.java
src/main/java/org/elasticsearch/discovery/zen/ping/multicast/MulticastZenPing.java
src/test/java/org/elasticsearch/discovery/zen/ping/multicast/MulticastZenPingTests.java
comments:
Allow to share multicast socket within jvm
Due to bugs in jvm (specifically OSX), running zen discovery tests causes for "socket close" failure on receive on multicast socket, and under some jvm versions, even crashes. This happens because of the creation of multiple multicast sockets within the same VM. In practice, in our tests, we use the same settings, so we can share the same multicast socket across multiple channels.
This change creates an abstraction called MulticastChannel, that can be shared, with ref counting. Today, the shared option is only enabled under OSX.
closes #5410

time:
2014-03-14T12:53:53Z
class:
src/main/java/org/elasticsearch/search/aggregations/support/numeric/ScriptDoubleValues.java
src/main/java/org/elasticsearch/search/aggregations/support/numeric/ScriptLongValues.java
src/test/java/org/elasticsearch/search/aggregations/support/ScriptValuesTests.java
comments:
Allow scripts to return more than 4 values in aggregations.

A missing call to ArrayUtil.grow prevented the array that stores the values
from growing in case the number of values returned by the script was higher
than the original size of the array.

Close #5414

time:
2014-03-14T12:22:38Z
class:
src/test/java/org/elasticsearch/plugin/PluginManagerTests.java
comments:
[TEST] pre check download service working

Seen during CI tests, it could appears that the download service is not available for any reason.

This fix in test will check before each test which requires an internet access (annotated with @Network) that the download service we are testing is still working.

It won't fail the test but will mark the test as `Ignored` in case of failure.

time:
2014-03-14T11:23:23Z
class:
comments:
[Doc] Add a chart about the relative error of the percentiles aggregation.

time:
2014-03-14T10:47:00Z
class:
src/test/java/org/apache/lucene/queries/BlendedTermQueryTest.java
src/test/java/org/apache/lucene/search/postingshighlight/CustomPostingsHighlighterTests.java
src/test/java/org/apache/lucene/search/postingshighlight/XPostingsHighlighterTests.java
src/test/java/org/elasticsearch/VersionTests.java
src/test/java/org/elasticsearch/action/admin/HotThreadsTest.java
src/test/java/org/elasticsearch/cluster/DiskUsageTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/NodeVersionAllocationDeciderTests.java
src/test/java/org/elasticsearch/cluster/routing/allocation/RandomAllocationDeciderTests.java
src/test/java/org/elasticsearch/common/hashing/MurmurHash3Tests.java
src/test/java/org/elasticsearch/common/lucene/search/XBooleanFilterTests.java
src/test/java/org/elasticsearch/common/unit/FuzzinessTests.java
src/test/java/org/elasticsearch/common/util/ByteUtilsTests.java
src/test/java/org/elasticsearch/common/util/BytesRefHashTests.java
src/test/java/org/elasticsearch/common/util/DoubleObjectHashMapTests.java
src/test/java/org/elasticsearch/common/util/LongObjectHashMapTests.java
src/test/java/org/elasticsearch/common/util/concurrent/CountDownTest.java
src/test/java/org/elasticsearch/count/simple/SimpleCountTests.java
src/test/java/org/elasticsearch/deleteByQuery/DeleteByQueryTests.java
src/test/java/org/elasticsearch/gateway/fs/IndexGatewayTests.java
src/test/java/org/elasticsearch/index/analysis/AnalyzerBackwardsCompatTests.java
src/test/java/org/elasticsearch/index/analysis/NGramTokenizerFactoryTests.java
src/test/java/org/elasticsearch/index/analysis/PreBuiltAnalyzerTests.java
src/test/java/org/elasticsearch/index/fielddata/AbstractStringFieldDataTests.java
src/test/java/org/elasticsearch/index/fielddata/DuelFieldDataTests.java
src/test/java/org/elasticsearch/index/fielddata/FieldDataFilterIntegrationTests.java
src/test/java/org/elasticsearch/index/query/SimpleIndexQueryParserTests.java
src/test/java/org/elasticsearch/indices/fielddata/breaker/CircuitBreakerServiceTests.java
src/test/java/org/elasticsearch/indices/fielddata/breaker/RandomExceptionCircuitBreakerTests.java
src/test/java/org/elasticsearch/indices/mapping/ConcurrentDynamicTemplateTests.java
src/test/java/org/elasticsearch/indices/template/IndexTemplateFileLoadingTests.java
src/test/java/org/elasticsearch/percolator/PercolatorFacetsAndAggregationsTests.java
src/test/java/org/elasticsearch/recovery/RecoveryWhileUnderLoadTests.java
src/test/java/org/elasticsearch/recovery/RelocationTests.java
src/test/java/org/elasticsearch/search/StressSearchServiceReaperTest.java
src/test/java/org/elasticsearch/search/aggregations/RandomTests.java
src/test/java/org/elasticsearch/search/aggregations/metrics/GroupTreeTests.java
src/test/java/org/elasticsearch/search/aggregations/metrics/RedBlackTreeTests.java
src/test/java/org/elasticsearch/search/aggregations/metrics/cardinality/HyperLogLogPlusPlusTests.java
src/test/java/org/elasticsearch/search/basic/SearchWhileRelocatingTests.java
src/test/java/org/elasticsearch/search/basic/SearchWithRandomExceptionsTests.java
src/test/java/org/elasticsearch/search/facet/SimpleFacetsTests.java
src/test/java/org/elasticsearch/search/functionscore/RandomScoreFunctionTests.java
src/test/java/org/elasticsearch/search/highlight/HighlighterSearchTests.java
src/test/java/org/elasticsearch/search/matchedqueries/MatchedQueriesTests.java
src/test/java/org/elasticsearch/search/query/MultiMatchQueryTests.java
src/test/java/org/elasticsearch/search/query/SimpleQueryTests.java
src/test/java/org/elasticsearch/search/rescore/QueryRescorerTests.java
src/test/java/org/elasticsearch/search/scan/SearchScanScrollingTests.java
src/test/java/org/elasticsearch/search/scan/SearchScanTests.java
src/test/java/org/elasticsearch/search/simple/SimpleSearchTests.java
src/test/java/org/elasticsearch/search/sort/SimpleSortTests.java
src/test/java/org/elasticsearch/search/suggest/CompletionSuggestSearchTests.java
src/test/java/org/elasticsearch/search/suggest/completion/CompletionPostingsFormatTest.java
src/test/java/org/elasticsearch/test/ElasticsearchLuceneTestCase.java
src/test/java/org/elasticsearch/test/junit/listeners/ReproduceInfoPrinter.java
src/test/java/org/elasticsearch/transport/netty/KeyedLockTests.java
comments:
upgrade randomized-testing to 2.1.1

Note that the standard `atLeast` implementation has now Integer.MAX_VALUE as upper bound, thus it behaves differently from what we expect in our tests, as we never expect the upper bound to be that high.
Added our own `atLeast` to `AbstractRandomizedTest` so that it has the expected behaviour with a reasonable upper bound.
See https://github.com/carrotsearch/randomizedtesting/issues/131

time:
2014-03-14T10:34:24Z
class:
src/main/java/org/elasticsearch/search/aggregations/AggregationBuilders.java
src/main/java/org/elasticsearch/search/aggregations/AggregationModule.java
src/main/java/org/elasticsearch/search/aggregations/TransportAggregationModule.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/BucketSignificancePriorityQueue.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/InternalSignificantTerms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantLongTerms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantLongTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantStringTerms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantStringTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantTerms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantTermsAggregatorFactory.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantTermsBuilder.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantTermsParser.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/UnmappedSignificantTerms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/significant/UnmappedSignificantTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/LongTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/StringTermsAggregator.java
src/test/java/org/elasticsearch/search/aggregations/bucket/SignificantTermsTests.java
comments:
Significant_terms aggregation identifies terms that are significant rather than merely popular in a set.
Significance is related to the changes in document frequency observed between everyday use in the corpus and
frequency observed in the result set. The asciidocs include extensive details on the applications of this feature.

Closes #5146

time:
2014-03-14T08:29:24Z
class:
src/main/java/org/elasticsearch/index/percolator/stats/PercolateStats.java
src/main/java/org/elasticsearch/index/percolator/stats/ShardPercolateService.java
src/test/java/org/elasticsearch/percolator/PercolatorTests.java
comments:
Disabled query size estimation in percolator, because this is too expensive cpu wise.
Lucene's RamUsageEstimator.sizeOf(Object) is to expensive.
Query size estimation will be enabled when a cheaper way of query size estimation can be found.

Closes #5372
Relates to #5339

time:
2014-03-14T08:26:56Z
class:
src/test/java/org/elasticsearch/indices/warmer/SimpleIndicesWarmerTests.java
comments:
[Test] Strengthen SimpleIndicesWarmerTests.testEagerLoading.

time:
2014-03-14T07:12:05Z
class:
src/main/java/org/elasticsearch/index/query/QueryFilterParser.java
src/main/java/org/elasticsearch/index/search/child/ChildrenConstantScoreQuery.java
src/main/java/org/elasticsearch/index/search/child/ChildrenQuery.java
src/main/java/org/elasticsearch/index/search/child/CustomQueryWrappingFilter.java
src/main/java/org/elasticsearch/index/search/child/ParentConstantScoreQuery.java
src/main/java/org/elasticsearch/index/search/child/ParentQuery.java
comments:
The p/c queries must always be wrapped in a CustomQueryWrappingFilter in fquery parser.
Also made assertions more descriptive when failing.
good catch martjin, this seems to me like a bug though... do we need an issue for this?

and if so I guess we should push this to 1.0 as well?

I wasn't 100% sure if this was causing the build failures, but now that is seems to be the case I'll open an issue for it and port it back to 1.0 as well.


time:
2014-03-14T03:51:34Z
class:
src/test/java/org/elasticsearch/discovery/DiscoveryTests.java
comments:
[TESTS] Specify unicast hosts and transport port range specifically

time:
2014-03-13T21:54:49Z
class:
src/main/java/org/elasticsearch/repositories/blobstore/BlobStoreRepository.java
comments:
Add retry mechanism to get snapshot method

During snapshot finalization the snapshot file is getting overwritten. If we try to read the snapshot file at this moment we can get back an empty or incomplete snapshot. This change adds a retry mechanism in case of such failure.

time:
2014-03-13T21:33:34Z
class:
src/test/java/org/elasticsearch/search/stats/SearchStatsTests.java
comments:
[TEST] Rewrite SearchStatsTests to not shut down nodes after indexing.

The test was shutting down nodes even if some of the inidces had only a
single shard. This caused that we basically had no shard active that
could sever the docs and caused random failures. This commit fixed the
test to rather allocate enough shards such that we never need to resize
the cluster which also makes the test faster.

time:
2014-03-13T20:09:13Z
class:
src/test/java/org/elasticsearch/percolator/ConcurrentPercolatorTests.java
comments:
[TEST] Stabelize ConcurrentPercolatorTests after # shard randomization

time:
2014-03-13T19:40:25Z
class:
src/test/java/org/elasticsearch/search/suggest/SuggestSearchTests.java
comments:
[TEST] Add mapping to use an actual stopword analyzer

This test was added when the default  analyzer was filtering stopwords. But since
1.0 the default analyzer doesn't filter stopwords

time:
2014-03-13T19:23:07Z
class:
comments:
Added static analysis profile to pom.xml

Added pmd, findbug as well as site generation logic to top pom.xml file
Created customized pmd ruleset

time:
2014-03-13T18:19:56Z
class:
src/main/java/org/elasticsearch/common/hash/MurmurHash3.java
src/main/java/org/elasticsearch/common/util/BigArrays.java
src/main/java/org/elasticsearch/common/util/BigByteArray.java
src/main/java/org/elasticsearch/common/util/BloomFilter.java
src/main/java/org/elasticsearch/common/util/ByteArray.java
src/main/java/org/elasticsearch/common/util/UnsafeUtils.java
src/main/java/org/elasticsearch/index/fielddata/MurmurHash3Values.java
src/main/java/org/elasticsearch/index/mapper/DocumentMapperParser.java
src/main/java/org/elasticsearch/index/mapper/MapperBuilders.java
src/main/java/org/elasticsearch/index/mapper/core/Murmur3FieldMapper.java
src/main/java/org/elasticsearch/search/aggregations/AggregationBuilders.java
src/main/java/org/elasticsearch/search/aggregations/AggregationModule.java
src/main/java/org/elasticsearch/search/aggregations/TransportAggregationModule.java
src/main/java/org/elasticsearch/search/aggregations/metrics/cardinality/Cardinality.java
src/main/java/org/elasticsearch/search/aggregations/metrics/cardinality/CardinalityAggregator.java
src/main/java/org/elasticsearch/search/aggregations/metrics/cardinality/CardinalityAggregatorFactory.java
src/main/java/org/elasticsearch/search/aggregations/metrics/cardinality/CardinalityBuilder.java
src/main/java/org/elasticsearch/search/aggregations/metrics/cardinality/CardinalityParser.java
src/main/java/org/elasticsearch/search/aggregations/metrics/cardinality/HyperLogLogPlusPlus.java
src/main/java/org/elasticsearch/search/aggregations/metrics/cardinality/InternalCardinality.java
src/test/java/org/elasticsearch/benchmark/search/aggregations/CardinalityAggregationSearchBenchmark.java
src/test/java/org/elasticsearch/common/hashing/MurmurHash3Tests.java
src/test/java/org/elasticsearch/common/util/BigArraysTests.java
src/test/java/org/elasticsearch/search/aggregations/metrics/CardinalityTests.java
src/test/java/org/elasticsearch/search/aggregations/metrics/cardinality/HyperLogLogPlusPlusTests.java
src/test/java/org/elasticsearch/test/cache/recycler/MockBigArrays.java
comments:
Cardinality aggregation.

This aggregation computes unique term counts using the hyperloglog++ algorithm
which uses linear counting to estimate low cardinalities and hyperloglog on
higher cardinalities.

Since this algorithm works on hashes, it is useful for high-cardinality fields
to store the hash of values directly in the index, which is the purpose of
the new `murmur3` field type. This is less necessary on low-cardinality
string fields because the aggregator is smart enough to only compute the hash
once per unique value per segment thanks to ordinals, or on numeric fields
since hashing them is very fast.

Close #5426
Is this correct?  The code as-written appears to weight positively with increased distance, which I believe is the opposite of what is intended.  For example, if `e` is exactly `rawEstimateData[index]` in the initial lookup then the return value will be `biasData[index]`, but if it is merely very close to it in this branch then returned value will effectively be `biasData[index -1]`.

@llasram You're right, interpolation is backwards here. Would you like to open a pull request to fix it?

Well, I am planning on using Elasticsearch soon, so why not?...  I've opened #13243.


time:
2014-03-13T18:02:47Z
class:
src/main/java/org/elasticsearch/search/aggregations/support/AggregationContext.java
comments:
Remove AggregationContext.cacheRecycler().

time:
2014-03-13T15:15:38Z
class:
src/main/java/org/elasticsearch/common/util/AbstractHash.java
src/main/java/org/elasticsearch/common/util/AbstractPagedHashMap.java
src/main/java/org/elasticsearch/common/util/BytesRefHash.java
src/main/java/org/elasticsearch/common/util/DoubleObjectPagedHashMap.java
src/main/java/org/elasticsearch/common/util/LongHash.java
src/main/java/org/elasticsearch/common/util/LongObjectPagedHashMap.java
src/main/java/org/elasticsearch/percolator/PercolatorService.java
src/main/java/org/elasticsearch/search/aggregations/InternalAggregation.java
src/main/java/org/elasticsearch/search/aggregations/InternalAggregations.java
src/main/java/org/elasticsearch/search/aggregations/bucket/InternalSingleBucketAggregation.java
src/main/java/org/elasticsearch/search/aggregations/bucket/geogrid/InternalGeoHashGrid.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/InternalHistogram.java
src/main/java/org/elasticsearch/search/aggregations/bucket/range/InternalRange.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/DoubleTerms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/InternalTerms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/LongTerms.java
src/main/java/org/elasticsearch/search/controller/SearchPhaseController.java
src/test/java/org/elasticsearch/common/util/DoubleObjectHashMapTests.java
src/test/java/org/elasticsearch/common/util/LongObjectHashMapTests.java
comments:
Make aggregations CacheRecycler-free.

Aggregations were still using CacheRecycler on the reduce phase. They are now
using page-based recycling for both the aggregation phase and the reduce phase.

Close #4929

time:
2014-03-13T14:50:05Z
class:
comments:
"azure vm list" command should be changed to "azure vm image list" in the README.md

In the `readme.md` file, `azure vm list` command should be changed to `azure vm image list`. The former lists all the VMs running in the current Azure subscription and the latter displays list of official available images.

The line is located just below the following line:

`To get a list of official available images, run:`

Closes #5.

time:
2014-03-13T14:35:00Z
class:
comments:
Add plugin release semi-automatic script

Closes #10.

time:
2014-03-13T13:21:15Z
class:
src/main/java/org/elasticsearch/index/query/FuzzyLikeThisQueryParser.java
src/test/java/org/apache/lucene/util/AbstractRandomizedTest.java
src/test/java/org/elasticsearch/index/query/SimpleIndexQueryParserTests.java
comments:
Allow edit distances > 2 on FuzzyLikeThisQuery

Due to a regression edit distances > 2 threw exceptions after unifying
the fuzziness factor in Elasticsearch `1.0`. This commit brings back the
expceted behavior.

Closes #5292

time:
2014-03-13T11:52:41Z
class:
src/test/java/org/elasticsearch/broadcast/BroadcastActionsTests.java
src/test/java/org/elasticsearch/cluster/ClusterHealthTests.java
src/test/java/org/elasticsearch/cluster/ack/AckClusterUpdateSettingsTests.java
src/test/java/org/elasticsearch/cluster/ack/AckTests.java
src/test/java/org/elasticsearch/cluster/allocation/AwarenessAllocationTests.java
src/test/java/org/elasticsearch/cluster/allocation/SimpleAllocationTests.java
src/test/java/org/elasticsearch/flt/FuzzyLikeThisActionTests.java
src/test/java/org/elasticsearch/indices/IndicesOptionsTests.java
src/test/java/org/elasticsearch/indices/fielddata/breaker/CircuitBreakerServiceTests.java
src/test/java/org/elasticsearch/indices/fielddata/breaker/RandomExceptionCircuitBreakerTests.java
src/test/java/org/elasticsearch/indices/mapping/ConcurrentDynamicTemplateTests.java
src/test/java/org/elasticsearch/indices/mapping/SimpleGetFieldMappingsTests.java
src/test/java/org/elasticsearch/indices/settings/UpdateNumberOfReplicasTests.java
src/test/java/org/elasticsearch/indices/stats/SimpleIndexStatsTests.java
src/test/java/org/elasticsearch/indices/template/IndexTemplateFileLoadingTests.java
src/test/java/org/elasticsearch/mlt/MoreLikeThisActionTests.java
src/test/java/org/elasticsearch/percolator/PercolatorTests.java
src/test/java/org/elasticsearch/percolator/RecoveryPercolatorTests.java
src/test/java/org/elasticsearch/percolator/TTLPercolatorTests.java
src/test/java/org/elasticsearch/recovery/FullRollingRestartTests.java
src/test/java/org/elasticsearch/recovery/RecoveryWhileUnderLoadTests.java
src/test/java/org/elasticsearch/recovery/SimpleRecoveryTests.java
src/test/java/org/elasticsearch/search/StressSearchServiceReaperTest.java
src/test/java/org/elasticsearch/search/aggregations/CombiTests.java
src/test/java/org/elasticsearch/search/aggregations/RandomTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/DateHistogramTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/DateRangeTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/DoubleTermsTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/FilterTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/GeoDistanceTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/GeoHashGridTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/GlobalTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/HistogramTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/IPv4RangeTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/LongTermsTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/MinDocCountTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/MissingTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/NaNSortingTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/NestedTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/RangeTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/ShardReduceTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/ShardSizeTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/StringTermsTests.java
src/test/java/org/elasticsearch/search/aggregations/metrics/AbstractNumericTests.java
src/test/java/org/elasticsearch/search/aggregations/metrics/ValueCountTests.java
src/test/java/org/elasticsearch/search/basic/SearchWithRandomExceptionsTests.java
src/test/java/org/elasticsearch/search/basic/TransportSearchFailuresTests.java
src/test/java/org/elasticsearch/search/facet/SimpleFacetsTests.java
src/test/java/org/elasticsearch/search/functionscore/RandomScoreFunctionTests.java
src/test/java/org/elasticsearch/search/preference/SearchPreferenceTests.java
src/test/java/org/elasticsearch/search/rescore/QueryRescorerTests.java
src/test/java/org/elasticsearch/search/suggest/CompletionSuggestSearchTests.java
src/test/java/org/elasticsearch/search/suggest/ContextSuggestSearchTests.java
src/test/java/org/elasticsearch/search/suggest/SuggestSearchTests.java
src/test/java/org/elasticsearch/snapshots/SharedClusterSnapshotRestoreTests.java
src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java
src/test/java/org/elasticsearch/test/TestCluster.java
src/test/java/org/elasticsearch/ttl/SimpleTTLTests.java
src/test/java/org/elasticsearch/versioning/ConcurrentDocumentOperationTests.java
comments:
[TEST] Randomized number of replicas used for indices created during tests

Introduced two levels of randomization for the number of replicas when running tests:

1) through the existing random index template, which now sets a random number of replicas that can either be 0 or 1 that is shared across all the indices created in the same test method unless overwritten

2)  through createIndex and prepareCreate methods, between 0 and the number of data nodes available, similar to what happens using the indexSettings method, which changes for every createIndex or prepareCreate unless overwritten (overwrites index template for what concerns the number of replicas)

Added the following facilities to deal with the random number of replicas:

- made it possible to retrieve how many data nodes are available in the `TestCluster`
- added common methods similar to indexSettings, to be used in combination with createIndex and prepareCreate method and explicitly control the second level of randomization: numberOfReplicas, minimumNumberOfReplicas and maximumNumberOfReplicas

Tests that specified the number of replicas have been reviewed:
- removed manual replicas randomization where present, replaced with ordinary one that's now available
- adapted tests that didn't need a specific number of replicas to the new random behaviour
- also done some more cleanup, used common methods like assertAcked, ensureGreen, refresh, flush and refreshAndFlush where possible

time:
2014-03-13T10:24:46Z
class:
src/main/java/org/apache/lucene/analysis/PrefixAnalyzer.java
src/main/java/org/apache/lucene/search/suggest/analyzing/XAnalyzingSuggester.java
src/main/java/org/apache/lucene/search/suggest/analyzing/XFuzzySuggester.java
src/main/java/org/elasticsearch/common/geo/GeoHashUtils.java
src/main/java/org/elasticsearch/common/geo/GeoPoint.java
src/main/java/org/elasticsearch/common/geo/GeohashPathIterator.java
src/main/java/org/elasticsearch/common/xcontent/XContentBuilder.java
src/main/java/org/elasticsearch/index/mapper/core/CompletionFieldMapper.java
src/main/java/org/elasticsearch/index/query/GeohashCellFilter.java
src/main/java/org/elasticsearch/search/suggest/SuggestBuilder.java
src/main/java/org/elasticsearch/search/suggest/SuggestionSearchContext.java
src/main/java/org/elasticsearch/search/suggest/completion/AnalyzingCompletionLookupProvider.java
src/main/java/org/elasticsearch/search/suggest/completion/Completion090PostingsFormat.java
src/main/java/org/elasticsearch/search/suggest/completion/CompletionSuggestParser.java
src/main/java/org/elasticsearch/search/suggest/completion/CompletionSuggestionContext.java
src/main/java/org/elasticsearch/search/suggest/completion/CompletionTokenStream.java
src/main/java/org/elasticsearch/search/suggest/context/CategoryContextMapping.java
src/main/java/org/elasticsearch/search/suggest/context/ContextBuilder.java
src/main/java/org/elasticsearch/search/suggest/context/ContextMapping.java
src/main/java/org/elasticsearch/search/suggest/context/GeolocationContextMapping.java
src/test/java/org/elasticsearch/search/geo/GeoFilterTests.java
src/test/java/org/elasticsearch/search/suggest/ContextSuggestSearchTests.java
src/test/java/org/elasticsearch/search/suggest/completion/AnalyzingCompletionLookupProviderV1.java
src/test/java/org/elasticsearch/search/suggest/completion/CompletionPostingsFormatTest.java
src/test/java/org/elasticsearch/test/hamcrest/ElasticsearchGeoAssertions.java
comments:
ContextSuggester
================

This commit extends the `CompletionSuggester` by context
informations. In example such a context informations can
be a simple string representing a category reducing the
suggestions in order to this category.

Three base implementations of these context informations
have been setup in this commit.

- a Category Context
- a Geo Context

All the mapping for these context informations are
specified within a context field in the completion
field that should use this kind of information.

time:
2014-03-13T10:21:07Z
class:
src/main/java/org/elasticsearch/percolator/PercolatorService.java
src/main/java/org/elasticsearch/percolator/QueryCollector.java
comments:
Invoke postCollection on aggregation collectors.
Also cleanup how facet and aggs collector are used inside the QueryCollector

Closes #5387

time:
2014-03-13T08:35:08Z
class:
src/test/java/org/elasticsearch/discovery/DiscoveryTests.java
comments:
[TESTS] Added AwaitsFix

time:
2014-03-13T08:25:05Z
class:
src/main/java/org/elasticsearch/discovery/zen/ping/unicast/UnicastZenPing.java
src/test/java/org/elasticsearch/cluster/ZenUnicastDiscoveryTests.java
comments:
For unicast zen discovery don't overwrite a ping response for a node if the previous ping response has a set master and the current response hasn't.

Per single main ping request we maintain the received ping response per node. Each node level ping response is mapped into that. If from a previous node level ping request the response has already been set for a node, it will be overwritten. We give higher value to the latest response. This change makes sure that this doesn't happen if the previous response has a set master and the current response hasn't a set master. Otherwise a node will lose the fact that another node has elected itself as master, the result of that would be that there would multiple master nodes in a single cluster.

Closes #5413

time:
2014-03-13T08:05:25Z
class:
comments:
[DOCS] Various aggregation doc fixes

time:
2014-03-13T07:44:17Z
class:
comments:
[DOCS] Added spring data elasticsearch integration

time:
2014-03-13T07:11:01Z
class:
src/test/java/org/elasticsearch/discovery/DiscoveryTests.java
comments:
[TESTS] Fix incorrect discovery options.

time:
2014-03-13T02:47:14Z
class:
src/main/java/org/elasticsearch/indices/fielddata/breaker/InternalCircuitBreakerService.java
comments:
compare with .bytes() instead of ByteSizeValue.equals() in breaker service

time:
2014-03-12T23:11:06Z
class:
src/main/java/org/elasticsearch/plugins/PluginsService.java
comments:
Disable by default plugins isolation

time:
2014-03-12T14:06:39Z
class:
comments:
[Build] Remove XReferenceManager and XSearcherManager from forbidden-apis' exclude list.

These classes have been removed on the upgrade to Lucene 4.7.

time:
2014-03-12T14:06:39Z
class:
src/main/java/org/elasticsearch/search/facet/terms/strings/TermsStringOrdinalsFacetExecutor.java
comments:
[Test] Fix missing release.

time:
2014-03-12T11:58:37Z
class:
src/test/java/org/elasticsearch/search/stats/SearchStatsTests.java
src/test/java/org/elasticsearch/test/TestCluster.java
comments:
[TEST] stabelize SearchStatsTests

time:
2014-03-12T11:19:17Z
class:
comments:
prepare for next development iteration

time:
2014-03-12T11:14:09Z
class:
comments:
prepare release elasticsearch-cloud-gce-2.0.0

time:
2014-03-12T11:03:27Z
class:
src/main/java/org/elasticsearch/discovery/gce/GceUnicastHostsProvider.java
src/test/java/org/elasticsearch/cloud/gce/AbstractGceTest.java
src/test/java/org/elasticsearch/cloud/gce/tests/GceAbstractTest.java
src/test/java/org/elasticsearch/cloud/gce/tests/GceDifferentTagsTest.java
src/test/java/org/elasticsearch/cloud/gce/tests/GceSameTagsTest.java
src/test/java/org/elasticsearch/discovery/gce/AbstractGceComputeServiceTest.java
src/test/java/org/elasticsearch/discovery/gce/GceComputeServiceAbstractMock.java
src/test/java/org/elasticsearch/discovery/gce/GceComputeServiceTwoNodesDifferentTagsMock.java
src/test/java/org/elasticsearch/discovery/gce/GceComputeServiceTwoNodesSameTagsMock.java
src/test/java/org/elasticsearch/discovery/gce/GceDifferentTagsNoTagTest.java
src/test/java/org/elasticsearch/discovery/gce/GceDifferentTagsOneTagTest.java
src/test/java/org/elasticsearch/discovery/gce/GceDifferentTagsTwoTagsTest.java
src/test/java/org/elasticsearch/discovery/gce/GceSameTagsNoTagTest.java
src/test/java/org/elasticsearch/discovery/gce/GceSameTagsOneTagTest.java
src/test/java/org/elasticsearch/discovery/gce/GceSameTagsTwoTagsTest.java
src/test/java/org/elasticsearch/discovery/gce/PropertiesHelper.java
src/test/java/org/elasticsearch/gce/itest/GceSimpleITest.java
comments:
Move tests to elasticsearch test framework

Closes #16.

time:
2014-03-12T09:50:22Z
class:
src/main/java/org/elasticsearch/index/store/support/AbstractIndexStore.java
comments:
Corrected issue with throttle type setting not respected upon updates

time:
2014-03-12T09:30:18Z
class:
src/main/java/org/elasticsearch/tribe/TribeService.java
src/test/java/org/elasticsearch/tribe/TribeTests.java
comments:
Blocking writes on a tribe node creates a "blocks" tribe
fixes #5389

time:
2014-03-12T09:27:57Z
class:
src/test/java/org/elasticsearch/percolator/ConcurrentPercolatorTests.java
comments:
Keep track of the exceptions instead of just flagging that an exception has occured.

time:
2014-03-12T07:51:11Z
class:
src/main/java/org/elasticsearch/index/search/child/TopChildrenQuery.java
src/test/java/org/elasticsearch/search/child/SimpleChildQuerySearchTests.java
comments:
Added more logging

time:
2014-03-12T00:48:22Z
class:
src/main/java/org/apache/lucene/queries/XTermsFilter.java
src/main/java/org/elasticsearch/index/mapper/MapperService.java
src/main/java/org/elasticsearch/index/mapper/core/AbstractFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/internal/IdFieldMapper.java
src/main/java/org/elasticsearch/index/mapper/internal/ParentFieldMapper.java
src/main/java/org/elasticsearch/index/query/IdsFilterParser.java
src/main/java/org/elasticsearch/index/query/IdsQueryParser.java
src/main/java/org/elasticsearch/index/query/TermsFilterParser.java
src/test/java/org/elasticsearch/common/lucene/search/TermsFilterTests.java
src/test/java/org/elasticsearch/common/lucene/search/XBooleanFilterLuceneTests.java
src/test/java/org/elasticsearch/index/query/SimpleIndexQueryParserTests.java
comments:
Use patched version of TermsFilter to prevent using wrong cached results

See LUCENE-5502

Closes #5363

time:
2014-03-11T23:55:17Z
class:
src/test/java/org/elasticsearch/search/query/SimpleQueryTests.java
comments:
[TEST] fixed SimpleQueryTests#testMultiMatchQuery check for shard failures

It can happen that not all shards are ready, thus we won't have a total failure, but we do need to check that we have at least a failure. Checked also the message of the failure.

time:
2014-03-11T21:17:36Z
class:
src/test/java/org/elasticsearch/snapshots/AbstractSnapshotTests.java
comments:
[TEST] Make sure that a snapshot is completed before trying to modify repository

time:
2014-03-11T16:45:58Z
class:
comments:
Update to elasticsearch 1.0.0

Closes #14.

time:
2014-03-11T16:39:10Z
class:
comments:
Add plugin release semi-automatic script

Closes #13.

time:
2014-03-11T10:36:22Z
class:
src/test/java/org/elasticsearch/search/stats/SearchStatsTests.java
src/test/java/org/elasticsearch/test/hamcrest/ElasticsearchAssertions.java
comments:
[TEST] Beef up SearchStatsTests

time:
2014-03-11T10:36:22Z
class:
src/test/java/org/elasticsearch/search/stats/SearchStatsTests.java
comments:
[TEST] Fix SearchStatsTests to have all shards allocated

If randomization brings up a single shard per index in this test
we might run our searches on only one index which causes the assertions
to fail afterwards that's why we need to wait until everything is alloated.

time:
2014-03-11T10:32:58Z
class:
comments:
Add docs for plugin isolation

time:
2014-03-11T09:45:07Z
class:
src/test/java/org/elasticsearch/test/TestCluster.java
comments:
Add randomized plugin isolation to test infrastructure

fix #5296

time:
2014-03-11T06:01:02Z
class:
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
comments:
Changed debug log to warn for when IW#rollback fails with an exception other than AlreadyClosedException

time:
2014-03-11T00:24:04Z
class:
src/main/java/org/elasticsearch/index/snapshots/blobstore/BlobStoreIndexShardRepository.java
comments:
Improve speed of running snapshot cancelation

The delete snapshot operation on a running snapshot should cancel the snapshot execution. However, it interrupts the snapshot only when currently running snapshot files are completely copied, which might take a long time for large files.

Closes #5242

time:
2014-03-10T22:24:57Z
class:
src/test/java/org/elasticsearch/test/rest/parser/GreaterThanEqualToParser.java
src/test/java/org/elasticsearch/test/rest/parser/LessThanOrEqualToParser.java
src/test/java/org/elasticsearch/test/rest/parser/RestTestSuiteParseContext.java
src/test/java/org/elasticsearch/test/rest/section/GreaterThanEqualToAssertion.java
src/test/java/org/elasticsearch/test/rest/section/LessThanOrEqualToAssertion.java
src/test/java/org/elasticsearch/test/rest/support/Features.java
comments:
Merge pull request #5360 from aleph-zero/issue-111

REST Testing framework enhancement

time:
2014-03-10T22:08:43Z
class:
src/test/java/org/elasticsearch/test/rest/parser/GreaterThanEqualToParser.java
src/test/java/org/elasticsearch/test/rest/parser/LessThanOrEqualToParser.java
src/test/java/org/elasticsearch/test/rest/parser/RestTestSuiteParseContext.java
src/test/java/org/elasticsearch/test/rest/section/GreaterThanEqualToAssertion.java
src/test/java/org/elasticsearch/test/rest/section/LessThanOrEqualToAssertion.java
src/test/java/org/elasticsearch/test/rest/support/Features.java
comments:
REST Testing framework enhancement

Adding operators 'lte' and 'gte' to our REST test framework. These
operators test for, respectively, less-than-or-equal and
greater-than-or-equal.

time:
2014-03-10T20:07:17Z
class:
src/main/java/org/elasticsearch/action/bulk/TransportShardBulkAction.java
src/main/java/org/elasticsearch/action/delete/DeleteRequest.java
src/main/java/org/elasticsearch/action/delete/TransportDeleteAction.java
src/main/java/org/elasticsearch/action/delete/index/TransportShardDeleteAction.java
src/main/java/org/elasticsearch/action/index/IndexRequest.java
src/main/java/org/elasticsearch/action/index/TransportIndexAction.java
src/main/java/org/elasticsearch/action/update/UpdateHelper.java
src/main/java/org/elasticsearch/action/update/UpdateRequest.java
src/main/java/org/elasticsearch/index/VersionType.java
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
src/main/java/org/elasticsearch/index/shard/service/InternalIndexShard.java
src/main/java/org/elasticsearch/index/translog/Translog.java
src/test/java/org/elasticsearch/index/VersionTypeTests.java
src/test/java/org/elasticsearch/index/engine/internal/InternalEngineTests.java
src/test/java/org/elasticsearch/versioning/SimpleVersioningTests.java
comments:
Introduced VersionType.FORCE & VersionType.EXTERNAL_GTE

Also added "external_gt" as an alias name for VersionType.EXTERNAL , accessible for the rest layer.

Closes #4213 , Closes #2946

time:
2014-03-10T18:39:34Z
class:
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/DateHistogramBuilder.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/DateHistogramParser.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/InternalDateHistogram.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/InternalHistogram.java
src/test/java/org/elasticsearch/search/aggregations/bucket/DateHistogramTests.java
comments:
Fixed a bug in date_histogram aggregation parsing

 - pre_zone_adjust_large_interval was not parsed properly
 - added tests for pre_zone and pre_zone_adjust_large_interval
 - changed DateHistogram#getBucketByKey(String) to support date formats (next to numeric strings)
 - added randomized testing for fetching the bucket by key in date_histogram tests
 - added missing "format" support in DateHistogramBuilder

 Closes #5375

time:
2014-03-10T17:35:29Z
class:
src/test/java/org/elasticsearch/search/facet/SimpleFacetsTests.java
comments:
[TEST] Raise shardSize parameter if number of shards is > 5

time:
2014-03-10T16:50:22Z
class:
src/test/java/org/elasticsearch/count/query/SimpleQueryTests.java
src/test/java/org/elasticsearch/search/query/SimpleQueryTests.java
comments:
[TEST] fixed SimpleQueryTests#testDateRangeInQueryString to specify the mappings upfront and wait for green

time:
2014-03-10T16:39:27Z
class:
src/test/java/org/elasticsearch/search/facet/SimpleFacetsTests.java
comments:
[TEST] Raise shardSize parameter if number of shards is > 5

time:
2014-03-10T12:21:54Z
class:
src/test/java/org/elasticsearch/get/GetActionTests.java
comments:
[TEST] Moving mapping creation to create index call, this will make sure that in the test the mapping is always available on all nodes.

time:
2014-03-10T12:01:52Z
class:
src/test/java/org/elasticsearch/action/termvector/AbstractTermVectorTests.java
src/test/java/org/elasticsearch/action/termvector/GetTermVectorCheckDocFreqTests.java
src/test/java/org/elasticsearch/action/termvector/GetTermVectorTests.java
src/test/java/org/elasticsearch/action/termvector/MultiTermVectorsTests.java
src/test/java/org/elasticsearch/aliases/IndexAliasesTests.java
src/test/java/org/elasticsearch/broadcast/BroadcastActionsTests.java
src/test/java/org/elasticsearch/cluster/MinimumMasterNodesTests.java
src/test/java/org/elasticsearch/cluster/NoMasterNodeTests.java
src/test/java/org/elasticsearch/cluster/SpecificMasterNodesTests.java
src/test/java/org/elasticsearch/cluster/UpdateSettingsValidationTests.java
src/test/java/org/elasticsearch/cluster/ack/AckClusterUpdateSettingsTests.java
src/test/java/org/elasticsearch/cluster/ack/AckTests.java
src/test/java/org/elasticsearch/cluster/allocation/AwarenessAllocationTests.java
src/test/java/org/elasticsearch/cluster/allocation/SimpleAllocationTests.java
src/test/java/org/elasticsearch/codecs/CodecTests.java
src/test/java/org/elasticsearch/count/query/SimpleQueryTests.java
src/test/java/org/elasticsearch/count/simple/SimpleCountTests.java
src/test/java/org/elasticsearch/deleteByQuery/DeleteByQueryTests.java
src/test/java/org/elasticsearch/document/BulkTests.java
src/test/java/org/elasticsearch/document/DocumentActionsTests.java
src/test/java/org/elasticsearch/explain/ExplainActionTests.java
src/test/java/org/elasticsearch/flt/FuzzyLikeThisActionTests.java
src/test/java/org/elasticsearch/gateway/fs/IndexGatewayTests.java
src/test/java/org/elasticsearch/gateway/local/LocalGatewayIndexStateTests.java
src/test/java/org/elasticsearch/gateway/local/QuorumLocalGatewayTests.java
src/test/java/org/elasticsearch/gateway/local/SimpleRecoveryLocalGatewayTests.java
src/test/java/org/elasticsearch/index/fielddata/FieldDataFilterIntegrationTests.java
src/test/java/org/elasticsearch/indices/fielddata/breaker/RandomExceptionCircuitBreakerTests.java
src/test/java/org/elasticsearch/indices/mapping/ConcurrentDynamicTemplateTests.java
src/test/java/org/elasticsearch/indices/mapping/SimpleGetFieldMappingsTests.java
src/test/java/org/elasticsearch/indices/mapping/UpdateMappingTests.java
src/test/java/org/elasticsearch/indices/settings/UpdateNumberOfReplicasTests.java
src/test/java/org/elasticsearch/indices/state/SimpleIndexStateTests.java
src/test/java/org/elasticsearch/indices/stats/SimpleIndexStatsTests.java
src/test/java/org/elasticsearch/indices/template/IndexTemplateFileLoadingTests.java
src/test/java/org/elasticsearch/indices/warmer/LocalGatewayIndicesWarmerTests.java
src/test/java/org/elasticsearch/indices/warmer/SimpleIndicesWarmerTests.java
src/test/java/org/elasticsearch/mget/SimpleMgetTests.java
src/test/java/org/elasticsearch/nested/SimpleNestedTests.java
src/test/java/org/elasticsearch/percolator/ConcurrentPercolatorTests.java
src/test/java/org/elasticsearch/percolator/MultiPercolatorTests.java
src/test/java/org/elasticsearch/percolator/PercolatorTests.java
src/test/java/org/elasticsearch/percolator/RecoveryPercolatorTests.java
src/test/java/org/elasticsearch/recovery/RecoveryWhileUnderLoadTests.java
src/test/java/org/elasticsearch/recovery/SimpleRecoveryTests.java
src/test/java/org/elasticsearch/river/RiverTests.java
src/test/java/org/elasticsearch/routing/AliasRoutingTests.java
src/test/java/org/elasticsearch/routing/SimpleRoutingTests.java
src/test/java/org/elasticsearch/script/IndexLookupTests.java
src/test/java/org/elasticsearch/search/StressSearchServiceReaperTest.java
src/test/java/org/elasticsearch/search/aggregations/CombiTests.java
src/test/java/org/elasticsearch/search/aggregations/RandomTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/DateHistogramTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/DateRangeTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/DoubleTermsTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/FilterTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/GeoDistanceTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/GeoHashGridTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/GlobalTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/HistogramTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/IPv4RangeTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/LongTermsTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/MinDocCountTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/MissingTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/NestedTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/RangeTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/ShardReduceTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/ShardSizeTermsTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/ShardSizeTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/StringTermsTests.java
src/test/java/org/elasticsearch/search/aggregations/metrics/AbstractNumericTests.java
src/test/java/org/elasticsearch/search/aggregations/metrics/ValueCountTests.java
src/test/java/org/elasticsearch/search/basic/SearchWhileCreatingIndexTests.java
src/test/java/org/elasticsearch/search/basic/SearchWithRandomExceptionsTests.java
src/test/java/org/elasticsearch/search/basic/TransportSearchFailuresTests.java
src/test/java/org/elasticsearch/search/basic/TransportTwoNodesSearchTests.java
src/test/java/org/elasticsearch/search/child/SimpleChildQuerySearchTests.java
src/test/java/org/elasticsearch/search/facet/ExtendedFacetsTests.java
src/test/java/org/elasticsearch/search/facet/SimpleFacetsTests.java
src/test/java/org/elasticsearch/search/facet/terms/ShardSizeTermsFacetTests.java
src/test/java/org/elasticsearch/search/facet/terms/UnmappedFieldsTermsFacetsTests.java
src/test/java/org/elasticsearch/search/facet/termsstats/ShardSizeTermsStatsFacetTests.java
src/test/java/org/elasticsearch/search/fields/SearchFieldsTests.java
src/test/java/org/elasticsearch/search/functionscore/DecayFunctionScoreTests.java
src/test/java/org/elasticsearch/search/functionscore/RandomScoreFunctionTests.java
src/test/java/org/elasticsearch/search/geo/GeoBoundingBoxTests.java
src/test/java/org/elasticsearch/search/geo/GeoDistanceTests.java
src/test/java/org/elasticsearch/search/highlight/HighlighterSearchTests.java
src/test/java/org/elasticsearch/search/indicesboost/SimpleIndicesBoostSearchTests.java
src/test/java/org/elasticsearch/search/preference/SearchPreferenceTests.java
src/test/java/org/elasticsearch/search/query/MultiMatchQueryTests.java
src/test/java/org/elasticsearch/search/query/SimpleQueryTests.java
src/test/java/org/elasticsearch/search/rescore/QueryRescorerTests.java
src/test/java/org/elasticsearch/search/scan/SearchScanScrollingTests.java
src/test/java/org/elasticsearch/search/scan/SearchScanTests.java
src/test/java/org/elasticsearch/search/scriptfilter/ScriptFilterSearchTests.java
src/test/java/org/elasticsearch/search/simple/SimpleSearchTests.java
src/test/java/org/elasticsearch/search/sort/SimpleSortTests.java
src/test/java/org/elasticsearch/search/suggest/CompletionSuggestSearchTests.java
src/test/java/org/elasticsearch/search/suggest/SuggestSearchTests.java
src/test/java/org/elasticsearch/search/timeout/SearchTimeoutTests.java
src/test/java/org/elasticsearch/snapshots/SharedClusterSnapshotRestoreTests.java
src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java
src/test/java/org/elasticsearch/test/hamcrest/ElasticsearchAssertions.java
src/test/java/org/elasticsearch/ttl/SimpleTTLTests.java
src/test/java/org/elasticsearch/update/UpdateByNativeScriptTests.java
src/test/java/org/elasticsearch/validate/SimpleValidateQueryTests.java
comments:
[TEST] Randomized number of shards used for indices created during tests

Introduced two levels of randomization for the number of shards (between 1 and 10) when running tests:

1) through the existing random index template, which now sets a random number of shards that is shared across all the indices created in the same test method unless overwritten

2) through `createIndex` and `prepareCreate` methods, similar to what happens using the `indexSettings` method, which changes for every `createIndex` or `prepareCreate` unless overwritten (overwrites index template for what concerns the number of shards)

Added the following facilities to deal with the random number of shards:
- `getNumShards` to retrieve the number of shards of a given existing index, useful when doing comparisons based on the number of shards and we can avoid specifying a static number. The method returns an object containing the number of primaries, number of replicas and the total number of shards for the existing index

- added `assertFailures` that checks that a shard failure happened during a search request, either partial failure or total (all shards failed). Checks also the error code and the error message related to the failure. This is needed as without knowing the number of shards upfront, when simulating errors we can run into either partial (search returns partial results and failures) or total failures (search returns an error)

- added common methods similar to `indexSettings`, to be used in combination with `createIndex` and `prepareCreate` method and explicitly control the second level of randomization: `numberOfShards`, `minimumNumberOfShards` and `maximumNumberOfShards`. Added also `numberOfReplicas` despite the number of replicas is not randomized (default not specified but can be overwritten by tests)

Tests that specified the number of shards have been reviewed and the results follow:
- removed number_of_shards in node settings, ignored anyway as it would be overwritten by both mechanisms above
- remove specific number of shards when not needed
- removed manual shards randomization where present, replaced with ordinary one that's now available
- adapted tests that didn't need a specific number of shards to the new random behaviour
- fixed a couple of test bugs (e.g. 3 levels parent child test could only work on a single shard as the routing key used for grand-children wasn't correct)
- also done some cleanup, shared code through shard size facets and aggs tests and used common methods like `assertAcked`, `ensureGreen`, `refresh`, `flush` and `refreshAndFlush` where possible
- made sure that `indexSettings()` is always used as a basis when using `prepareCreate` to inject specific settings
- converted indexRandom(false, ...) + refresh to indexRandom(true, ...)

time:
2014-03-10T11:22:41Z
class:
src/main/java/org/elasticsearch/index/query/GeoPolygonFilterParser.java
src/test/java/org/elasticsearch/index/query/SimpleIndexQueryParserTests.java
comments:
Improve error detection in geo_filter parsing

Relates to #5370

time:
2014-03-10T08:27:44Z
class:
comments:
[DOCS] Add `coming` tag to multiple rescores

Closes #5365

time:
2014-03-10T06:53:02Z
class:
src/main/java/org/elasticsearch/percolator/MultiDocumentPercolatorIndex.java
src/main/java/org/elasticsearch/percolator/PercolatorIndex.java
src/main/java/org/elasticsearch/percolator/PercolatorService.java
src/main/java/org/elasticsearch/percolator/SingleDocumentPercolatorIndex.java
comments:
Also make use of the thread local memory reuse for a document being percolated with nested objects.
The memory index will only be reused for the root doc, since most of the times that will be the biggest document.

time:
2014-03-10T04:59:24Z
class:
src/main/java/org/elasticsearch/action/percolate/PercolateShardResponse.java
src/main/java/org/elasticsearch/percolator/PercolateContext.java
src/main/java/org/elasticsearch/percolator/PercolatorService.java
src/main/java/org/elasticsearch/percolator/QueryCollector.java
src/test/java/org/elasticsearch/percolator/PercolatorTests.java
comments:
Don't throw UOE in PercolateContext#from and #size
Create mapping in PercolatorTests#testPercolateSorting_unsupportedField in create index call instead of lazily via index call.

time:
2014-03-09T22:40:43Z
class:
comments:
jackson: upgrade to 2.3.2

time:
2014-03-09T21:56:09Z
class:
comments:
mvel: upgrade to 2.1.9

time:
2014-03-09T18:45:16Z
class:
comments:
[DOCS] Updated the Perl docs

time:
2014-03-09T09:51:26Z
class:
comments:
Add plugin version in es-plugin.properties

With https://github.com/elasticsearch/elasticsearch/issues/2784, we can now add plugin version in `es-plugin.properties` file.

It will only be used with elasticsearch 1.0.0 and upper. No need to push it in 1.x branch.

Closes #22.

time:
2014-03-09T09:46:59Z
class:
comments:
Add plugin version in es-plugin.properties

With https://github.com/elasticsearch/elasticsearch/issues/2784, we can now add plugin version in `es-plugin.properties` file.

It will only be used with elasticsearch 1.0.0 and upper. No need to push it in 1.x branch.

Closes #16.

time:
2014-03-09T09:43:11Z
class:
comments:
Add plugin version in es-plugin.properties

With https://github.com/elasticsearch/elasticsearch/issues/2784, we can now add plugin version in `es-plugin.properties` file.

It will only be used with elasticsearch 1.0.0 and upper. No need to push it in 1.x branch.

Closes #21.

time:
2014-03-09T09:39:23Z
class:
comments:
Add plugin version in es-plugin.properties

With https://github.com/elasticsearch/elasticsearch/issues/2784, we can now add plugin version in `es-plugin.properties` file.

It will only be used with elasticsearch 1.0.0 and upper. No need to push it in 1.x branch.

Closes #26.

time:
2014-03-07T23:30:43Z
class:
src/main/java/org/elasticsearch/index/fielddata/RamAccountingTermsEnum.java
comments:
Increase RamAccountingTermsEnum flush size from 1mb to 5mb

Reduces the number of logs when TRACE logging is turned on for the
circuit breaker

time:
2014-03-07T22:59:20Z
class:
comments:
Adjusted local repository policy

When running plugin test, set local repository update policy to always.

time:
2014-03-07T19:21:43Z
class:
src/main/java/org/elasticsearch/rest/action/cat/RestCatAction.java
comments:
Display all available endpoints by default at /_cat

Closes #5106

time:
2014-03-07T16:41:37Z
class:
comments:
prepare for next development iteration

time:
2014-03-07T16:37:59Z
class:
comments:
prepare release elasticsearch-lang-python-2.0.0

time:
2014-03-07T16:34:04Z
class:
comments:
Add documentation

Closes #2.

time:
2014-03-07T16:23:26Z
class:
src/test/java/org/elasticsearch/script/python/PythonScriptSearchTests.java
comments:
Update to elasticsearch 1.0.0

Closes #10.

time:
2014-03-07T16:19:30Z
class:
comments:
Add plugin version in es-plugin.properties

With https://github.com/elasticsearch/elasticsearch/issues/2784, we can now add plugin version in `es-plugin.properties` file.

It will only be used with elasticsearch 1.0.0 and upper. No need to push it in 1.x branch.

Closes #9.

time:
2014-03-07T16:17:47Z
class:
comments:
Add plugin release semi-automatic script

Closes #8.

time:
2014-03-07T15:42:29Z
class:
src/test/java/org/elasticsearch/script/javascript/JavaScriptScriptSearchTests.java
comments:
Remove `_source.obj1`

Related to #14.

time:
2014-03-07T15:40:46Z
class:
comments:
Add Javascript examples

Closes #8.

time:
2014-03-07T15:05:41Z
class:
comments:
Update to elasticsearch 1.0.1 (Lucene 4.7.0)

Closes #12.

time:
2014-03-07T14:48:49Z
class:
src/test/java/org/elasticsearch/script/javascript/JavaScriptScriptSearchTests.java
comments:
Update to elasticsearch 1.0.0

Closes #14

time:
2014-03-07T14:43:37Z
class:
comments:
Add plugin version in es-plugin.properties

With https://github.com/elasticsearch/elasticsearch/issues/2784, we can now add plugin version in `es-plugin.properties` file.

It will only be used with elasticsearch 1.0.0 and upper. No need to push it in 1.x branch.

Closes #16.

time:
2014-03-07T14:41:46Z
class:
comments:
Add plugin release semi-automatic script

Closes #15.

time:
2014-03-07T13:24:58Z
class:
comments:
[DOCS] Multiple doc fixes

Closes #5047

time:
2014-03-07T09:10:19Z
class:
comments:
Fix small typo in percentiles doc

time:
2014-03-07T09:03:15Z
class:
comments:
[DOC] The percentiles aggregation is coming in 1.1.0.

time:
2014-03-07T08:35:49Z
class:
src/test/java/org/elasticsearch/test/rest/spec/RestApiParser.java
src/test/java/org/elasticsearch/test/rest/test/RestApiParserFailingTests.java
comments:
[TEST] Replaced RestApiParser assertions with exceptions for better error messages

time:
2014-03-06T22:46:12Z
class:
comments:
Added plug-in test hooks

time:
2014-03-06T16:02:14Z
class:
src/main/java/org/elasticsearch/action/admin/cluster/health/ClusterHealthRequest.java
src/main/java/org/elasticsearch/action/admin/cluster/reroute/TransportClusterRerouteAction.java
src/main/java/org/elasticsearch/action/admin/cluster/settings/TransportClusterUpdateSettingsAction.java
src/main/java/org/elasticsearch/cluster/service/PendingClusterTask.java
src/main/java/org/elasticsearch/common/Priority.java
src/main/java/org/elasticsearch/discovery/zen/ZenDiscovery.java
src/test/java/org/elasticsearch/cluster/ClusterServiceTests.java
src/test/java/org/elasticsearch/common/util/concurrent/PrioritizedExecutorsTests.java
comments:
Introduced a new IMMEDIATE priority - higher than URGENT

* applied to cluster update settings, reroute, node join/leave events, node failure

Closes #5062

time:
2014-03-06T14:52:54Z
class:
src/test/java/org/elasticsearch/index/engine/internal/InternalEngineIntegrationTest.java
comments:
since we no longer have bytebuffer dir, this test is not needed

time:
2014-03-06T11:23:51Z
class:
src/test/java/org/elasticsearch/indices/analyze/AnalyzeActionTests.java
comments:
[TEST] removed explicit index deletion from AnalyzeActionTests, more ensureGreen

time:
2014-03-06T11:23:51Z
class:
src/main/java/org/elasticsearch/action/admin/indices/analyze/AnalyzeRequest.java
src/main/java/org/elasticsearch/action/admin/indices/analyze/AnalyzeRequestBuilder.java
src/main/java/org/elasticsearch/action/admin/indices/analyze/TransportAnalyzeAction.java
src/main/java/org/elasticsearch/rest/action/admin/indices/analyze/RestAnalyzeAction.java
src/test/java/org/elasticsearch/indices/analyze/AnalyzeActionTests.java
comments:
Added support for char filters in the analyze API

Closes #5148

time:
2014-03-06T11:16:01Z
class:
comments:
[TESTS] Fixed YAML in put_templates test

time:
2014-03-06T10:26:49Z
class:
src/main/java/org/elasticsearch/action/admin/indices/create/CreateIndexRequest.java
src/main/java/org/elasticsearch/action/admin/indices/create/CreateIndexRequestBuilder.java
comments:
Improved how aliases get parsed in create index

Added also CreateIndexRequest#aliases(BytesReference) method

time:
2014-03-06T10:11:07Z
class:
src/main/java/org/elasticsearch/action/admin/indices/template/put/PutIndexTemplateRequest.java
src/main/java/org/elasticsearch/action/admin/indices/template/put/PutIndexTemplateRequestBuilder.java
src/main/java/org/elasticsearch/action/admin/indices/template/put/TransportPutIndexTemplateAction.java
src/main/java/org/elasticsearch/cluster/metadata/AliasMetaData.java
src/main/java/org/elasticsearch/cluster/metadata/AliasValidator.java
src/main/java/org/elasticsearch/cluster/metadata/IndexTemplateMetaData.java
src/main/java/org/elasticsearch/cluster/metadata/MetaDataCreateIndexService.java
src/main/java/org/elasticsearch/cluster/metadata/MetaDataIndexTemplateService.java
src/test/java/org/elasticsearch/cluster/metadata/ToAndFromJsonMetaDataTests.java
src/test/java/org/elasticsearch/indices/template/IndexTemplateFileLoadingTests.java
src/test/java/org/elasticsearch/indices/template/SimpleIndexTemplateTests.java
comments:
Added support for aliases to index templates

Adapted existing PR (#2739) to updated code (post #4920), added tests and docs (@javanna)

Closes #1825

time:
2014-03-06T10:08:42Z
class:
src/main/java/org/elasticsearch/action/support/nodes/TransportNodesOperationAction.java
src/main/java/org/elasticsearch/transport/NodeShouldNotConnectException.java
comments:
Nicer failure message when node should not connect to another in nodes API
There are cases where nodes should not connect to another node. For example, client nodes do not connect to other client nodes. When executing a nodes level API, we should have a nicer failure indicating that, and not log it by default, as its not a real failure

time:
2014-03-05T23:05:27Z
class:
src/main/java/org/elasticsearch/common/util/AbstractHash.java
src/main/java/org/elasticsearch/search/aggregations/Aggregator.java
src/main/java/org/elasticsearch/search/aggregations/AggregatorParsers.java
src/main/java/org/elasticsearch/search/aggregations/HasAggregations.java
src/main/java/org/elasticsearch/search/aggregations/bucket/BucketsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/MultiBucketsAggregation.java
src/main/java/org/elasticsearch/search/aggregations/bucket/SingleBucketAggregation.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/DateHistogramParser.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/Histogram.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/HistogramAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/HistogramParser.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/InternalOrder.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/InternalOrder.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/Terms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/TermsParser.java
src/main/java/org/elasticsearch/search/aggregations/support/OrderPath.java
src/test/java/org/elasticsearch/search/aggregations/ParsingTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/DoubleTermsTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/HistogramTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/LongTermsTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/StringTermsTests.java
src/test/java/org/elasticsearch/search/aggregations/support/PathTests.java
comments:
Added support for sorting buckets based on sub aggregations

 Supports sorting on sub-aggs down the current hierarchy. This is supported as long as the aggregation in the specified order path are of a single-bucket type, where the last aggregation in the path points to either a single-bucket aggregation or a metrics one. If it's a single-bucket aggregation, the sort will be applied on the document count in the bucket (i.e. doc_count), and if it is a metrics type, the sort will be applied on the pointed out metric (in case of a single-metric aggregations, such as avg, the sort will be applied on the single metric value)

 NOTE: this commit adds a constraint on what should be considered a valid aggregation name. Aggregations names must be alpha-numeric and may contain '-' and '_'.

 Closes #5253

time:
2014-03-05T20:33:59Z
class:
comments:
[DOCS] Update boolean mapping docs with a full list of values that are treated as false

Closes #5337

time:
2014-03-05T17:56:27Z
class:
src/main/java/org/elasticsearch/rest/action/cat/RestNodesAction.java
comments:
if there is no master node id, make sure not to fail the cat call, and report x

time:
2014-03-05T16:40:51Z
class:
comments:
[DOCS] Formatting error

Closes #5346

time:
2014-03-05T14:32:17Z
class:
src/main/java/org/elasticsearch/indices/fielddata/breaker/InternalCircuitBreakerService.java
comments:
Fix issue where circuit breaker was always reset to 80% upon startup

time:
2014-03-05T13:16:56Z
class:
comments:
[DOCS] add Elasticsearch Image Plugin

time:
2014-03-05T12:26:26Z
class:
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
src/main/java/org/elasticsearch/index/merge/EnableMergeScheduler.java
src/main/java/org/elasticsearch/index/merge/Merges.java
src/main/java/org/elasticsearch/index/merge/scheduler/ConcurrentMergeSchedulerProvider.java
src/main/java/org/elasticsearch/index/merge/scheduler/MergeSchedulerModule.java
src/main/java/org/elasticsearch/index/merge/scheduler/MergeSchedulerProvider.java
src/main/java/org/elasticsearch/index/merge/scheduler/SerialMergeSchedulerProvider.java
src/test/java/org/elasticsearch/benchmark/fielddata/LongFieldDataBenchmark.java
src/test/java/org/elasticsearch/common/lucene/uid/VersionsTests.java
src/test/java/org/elasticsearch/index/codec/postingformat/DefaultPostingsFormatTests.java
src/test/java/org/elasticsearch/index/engine/internal/InternalEngineTests.java
src/test/java/org/elasticsearch/index/fielddata/FilterFieldDataTest.java
src/test/java/org/elasticsearch/index/fielddata/LongFieldDataTests.java
src/test/java/org/elasticsearch/search/suggest/completion/CompletionPostingsFormatTest.java
src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java
comments:
Force merges to not happen when indexing a doc / flush
Today, even though our merge policy doesn't return new merge specs on SEGMENT_FLUSH, merge on the scheduler is still called on flush time, and can cause merges to stall indexing during merges. Both for the concurrent merge scheduler (the default) and the serial merge scheduler. This behavior become worse when throttling kicks in (today at 20mb per sec).

In order to solve it (outside of Lucene for now), we wrap the merge scheduler with an EnableMergeScheduler, where, on the thread level, using a thread local, the call to merge can be enabled/disabled.

A Merges helper class is added where all explicit merges operations should go through. If the scheduler is the enabled one, it will enable merges before calling the relevant explicit method call. In order to make sure Merges is the only class that calls the explicit merge calls, the IW variant of them is added to the forbidden APIs list.

closes #5319

time:
2014-03-04T17:52:19Z
class:
src/main/java/org/elasticsearch/index/fielddata/plain/ParentChildIndexFieldData.java
comments:
Implement custom circuit breaker estimator for parent/child field data

time:
2014-03-04T17:18:13Z
class:
src/main/java/org/elasticsearch/index/fielddata/plain/PagedBytesIndexFieldData.java
comments:
check for null term in PagedBytesEstimator.bytesPerValue()

Fixes #5326
can we have a test for this? :)


time:
2014-03-04T13:51:26Z
class:
src/main/java/org/elasticsearch/common/io/stream/BytesStreamOutput.java
src/main/java/org/elasticsearch/index/translog/fs/FsTranslog.java
src/main/java/org/elasticsearch/repositories/blobstore/BlobStoreRepository.java
src/test/java/org/elasticsearch/common/io/streams/BytesStreamsTests.java
comments:
Rewrite BytesStreamOutput on top of BigArrays/ByteArray.

Fix for #5159

time:
2014-03-04T10:13:38Z
class:
src/main/java/org/elasticsearch/search/aggregations/metrics/avg/AvgAggregator.java
src/main/java/org/elasticsearch/search/aggregations/metrics/max/MaxAggregator.java
src/main/java/org/elasticsearch/search/aggregations/metrics/min/MinAggregator.java
src/main/java/org/elasticsearch/search/aggregations/metrics/sum/SumAggregator.java
src/main/java/org/elasticsearch/search/aggregations/metrics/valuecount/ValueCountAggregator.java
comments:
Fix `metric` impl on unmapped fields.

time:
2014-03-04T08:55:21Z
class:
src/main/java/org/elasticsearch/search/aggregations/AggregatorFactories.java
comments:
Fix NPE/AIOOBE when building a bucket which has not been collected.

Close #5048

time:
2014-03-04T08:46:13Z
class:
src/main/java/org/elasticsearch/common/util/Comparators.java
src/main/java/org/elasticsearch/search/aggregations/bucket/MultiBucketsAggregation.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/InternalOrder.java
src/test/java/org/elasticsearch/search/aggregations/bucket/NaNSortingTests.java
comments:
Added unit tests for terms and histogram sorting on sub aggregations that return NaN.

time:
2014-03-04T08:45:53Z
class:
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/InternalOrder.java
comments:
Fix sorting of NaN values in terms aggregations.

Closes #5236.

time:
2014-03-04T08:38:20Z
class:
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/TermsAggregatorFactory.java
comments:
Terms aggs: only use ordinals on low-cardinality fields by default.

Close #5303

time:
2014-03-03T23:20:49Z
class:
comments:
[DOCS] Java API JSON typo

time:
2014-03-03T19:31:38Z
class:
src/test/java/org/elasticsearch/search/aggregations/metrics/PercentilesTests.java
comments:
Fix test bug: a too low compression level can make accuracy terrible.

time:
2014-03-03T17:06:14Z
class:
src/main/java/org/elasticsearch/common/util/ArrayUtils.java
src/main/java/org/elasticsearch/common/util/BigArrays.java
src/main/java/org/elasticsearch/common/util/BigIntArray.java
src/main/java/org/elasticsearch/common/util/BigObjectArray.java
src/main/java/org/elasticsearch/common/util/IntArray.java
src/main/java/org/elasticsearch/common/util/ObjectArray.java
src/main/java/org/elasticsearch/search/aggregations/AggregationBuilders.java
src/main/java/org/elasticsearch/search/aggregations/AggregationModule.java
src/main/java/org/elasticsearch/search/aggregations/TransportAggregationModule.java
src/main/java/org/elasticsearch/search/aggregations/metrics/percentiles/InternalPercentiles.java
src/main/java/org/elasticsearch/search/aggregations/metrics/percentiles/Percentiles.java
src/main/java/org/elasticsearch/search/aggregations/metrics/percentiles/PercentilesAggregator.java
src/main/java/org/elasticsearch/search/aggregations/metrics/percentiles/PercentilesBuilder.java
src/main/java/org/elasticsearch/search/aggregations/metrics/percentiles/PercentilesEstimator.java
src/main/java/org/elasticsearch/search/aggregations/metrics/percentiles/PercentilesParser.java
src/main/java/org/elasticsearch/search/aggregations/metrics/percentiles/tdigest/GroupRedBlackTree.java
src/main/java/org/elasticsearch/search/aggregations/metrics/percentiles/tdigest/RedBlackTree.java
src/main/java/org/elasticsearch/search/aggregations/metrics/percentiles/tdigest/TDigest.java
src/main/java/org/elasticsearch/search/aggregations/metrics/percentiles/tdigest/TDigestState.java
src/test/java/org/elasticsearch/benchmark/search/aggregations/PercentilesAggregationSearchBenchmark.java
src/test/java/org/elasticsearch/common/util/ArrayUtilsTests.java
src/test/java/org/elasticsearch/search/aggregations/RandomTests.java
src/test/java/org/elasticsearch/search/aggregations/metrics/AbstractNumericTests.java
src/test/java/org/elasticsearch/search/aggregations/metrics/GroupTree.java
src/test/java/org/elasticsearch/search/aggregations/metrics/GroupTreeTests.java
src/test/java/org/elasticsearch/search/aggregations/metrics/PercentilesTests.java
src/test/java/org/elasticsearch/search/aggregations/metrics/RedBlackTreeTests.java
src/test/java/org/elasticsearch/search/aggregations/metrics/TDigestStateTests.java
src/test/java/org/elasticsearch/test/cache/recycler/MockBigArrays.java
comments:
Percentiles aggregation.

A new metric aggregation that can compute approximate values of arbitrary
percentiles.

Close #5323

time:
2014-03-03T13:12:18Z
class:
comments:
[DOCS] Better document the limitation of nested objects.

time:
2014-03-03T12:34:22Z
class:
src/test/java/org/elasticsearch/test/rest/RestTestExecutionContext.java
src/test/java/org/elasticsearch/test/rest/Stash.java
src/test/java/org/elasticsearch/test/rest/parser/DoSectionParser.java
src/test/java/org/elasticsearch/test/rest/section/ApiCallSection.java
src/test/java/org/elasticsearch/test/rest/section/Assertion.java
src/test/java/org/elasticsearch/test/rest/section/DoSection.java
src/test/java/org/elasticsearch/test/rest/section/SetSection.java
src/test/java/org/elasticsearch/test/rest/test/DoSectionParserTests.java
comments:
[TEST] added support for replacing stashed values within objects and lists in our REST tests

time:
2014-03-03T10:15:32Z
class:
comments:
fix typos in README.md

Closes #23

time:
2014-03-03T09:47:42Z
class:
comments:
Update naming for better mailing list announcement

By now, when we release the plugin, users can be confused about version naming.

For example, email title could be:

```
 [ANN] Phonetic Analysis for elasticsearch 1.8.0 released
```

We prefer to have that form:

```
 [ANN] Elasticsearch Phonetic Analysis plugin 1.8.0 released
 ```

  Thanks to @spinscale to reporting this.

time:
2014-03-03T09:45:20Z
class:
comments:
Update naming for better mailing list announcement

By now, when we release the plugin, users can be confused about version naming.

For example, email title could be:

```
 [ANN] Stempel (Polish) Analysis plugin for elasticsearch 1.8.0 released
```

We prefer to have that form:

```
 [ANN] Elasticsearch Stempel (Polish) Analysis plugin 1.8.0 released
 ```

  Thanks to @spinscale to reporting this.

time:
2014-03-03T09:43:23Z
class:
comments:
Update naming for better mailing list announcement

By now, when we release the plugin, users can be confused about version naming.

For example, email title could be:

```
 [ANN] Smart Chinese Analysis plugin for elasticsearch 1.8.0 released
```

We prefer to have that form:

```
 [ANN] Elasticsearch Smart Chinese Analysis plugin 1.8.0 released
 ```

  Thanks to @spinscale to reporting this.

time:
2014-03-03T09:41:25Z
class:
comments:
Update naming for better mailing list announcement

By now, when we release the plugin, users can be confused about version naming.

For example, email title could be:

```
 [ANN] ICU Analysis plugin for elasticsearch 1.8.0 released
```

We prefer to have that form:

```
 [ANN] Elasticsearch ICU Analysis plugin 1.8.0 released
 ```

  Thanks to @spinscale to reporting this.

time:
2014-03-03T09:36:55Z
class:
comments:
Update naming for better mailing list announcement

By now, when we release the plugin, users can be confused about version naming.

For example, email title could be:

```
[ANN] Japanese (kuromoji) Analysis plugin for elasticsearch 1.8.0 released
```

We prefer to have that form:

```
[ANN] Elasticsearch Japanese (kuromoji) Analysis plugin 1.8.0 released
```

Thanks to @spinscale to reporting this.

time:
2014-03-02T19:31:23Z
class:
src/main/java/org/elasticsearch/plugins/PluginUtils.java
comments:
fix typo causing incorrect plugin properties lookup in jars

relates #5261

time:
2014-02-28T22:57:04Z
class:
comments:
prepare for next development iteration

time:
2014-02-28T22:55:36Z
class:
comments:
prepare release elasticsearch-analysis-kuromoji-2.0.0

time:
2014-02-28T22:48:24Z
class:
src/main/java/org/elasticsearch/indices/analysis/KuromojiIndicesAnalysis.java
src/main/java/org/elasticsearch/indices/analysis/KurumojiCharFilterFactoryFactory.java
src/main/java/org/elasticsearch/indices/analysis/KurumojiTokenFilterFactoryFactory.java
src/main/java/org/elasticsearch/indices/analysis/KurumojiTokenizerFactoryFactory.java
comments:
Can not upgrade kuromoji plugin from elasticsearch 0.90.5

Due to fix [3790](https://github.com/elasticsearch/elasticsearch/issues/3790) in core, upgrading an analyzer provided as a plugin now fails.

See https://github.com/elasticsearch/elasticsearch/issues/5030 for details.

Issue is in elasticsearch core code but can be fixed in plugins by overloading `PreBuiltAnalyzerProviderFactory`,  `PreBuiltTokenFilterFactoryFactory`, `PreBuiltTokenizerFactoryFactory` or `PreBuiltCharFilterFactoryFactory ` when used.

Closes #21
(cherry picked from commit 3401c21)

time:
2014-02-28T22:37:00Z
class:
comments:
Update to Lucene 4.6.1 / Elasticsearch 1.0.0

Closes #18

time:
2014-02-28T22:27:37Z
class:
comments:
Add plugin release semi-automatic script

Closes #22

time:
2014-02-28T22:20:30Z
class:
comments:
prepare for next development iteration

time:
2014-02-28T22:17:47Z
class:
comments:
prepare release elasticsearch-analysis-icu-2.0.0

time:
2014-02-28T22:16:00Z
class:
comments:
Update to Lucene 4.6.1 / Elasticsearch 1.0.0

Closes #18

time:
2014-02-28T22:09:56Z
class:
comments:
Add plugin release semi-automatic script

Closes #21

time:
2014-02-28T22:01:44Z
class:
comments:
prepare for next development iteration

time:
2014-02-28T22:00:47Z
class:
comments:
prepare release elasticsearch-analysis-phonetic-2.0.0

time:
2014-02-28T21:59:08Z
class:
src/test/java/org/elasticsearch/plugins/IsolatedPluginTests.java
comments:
fix incorrect array search in test (by sorting it first)

relates to #5621

time:
2014-02-28T21:54:17Z
class:
comments:
Update to Lucene 4.6.1 / Elasticsearch 1.0.0

Closes #19

time:
2014-02-28T21:51:28Z
class:
comments:
Add plugin release semi-automatic script

Closes #20

time:
2014-02-28T20:31:10Z
class:
src/main/java/org/elasticsearch/common/util/BigArrays.java
comments:
Reuse pages more agressively in BigArrays.

Pages are now going to be reused when the size of the array is greater than
${page_size}/2 (as opposed to ${page_size} currently).

Close #5299

time:
2014-02-28T20:31:10Z
class:
src/test/java/org/elasticsearch/cache/recycler/MockPageCacheRecycler.java
src/test/java/org/elasticsearch/test/ElasticsearchTestCase.java
comments:
Prevent page-tracking checks from spreading across tests.

time:
2014-02-28T20:31:10Z
class:
src/test/java/org/elasticsearch/cache/recycler/MockPageCacheRecycler.java
comments:
Remove same-thread checks when recycling (see #5254).

time:
2014-02-28T19:38:57Z
class:
comments:
Clarify range aggregations

time:
2014-02-28T17:39:07Z
class:
comments:
[TEST] skip explain reroute REST test until param substitution is implemented

time:
2014-02-28T17:19:32Z
class:
comments:
prepare for next development iteration

time:
2014-02-28T17:16:11Z
class:
comments:
prepare release elasticsearch-analysis-smartcn-2.0.0

time:
2014-02-28T17:14:40Z
class:
comments:
Update to Lucene 4.6.1 / Elasticsearch 1.0.0

Closes #11

time:
2014-02-28T17:11:53Z
class:
src/test/java/org/elasticsearch/plugins/IsolatedPluginTests.java
comments:
make test assertions relative in IsolatedPluginTests

relates to #5621

time:
2014-02-28T17:02:42Z
class:
comments:
Add plugin release semi-automatic script

Closes #15.

time:
2014-02-28T16:50:36Z
class:
comments:
prepare for next development iteration

time:
2014-02-28T16:49:40Z
class:
comments:
prepare release elasticsearch-analysis-stempel-2.0.0

time:
2014-02-28T16:44:34Z
class:
comments:
Update to elasticsearch 1.0.0

Closes #21.

time:
2014-02-28T16:38:42Z
class:
comments:
Add plugin release semi-automatic script

We want to be able to release versions in a faster way then we do by now.

Closes #20.

time:
2014-02-28T14:29:43Z
class:
comments:
[DOCS] Fixed added[] tag version number

time:
2014-02-28T14:21:11Z
class:
src/test/java/org/elasticsearch/plugins/IsolatedPluginTests.java
comments:
fix failing IsolatedPluginTests (change numNodes to 0)

(cherry picked from commit f26a369a78ade032df44fcf331f378644f74b9ea)

time:
2014-02-28T13:41:01Z
class:
comments:
[TEST] Dynamically extract node ID for test

time:
2014-02-28T13:27:17Z
class:
comments:
[TEST] Add version and master_node parameter to _cluster/state

time:
2014-02-28T13:05:20Z
class:
src/main/java/org/elasticsearch/action/admin/cluster/node/info/PluginInfo.java
src/main/java/org/elasticsearch/plugins/PluginClassLoader.java
src/main/java/org/elasticsearch/plugins/PluginUtils.java
src/main/java/org/elasticsearch/plugins/PluginsService.java
src/test/java/org/elasticsearch/nodesinfo/SimpleNodesInfoTests.java
src/test/java/org/elasticsearch/plugins/IsolatedPluginTests.java
src/test/java/org/elasticsearch/plugins/PluginClassLoaderTest.java
src/test/java/org/elasticsearch/plugins/isolation/DummyClass.java
src/test/java/org/elasticsearch/plugins/isolation/IsolatedPlugin.java
comments:
Add plugin class space isolation

Each plugin is now loaded in its own classloader to prevent class
conflicts when loading different versions of the same library. It
 is enabled by default and is configurable through
 `plugins.isolation` settings .Additionally, each plugin can
change its own isolation through the `isolation` property in
`es-plugin.properties`- if not specified, the global setting in
ES applies.

Closes #5261

time:
2014-02-28T11:54:10Z
class:
src/test/java/org/elasticsearch/snapshots/SharedClusterSnapshotRestoreTests.java
comments:
[TEST] more assertAcked in SharedClusterShapshotRestoreTests

time:
2014-02-28T10:19:18Z
class:
src/main/java/org/elasticsearch/action/admin/indices/mapping/delete/TransportDeleteMappingAction.java
src/test/java/org/elasticsearch/percolator/PercolatorTests.java
comments:
Added more trace and debug logging

time:
2014-02-27T22:11:43Z
class:
src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java
comments:
Move ensureEstimatedStats() after index wiping to ensure everything is cleaned up once the index is removed

time:
2014-02-27T21:41:40Z
class:
src/main/java/org/elasticsearch/common/lucene/SegmentReaderUtils.java
comments:
Add assertion to not forget to replace reflection with the new FilterAtomicReader.unwrap.

time:
2014-02-27T21:41:40Z
class:
comments:
Update Eclipse configuration to Java 1.7.

time:
2014-02-27T21:39:39Z
class:
src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java
comments:
Improve error reporting on breaker stats assertion

time:
2014-02-27T20:24:11Z
class:
src/test/java/org/elasticsearch/indices/fielddata/breaker/RandomExceptionCircuitBreakerTests.java
comments:
Remove trace logging from testBreakerWithRandomExceptions()

time:
2014-02-27T16:48:51Z
class:
src/main/java/org/elasticsearch/action/admin/cluster/reroute/ClusterRerouteRequest.java
src/main/java/org/elasticsearch/action/admin/cluster/reroute/ClusterRerouteRequestBuilder.java
src/main/java/org/elasticsearch/action/admin/cluster/reroute/ClusterRerouteResponse.java
src/main/java/org/elasticsearch/action/admin/cluster/reroute/TransportClusterRerouteAction.java
src/main/java/org/elasticsearch/action/admin/cluster/state/TransportClusterStateAction.java
src/main/java/org/elasticsearch/cluster/ClusterState.java
src/main/java/org/elasticsearch/cluster/routing/allocation/AllocationService.java
src/main/java/org/elasticsearch/cluster/routing/allocation/RerouteExplanation.java
src/main/java/org/elasticsearch/cluster/routing/allocation/RoutingAllocation.java
src/main/java/org/elasticsearch/cluster/routing/allocation/RoutingExplanations.java
src/main/java/org/elasticsearch/cluster/routing/allocation/command/AllocateAllocationCommand.java
src/main/java/org/elasticsearch/cluster/routing/allocation/command/AllocationCommand.java
src/main/java/org/elasticsearch/cluster/routing/allocation/command/AllocationCommands.java
src/main/java/org/elasticsearch/cluster/routing/allocation/command/CancelAllocationCommand.java
src/main/java/org/elasticsearch/cluster/routing/allocation/command/MoveAllocationCommand.java
src/main/java/org/elasticsearch/cluster/routing/allocation/decider/AwarenessAllocationDecider.java
src/main/java/org/elasticsearch/cluster/routing/allocation/decider/ClusterRebalanceAllocationDecider.java
src/main/java/org/elasticsearch/cluster/routing/allocation/decider/ConcurrentRebalanceAllocationDecider.java
src/main/java/org/elasticsearch/cluster/routing/allocation/decider/Decision.java
src/main/java/org/elasticsearch/cluster/routing/allocation/decider/DisableAllocationDecider.java
src/main/java/org/elasticsearch/cluster/routing/allocation/decider/DiskThresholdDecider.java
src/main/java/org/elasticsearch/cluster/routing/allocation/decider/EnableAllocationDecider.java
src/main/java/org/elasticsearch/cluster/routing/allocation/decider/FilterAllocationDecider.java
src/main/java/org/elasticsearch/cluster/routing/allocation/decider/NodeVersionAllocationDecider.java
src/main/java/org/elasticsearch/cluster/routing/allocation/decider/RebalanceOnlyWhenActiveAllocationDecider.java
src/main/java/org/elasticsearch/cluster/routing/allocation/decider/ReplicaAfterPrimaryActiveAllocationDecider.java
src/main/java/org/elasticsearch/cluster/routing/allocation/decider/SameShardAllocationDecider.java
src/main/java/org/elasticsearch/cluster/routing/allocation/decider/ShardsLimitAllocationDecider.java
src/main/java/org/elasticsearch/cluster/routing/allocation/decider/SnapshotInProgressAllocationDecider.java
src/main/java/org/elasticsearch/cluster/routing/allocation/decider/ThrottlingAllocationDecider.java
src/main/java/org/elasticsearch/rest/action/admin/cluster/reroute/RestClusterRerouteAction.java
src/test/java/org/elasticsearch/cluster/allocation/ClusterRerouteTests.java
comments:
Add `explain` flag support to the reroute API

By specifying the `explain` flag, an explanation for the reason a
command can or cannot be executed is returned. No allocation commands
are actually performed.

Returns a response similar to:

{
  "state": {...cluster state...},
  "acknowledged": true,
  "explanations" : [ {
    "command" : "cancel",
      "parameters" : {
        "index" : "decide",
        "shard" : 0,
        "node" : "IvpoKRdtRiGrQ_WKtt4_4w",
        "allow_primary" : false
      },
      "decisions" : [ {
        "decider" : "cancel_allocation_command",
        "decision" : "YES",
        "explanation" : "..."
        } ]
     }, {
      "command" : "move",
      "parameters" : {
        "index" : "decide",
        "shard" : 0,
        "from_node" : "IvpoKRdtRiGrQ_WKtt4_4w",
        "to_node" : "IvpoKRdtRiGrQ_WKtt4_4w"
       },
       "decisions" : [ {
         "decider" : "same_shard",
         "decision" : "NO",
         "explanation" : "shard cannot be allocated on same node [IvpoKRdtRiGrQ_WKtt4_4w] it already exists on"
       },
       etc
       ]
  }]
}

also removes AllocationExplanation from cluster state

Closes #2483
Closes #5169

time:
2014-02-27T14:12:02Z
class:
comments:
Move master to Java 1.7

Closes #5267

time:
2014-02-27T13:50:42Z
class:
src/main/java/org/apache/lucene/queries/ExtendedCommonTermsQuery.java
src/main/java/org/elasticsearch/index/query/CommonTermsQueryParser.java
src/main/java/org/elasticsearch/index/search/MatchQuery.java
src/test/java/org/elasticsearch/search/query/SimpleQueryTests.java
comments:
Use FieldMapper to create the low level term queries in CommonTermQuery

Closes #5258

time:
2014-02-27T13:01:12Z
class:
src/main/java/org/elasticsearch/action/admin/indices/validate/query/TransportValidateQueryAction.java
src/main/java/org/elasticsearch/action/count/TransportCountAction.java
src/main/java/org/elasticsearch/action/deletebyquery/TransportShardDeleteByQueryAction.java
src/main/java/org/elasticsearch/action/explain/TransportExplainAction.java
src/main/java/org/elasticsearch/common/compress/CompressedIndexInput.java
src/main/java/org/elasticsearch/common/lease/Releasables.java
src/main/java/org/elasticsearch/common/util/AbstractArray.java
src/main/java/org/elasticsearch/common/util/AbstractBigArray.java
src/main/java/org/elasticsearch/common/util/AbstractHash.java
src/main/java/org/elasticsearch/common/util/BigArray.java
src/main/java/org/elasticsearch/common/util/BigArrays.java
src/main/java/org/elasticsearch/common/util/BigArraysModule.java
src/main/java/org/elasticsearch/common/util/BytesRefHash.java
src/main/java/org/elasticsearch/common/util/DefaultBigArraysModule.java
src/main/java/org/elasticsearch/common/util/LongHash.java
src/main/java/org/elasticsearch/index/fielddata/plain/FSTBytesAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/PagedBytesAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/SortedSetDVAtomicFieldData.java
src/main/java/org/elasticsearch/index/search/child/ChildrenConstantScoreQuery.java
src/main/java/org/elasticsearch/index/search/child/ChildrenQuery.java
src/main/java/org/elasticsearch/index/search/child/ParentConstantScoreQuery.java
src/main/java/org/elasticsearch/index/search/child/ParentQuery.java
src/main/java/org/elasticsearch/node/internal/InternalNode.java
src/main/java/org/elasticsearch/percolator/PercolateContext.java
src/main/java/org/elasticsearch/percolator/PercolatorService.java
src/main/java/org/elasticsearch/search/SearchService.java
src/main/java/org/elasticsearch/search/aggregations/Aggregator.java
src/main/java/org/elasticsearch/search/aggregations/AggregatorFactories.java
src/main/java/org/elasticsearch/search/aggregations/bucket/BucketsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/geogrid/GeoHashGridAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/HistogramAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/DoubleTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/LongTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/StringTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/metrics/avg/AvgAggregator.java
src/main/java/org/elasticsearch/search/aggregations/metrics/max/MaxAggregator.java
src/main/java/org/elasticsearch/search/aggregations/metrics/min/MinAggregator.java
src/main/java/org/elasticsearch/search/aggregations/metrics/stats/StatsAggegator.java
src/main/java/org/elasticsearch/search/aggregations/metrics/stats/extended/ExtendedStatsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/metrics/sum/SumAggregator.java
src/main/java/org/elasticsearch/search/aggregations/metrics/valuecount/ValueCountAggregator.java
src/main/java/org/elasticsearch/search/aggregations/support/AggregationContext.java
src/main/java/org/elasticsearch/search/facet/terms/strings/TermsStringOrdinalsFacetExecutor.java
src/main/java/org/elasticsearch/search/internal/DefaultSearchContext.java
src/main/java/org/elasticsearch/search/internal/SearchContext.java
src/test/java/org/elasticsearch/common/util/BigArraysTests.java
src/test/java/org/elasticsearch/common/util/BytesRefHashTests.java
src/test/java/org/elasticsearch/common/util/LongHashTests.java
src/test/java/org/elasticsearch/index/search/child/ChildrenConstantScoreQueryTests.java
src/test/java/org/elasticsearch/index/search/child/TestSearchContext.java
src/test/java/org/elasticsearch/search/aggregations/bucket/DoubleTermsTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/LongTermsTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/NestedTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/StringTermsTests.java
src/test/java/org/elasticsearch/test/ElasticsearchTestCase.java
src/test/java/org/elasticsearch/test/TestCluster.java
src/test/java/org/elasticsearch/test/cache/recycler/MockBigArrays.java
src/test/java/org/elasticsearch/test/cache/recycler/MockBigArraysModule.java
comments:
Add tracking of allocated arrays.

The BigArrays utility class is useful to generate arrays of various sizes: when
small, arrays will be allocated directly on the heap while larger arrays are
going to be paged and to recycle pages through PageCacheRecycler. We already
have tracking for pages but this is not triggered very often since it only
happens on large amounts of data while our tests work on small amounts of data
in order to be fast.

Tracking arrays directly helps make sure that we never forget to release them.

This pull request also improves testing by:

 - putting random content in the arrays upon release: this makes sure that
   consumers don't use these arrays anymore when they are released as their
   content may be subject to use for another purpose since pages are recycled

 - putting random content in the arrays upon creation and resize when
   `clearOnResize` is `false`.

The major difference with `master` is that the `BigArrays` class is now
instanciable, injected via Guice and usually available through the
`SearchContext`. This way, it can be mocked for tests.

time:
2014-02-27T12:26:54Z
class:
src/main/java/org/elasticsearch/index/fielddata/plain/ParentChildIndexFieldData.java
comments:
estimator#afterLoad should be invoked once only per reader.

It was being invoked once per reader and parent type combination resulting in more memory being reported to the circuit breaker than actually being used in field data.

time:
2014-02-27T10:28:27Z
class:
src/test/java/org/elasticsearch/indices/fielddata/breaker/RandomExceptionCircuitBreakerTests.java
src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java
src/test/java/org/elasticsearch/test/hamcrest/ElasticsearchAssertions.java
comments:
Add RamUsageEstimator assertion to ElasticsearchIntegrationTest

time:
2014-02-26T22:53:53Z
class:
src/test/java/org/elasticsearch/indices/fielddata/breaker/RandomExceptionCircuitBreakerTests.java
comments:
Enable trace logging for RandomExceptionCircuitBreakerTests.testBreakerWithRandomExceptions

time:
2014-02-26T22:18:44Z
class:
comments:
Moved es download master url from JDK7 to JDK6

time:
2014-02-26T21:21:10Z
class:
src/main/java/org/elasticsearch/common/geo/GeoDistance.java
src/main/java/org/elasticsearch/common/geo/GeoUtils.java
src/test/java/org/apache/lucene/util/SloppyMathTests.java
comments:
Improve `arc` geo-distance accuracy.

Close #5192

time:
2014-02-26T21:21:10Z
class:
src/main/java/org/elasticsearch/index/analysis/ShingleTokenFilterFactory.java
src/test/java/org/elasticsearch/index/analysis/ShingleTokenFilterFactoryTests.java
comments:
Expose `filler_token` via ShingleTokenFilterFactory

Lucene 4.7 supports a setter for the `filler_token` that is
inserted if there are gaps in the token stream. This change exposes
this setting.

Closes #4307

time:
2014-02-26T21:21:10Z
class:
src/main/java/org/apache/lucene/analysis/miscellaneous/XASCIIFoldingFilter.java
src/main/java/org/apache/lucene/queryparser/XSimpleQueryParser.java
src/main/java/org/apache/lucene/search/XReferenceManager.java
src/main/java/org/apache/lucene/search/XSearcherManager.java
src/main/java/org/apache/lucene/search/suggest/analyzing/XAnalyzingSuggester.java
src/main/java/org/elasticsearch/Version.java
src/main/java/org/elasticsearch/common/lucene/Lucene.java
src/main/java/org/elasticsearch/env/NodeEnvironment.java
src/main/java/org/elasticsearch/index/analysis/ASCIIFoldingTokenFilterFactory.java
src/main/java/org/elasticsearch/index/analysis/ShingleTokenFilterFactory.java
src/main/java/org/elasticsearch/index/engine/SegmentsStats.java
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/BytesRefOrdValComparator.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/BytesRefValComparator.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/DoubleScriptDataComparator.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/DoubleValuesComparatorBase.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/GeoDistanceComparator.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/LongValuesComparatorBase.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/NumberComparatorBase.java
src/main/java/org/elasticsearch/index/fielddata/fieldcomparator/StringScriptDataComparator.java
src/main/java/org/elasticsearch/index/gateway/fs/FsIndexShardGateway.java
src/main/java/org/elasticsearch/index/query/SimpleQueryParser.java
src/main/java/org/elasticsearch/index/query/SimpleQueryStringFlag.java
src/main/java/org/elasticsearch/index/query/SimpleQueryStringParser.java
src/main/java/org/elasticsearch/index/search/nested/NestedFieldComparatorSource.java
src/test/java/org/elasticsearch/index/analysis/ShingleTokenFilterFactoryTests.java
src/test/java/org/elasticsearch/indices/warmer/SimpleIndicesWarmerTests.java
src/test/java/org/elasticsearch/test/engine/MockInternalEngine.java
comments:
Upgrade to Lucene 4.7

Closes #5104
Closes #5129
Closes #3757

time:
2014-02-26T21:16:51Z
class:
comments:
[DOCS] Updated memory considerations for p/c queries and filters.

time:
2014-02-26T19:33:59Z
class:
src/main/java/org/elasticsearch/common/util/AbstractHash.java
src/main/java/org/elasticsearch/common/util/BytesRefHash.java
src/main/java/org/elasticsearch/common/util/LongHash.java
src/main/java/org/elasticsearch/index/search/child/ChildrenConstantScoreQuery.java
src/main/java/org/elasticsearch/index/search/child/ChildrenQuery.java
src/main/java/org/elasticsearch/index/search/child/ParentConstantScoreQuery.java
src/main/java/org/elasticsearch/index/search/child/ParentIdsFilter.java
src/main/java/org/elasticsearch/index/search/child/ParentQuery.java
src/main/java/org/elasticsearch/search/aggregations/bucket/geogrid/GeoHashGridAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/HistogramAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/DoubleTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/LongTermsAggregator.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/StringTermsAggregator.java
src/test/java/org/elasticsearch/common/util/BytesRefHashTests.java
src/test/java/org/elasticsearch/common/util/LongHashTests.java
comments:
Moved AbstractHash, BytesRefHash and LongHash to o.e.common.util

time:
2014-02-26T19:16:14Z
class:
src/test/java/org/elasticsearch/index/fielddata/ParentChildFieldDataTests.java
comments:
Added missing licence header.

time:
2014-02-26T18:46:05Z
class:
src/main/java/org/elasticsearch/action/admin/indices/cache/clear/TransportClearIndicesCacheAction.java
src/main/java/org/elasticsearch/cache/recycler/PageCacheRecycler.java
src/main/java/org/elasticsearch/common/util/AbstractBigArray.java
src/main/java/org/elasticsearch/common/util/BigArrays.java
src/main/java/org/elasticsearch/common/util/BigFloatArray.java
src/main/java/org/elasticsearch/common/util/FloatArray.java
src/main/java/org/elasticsearch/index/cache/IndexCache.java
src/main/java/org/elasticsearch/index/cache/IndexCacheModule.java
src/main/java/org/elasticsearch/index/cache/id/IdCache.java
src/main/java/org/elasticsearch/index/cache/id/IdCacheModule.java
src/main/java/org/elasticsearch/index/cache/id/IdCacheStats.java
src/main/java/org/elasticsearch/index/cache/id/IdReaderCache.java
src/main/java/org/elasticsearch/index/cache/id/ShardIdCache.java
src/main/java/org/elasticsearch/index/cache/id/ShardIdCacheModule.java
src/main/java/org/elasticsearch/index/cache/id/simple/SimpleIdCache.java
src/main/java/org/elasticsearch/index/cache/id/simple/SimpleIdReaderCache.java
src/main/java/org/elasticsearch/index/cache/id/simple/SimpleIdReaderTypeCache.java
src/main/java/org/elasticsearch/index/fielddata/IndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/IndexFieldDataService.java
src/main/java/org/elasticsearch/index/fielddata/ShardFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/DisabledIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/DocValuesIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/DoubleArrayIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/FSTBytesIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/FloatArrayIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/GeoPointBinaryDVIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/GeoPointCompressedIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/GeoPointDoubleArrayIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/PackedArrayIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/PagedBytesIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/ParentChildAtomicFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/ParentChildFilteredTermsEnum.java
src/main/java/org/elasticsearch/index/fielddata/plain/ParentChildIndexFieldData.java
src/main/java/org/elasticsearch/index/fielddata/plain/ParentChildIntersectTermsEnum.java
src/main/java/org/elasticsearch/index/mapper/Uid.java
src/main/java/org/elasticsearch/index/mapper/internal/ParentFieldMapper.java
src/main/java/org/elasticsearch/index/query/HasChildFilterParser.java
src/main/java/org/elasticsearch/index/query/HasChildQueryParser.java
src/main/java/org/elasticsearch/index/query/HasParentFilterParser.java
src/main/java/org/elasticsearch/index/query/HasParentQueryParser.java
src/main/java/org/elasticsearch/index/query/TopChildrenQueryParser.java
src/main/java/org/elasticsearch/index/search/child/ChildrenConstantScoreQuery.java
src/main/java/org/elasticsearch/index/search/child/ChildrenQuery.java
src/main/java/org/elasticsearch/index/search/child/ParentConstantScoreQuery.java
src/main/java/org/elasticsearch/index/search/child/ParentIdCollector.java
src/main/java/org/elasticsearch/index/search/child/ParentIdsFilter.java
src/main/java/org/elasticsearch/index/search/child/ParentQuery.java
src/main/java/org/elasticsearch/index/search/child/TopChildrenQuery.java
src/main/java/org/elasticsearch/index/service/InternalIndexService.java
src/main/java/org/elasticsearch/index/shard/service/IndexShard.java
src/main/java/org/elasticsearch/index/shard/service/InternalIndexShard.java
src/main/java/org/elasticsearch/percolator/PercolateContext.java
src/main/java/org/elasticsearch/search/SearchService.java
src/main/java/org/elasticsearch/search/internal/DefaultSearchContext.java
src/main/java/org/elasticsearch/search/internal/SearchContext.java
src/test/java/org/elasticsearch/index/cache/id/SimpleIdCacheTests.java
src/test/java/org/elasticsearch/index/fielddata/AbstractFieldDataTests.java
src/test/java/org/elasticsearch/index/fielddata/IndexFieldDataServiceTests.java
src/test/java/org/elasticsearch/index/fielddata/ParentChildFieldDataTests.java
src/test/java/org/elasticsearch/index/fielddata/plain/ParentChildFilteredTermsEnumTests.java
src/test/java/org/elasticsearch/index/mapper/UidTests.java
src/test/java/org/elasticsearch/index/query/IndexQueryParserFilterCachingTests.java
src/test/java/org/elasticsearch/index/query/SimpleIndexQueryParserTests.java
src/test/java/org/elasticsearch/index/search/FieldDataTermsFilterTests.java
src/test/java/org/elasticsearch/index/search/child/ChildrenConstantScoreQueryTests.java
src/test/java/org/elasticsearch/index/search/child/ChildrenQueryTests.java
src/test/java/org/elasticsearch/index/search/child/ParentConstantScoreQueryTests.java
src/test/java/org/elasticsearch/index/search/child/ParentQueryTests.java
src/test/java/org/elasticsearch/index/search/child/TestSearchContext.java
src/test/java/org/elasticsearch/search/child/SimpleChildQuerySearchTests.java
src/test/java/org/elasticsearch/test/index/service/StubIndexService.java
comments:
Migrated p/c queries from id cache to field data. Changed p/c queries to use paging data structures (BytesRefHash, BigFloatArray, BigIntArray) instead of hppc maps / sets.
Also removed the id cache.

Closes #4930
Any particular reason this method was removed?

Not sure why it was removed, but you can achieve the same effect with:

``` java
String id = org.elasticsearch.index.mapper.Uid.createUid("").id();
```


time:
2014-02-26T17:40:34Z
class:
src/main/java/org/elasticsearch/index/query/SimpleQueryParser.java
src/main/java/org/elasticsearch/index/query/SimpleQueryStringBuilder.java
src/main/java/org/elasticsearch/index/query/SimpleQueryStringParser.java
src/test/java/org/elasticsearch/search/query/SimpleQueryTests.java
comments:
refactor SimpleQueryParser settings into separate class, add "lenient" option

Fixes #5011

time:
2014-02-26T15:40:04Z
class:
comments:
[DOCS]: fixed small problem in example json

time:
2014-02-26T13:11:40Z
class:
comments:
[TEST] removed REST test that checks for delete by query shard failures

The clients return an exception in case of failure and not the whole json response containing failures, thus this tests can only work with the Java REST tests runner

time:
2014-02-26T12:14:52Z
class:
src/main/java/org/elasticsearch/rest/action/deletebyquery/RestDeleteByQueryAction.java
comments:
Expose delete by query shard failures follow-up

- Removed if conditions on index name and shard_id
- Added REST test

time:
2014-02-26T12:14:52Z
class:
src/main/java/org/elasticsearch/rest/action/deletebyquery/RestDeleteByQueryAction.java
comments:
Add failures reason to delete by query response

Closes #5093

time:
2014-02-26T08:54:55Z
class:
src/test/java/org/elasticsearch/node/internal/InternalSettingsPreparerTests.java
comments:
Class name typo.

time:
2014-02-26T08:52:53Z
class:
comments:
Minor cleanups.

time:
2014-02-25T16:29:12Z
class:
src/main/java/org/elasticsearch/action/delete/index/IndexDeleteResponse.java
src/main/java/org/elasticsearch/action/delete/index/TransportIndexDeleteAction.java
src/main/java/org/elasticsearch/action/deletebyquery/TransportIndexDeleteByQueryAction.java
src/main/java/org/elasticsearch/action/support/replication/TransportIndexReplicationOperationAction.java
src/test/java/org/elasticsearch/deleteByQuery/DeleteByQueryTests.java
comments:
Refactored TransportIndexReplicationOperationAction to be able to expose the shard id related to a shard failure

The `ShardOperationFailedException` is now created within `TransportIndexReplicationAction` passing in the current shard id as a constructor argument.
Also replaced `AtomicReferenceArray<Object>` with `AtomicReferenceArray<ShardActionResult>`, where `ShardActionResult` wraps the `ShardResponse` or the failure, containing all the needed info.

time:
2014-02-25T15:51:55Z
class:
src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java
src/test/java/org/elasticsearch/test/TestCluster.java
src/test/java/org/elasticsearch/test/junit/listeners/ReproduceInfoPrinter.java
src/test/java/org/elasticsearch/test/rest/junit/RestReproduceInfoPrinter.java
src/test/java/org/elasticsearch/test/rest/junit/RestTestSuiteRunner.java
comments:
Remove nanoTime in global cluster randomization in favor of deriving the
seed from the main master seed. Removed shared cluster's seed entirely.

The problem here is that if you don't give cluster's seed then test times
fluctuate oddly, even for a fixed -Dtests.seed=... This shouldn't be the
case -- ideally, the test ran with the same master seed should reproduce
pretty much with the same execution time (and internal logic, obviously).

From the code point of view "global" variables are indeed a problem
because JUnit has no notion of before-suite hooks. And RandomizedRunner
doesn't support context accesses in static class initializers (this is
intentional because there is no way to determine when such initializers
will be executed). A workaround is to move such static global variables to
lazily-initialized methods and invoke them (once) in @BeforeClass hooks.

time:
2014-02-25T13:59:41Z
class:
src/main/java/org/elasticsearch/cache/recycler/CacheRecycler.java
src/main/java/org/elasticsearch/cache/recycler/PageCacheRecycler.java
src/main/java/org/elasticsearch/common/recycler/Recycler.java
src/main/java/org/elasticsearch/common/recycler/Recyclers.java
src/test/java/org/elasticsearch/benchmark/common/recycler/RecyclerBenchmark.java
src/test/java/org/elasticsearch/common/recycler/SoftThreadLocalRecyclerTests.java
src/test/java/org/elasticsearch/common/recycler/ThreadLocalRecyclerTests.java
comments:
remove thread local recycler

the thread local recycler requires obtain and recycle to be called on the same thread, while other recyclers do not. Also, it can create heavy recycle usage since it depends on the threads that its being used on. The concurrent / pinned thread base one is by far better than the pure thread local (and is the default) one since it more easily bounds the elements recycled, while still allowing to mix obtain and recycle across threads.

We will end up using the paged recyclers more and more, for example, in our networking output buffer, where obtaining will happen on one thread, while recycling can potentially occur on another thread (the callback thread). Since the limit of binding to a thread of the 2 calls is not really needed, and our best implementation supports going cross threads, there is no real need to impose this restriction.

time:
2014-02-25T09:35:01Z
class:
src/main/java/org/elasticsearch/Version.java
comments:
Add coming 0.90.12 version to the constants

time:
2014-02-25T09:13:08Z
class:
src/main/java/org/apache/lucene/queries/BlendedTermQuery.java
src/main/java/org/apache/lucene/search/vectorhighlight/CustomFieldQuery.java
src/main/java/org/elasticsearch/search/highlight/CustomQueryScorer.java
src/test/java/org/apache/lucene/queries/BlendedTermQueryTest.java
src/test/java/org/elasticsearch/search/highlight/HighlighterSearchTests.java
comments:
Implement BlendedTermQuery#extractTerms to support highlighing.

some of the highlighters require term extraction to be implemented in
order to work. BlendedTermQuery doesn't implement the trivial extraction.

Closes #5246

time:
2014-02-25T07:49:13Z
class:
src/main/java/org/elasticsearch/cache/recycler/CacheRecycler.java
src/main/java/org/elasticsearch/cache/recycler/PageCacheRecycler.java
src/main/java/org/elasticsearch/common/recycler/AbstractRecyclerC.java
src/main/java/org/elasticsearch/common/recycler/DequeRecycler.java
src/main/java/org/elasticsearch/common/recycler/NoneRecycler.java
src/main/java/org/elasticsearch/common/recycler/Recycler.java
src/main/java/org/elasticsearch/common/recycler/Recyclers.java
src/test/java/org/elasticsearch/benchmark/common/recycler/RecyclerBenchmark.java
src/test/java/org/elasticsearch/common/recycler/AbstractRecyclerTests.java
src/test/java/org/elasticsearch/common/recycler/ConcurrentRecyclerTests.java
src/test/java/org/elasticsearch/common/recycler/LockedRecyclerTests.java
src/test/java/org/elasticsearch/common/recycler/NoneRecyclerTests.java
src/test/java/org/elasticsearch/common/recycler/QueueRecyclerTests.java
src/test/java/org/elasticsearch/common/recycler/SoftConcurrentRecyclerTests.java
src/test/java/org/elasticsearch/common/recycler/SoftThreadLocalRecyclerTests.java
src/test/java/org/elasticsearch/common/recycler/ThreadLocalRecyclerTests.java
comments:
Recycler: better lifecycle control for pooled instances (#5214)

- introduce additional destroy() callback that allows better control
over internals of recycled data
- introduced AbstractRecyclerC as superclass for Recycler factories
(Adrien) with empty destroy() by default
- added tests for destroy()
- cleaned up Recycler tests (reduce copy&paste)

time:
2014-02-24T23:17:01Z
class:
src/main/java/org/elasticsearch/percolator/PercolateContext.java
src/main/java/org/elasticsearch/percolator/PercolatorService.java
src/main/java/org/elasticsearch/search/highlight/FastVectorHighlighter.java
src/main/java/org/elasticsearch/search/highlight/HighlightPhase.java
src/main/java/org/elasticsearch/search/highlight/HighlightUtils.java
src/main/java/org/elasticsearch/search/highlight/HighlighterParseElement.java
src/main/java/org/elasticsearch/search/highlight/PlainHighlighter.java
src/main/java/org/elasticsearch/search/highlight/PostingsHighlighter.java
src/main/java/org/elasticsearch/search/highlight/SearchContextHighlight.java
src/test/java/org/elasticsearch/search/highlight/CustomHighlighter.java
src/test/java/org/elasticsearch/search/highlight/HighlighterSearchTests.java
comments:
Made SearchContextHighlight.Field class immutable to prevent from erroneously updating it, as it doesn't necessarily map to a single field

A Field instance can map to multiple actual fields when using wildcard expressions. Each actual field should use the proper highlighter depending on the available data structure (e.g. term_vectors), while we currently select the highlighter for the first field and we keep using the same for all the fields that match the wildcard expression.

Modified also how the PercolateContext sets the forceSource option, in a global manner now rather than per field.

Closes #5175

time:
2014-02-24T19:58:44Z
class:
src/test/java/org/elasticsearch/index/mapper/geo/GeoMappingTests.java
comments:
Need use ensureYellow() b/c get mapping request checks on actual shard instead of master node

time:
2014-02-24T16:49:45Z
class:
src/test/java/org/elasticsearch/indices/mapping/SimpleGetFieldMappingsTests.java
comments:
Need use ensureYellow() b/c get mapping request checks the mapping on the master node

time:
2014-02-24T14:54:24Z
class:
src/main/java/org/elasticsearch/action/ActionModule.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/get/GetFieldMappingsIndexRequest.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/get/GetFieldMappingsRequest.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/get/TransportGetFieldMappingsAction.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/get/TransportGetFieldMappingsIndexAction.java
comments:
Added TransportGetFieldMappingsIndexAction that uses TransportSingleCustomOperationAction as base class, with the goal to reuse common logic (like: retry on failures, shard picking, connecting to nodes)

time:
2014-02-24T13:49:22Z
class:
src/test/java/org/elasticsearch/indices/mapping/DedicatedMasterGetFieldMappingTests.java
comments:
[TEST] Added get field mapping test variant that tests with a cluster that has a master only node.

time:
2014-02-24T13:49:22Z
class:
src/main/java/org/elasticsearch/action/admin/indices/mapping/get/GetFieldMappingsRequest.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/get/GetFieldMappingsRequestBuilder.java
src/main/java/org/elasticsearch/action/admin/indices/mapping/get/TransportGetFieldMappingsAction.java
src/test/java/org/elasticsearch/indices/mapping/SimpleGetFieldMappingsTests.java
comments:
Change GetFieldMapping API to broadcast requests to nodes hosting the relevant indices.

This is due to the fact that have to have mappers in order to return the response.

Closes #5177

time:
2014-02-24T10:47:13Z
class:
src/main/java/org/elasticsearch/common/io/FileSystemUtils.java
src/main/java/org/elasticsearch/plugins/PluginsService.java
comments:
NPE in PluginsService when starting elasticsearch with a wrong user

When starting elasticsearch with a wrong linux user, it could generate a `NullPointerException` when `PluginsService` tries to list available plugins in `./plugins` dir.

To reproduce:

* create a plugins directory with `rwx` rights for root user only
* launch elasticsearch from another account (elasticsearch for example)

It was supposed to be fixed with #4186, but sadly it's not :-(

Closes #5195.

time:
2014-02-24T10:36:22Z
class:
comments:
[DOCS] Added note about dely in clearing filter cache.

Closes #5231

time:
2014-02-24T10:29:50Z
class:
comments:
[DOCS] Fix wrong explanation in configuration.asciidoc

Replaced network.host with node.name to match config file

time:
2014-02-23T00:05:36Z
class:
src/main/java/org/elasticsearch/snapshots/RestoreService.java
src/test/java/org/elasticsearch/snapshots/SharedClusterSnapshotRestoreTests.java
comments:
Open correct (renamed) index on restore

Closes #5212

time:
2014-02-22T23:28:19Z
class:
src/main/java/org/elasticsearch/snapshots/RestoreService.java
src/test/java/org/elasticsearch/snapshots/SharedClusterSnapshotRestoreTests.java
comments:
Restore process should replace the mapping and settings if index already exists

Closes #5210

time:
2014-02-21T20:43:40Z
class:
src/main/java/org/elasticsearch/search/highlight/PostingsHighlighter.java
src/test/java/org/elasticsearch/search/highlight/HighlighterSearchTests.java
comments:
Fixed multi term queries support in postings highlighter for non top-level queries

In #4052 we added support for highlighting multi term queries using the postings highlighter. That worked only for top-level queries though, and not for multi term queries that are nested for instance within a bool query, or filtered query, or a constant score query.

The way we make this work is by walking the query structure and temporarily overriding the query rewrite method with a method that allows for multi terms extraction.

Closes #5102

time:
2014-02-21T17:56:35Z
class:
src/main/java/org/elasticsearch/search/highlight/FastVectorHighlighter.java
src/main/java/org/elasticsearch/search/highlight/HighlightPhase.java
src/main/java/org/elasticsearch/search/highlight/PostingsHighlighter.java
src/test/java/org/elasticsearch/search/highlight/HighlighterSearchTests.java
comments:
Fixed field names returned when using wildcard expression to specify fields to highlight

Closes #5221

time:
2014-02-21T16:46:32Z
class:
src/main/java/org/elasticsearch/search/highlight/HighlightBuilder.java
src/test/java/org/elasticsearch/search/highlight/HighlighterSearchTests.java
comments:
Fixed per-field forceSource highlighting option

Closes #5220

time:
2014-02-21T11:01:32Z
class:
comments:
Document the indices segments response format.

time:
2014-02-21T01:51:46Z
class:
src/main/java/org/elasticsearch/search/aggregations/AggregatorFactories.java
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/DateHistogramParser.java
src/test/java/org/elasticsearch/search/aggregations/CombiTests.java
comments:
Fixed an issue where and IndexOutOfBoundsException was thrown when a date_/histogram aggregation was defined on unmapped field and also had a sub aggregation. The root cause there was that in such case, the estimated bucket count was 0, and the code was not designed to handle that well.

Closes #5179

time:
2014-02-20T23:08:13Z
class:
src/main/java/org/elasticsearch/common/Strings.java
src/test/java/org/elasticsearch/common/StringsTests.java
comments:
Fix possible exception in toCamelCase method

time:
2014-02-20T23:07:48Z
class:
src/main/java/org/elasticsearch/plugins/PluginManager.java
comments:
Remove useless URL instanciation

time:
2014-02-20T23:00:28Z
class:
src/main/java/org/elasticsearch/common/xcontent/XContentFactory.java
comments:
Fix yamlBuilder() to return YAML builder instead of SMILE

Closes #5185

time:
2014-02-20T22:53:08Z
class:
src/main/java/org/apache/lucene/queryparser/classic/MapperQueryParser.java
src/main/java/org/apache/lucene/queryparser/classic/QueryParserSettings.java
src/main/java/org/elasticsearch/common/util/LocaleUtils.java
src/main/java/org/elasticsearch/index/mapper/core/DateFieldMapper.java
src/main/java/org/elasticsearch/index/query/QueryStringQueryBuilder.java
src/main/java/org/elasticsearch/index/query/QueryStringQueryParser.java
src/main/java/org/elasticsearch/index/query/SimpleQueryParser.java
src/main/java/org/elasticsearch/index/query/SimpleQueryStringBuilder.java
src/main/java/org/elasticsearch/index/query/SimpleQueryStringParser.java
src/test/java/org/elasticsearch/index/mapper/date/SimpleDateMappingTests.java
src/test/java/org/elasticsearch/search/query/SimpleQueryTests.java
comments:
Add "locale" parameter to query_string and simple_query_string

Fixes #5128

Remove java 7 specific Locale functions, add "coming[1.1.0]" to documentation

add LocaleUtils utility class for dealing with Locale functions

time:
2014-02-20T22:45:22Z
class:
src/main/java/org/elasticsearch/index/engine/SegmentsStats.java
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
comments:
Disable RAM usage estimation on Lucene 3.x segments.

Close #5201

time:
2014-02-20T21:33:32Z
class:
src/main/java/org/elasticsearch/search/aggregations/support/AggregationContext.java
src/test/java/org/elasticsearch/search/aggregations/CombiTests.java
src/test/java/org/elasticsearch/search/aggregations/RandomTests.java
src/test/java/org/elasticsearch/search/aggregations/bucket/StringTermsTests.java
comments:
Changed the caching of FieldDataSource in aggs to be based on field name + required Value Source type as a combi key (used to be only field name). This fixes a problem where multiple aggregations where defined on the same field, yet require different types of value sources.

Closes #5190

time:
2014-02-20T18:05:10Z
class:
comments:
Add thrid party license generation profile

time:
2014-02-20T16:57:58Z
class:
src/test/java/org/elasticsearch/plugin/PluginManagerTests.java
comments:
Wait for REST Service to start

When running tests for site plugins, it could happen that the REST Service is not fully started and not ready immediately to serve HTTP requests.
It gives `503 Service Unavailable` error in that case.

This patch will gives 5 seconds before failing the test.

time:
2014-02-20T16:45:49Z
class:
comments:
[TEST] Removed whitespace between } and ,

time:
2014-02-20T15:43:06Z
class:
comments:
[DOCS] Included the `_percolator` index breaking change to migration docs.

time:
2014-02-20T15:01:23Z
class:
comments:
The seed format is suite:method, clarified it in the docs.

time:
2014-02-20T15:00:27Z
class:
comments:
[TEST] Added whitespaces after brackets, colons and commas in nested percolator test.

time:
2014-02-20T13:35:57Z
class:
src/main/java/org/elasticsearch/index/query/TemplateQueryBuilder.java
src/main/java/org/elasticsearch/index/query/TemplateQueryParser.java
src/main/java/org/elasticsearch/script/mustache/MustacheScriptEngineService.java
src/test/java/org/elasticsearch/index/query/TemplateQueryBuilderTest.java
src/test/java/org/elasticsearch/index/query/TemplateQueryParserTest.java
src/test/java/org/elasticsearch/index/query/TemplateQueryTest.java
src/test/java/org/elasticsearch/script/mustache/MustacheScriptEngineTest.java
src/test/java/org/elasticsearch/script/mustache/MustacheTest.java
comments:
Fixing license headers.

time:
2014-02-20T11:21:59Z
class:
src/main/java/org/elasticsearch/index/query/TemplateQueryBuilder.java
src/main/java/org/elasticsearch/index/query/TemplateQueryParser.java
src/main/java/org/elasticsearch/indices/query/IndicesQueriesModule.java
src/main/java/org/elasticsearch/script/ScriptModule.java
src/main/java/org/elasticsearch/script/mustache/MustacheScriptEngineService.java
src/test/java/org/elasticsearch/index/query/TemplateQueryBuilderTest.java
src/test/java/org/elasticsearch/index/query/TemplateQueryParserTest.java
src/test/java/org/elasticsearch/index/query/TemplateQueryTest.java
src/test/java/org/elasticsearch/script/mustache/MustacheScriptEngineTest.java
src/test/java/org/elasticsearch/script/mustache/MustacheTest.java
comments:
Add mustache templating to query execution.

Adds support for storing mustache based query templates that can later be filled
with query parameter values at execution time. Templates may be both quoted,
non-quoted and referencing templates stored in config/scripts/*.mustache by file
name.

See docs/reference/query-dsl/queries/template-query.asciidoc for templating
examples.

Implementation detail: mustache itself is being shaded as it depends directly on
guava - so having it marked optional but included in the final distribution
raises chances of version conflicts downstream.

Fixes #4879

time:
2014-02-20T08:01:56Z
class:
src/main/java/org/apache/lucene/queryparser/classic/ExistsFieldQueryExtension.java
src/main/java/org/apache/lucene/queryparser/classic/MissingFieldQueryExtension.java
src/main/java/org/elasticsearch/index/query/ExistsFilterParser.java
src/main/java/org/elasticsearch/index/query/MissingFilterParser.java
comments:
Make _exists_/_missing_ behave consistently with exists/missing.

`_exists_` and `_missing_` miss field name expansion that `exists` and
`missing` have, which allows these filters to work on `object` fields.

Close #5142

time:
2014-02-19T21:51:34Z
class:
src/test/java/org/elasticsearch/search/query/SimpleQueryTests.java
comments:
[TEST] Update testNGramCopyField to reflect the effect of an index_analyzer

time:
2014-02-19T19:03:12Z
class:
src/test/java/org/elasticsearch/indices/template/SimpleIndexTemplateTests.java
comments:
[TEST] Added index templates tests for broken mapping and invalid settings scenarios

time:
2014-02-19T18:08:35Z
class:
src/test/java/org/elasticsearch/index/analysis/NGramTokenizerFactoryTests.java
src/test/java/org/elasticsearch/search/query/SimpleQueryTests.java
comments:
Added tests for empty token chars on ngram tokenizer

This relates to #5120

time:
2014-02-19T18:02:15Z
class:
src/test/java/org/elasticsearch/test/rest/junit/RestTestSuiteRunner.java
comments:
[TEST] Initialization errors are checked before returning "no tests to run" error

If there initialization errors and no tests to execute at the same time, better to return the initialization errors, whose check should be first then, as it might be that the "no tests to execute" is caused by the initialization errors.

time:
2014-02-19T16:49:38Z
class:
comments:
[DOCS] Fixed typo in create index api

time:
2014-02-19T12:43:40Z
class:
comments:
Added script to extract release notes

Just call ./es_release_notes.pl <issue-tag> to get all release notes.

By default html output is returned, but you can switch to markdown by calling
./es_release_notes.pl <issue-tag> markdown

time:
2014-02-19T11:42:46Z
class:
src/test/java/org/elasticsearch/aliases/IndexAliasesTests.java
comments:
[TEST] Added tests for alias filter that is valid json but not a valid filter

time:
2014-02-19T11:04:30Z
class:
src/main/java/org/elasticsearch/action/admin/indices/alias/Alias.java
src/main/java/org/elasticsearch/cluster/metadata/IndexMetaData.java
src/main/java/org/elasticsearch/cluster/metadata/IndexTemplateMetaData.java
src/main/java/org/elasticsearch/cluster/metadata/MetaDataIndexAliasesService.java
comments:
Alias code cleanup

- Renamed IndexMetaData#removerAlias to removeAlias
- Removed IndexTemplateMetaData#fromXContentStandalone unused method (relates to #4511)
- MetaDataIndexAliasesService fix typo in comment
- Alias removed unused constructor that accepts both alias name and filter

time:
2014-02-19T10:06:09Z
class:
src/main/java/org/elasticsearch/search/SearchService.java
src/test/java/org/elasticsearch/search/StressSearchServiceReaperTest.java
src/test/java/org/elasticsearch/test/TestCluster.java
comments:
Add test and randomization for #5165

time:
2014-02-19T10:06:09Z
class:
src/main/java/org/elasticsearch/search/SearchService.java
src/main/java/org/elasticsearch/search/internal/DefaultSearchContext.java
comments:
Fix SearchContext from being closed prematurely

Fixes SearchContext from being closed during initialization or immediately
after processing is started

Closes #5165

time:
2014-02-19T09:31:32Z
class:
src/main/java/org/elasticsearch/action/admin/indices/delete/DeleteIndexRequest.java
src/main/java/org/elasticsearch/client/IndicesAdminClient.java
comments:
[DOCS] Javadoc: delete index request does not support empty String

In 0.90.x I was able to delete all my indices from the java api by calling

    client.admin().indices().prepareDelete(new String[] {}).execute().actionGet();

However this fails in 1.0.0 with

org.elasticsearch.action.ActionRequestValidationException: Validation Failed: 1: index / indices is missing;
	at org.elasticsearch.action.ValidateActions.addValidationError(ValidateActions.java:29)
	at org.elasticsearch.action.admin.indices.delete.DeleteIndexRequest.validate(DeleteIndexRequest.java:72)
	*snip long stacktrace*

which points me to

    public ActionRequestValidationException validate() {
        ActionRequestValidationException validationException = null;
        if (indices == null || indices.length == 0) {
            validationException = addValidationError("index / indices is missing", validationException);
        }
        return validationException;
    }

So that's what now throws the error, however the documentation still says:

    /**
     * Deletes an index based on the index name.
     *
     * @param indices The indices to delete. Empty array to delete all indices.
     */
    DeleteIndexRequestBuilder prepareDelete(String... indices);

Closes #5164.
Closes #5167.
Closes #5168.

time:
2014-02-18T19:55:08Z
class:
src/main/java/org/elasticsearch/rest/action/cat/RestCatAction.java
comments:
support help as well as h in direct cat call to list all actions

time:
2014-02-18T12:22:28Z
class:
comments:
Set permission in debian postinst script correctly

The old post installation script on debian set all data to
644 inside of /etc/elasticsearch, which does not work, when
there are subdirectories

Closes #3820

time:
2014-02-17T17:46:51Z
class:
comments:
Fix typo

time:
2014-02-17T17:15:30Z
class:
src/main/java/org/elasticsearch/common/xcontent/support/XContentMapValues.java
src/test/java/org/elasticsearch/search/source/SourceFetchingTests.java
comments:
Source filtering with wildcards broken when given multiple patterns

```
curl -XPUT 'http://localhost:9200/twitter/tweet/1' -d '{
    "user" : "kimchy",
    "post_date" : "2009-11-15T14:12:12",
    "message" : "trying out Elasticsearch", "retweeted": false
}'
```

No source fields delivered:

```
curl -XGET 'http://localhost:9200/twitter/tweet/1?_source=*.id,retweeted&pretty=yes'
```

`retweeted` returned:

```
curl -XGET 'http://localhost:9200/twitter/tweet/1?_source=retweeted,*.id&pretty=yes'
```

Closes #5132.
Closes #5133.

time:
2014-02-17T14:24:53Z
class:
comments:
Old versions (for es < 1.0) go to 1.x branch

time:
2014-02-17T14:21:24Z
class:
src/test/java/org/elasticsearch/index/analysis/SimplePolishIntegrationTests.java
comments:
Add test stempel analyzer in mapping

time:
2014-02-17T14:20:12Z
class:
comments:
[DOCS] Remove clear flag from node-stats as it is not used anymore

time:
2014-02-17T13:54:21Z
class:
src/main/java/org/elasticsearch/action/admin/indices/alias/Alias.java
src/main/java/org/elasticsearch/action/admin/indices/create/CreateIndexClusterStateUpdateRequest.java
src/main/java/org/elasticsearch/action/admin/indices/create/CreateIndexRequest.java
src/main/java/org/elasticsearch/action/admin/indices/create/CreateIndexRequestBuilder.java
src/main/java/org/elasticsearch/action/admin/indices/create/TransportCreateIndexAction.java
src/main/java/org/elasticsearch/cluster/metadata/AliasValidator.java
src/main/java/org/elasticsearch/cluster/metadata/MetaDataCreateIndexService.java
src/main/java/org/elasticsearch/cluster/metadata/MetaDataIndexAliasesService.java
src/test/java/org/elasticsearch/aliases/IndexAliasesTests.java
comments:
Added support for aliases to create index api

It is now possible to specify aliases during index creation:

curl -XPUT 'http://localhost:9200/test' -d '
{
    "aliases" : {
        "alias1" : {},
        "alias2" : {
            "filter" : { "term" : {"field":"value"}}
        }
    }
}'

Closes #4920

time:
2014-02-17T10:10:49Z
class:
src/main/java/org/elasticsearch/cluster/service/InternalClusterService.java
src/main/java/org/elasticsearch/discovery/local/LocalDiscovery.java
src/main/java/org/elasticsearch/discovery/zen/ZenDiscovery.java
comments:
Optimize multiple cluster state processing on receiving nodes
Nodes that receive the cluster state, and they have several of those pending, can optimize and try and process potentially only one of those.
closes #5139

time:
2014-02-14T21:42:33Z
class:
src/main/java/org/elasticsearch/percolator/MultiDocumentPercolatorIndex.java
src/main/java/org/elasticsearch/percolator/PercolateContext.java
src/main/java/org/elasticsearch/percolator/PercolatorIndex.java
src/main/java/org/elasticsearch/percolator/PercolatorService.java
src/main/java/org/elasticsearch/percolator/SingleDocumentPercolatorIndex.java
src/test/java/org/elasticsearch/percolator/MultiPercolatorTests.java
src/test/java/org/elasticsearch/percolator/PercolatorTests.java
comments:
Enable percolation for nested documents

closes #5082

time:
2014-02-14T18:55:49Z
class:
src/main/java/org/elasticsearch/index/query/SimpleQueryParser.java
comments:
Fix license header for SimpleQueryParser

time:
2014-02-14T18:51:23Z
class:
src/main/java/org/elasticsearch/index/query/SimpleQueryParser.java
src/main/java/org/elasticsearch/index/query/SimpleQueryStringBuilder.java
src/main/java/org/elasticsearch/index/query/SimpleQueryStringParser.java
src/test/java/org/elasticsearch/search/query/SimpleQueryTests.java
comments:
Add support for `lowercase_expanded_terms` flag to simple_query_string

Default the flag to true, making simple_query_string behave similarly to
query_string

Fixes #5008

time:
2014-02-14T18:37:00Z
class:
src/main/java/org/apache/lucene/analysis/miscellaneous/XASCIIFoldingFilter.java
src/main/java/org/elasticsearch/index/analysis/ASCIIFoldingTokenFilterFactory.java
src/test/java/org/elasticsearch/index/analysis/ASCIIFoldingTokenFilterFactoryTests.java
comments:
Add preserve original token option to ASCIIFolding

Closes #4931

time:
2014-02-14T18:05:40Z
class:
comments:
code coverage hookup

time:
2014-02-14T17:39:08Z
class:
comments:
prepare for next development iteration

time:
2014-02-14T17:39:08Z
class:
comments:
prepare release elasticsearch-cloud-azure-2.0.0

time:
2014-02-14T16:54:25Z
class:
src/main/java/org/elasticsearch/percolator/PercolatorService.java
src/test/java/org/elasticsearch/percolator/PercolatorTests.java
comments:
Fixed issue where highlighting in percolate existing doc api doesn't work (no highlight snippets)

time:
2014-02-14T16:39:06Z
class:
src/test/java/org/elasticsearch/search/child/SimpleChildQuerySearchTests.java
comments:
Make sure that parent type is created explicitly.
Cleaned up the p/c integration tests to use shorter mapping definition, ensureGreen() and .get()

time:
2014-02-14T12:11:10Z
class:
comments:
[DOCS] improved get docs

- added _version to response
- exists call use -XHEAD with -i flag to include headers in the output

time:
2014-02-14T12:11:10Z
class:
comments:
Update get.asciidoc

Minor improvements.

curl -XHEAD doesn't actually print anything so I've changed to use -I which actually prints the headers received.

time:
2014-02-14T10:48:58Z
class:
src/main/java/org/elasticsearch/common/unit/DistanceUnit.java
src/test/java/org/elasticsearch/common/unit/DistanceUnitTests.java
comments:
Added the `DistanceUnit.NAUTICALMILES` enumeration
label with the corresponding *NM* and *nmi* unit
suffixes. Update the docs to match.

Closes #5085

time:
2014-02-14T10:35:40Z
class:
comments:
[TEST] added missing wait for yellow in put warmer REST test

time:
2014-02-13T19:36:02Z
class:
comments:
[docs] fixed errors in aggs docs
- error in nested aggs example
- error in terms aggs example

time:
2014-02-13T16:31:33Z
class:
src/main/java/org/elasticsearch/index/query/SimpleQueryStringParser.java
src/test/java/org/elasticsearch/search/query/SimpleQueryTests.java
comments:
Allow specifying nested fields in simple_query_string

Fixes #5091

time:
2014-02-13T15:45:30Z
class:
comments:
Fix typo in similarity docs

DRF similarity -> DFR similarity

time:
2014-02-13T12:36:20Z
class:
comments:
[DOCS] fixed count docs, it now requires a top-level query object, same as other apis

Relates to #4074

time:
2014-02-13T10:44:51Z
class:
comments:
[DOCS] rephrased delete by query docs

time:
2014-02-13T10:42:04Z
class:
comments:
[DOCS] fixed count and validate query docs, they now require a top-level query object, same as other apis

Relates to #4074
Closes #5111

time:
2014-02-13T10:02:36Z
class:
comments:
add elasticsearch-osem to integrations page

time:
2014-02-13T09:38:04Z
class:
comments:
[DOCS] add DynamoDB river plugin

time:
2014-02-13T09:33:15Z
class:
comments:
fixed markup and typo

time:
2014-02-13T03:28:00Z
class:
comments:
[DOCS] should use setPostFilter instead of setFilter

time:
2014-02-12T15:17:25Z
class:
comments:
[DOCS] Changed coming[] to added[] for 1.0.0*

time:
2014-02-12T15:13:35Z
class:
src/main/java/org/elasticsearch/percolator/PercolateContext.java
src/main/java/org/elasticsearch/percolator/PercolatorService.java
src/test/java/org/elasticsearch/percolator/PercolatorTests.java
comments:
Made highlight query also work in the percolate api.

time:
2014-02-12T14:24:38Z
class:
comments:
[DOCS] added coming tags for `zen.discovery.publish_timeout` made dynamic

time:
2014-02-12T11:50:55Z
class:
src/main/java/org/elasticsearch/cluster/routing/allocation/decider/ShardsLimitAllocationDecider.java
comments:
Minor cleanups in ShardsLimitAllocationDecider

time:
2014-02-12T09:45:37Z
class:
src/main/java/org/elasticsearch/discovery/DiscoverySettings.java
src/test/java/org/elasticsearch/cluster/settings/ClusterSettingsTests.java
comments:
Improved ClusterSettingsTests

more assertAcked, checked that the `discovery.zen.publish_timeout` has been changed in `DiscoverySettings`, removed restriction on number of nodes, doesn't seem needed.

time:
2014-02-12T09:45:37Z
class:
comments:
[DOCS] Documented `discovery.zen.publish_timeout` setting

time:
2014-02-12T09:45:30Z
class:
comments:
[DOCS] added `discovery.zen.publish_timeout` to the dynamic settings list

time:
2014-02-11T16:16:43Z
class:
comments:
[TEST] disabled replicas in validate query test

time:
2014-02-11T15:23:16Z
class:
src/test/java/org/elasticsearch/deleteByQuery/DeleteByQueryTests.java
comments:
Beefed up DeleteByQueryTests to run not just against a single document

time:
2014-02-11T15:12:53Z
class:
comments:
[DOC] Updated the Ruby gem version for Elasticsearch 0.90.x

time:
2014-02-11T14:58:57Z
class:
src/test/java/org/elasticsearch/search/rescore/QueryRescorerTests.java
comments:
Added test #5078

time:
2014-02-11T14:23:07Z
class:
comments:
[DOCS] Fix typo in rename_pattern in snapshot/restore documentation

time:
2014-02-11T13:59:15Z
class:
src/test/java/org/elasticsearch/index/query/SimpleIndexQueryParserTests.java
comments:
[Docs] Remove `custom_score` from documentation and add a migration
section.

time:
2014-02-11T13:59:15Z
class:
src/main/java/org/elasticsearch/index/query/CustomBoostFactorQueryBuilder.java
src/main/java/org/elasticsearch/index/query/CustomBoostFactorQueryParser.java
src/main/java/org/elasticsearch/index/query/CustomFiltersScoreQueryBuilder.java
src/main/java/org/elasticsearch/index/query/CustomFiltersScoreQueryParser.java
src/main/java/org/elasticsearch/index/query/CustomScoreQueryBuilder.java
src/main/java/org/elasticsearch/index/query/CustomScoreQueryParser.java
src/main/java/org/elasticsearch/index/query/QueryBuilders.java
src/main/java/org/elasticsearch/indices/query/IndicesQueriesModule.java
src/test/java/org/elasticsearch/index/query/SimpleIndexQueryParserTests.java
src/test/java/org/elasticsearch/search/basic/TransportTwoNodesSearchTests.java
src/test/java/org/elasticsearch/search/child/SimpleChildQuerySearchTests.java
src/test/java/org/elasticsearch/search/customscore/CustomScoreSearchTests.java
src/test/java/org/elasticsearch/search/sort/SimpleSortTests.java
comments:
Remove `custom_score` and `custom_boost_factor` queries

`custom_boost_factor` and `custom_score` were deprecated in `0.90.5`
and their documentation was removed already in `1.0`. This commit
removes all support for those queries since they are supercede by
`function_score`.

time:
2014-02-11T11:04:28Z
class:
src/main/java/org/elasticsearch/cluster/settings/ClusterDynamicSettingsModule.java
src/main/java/org/elasticsearch/cluster/settings/Validator.java
src/main/java/org/elasticsearch/discovery/Discovery.java
src/main/java/org/elasticsearch/discovery/DiscoverySettings.java
src/main/java/org/elasticsearch/discovery/local/LocalDiscovery.java
src/main/java/org/elasticsearch/discovery/zen/ZenDiscovery.java
src/main/java/org/elasticsearch/discovery/zen/publish/PublishClusterStateAction.java
src/test/java/org/elasticsearch/cluster/ack/AckClusterUpdateSettingsTests.java
src/test/java/org/elasticsearch/cluster/ack/AckTests.java
src/test/java/org/elasticsearch/cluster/settings/ClusterSettingsTests.java
comments:
Made possible to dynamically update `discovery.zen.publish_timeout` cluster setting

`discovery.zen.publish_timeout` controls how long the master node is going to try and wait for all the nodes to respond to a cluster state publish before going ahead with the following updates in the queue (default 30s). Up until now changing the settings required restarting each node. The setting is now dynamic and can be changed through the cluster update settings api.

Closes #5063

time:
2014-02-11T10:55:24Z
class:
comments:
[DOCS] Add GitHub community river plugin

time:
2014-02-11T09:05:10Z
class:
src/main/java/org/elasticsearch/action/admin/cluster/node/info/NodesInfoRequest.java
src/main/java/org/elasticsearch/action/admin/cluster/node/info/NodesInfoRequestBuilder.java
src/main/java/org/elasticsearch/action/admin/cluster/node/info/TransportNodesInfoAction.java
src/main/java/org/elasticsearch/rest/action/admin/cluster/node/info/RestNodesInfoAction.java
src/test/java/org/elasticsearch/nodesinfo/SimpleNodesInfoTests.java
src/test/java/org/elasticsearch/plugin/PluginManagerTests.java
comments:
Migrating NodesInfo API to use plugins instead of singular plugin

In order to be consistent (and because in 1.0 we switched from
parameter driven information to specifzing the metrics as part of the URI)
this patch moves from 'plugin' to 'plugins' in the Nodes Info API.

time:
2014-02-11T02:43:53Z
class:
comments:
[DOCS] adding a note on python client versioning schema

time:
2014-02-10T18:31:40Z
class:
comments:
Add prerequisite about openssl version

time:
2014-02-10T17:14:10Z
class:
src/main/java/org/elasticsearch/common/lucene/docset/AndDocIdSet.java
src/test/java/org/elasticsearch/percolator/PercolatorTests.java
comments:
Fix AndDocIdSet#IteratorBasedIterator to not violate initial doc state

AndDocIdSet#IteratorBasedIterator was potentially initialized with
NO_MORE_DOCS which violates the initial state of DocIdSetIterator and
could lead to undefined behavior when used in a search context.

Closes #5049

time:
2014-02-10T15:22:38Z
class:
comments:
[TEST] Made cat.count REST test more readable

time:
2014-02-10T15:20:04Z
class:
src/main/java/org/elasticsearch/rest/action/cat/RestThreadPoolAction.java
comments:
more AbstractRestResponseActionListener in RestThreadPoolAction (cat api)

time:
2014-02-10T15:20:03Z
class:
comments:
[TEST] fixed typo in _cat/thread_pool docs

time:
2014-02-10T15:20:03Z
class:
comments:
[TEST] Added REST tests for _cat/thread_pool endpoint

time:
2014-02-10T11:32:34Z
class:
comments:
[TEST] moved routing REST tests to 0 replicas

REST tests get run against either 1 node or multiple nodes. Wait for yellow with replicas>0 is not enough when running against multiple nodes as replicas shard might get initialized  during testing, which can cause timing issues.

time:
2014-02-10T11:32:34Z
class:
comments:
[TEST] Fixed get_source/60_realtime_refresh REST test to work against multiple nodes

Replaced also wait for yellow with wait for green when using no replicas.

get_source/60_realtime_refresh tests per shard refresh using refresh:true and realtime:true in get api. We might run into troubles though if we have a replica that gets initialized after a doc was indexed without a refresh, as that doc will be found when searching against that specific replica shard (as a refresh happens automatically before a replica gets exposed as started).

time:
2014-02-10T11:23:01Z
class:
src/main/java/org/elasticsearch/rest/action/cat/RestShardsAction.java
comments:
[TEST] Add basic test for /cat/shards/{index}

Basic REST test for rendering the cat/shards endpoint.

time:
2014-02-10T10:58:42Z
class:
comments:
[DOCS] Added a table with 0.90/1.0 compatibility and corresponding instructions

time:
2014-02-10T09:58:13Z
class:
comments:
[TEST] Fixed delete/50_refresh REST test to work against multiple nodes

delete/50_refresh tests per shard refresh using refresh:true in delete api. We might run into troubles though if we have a replica that gets initialized after a doc was indexed and deleted, without a refresh, as that doc won't be found when searching against that specific replica shard (as a refresh happens automatically before a replica gets exposed as started).

time:
2014-02-10T01:24:03Z
class:
src/main/java/org/elasticsearch/cluster/ClusterState.java
src/main/java/org/elasticsearch/rest/action/admin/cluster/state/RestClusterStateAction.java
comments:
add version and master_node flags to cluster state

time:
2014-02-10T00:21:58Z
class:
src/main/java/org/elasticsearch/cluster/action/shard/ShardStateAction.java
comments:
Bulk process of shard started/failed should not execute on already processed events
closes #5061

time:
2014-02-09T21:05:36Z
class:
src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/DateHistogramParser.java
src/test/java/org/elasticsearch/search/aggregations/bucket/DateHistogramTests.java
comments:
Fixed parsing time zones as numeric value in DateHistogramParser

Closes #5057

time:
2014-02-09T13:19:59Z
class:
comments:
[TEST] Removed nested quantifier in cat.allocation regex and made node name regex more liberal

time:
2014-02-08T09:43:54Z
class:
comments:
[DOCS] Add GridFS repository community plugin

time:
2014-02-08T01:21:26Z
class:
comments:
Merge pull request #5055 from seang-es/fix/5025

Doc fix explaining resynchronization with the Cancel command.

time:
2014-02-07T22:02:36Z
class:
comments:
Doc fix explaining resynchronization with the Cancel command.

Added line explaining resync process to Reroute/Cancel command.

Closes #5025

time:
2014-02-07T19:59:42Z
class:
comments:
[DOCS] Removed deprecated queries/filters from Java API docs

time:
2014-02-07T19:52:49Z
class:
comments:
Removed 0.90.* deprecation and addition notifications

Closes #5052

time:
2014-02-07T18:20:36Z
class:
comments:
Wait for green in mlt tests

time:
2014-02-07T17:28:00Z
class:
comments:
[TESTS] Looks like Java character classes require explicit \s

time:
2014-02-07T17:22:07Z
class:
comments:
[TEST] fixed cat/allocation REST tests

time:
2014-02-07T16:54:38Z
class:
comments:
[TESTS] Make cat.allocation tests handle different disk sizes

time:
2014-02-07T16:44:41Z
class:
comments:
[TESTS] Fixed cat.allocation tests to work with one node cluster

time:
2014-02-07T16:36:01Z
class:
comments:
[TEST] Added cat.allocation and cat.aliases tests

time:
2014-02-07T14:24:08Z
class:
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
comments:
Log warning in case of double release of the IndexSearcher instead of throwing an exception.

time:
2014-02-07T13:51:15Z
class:
src/test/java/org/elasticsearch/search/aggregations/bucket/DoubleTermsTests.java
comments:
Add a aggregation test that uses `doc.score` to make sure we don't forget to set the Scorer.

time:
2014-02-07T12:52:49Z
class:
comments:
[TEST] disabled refresh for get_source realtime test

time:
2014-02-07T12:52:49Z
class:
comments:
[TEST] slightly sped up warmer tests by providing warmers during index creation

time:
2014-02-07T12:52:49Z
class:
comments:
[TEST] removed leftover delete alias test in delete mapping

time:
2014-02-07T12:52:48Z
class:
src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java
src/test/java/org/elasticsearch/test/TestCluster.java
src/test/java/org/elasticsearch/test/rest/RestTestExecutionContext.java
src/test/java/org/elasticsearch/test/rest/client/RestClient.java
src/test/java/org/elasticsearch/test/rest/junit/RestTestSuiteRunner.java
src/test/java/org/elasticsearch/tribe/TribeTests.java
comments:
[TEST] run REST tests against multiple nodes (round-robin)

Multiple nodes are now started when running REST tests against the `TestCluster` (default randomized settings are now used instead of the hardcoded `1`)

Added also randomized round-robin based on all available nodes, and ability to provide multiple addresses when running tests against an external cluster to have the same behaviour

time:
2014-02-07T12:35:58Z
class:
comments:
s/\t/    /

time:
2014-02-07T11:20:34Z
class:
src/main/java/org/elasticsearch/index/analysis/PreBuiltAnalyzerProviderFactory.java
src/main/java/org/elasticsearch/index/analysis/PreBuiltCharFilterFactoryFactory.java
src/main/java/org/elasticsearch/index/analysis/PreBuiltTokenFilterFactoryFactory.java
src/main/java/org/elasticsearch/index/analysis/PreBuiltTokenizerFactoryFactory.java
src/main/java/org/elasticsearch/indices/analysis/PreBuiltAnalyzers.java
src/main/java/org/elasticsearch/indices/analysis/PreBuiltCharFilters.java
src/main/java/org/elasticsearch/indices/analysis/PreBuiltTokenFilters.java
src/main/java/org/elasticsearch/indices/analysis/PreBuiltTokenizers.java
src/test/java/org/elasticsearch/indices/analysis/DummyAnalysisBinderProcessor.java
src/test/java/org/elasticsearch/indices/analysis/DummyAnalysisPlugin.java
src/test/java/org/elasticsearch/indices/analysis/DummyAnalyzer.java
src/test/java/org/elasticsearch/indices/analysis/DummyAnalyzerProvider.java
src/test/java/org/elasticsearch/indices/analysis/DummyCharFilterFactory.java
src/test/java/org/elasticsearch/indices/analysis/DummyIndicesAnalysis.java
src/test/java/org/elasticsearch/indices/analysis/DummyIndicesAnalysisModule.java
src/test/java/org/elasticsearch/indices/analysis/DummyTokenFilterFactory.java
src/test/java/org/elasticsearch/indices/analysis/DummyTokenizerFactory.java
src/test/java/org/elasticsearch/indices/analysis/PreBuiltAnalyzerIntegrationTests.java
comments:
Upgrading analysis plugins fails

When an analysis plugins provides default index settings using `PreBuiltAnalyzerProviderFactory`,  `PreBuiltTokenFilterFactoryFactory` or `PreBuiltTokenizerFactoryFactory` it fails when upgrading it with elasticsearch superior or equal to 0.90.5.

Related issue: #4936

Fix is needed in core. But, in the meantime, analysis plugins developers can fix that issue by overloading default prebuilt factories.

For example:

```java
public class StempelAnalyzerProviderFactory extends PreBuiltAnalyzerProviderFactory {

    private final PreBuiltAnalyzerProvider analyzerProvider;

    public StempelAnalyzerProviderFactory(String name, AnalyzerScope scope, Analyzer analyzer) {
        super(name, scope, analyzer);
        analyzerProvider = new PreBuiltAnalyzerProvider(name, scope, analyzer);
    }

    @Override
    public AnalyzerProvider create(String name, Settings settings) {
        return analyzerProvider;
    }

    public Analyzer analyzer() {
        return analyzerProvider.get();
    }
}
```

And instead of:

```java
    @Inject
    public PolishIndicesAnalysis(Settings settings, IndicesAnalysisService indicesAnalysisService) {
        super(settings);
        indicesAnalysisService.analyzerProviderFactories().put("polish", new PreBuiltAnalyzerProviderFactory("polish", AnalyzerScope.INDICES, new PolishAnalyzer(Lucene.ANALYZER_VERSION)));
    }
```

do

```java
    @Inject
    public PolishIndicesAnalysis(Settings settings, IndicesAnalysisService indicesAnalysisService) {
        super(settings);
        indicesAnalysisService.analyzerProviderFactories().put("polish", new StempelAnalyzerProviderFactory("polish", AnalyzerScope.INDICES, new PolishAnalyzer(Lucene.ANALYZER_VERSION)));
    }
```

Closes #5030

time:
2014-02-07T11:02:11Z
class:
src/test/java/org/apache/lucene/queries/BlendedTermQueryTest.java
comments:
Extend ElasticsearchLuceneTestCase rather than LuceneTestCase

LuceneTestCase misses some thread filters that might fail a test
since a background cluster is still running from a previous test.

time:
2014-02-07T09:38:45Z
class:
src/main/java/org/elasticsearch/index/gateway/IndexShardGatewayService.java
src/main/java/org/elasticsearch/index/mapper/MapperService.java
src/main/java/org/elasticsearch/indices/recovery/RecoveryTarget.java
comments:
fixed trace logging hidden by check for isDebugEnabled

time:
2014-02-07T08:55:10Z
class:
src/main/java/org/elasticsearch/search/aggregations/InternalAggregation.java
src/main/java/org/elasticsearch/search/aggregations/bucket/BucketUtils.java
src/main/java/org/elasticsearch/search/aggregations/bucket/geogrid/GeoHashGridParser.java
src/main/java/org/elasticsearch/search/aggregations/bucket/geogrid/InternalGeoHashGrid.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/InternalTerms.java
src/test/java/org/elasticsearch/search/aggregations/bucket/GeoHashGridTests.java
comments:
Make size=0 return all buckets for the geohash_grid aggregation.

Close #4875

time:
2014-02-07T08:46:06Z
class:
src/main/java/org/elasticsearch/search/aggregations/bucket/BytesRefHash.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/StringTerms.java
src/main/java/org/elasticsearch/search/aggregations/bucket/terms/StringTermsAggregator.java
src/test/java/org/elasticsearch/cache/recycler/MockPageCacheRecycler.java
src/test/java/org/elasticsearch/search/aggregations/RandomTests.java
comments:
Fix BytesRef owning issue in string terms aggregations.

The byte[] array that was used to store the term was owned by the BytesRefHash
which is used to compute counts. However, the BytesRefHash is released at some
point and its content may be recycled.

MockPageCacheRecycler has been improved to expose this issue (putting random
content into the arrays upon release).

Number of documents/terms have been increased in RandomTests to make sure page
recycling occurs.

Close #5021

time:
2014-02-07T07:50:15Z
class:
comments:
[DOCS] delete by query requires a top-level query parameter

Closes #5044
(cherry picked from commit 1e265b3)

time:
2014-02-06T20:45:38Z
class:
src/main/java/org/apache/lucene/search/XReferenceManager.java
src/main/java/org/apache/lucene/search/XSearcherManager.java
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
src/test/java/org/elasticsearch/test/engine/MockInternalEngine.java
comments:
Use patched version of ReferenceManager to prevent infinite loop in
RefrenceManager#accquire()

See LUCENE-5436

time:
2014-02-06T20:00:56Z
class:
src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java
comments:
Be paranoid about double release.

time:
2014-02-06T20:00:56Z
class:
comments:
Add IndexReader reference counting methods to forbidden APIs.

time:
2014-02-06T18:10:46Z
class:
comments:
[DOCS] Added backwards compatibility instructions to Perl client

time:
2014-02-06T17:19:54Z
class:
comments:
add redis transport plugin

time:
2014-02-06T17:14:21Z
class:
comments:
Add Marvel and Paramedic to config file

time:
2014-02-06T17:05:10Z
class:
src/main/java/org/apache/lucene/queryparser/XSimpleQueryParser.java
src/main/java/org/elasticsearch/index/query/SimpleQueryStringFlag.java
src/main/java/org/elasticsearch/index/query/SimpleQueryStringParser.java
comments:
Add fuzzy/slop support to `simple_query_string`

Ports the change from https://issues.apache.org/jira/browse/LUCENE-5410

time:
2014-02-06T17:01:58Z
class:
comments:
[DOCS] organize a bit the repository plugins

(cherry picked from commit 88e1c20c4581885db7e5e65edf7eb3629c2d31ca)
I would not mention S3 repository here because you say it later

I actually like the redundancy since it's clear is the same plugin - otherwise, it might be confusing to see the same URL having two different descriptions.


time:
2014-02-06T16:29:40Z
class:
comments:
Fixed the string() code literal in the java client index api doc.

time:
2014-02-06T16:25:27Z
class:
comments:
Updated nodes info endpoint in elasticsearch.yml

Relates to #4055

